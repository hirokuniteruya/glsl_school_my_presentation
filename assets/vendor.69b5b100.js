var mM=Object.defineProperty,gM=Object.defineProperties;var _M=Object.getOwnPropertyDescriptors;var Lc=Object.getOwnPropertySymbols;var Ym=Object.prototype.hasOwnProperty,Zm=Object.prototype.propertyIsEnumerable;var Jm=(r,t,e)=>t in r?mM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,gt=(r,t)=>{for(var e in t||(t={}))Ym.call(t,e)&&Jm(r,e,t[e]);if(Lc)for(var e of Lc(t))Zm.call(t,e)&&Jm(r,e,t[e]);return r},Bt=(r,t)=>gM(r,_M(t));var Za=(r,t)=>{var e={};for(var n in r)Ym.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&Lc)for(var n of Lc(r))t.indexOf(n)<0&&Zm.call(r,n)&&(e[n]=r[n]);return e};/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const cd="136",po={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},fo={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},vM=0,Km=1,xM=2,Qm=1,yM=2,Ja=3,Ka=0,Ge=1,mo=2,tg=1,Cs=0,Qa=1,eg=2,ng=3,ig=4,bM=5,go=100,wM=101,MM=102,sg=103,rg=104,SM=200,TM=201,EM=202,CM=203,og=204,ag=205,AM=206,PM=207,RM=208,DM=209,LM=210,kM=0,IM=1,NM=2,hd=3,FM=4,OM=5,zM=6,VM=7,kc=0,BM=1,UM=2,As=0,HM=1,WM=2,GM=3,qM=4,jM=5,lg=300,tl=301,el=302,ud=303,dd=304,Ic=306,pd=307,fd=1e3,Bn=1001,md=1002,qe=1003,cg=1004,hg=1005,vn=1006,$M=1007,Nc=1008,Ji=1009,XM=1010,YM=1011,nl=1012,ZM=1013,Fc=1014,Ps=1015,Mr=1016,JM=1017,KM=1018,QM=1019,_o=1020,t1=1021,Sr=1022,Ye=1023,e1=1024,n1=1025,Tr=1026,vo=1027,i1=1028,s1=1029,r1=1030,o1=1031,a1=1032,l1=1033,ug=33776,dg=33777,pg=33778,fg=33779,mg=35840,gg=35841,_g=35842,vg=35843,c1=36196,xg=37492,yg=37496,h1=37808,u1=37809,d1=37810,p1=37811,f1=37812,m1=37813,g1=37814,_1=37815,v1=37816,x1=37817,y1=37818,b1=37819,w1=37820,M1=37821,S1=36492,T1=37840,E1=37841,C1=37842,A1=37843,P1=37844,R1=37845,D1=37846,L1=37847,k1=37848,I1=37849,N1=37850,F1=37851,O1=37852,z1=37853,V1=2200,B1=2201,U1=2202,Oc=2300,zc=2301,gd=2302,xo=2400,yo=2401,Vc=2402,_d=2500,bg=2501,H1=0,pi=3e3,bo=3001,W1=3200,G1=3201,wo=0,q1=1,vd=7680,j1=519,il=35044,Bc=35048,wg="300 es";class Rs{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const i=this._listeners[t];if(i!==void 0){const s=i.indexOf(e);s!==-1&&i.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const i=n.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,t);t.target=null}}}const sn=[];for(let r=0;r<256;r++)sn[r]=(r<16?"0":"")+r.toString(16);const xd=Math.PI/180,yd=180/Math.PI;function Ri(){const r=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(sn[r&255]+sn[r>>8&255]+sn[r>>16&255]+sn[r>>24&255]+"-"+sn[t&255]+sn[t>>8&255]+"-"+sn[t>>16&15|64]+sn[t>>24&255]+"-"+sn[e&63|128]+sn[e>>8&255]+"-"+sn[e>>16&255]+sn[e>>24&255]+sn[n&255]+sn[n>>8&255]+sn[n>>16&255]+sn[n>>24&255]).toUpperCase()}function En(r,t,e){return Math.max(t,Math.min(e,r))}function $1(r,t){return(r%t+t)%t}function bd(r,t,e){return(1-e)*r+e*t}function Mg(r){return(r&r-1)==0&&r!==0}function X1(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}class ht{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*n-o*i+t.x,this.y=s*i+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ht.prototype.isVector2=!0;class rn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,s,o,a,l,h){const u=this.elements;return u[0]=t,u[1]=i,u[2]=a,u[3]=e,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,s=this.elements,o=n[0],a=n[3],l=n[6],h=n[1],u=n[4],d=n[7],f=n[2],m=n[5],_=n[8],x=i[0],w=i[3],v=i[6],y=i[1],C=i[4],S=i[7],M=i[2],E=i[5],T=i[8];return s[0]=o*x+a*y+l*M,s[3]=o*w+a*C+l*E,s[6]=o*v+a*S+l*T,s[1]=h*x+u*y+d*M,s[4]=h*w+u*C+d*E,s[7]=h*v+u*S+d*T,s[2]=f*x+m*y+_*M,s[5]=f*w+m*C+_*E,s[8]=f*v+m*S+_*T,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8];return e*o*u-e*a*h-n*s*u+n*a*l+i*s*h-i*o*l}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8],d=u*o-a*h,f=a*l-u*s,m=h*s-o*l,_=e*d+n*f+i*m;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/_;return t[0]=d*x,t[1]=(i*h-u*n)*x,t[2]=(a*n-i*o)*x,t[3]=f*x,t[4]=(u*e-i*l)*x,t[5]=(i*s-a*e)*x,t[6]=m*x,t[7]=(n*l-h*e)*x,t[8]=(o*e-n*s)*x,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,s,o,a){const l=Math.cos(s),h=Math.sin(s);return this.set(n*l,n*h,-n*(l*o+h*a)+o+t,-i*h,i*l,-i*(-h*o+l*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],h=i[4],u=i[7];return i[0]=e*s+n*l,i[3]=e*o+n*h,i[6]=e*a+n*u,i[1]=-n*s+e*l,i[4]=-n*o+e*h,i[7]=-n*a+e*u,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}rn.prototype.isMatrix3=!0;function Sg(r){if(r.length===0)return-1/0;let t=r[0];for(let e=1,n=r.length;e<n;++e)r[e]>t&&(t=r[e]);return t}function Uc(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}let Mo;class So{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Mo===void 0&&(Mo=Uc("canvas")),Mo.width=t.width,Mo.height=t.height;const n=Mo.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Mo}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let Y1=0;class Ze extends Rs{constructor(t=Ze.DEFAULT_IMAGE,e=Ze.DEFAULT_MAPPING,n=Bn,i=Bn,s=vn,o=Nc,a=Ye,l=Ji,h=1,u=pi){super();Object.defineProperty(this,"id",{value:Y1++}),this.uuid=Ri(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=l,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.center=new ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new rn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const i=this.image;if(i.uuid===void 0&&(i.uuid=Ri()),!e&&t.images[i.uuid]===void 0){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(wd(i[o].image)):s.push(wd(i[o]))}else s=wd(i);t.images[i.uuid]={uuid:i.uuid,url:s}}n.image=i.uuid}return JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==lg)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case fd:t.x=t.x-Math.floor(t.x);break;case Bn:t.x=t.x<0?0:1;break;case md:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case fd:t.y=t.y-Math.floor(t.y);break;case Bn:t.y=t.y<0?0:1;break;case md:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}}Ze.DEFAULT_IMAGE=void 0;Ze.DEFAULT_MAPPING=lg;Ze.prototype.isTexture=!0;function wd(r){return typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap?So.getDataURL(r):r.data?{data:Array.prototype.slice.call(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class ge{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,s=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*s,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*s,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*s,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,s;const o=.01,a=.1,l=t.elements,h=l[0],u=l[4],d=l[8],f=l[1],m=l[5],_=l[9],x=l[2],w=l[6],v=l[10];if(Math.abs(u-f)<o&&Math.abs(d-x)<o&&Math.abs(_-w)<o){if(Math.abs(u+f)<a&&Math.abs(d+x)<a&&Math.abs(_+w)<a&&Math.abs(h+m+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const C=(h+1)/2,S=(m+1)/2,M=(v+1)/2,E=(u+f)/4,T=(d+x)/4,R=(_+w)/4;return C>S&&C>M?C<o?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(C),i=E/n,s=T/n):S>M?S<o?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(S),n=E/i,s=R/i):M<o?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(M),n=T/s,i=R/s),this.set(n,i,s,e),this}let y=Math.sqrt((w-_)*(w-_)+(d-x)*(d-x)+(f-u)*(f-u));return Math.abs(y)<.001&&(y=1),this.x=(w-_)/y,this.y=(d-x)/y,this.z=(f-u)/y,this.w=Math.acos((h+m+v-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}ge.prototype.isVector4=!0;class Kn extends Rs{constructor(t,e,n={}){super();this.width=t,this.height=e,this.depth=1,this.scissor=new ge(0,0,t,e),this.scissorTest=!1,this.viewport=new ge(0,0,t,e),this.texture=new Ze(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:vn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=gt({},this.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Kn.prototype.isWebGLRenderTarget=!0;class Z1 extends Kn{constructor(t,e,n){super(t,e);const i=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=i.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}Z1.prototype.isWebGLMultipleRenderTargets=!0;class Md extends Kn{constructor(t,e,n={}){super(t,e,n);this.samples=4,this.ignoreDepthForMultisampleCopy=n.ignoreDepth!==void 0?n.ignoreDepth:!0,this.useRenderToTexture=n.useRenderToTexture!==void 0?n.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}}Md.prototype.isWebGLMultisampleRenderTarget=!0;class on{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,s,o,a){let l=n[i+0],h=n[i+1],u=n[i+2],d=n[i+3];const f=s[o+0],m=s[o+1],_=s[o+2],x=s[o+3];if(a===0){t[e+0]=l,t[e+1]=h,t[e+2]=u,t[e+3]=d;return}if(a===1){t[e+0]=f,t[e+1]=m,t[e+2]=_,t[e+3]=x;return}if(d!==x||l!==f||h!==m||u!==_){let w=1-a;const v=l*f+h*m+u*_+d*x,y=v>=0?1:-1,C=1-v*v;if(C>Number.EPSILON){const M=Math.sqrt(C),E=Math.atan2(M,v*y);w=Math.sin(w*E)/M,a=Math.sin(a*E)/M}const S=a*y;if(l=l*w+f*S,h=h*w+m*S,u=u*w+_*S,d=d*w+x*S,w===1-a){const M=1/Math.sqrt(l*l+h*h+u*u+d*d);l*=M,h*=M,u*=M,d*=M}}t[e]=l,t[e+1]=h,t[e+2]=u,t[e+3]=d}static multiplyQuaternionsFlat(t,e,n,i,s,o){const a=n[i],l=n[i+1],h=n[i+2],u=n[i+3],d=s[o],f=s[o+1],m=s[o+2],_=s[o+3];return t[e]=a*_+u*d+l*m-h*f,t[e+1]=l*_+u*f+h*d-a*m,t[e+2]=h*_+u*m+a*f-l*d,t[e+3]=u*_-a*d-l*f-h*m,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,s=t._z,o=t._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(i/2),d=a(s/2),f=l(n/2),m=l(i/2),_=l(s/2);switch(o){case"XYZ":this._x=f*u*d+h*m*_,this._y=h*m*d-f*u*_,this._z=h*u*_+f*m*d,this._w=h*u*d-f*m*_;break;case"YXZ":this._x=f*u*d+h*m*_,this._y=h*m*d-f*u*_,this._z=h*u*_-f*m*d,this._w=h*u*d+f*m*_;break;case"ZXY":this._x=f*u*d-h*m*_,this._y=h*m*d+f*u*_,this._z=h*u*_+f*m*d,this._w=h*u*d-f*m*_;break;case"ZYX":this._x=f*u*d-h*m*_,this._y=h*m*d+f*u*_,this._z=h*u*_-f*m*d,this._w=h*u*d+f*m*_;break;case"YZX":this._x=f*u*d+h*m*_,this._y=h*m*d+f*u*_,this._z=h*u*_-f*m*d,this._w=h*u*d-f*m*_;break;case"XZY":this._x=f*u*d-h*m*_,this._y=h*m*d-f*u*_,this._z=h*u*_+f*m*d,this._w=h*u*d+f*m*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],s=e[8],o=e[1],a=e[5],l=e[9],h=e[2],u=e[6],d=e[10],f=n+a+d;if(f>0){const m=.5/Math.sqrt(f+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-h)*m,this._z=(o-i)*m}else if(n>a&&n>d){const m=2*Math.sqrt(1+n-a-d);this._w=(u-l)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+h)/m}else if(a>d){const m=2*Math.sqrt(1+a-n-d);this._w=(s-h)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+d-n-a);this._w=(o-i)/m,this._x=(s+h)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(En(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,s=t._z,o=t._w,a=e._x,l=e._y,h=e._z,u=e._w;return this._x=n*u+o*a+i*h-s*l,this._y=i*u+o*l+s*a-n*h,this._z=s*u+o*h+n*l-i*a,this._w=o*u-n*a-i*l-s*h,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,i=this._y,s=this._z,o=this._w;let a=o*t._w+n*t._x+i*t._y+s*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*n+e*this._x,this._y=m*i+e*this._y,this._z=m*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),d=Math.sin((1-e)*u)/h,f=Math.sin(e*u)/h;return this._w=o*d+this._w*f,this._x=n*d+this._x*f,this._y=i*d+this._y*f,this._z=s*d+this._z*f,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(s),n*Math.cos(s),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}on.prototype.isQuaternion=!0;class H{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Tg.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Tg.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6]*i,this.y=s[1]*e+s[4]*n+s[7]*i,this.z=s[2]*e+s[5]*n+s[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,s=t.elements,o=1/(s[3]*e+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*e+s[4]*n+s[8]*i+s[12])*o,this.y=(s[1]*e+s[5]*n+s[9]*i+s[13])*o,this.z=(s[2]*e+s[6]*n+s[10]*i+s[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,s=t.x,o=t.y,a=t.z,l=t.w,h=l*e+o*i-a*n,u=l*n+a*e-s*i,d=l*i+s*n-o*e,f=-s*e-o*n-a*i;return this.x=h*l+f*-s+u*-a-d*-o,this.y=u*l+f*-o+d*-s-h*-a,this.z=d*l+f*-a+h*-o-u*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i,this.y=s[1]*e+s[5]*n+s[9]*i,this.z=s[2]*e+s[6]*n+s[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,s=t.z,o=e.x,a=e.y,l=e.z;return this.x=i*l-s*a,this.y=s*o-n*l,this.z=n*a-i*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Sd.copy(this).projectOnVector(t),this.sub(Sd)}reflect(t){return this.sub(Sd.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(En(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}H.prototype.isVector3=!0;const Sd=new H,Tg=new on;class fi{constructor(t=new H(1/0,1/0,1/0),e=new H(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=t.length;l<h;l+=3){const u=t[l],d=t[l+1],f=t[l+2];u<e&&(e=u),d<n&&(n=d),f<i&&(i=f),u>s&&(s=u),d>o&&(o=d),f>a&&(a=f)}return this.min.set(e,n,i),this.max.set(s,o,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=t.count;l<h;l++){const u=t.getX(l),d=t.getY(l),f=t.getZ(l);u<e&&(e=u),d<n&&(n=d),f<i&&(i=f),u>s&&(s=u),d>o&&(o=d),f>a&&(a=f)}return this.min.set(e,n,i),this.max.set(s,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=sl.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;e!==void 0&&(e.boundingBox===null&&e.computeBoundingBox(),Td.copy(e.boundingBox),Td.applyMatrix4(t.matrixWorld),this.union(Td));const n=t.children;for(let i=0,s=n.length;i<s;i++)this.expandByObject(n[i]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,sl),sl.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(rl),Hc.subVectors(this.max,rl),To.subVectors(t.a,rl),Eo.subVectors(t.b,rl),Co.subVectors(t.c,rl),Ds.subVectors(Eo,To),Ls.subVectors(Co,Eo),Er.subVectors(To,Co);let e=[0,-Ds.z,Ds.y,0,-Ls.z,Ls.y,0,-Er.z,Er.y,Ds.z,0,-Ds.x,Ls.z,0,-Ls.x,Er.z,0,-Er.x,-Ds.y,Ds.x,0,-Ls.y,Ls.x,0,-Er.y,Er.x,0];return!Ed(e,To,Eo,Co,Hc)||(e=[1,0,0,0,1,0,0,0,1],!Ed(e,To,Eo,Co,Hc))?!1:(Wc.crossVectors(Ds,Ls),e=[Wc.x,Wc.y,Wc.z],Ed(e,To,Eo,Co,Hc))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return sl.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(sl).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Ki[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ki[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ki[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ki[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ki[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ki[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ki[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ki[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ki),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}fi.prototype.isBox3=!0;const Ki=[new H,new H,new H,new H,new H,new H,new H,new H],sl=new H,Td=new fi,To=new H,Eo=new H,Co=new H,Ds=new H,Ls=new H,Er=new H,rl=new H,Hc=new H,Wc=new H,Cr=new H;function Ed(r,t,e,n,i){for(let s=0,o=r.length-3;s<=o;s+=3){Cr.fromArray(r,s);const a=i.x*Math.abs(Cr.x)+i.y*Math.abs(Cr.y)+i.z*Math.abs(Cr.z),l=t.dot(Cr),h=e.dot(Cr),u=n.dot(Cr);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}const J1=new fi,Eg=new H,Gc=new H,Cd=new H;class Ao{constructor(t=new H,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):J1.setFromPoints(t).getCenter(n);let i=0;for(let s=0,o=t.length;s<o;s++)i=Math.max(i,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Cd.subVectors(t,this.center);const e=Cd.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),i=(n-this.radius)*.5;this.center.add(Cd.multiplyScalar(i/n)),this.radius+=i}return this}union(t){return this.center.equals(t.center)===!0?Gc.set(0,0,1).multiplyScalar(t.radius):Gc.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Eg.copy(t.center).add(Gc)),this.expandByPoint(Eg.copy(t.center).sub(Gc)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Qi=new H,Ad=new H,qc=new H,ks=new H,Pd=new H,jc=new H,Rd=new H;class Ar{constructor(t=new H,e=new H(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Qi)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Qi.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Qi.copy(this.direction).multiplyScalar(e).add(this.origin),Qi.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){Ad.copy(t).add(e).multiplyScalar(.5),qc.copy(e).sub(t).normalize(),ks.copy(this.origin).sub(Ad);const s=t.distanceTo(e)*.5,o=-this.direction.dot(qc),a=ks.dot(this.direction),l=-ks.dot(qc),h=ks.lengthSq(),u=Math.abs(1-o*o);let d,f,m,_;if(u>0)if(d=o*l-a,f=o*a-l,_=s*u,d>=0)if(f>=-_)if(f<=_){const x=1/u;d*=x,f*=x,m=d*(d+o*f+2*a)+f*(o*d+f+2*l)+h}else f=s,d=Math.max(0,-(o*f+a)),m=-d*d+f*(f+2*l)+h;else f=-s,d=Math.max(0,-(o*f+a)),m=-d*d+f*(f+2*l)+h;else f<=-_?(d=Math.max(0,-(-o*s+a)),f=d>0?-s:Math.min(Math.max(-s,-l),s),m=-d*d+f*(f+2*l)+h):f<=_?(d=0,f=Math.min(Math.max(-s,-l),s),m=f*(f+2*l)+h):(d=Math.max(0,-(o*s+a)),f=d>0?s:Math.min(Math.max(-s,-l),s),m=-d*d+f*(f+2*l)+h);else f=o>0?-s:s,d=Math.max(0,-(o*f+a)),m=-d*d+f*(f+2*l)+h;return n&&n.copy(this.direction).multiplyScalar(d).add(this.origin),i&&i.copy(qc).multiplyScalar(f).add(Ad),m}intersectSphere(t,e){Qi.subVectors(t.center,this.origin);const n=Qi.dot(this.direction),i=Qi.dot(Qi)-n*n,s=t.radius*t.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=n-o,l=n+o;return a<0&&l<0?null:a<0?this.at(l,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,s,o,a,l;const h=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,f=this.origin;return h>=0?(n=(t.min.x-f.x)*h,i=(t.max.x-f.x)*h):(n=(t.max.x-f.x)*h,i=(t.min.x-f.x)*h),u>=0?(s=(t.min.y-f.y)*u,o=(t.max.y-f.y)*u):(s=(t.max.y-f.y)*u,o=(t.min.y-f.y)*u),n>o||s>i||((s>n||n!==n)&&(n=s),(o<i||i!==i)&&(i=o),d>=0?(a=(t.min.z-f.z)*d,l=(t.max.z-f.z)*d):(a=(t.max.z-f.z)*d,l=(t.min.z-f.z)*d),n>l||a>i)||((a>n||n!==n)&&(n=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,e)}intersectsBox(t){return this.intersectBox(t,Qi)!==null}intersectTriangle(t,e,n,i,s){Pd.subVectors(e,t),jc.subVectors(n,t),Rd.crossVectors(Pd,jc);let o=this.direction.dot(Rd),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;ks.subVectors(this.origin,t);const l=a*this.direction.dot(jc.crossVectors(ks,jc));if(l<0)return null;const h=a*this.direction.dot(Pd.cross(ks));if(h<0||l+h>o)return null;const u=-a*ks.dot(Rd);return u<0?null:this.at(u/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ot{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,s,o,a,l,h,u,d,f,m,_,x,w){const v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=h,v[6]=u,v[10]=d,v[14]=f,v[3]=m,v[7]=_,v[11]=x,v[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ot().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/Po.setFromMatrixColumn(t,0).length(),s=1/Po.setFromMatrixColumn(t,1).length(),o=1/Po.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,s=t.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(i),h=Math.sin(i),u=Math.cos(s),d=Math.sin(s);if(t.order==="XYZ"){const f=o*u,m=o*d,_=a*u,x=a*d;e[0]=l*u,e[4]=-l*d,e[8]=h,e[1]=m+_*h,e[5]=f-x*h,e[9]=-a*l,e[2]=x-f*h,e[6]=_+m*h,e[10]=o*l}else if(t.order==="YXZ"){const f=l*u,m=l*d,_=h*u,x=h*d;e[0]=f+x*a,e[4]=_*a-m,e[8]=o*h,e[1]=o*d,e[5]=o*u,e[9]=-a,e[2]=m*a-_,e[6]=x+f*a,e[10]=o*l}else if(t.order==="ZXY"){const f=l*u,m=l*d,_=h*u,x=h*d;e[0]=f-x*a,e[4]=-o*d,e[8]=_+m*a,e[1]=m+_*a,e[5]=o*u,e[9]=x-f*a,e[2]=-o*h,e[6]=a,e[10]=o*l}else if(t.order==="ZYX"){const f=o*u,m=o*d,_=a*u,x=a*d;e[0]=l*u,e[4]=_*h-m,e[8]=f*h+x,e[1]=l*d,e[5]=x*h+f,e[9]=m*h-_,e[2]=-h,e[6]=a*l,e[10]=o*l}else if(t.order==="YZX"){const f=o*l,m=o*h,_=a*l,x=a*h;e[0]=l*u,e[4]=x-f*d,e[8]=_*d+m,e[1]=d,e[5]=o*u,e[9]=-a*u,e[2]=-h*u,e[6]=m*d+_,e[10]=f-x*d}else if(t.order==="XZY"){const f=o*l,m=o*h,_=a*l,x=a*h;e[0]=l*u,e[4]=-d,e[8]=h*u,e[1]=f*d+x,e[5]=o*u,e[9]=m*d-_,e[2]=_*d-m,e[6]=a*u,e[10]=x*d+f}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(K1,t,Q1)}lookAt(t,e,n){const i=this.elements;return Un.subVectors(t,e),Un.lengthSq()===0&&(Un.z=1),Un.normalize(),Is.crossVectors(n,Un),Is.lengthSq()===0&&(Math.abs(n.z)===1?Un.x+=1e-4:Un.z+=1e-4,Un.normalize(),Is.crossVectors(n,Un)),Is.normalize(),$c.crossVectors(Un,Is),i[0]=Is.x,i[4]=$c.x,i[8]=Un.x,i[1]=Is.y,i[5]=$c.y,i[9]=Un.y,i[2]=Is.z,i[6]=$c.z,i[10]=Un.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,s=this.elements,o=n[0],a=n[4],l=n[8],h=n[12],u=n[1],d=n[5],f=n[9],m=n[13],_=n[2],x=n[6],w=n[10],v=n[14],y=n[3],C=n[7],S=n[11],M=n[15],E=i[0],T=i[4],R=i[8],F=i[12],z=i[1],L=i[5],A=i[9],D=i[13],I=i[2],B=i[6],k=i[10],G=i[14],tt=i[3],K=i[7],j=i[11],$=i[15];return s[0]=o*E+a*z+l*I+h*tt,s[4]=o*T+a*L+l*B+h*K,s[8]=o*R+a*A+l*k+h*j,s[12]=o*F+a*D+l*G+h*$,s[1]=u*E+d*z+f*I+m*tt,s[5]=u*T+d*L+f*B+m*K,s[9]=u*R+d*A+f*k+m*j,s[13]=u*F+d*D+f*G+m*$,s[2]=_*E+x*z+w*I+v*tt,s[6]=_*T+x*L+w*B+v*K,s[10]=_*R+x*A+w*k+v*j,s[14]=_*F+x*D+w*G+v*$,s[3]=y*E+C*z+S*I+M*tt,s[7]=y*T+C*L+S*B+M*K,s[11]=y*R+C*A+S*k+M*j,s[15]=y*F+C*D+S*G+M*$,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],s=t[12],o=t[1],a=t[5],l=t[9],h=t[13],u=t[2],d=t[6],f=t[10],m=t[14],_=t[3],x=t[7],w=t[11],v=t[15];return _*(+s*l*d-i*h*d-s*a*f+n*h*f+i*a*m-n*l*m)+x*(+e*l*m-e*h*f+s*o*f-i*o*m+i*h*u-s*l*u)+w*(+e*h*d-e*a*m-s*o*d+n*o*m+s*a*u-n*h*u)+v*(-i*a*u-e*l*d+e*a*f+i*o*d-n*o*f+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8],d=t[9],f=t[10],m=t[11],_=t[12],x=t[13],w=t[14],v=t[15],y=d*w*h-x*f*h+x*l*m-a*w*m-d*l*v+a*f*v,C=_*f*h-u*w*h-_*l*m+o*w*m+u*l*v-o*f*v,S=u*x*h-_*d*h+_*a*m-o*x*m-u*a*v+o*d*v,M=_*d*l-u*x*l-_*a*f+o*x*f+u*a*w-o*d*w,E=e*y+n*C+i*S+s*M;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/E;return t[0]=y*T,t[1]=(x*f*s-d*w*s-x*i*m+n*w*m+d*i*v-n*f*v)*T,t[2]=(a*w*s-x*l*s+x*i*h-n*w*h-a*i*v+n*l*v)*T,t[3]=(d*l*s-a*f*s-d*i*h+n*f*h+a*i*m-n*l*m)*T,t[4]=C*T,t[5]=(u*w*s-_*f*s+_*i*m-e*w*m-u*i*v+e*f*v)*T,t[6]=(_*l*s-o*w*s-_*i*h+e*w*h+o*i*v-e*l*v)*T,t[7]=(o*f*s-u*l*s+u*i*h-e*f*h-o*i*m+e*l*m)*T,t[8]=S*T,t[9]=(_*d*s-u*x*s-_*n*m+e*x*m+u*n*v-e*d*v)*T,t[10]=(o*x*s-_*a*s+_*n*h-e*x*h-o*n*v+e*a*v)*T,t[11]=(u*a*s-o*d*s-u*n*h+e*d*h+o*n*m-e*a*m)*T,t[12]=M*T,t[13]=(u*x*i-_*d*i+_*n*f-e*x*f-u*n*w+e*d*w)*T,t[14]=(_*a*i-o*x*i-_*n*l+e*x*l+o*n*w-e*a*w)*T,t[15]=(o*d*i-u*a*i+u*n*l-e*d*l-o*n*f+e*a*f)*T,this}scale(t){const e=this.elements,n=t.x,i=t.y,s=t.z;return e[0]*=n,e[4]*=i,e[8]*=s,e[1]*=n,e[5]*=i,e[9]*=s,e[2]*=n,e[6]*=i,e[10]*=s,e[3]*=n,e[7]*=i,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),s=1-n,o=t.x,a=t.y,l=t.z,h=s*o,u=s*a;return this.set(h*o+n,h*a-i*l,h*l+i*a,0,h*a+i*l,u*a+n,u*l-i*o,0,h*l-i*a,u*l+i*o,s*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,s,o){return this.set(1,n,s,0,t,1,o,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,s=e._x,o=e._y,a=e._z,l=e._w,h=s+s,u=o+o,d=a+a,f=s*h,m=s*u,_=s*d,x=o*u,w=o*d,v=a*d,y=l*h,C=l*u,S=l*d,M=n.x,E=n.y,T=n.z;return i[0]=(1-(x+v))*M,i[1]=(m+S)*M,i[2]=(_-C)*M,i[3]=0,i[4]=(m-S)*E,i[5]=(1-(f+v))*E,i[6]=(w+y)*E,i[7]=0,i[8]=(_+C)*T,i[9]=(w-y)*T,i[10]=(1-(f+x))*T,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let s=Po.set(i[0],i[1],i[2]).length();const o=Po.set(i[4],i[5],i[6]).length(),a=Po.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],mi.copy(this);const h=1/s,u=1/o,d=1/a;return mi.elements[0]*=h,mi.elements[1]*=h,mi.elements[2]*=h,mi.elements[4]*=u,mi.elements[5]*=u,mi.elements[6]*=u,mi.elements[8]*=d,mi.elements[9]*=d,mi.elements[10]*=d,e.setFromRotationMatrix(mi),n.x=s,n.y=o,n.z=a,this}makePerspective(t,e,n,i,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*s/(e-t),h=2*s/(n-i),u=(e+t)/(e-t),d=(n+i)/(n-i),f=-(o+s)/(o-s),m=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,i,s,o){const a=this.elements,l=1/(e-t),h=1/(n-i),u=1/(o-s),d=(e+t)*l,f=(n+i)*h,m=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}Ot.prototype.isMatrix4=!0;const Po=new H,mi=new Ot,K1=new H(0,0,0),Q1=new H(1,1,1),Is=new H,$c=new H,Un=new H,Cg=new Ot,Ag=new on;class Ro{constructor(t=0,e=0,n=0,i=Ro.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,s=i[0],o=i[4],a=i[8],l=i[1],h=i[5],u=i[9],d=i[2],f=i[6],m=i[10];switch(e){case"XYZ":this._y=Math.asin(En(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,h),this._z=0);break;case"YXZ":this._x=Math.asin(-En(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(En(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-En(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(En(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-En(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Cg.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Cg,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Ag.setFromEuler(this),this.setFromQuaternion(Ag,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new H(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Ro.prototype.isEuler=!0;Ro.DefaultOrder="XYZ";Ro.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Dd{constructor(){this.mask=1|0}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=4294967295|0}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}isEnabled(t){return(this.mask&(1<<t|0))!=0}}let tS=0;const Pg=new H,Do=new on,ts=new Ot,Xc=new H,ol=new H,eS=new H,nS=new on,Rg=new H(1,0,0),Dg=new H(0,1,0),Lg=new H(0,0,1),iS={type:"added"},kg={type:"removed"};class le extends Rs{constructor(){super();Object.defineProperty(this,"id",{value:tS++}),this.uuid=Ri(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=le.DefaultUp.clone();const t=new H,e=new Ro,n=new on,i=new H(1,1,1);function s(){n.setFromEuler(e,!1)}function o(){e.setFromQuaternion(n,void 0,!1)}e._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ot},normalMatrix:{value:new rn}}),this.matrix=new Ot,this.matrixWorld=new Ot,this.matrixAutoUpdate=le.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Dd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Do.setFromAxisAngle(t,e),this.quaternion.multiply(Do),this}rotateOnWorldAxis(t,e){return Do.setFromAxisAngle(t,e),this.quaternion.premultiply(Do),this}rotateX(t){return this.rotateOnAxis(Rg,t)}rotateY(t){return this.rotateOnAxis(Dg,t)}rotateZ(t){return this.rotateOnAxis(Lg,t)}translateOnAxis(t,e){return Pg.copy(t).applyQuaternion(this.quaternion),this.position.add(Pg.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Rg,t)}translateY(t){return this.translateOnAxis(Dg,t)}translateZ(t){return this.translateOnAxis(Lg,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(ts.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Xc.copy(t):Xc.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),ol.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ts.lookAt(ol,Xc,this.up):ts.lookAt(Xc,ol,this.up),this.quaternion.setFromRotationMatrix(ts),i&&(ts.extractRotation(i.matrixWorld),Do.setFromRotationMatrix(ts),this.quaternion.premultiply(Do.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(iS)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(kg)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(kg)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),ts.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),ts.multiply(t.parent.matrixWorld)),t.applyMatrix4(ts),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ol,t,eS),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ol,nS,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,u=l.length;h<u;h++){const d=l[h];s(t.shapes,d)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(s(t.materials,this.material[l]));i.material=a}else i.material=s(t.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(t.animations,l))}}if(e){const a=o(t.geometries),l=o(t.materials),h=o(t.textures),u=o(t.images),d=o(t.shapes),f=o(t.skeletons),m=o(t.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),d.length>0&&(n.shapes=d),f.length>0&&(n.skeletons=f),m.length>0&&(n.animations=m)}return n.object=i,n;function o(a){const l=[];for(const h in a){const u=a[h];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const i=t.children[n];this.add(i.clone())}return this}}le.DefaultUp=new H(0,1,0);le.DefaultMatrixAutoUpdate=!0;le.prototype.isObject3D=!0;const gi=new H,es=new H,Ld=new H,ns=new H,Lo=new H,ko=new H,Ig=new H,kd=new H,Id=new H,Nd=new H;class Be{constructor(t=new H,e=new H,n=new H){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),gi.subVectors(t,e),i.cross(gi);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(t,e,n,i,s){gi.subVectors(i,e),es.subVectors(n,e),Ld.subVectors(t,e);const o=gi.dot(gi),a=gi.dot(es),l=gi.dot(Ld),h=es.dot(es),u=es.dot(Ld),d=o*h-a*a;if(d===0)return s.set(-2,-1,-1);const f=1/d,m=(h*l-a*u)*f,_=(o*u-a*l)*f;return s.set(1-m-_,_,m)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,ns),ns.x>=0&&ns.y>=0&&ns.x+ns.y<=1}static getUV(t,e,n,i,s,o,a,l){return this.getBarycoord(t,e,n,i,ns),l.set(0,0),l.addScaledVector(s,ns.x),l.addScaledVector(o,ns.y),l.addScaledVector(a,ns.z),l}static isFrontFacing(t,e,n,i){return gi.subVectors(n,e),es.subVectors(t,e),gi.cross(es).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return gi.subVectors(this.c,this.b),es.subVectors(this.a,this.b),gi.cross(es).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Be.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Be.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,s){return Be.getUV(t,this.a,this.b,this.c,e,n,i,s)}containsPoint(t){return Be.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Be.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,s=this.c;let o,a;Lo.subVectors(i,n),ko.subVectors(s,n),kd.subVectors(t,n);const l=Lo.dot(kd),h=ko.dot(kd);if(l<=0&&h<=0)return e.copy(n);Id.subVectors(t,i);const u=Lo.dot(Id),d=ko.dot(Id);if(u>=0&&d<=u)return e.copy(i);const f=l*d-u*h;if(f<=0&&l>=0&&u<=0)return o=l/(l-u),e.copy(n).addScaledVector(Lo,o);Nd.subVectors(t,s);const m=Lo.dot(Nd),_=ko.dot(Nd);if(_>=0&&m<=_)return e.copy(s);const x=m*h-l*_;if(x<=0&&h>=0&&_<=0)return a=h/(h-_),e.copy(n).addScaledVector(ko,a);const w=u*_-m*d;if(w<=0&&d-u>=0&&m-_>=0)return Ig.subVectors(s,i),a=(d-u)/(d-u+(m-_)),e.copy(i).addScaledVector(Ig,a);const v=1/(w+x+f);return o=x*v,a=f*v,e.copy(n).addScaledVector(Lo,o).addScaledVector(ko,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let sS=0;class dn extends Rs{constructor(){super();Object.defineProperty(this,"id",{value:sS++}),this.uuid=Ri(),this.name="",this.type="Material",this.fog=!0,this.blending=Qa,this.side=Ka,this.vertexColors=!1,this.opacity=1,this.format=Ye,this.transparent=!1,this.blendSrc=og,this.blendDst=ag,this.blendEquation=go,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=hd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=j1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=vd,this.stencilZFail=vd,this.stencilZPass=vd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===tg;continue}const i=this[e];if(i===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Qa&&(n.blending=this.blending),this.side!==Ka&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==Ye&&(n.format=this.format),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(e){const s=i(t.textures),o=i(t.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.format=t.format,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const i=e.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=e[s].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}dn.prototype.isMaterial=!0;const Ng={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_i={h:0,s:0,l:0},Yc={h:0,s:0,l:0};function Fd(r,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+(t-r)*6*e:e<1/2?t:e<2/3?r+(t-r)*6*(2/3-e):r}function Od(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function zd(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class kt{constructor(t,e,n){return e===void 0&&n===void 0?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=$1(t,1),e=En(e,0,1),n=En(n,0,1),e===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,s=2*n-i;this.r=Fd(s,i,t+1/3),this.g=Fd(s,i,t),this.b=Fd(s,i,t-1/3)}return this}setStyle(t){function e(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let i;const s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const a=parseFloat(i[1])/360,l=parseInt(i[2],10)/100,h=parseInt(i[3],10)/100;return e(i[4]),this.setHSL(a,l,h)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const i=n[1],s=i.length;if(s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=Ng[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Od(t.r),this.g=Od(t.g),this.b=Od(t.b),this}copyLinearToSRGB(t){return this.r=zd(t.r),this.g=zd(t.g),this.b=zd(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,i=this.b,s=Math.max(e,n,i),o=Math.min(e,n,i);let a,l;const h=(o+s)/2;if(o===s)a=0,l=0;else{const u=s-o;switch(l=h<=.5?u/(s+o):u/(2-s-o),s){case e:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-e)/u+2;break;case i:a=(e-n)/u+4;break}a/=6}return t.h=a,t.s=l,t.l=h,t}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(t,e,n){return this.getHSL(_i),_i.h+=t,_i.s+=e,_i.l+=n,this.setHSL(_i.h,_i.s,_i.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(_i),t.getHSL(Yc);const n=bd(_i.h,Yc.h,e),i=bd(_i.s,Yc.s,e),s=bd(_i.l,Yc.l,e);return this.setHSL(n,i,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}kt.NAMES=Ng;kt.prototype.isColor=!0;kt.prototype.r=1;kt.prototype.g=1;kt.prototype.b=1;class Vd extends dn{constructor(t){super();this.type="MeshBasicMaterial",this.color=new kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}Vd.prototype.isMeshBasicMaterial=!0;const be=new H,Zc=new ht;class je{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=il,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new kt),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new ht),e[n++]=o.x,e[n++]=o.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new H),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new ge),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)Zc.fromBufferAttribute(this,e),Zc.applyMatrix3(t),this.setXY(e,Zc.x,Zc.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)be.fromBufferAttribute(this,e),be.applyMatrix3(t),this.setXYZ(e,be.x,be.y,be.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)be.x=this.getX(e),be.y=this.getY(e),be.z=this.getZ(e),be.applyMatrix4(t),this.setXYZ(e,be.x,be.y,be.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)be.x=this.getX(e),be.y=this.getY(e),be.z=this.getZ(e),be.applyNormalMatrix(t),this.setXYZ(e,be.x,be.y,be.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)be.x=this.getX(e),be.y=this.getY(e),be.z=this.getZ(e),be.transformDirection(t),this.setXYZ(e,be.x,be.y,be.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,s){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==il&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}}je.prototype.isBufferAttribute=!0;class Fg extends je{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Og extends je{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class rS extends je{constructor(t,e,n){super(new Uint16Array(t),e,n)}}rS.prototype.isFloat16BufferAttribute=!0;class ce extends je{constructor(t,e,n){super(new Float32Array(t),e,n)}}let oS=0;const Qn=new Ot,Bd=new le,Io=new H,Hn=new fi,al=new fi,Je=new H;class de extends Rs{constructor(){super();Object.defineProperty(this,"id",{value:oS++}),this.uuid=Ri(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Sg(t)>65535?Og:Fg)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new rn().getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Qn.makeRotationFromQuaternion(t),this.applyMatrix4(Qn),this}rotateX(t){return Qn.makeRotationX(t),this.applyMatrix4(Qn),this}rotateY(t){return Qn.makeRotationY(t),this.applyMatrix4(Qn),this}rotateZ(t){return Qn.makeRotationZ(t),this.applyMatrix4(Qn),this}translate(t,e,n){return Qn.makeTranslation(t,e,n),this.applyMatrix4(Qn),this}scale(t,e,n){return Qn.makeScale(t,e,n),this.applyMatrix4(Qn),this}lookAt(t){return Bd.lookAt(t),Bd.updateMatrix(),this.applyMatrix4(Bd.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Io).negate(),this.translate(Io.x,Io.y,Io.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const s=t[n];e.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ce(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new fi);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new H(-1/0,-1/0,-1/0),new H(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++){const s=e[n];Hn.setFromBufferAttribute(s),this.morphTargetsRelative?(Je.addVectors(this.boundingBox.min,Hn.min),this.boundingBox.expandByPoint(Je),Je.addVectors(this.boundingBox.max,Hn.max),this.boundingBox.expandByPoint(Je)):(this.boundingBox.expandByPoint(Hn.min),this.boundingBox.expandByPoint(Hn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ao);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new H,1/0);return}if(t){const n=this.boundingSphere.center;if(Hn.setFromBufferAttribute(t),e)for(let s=0,o=e.length;s<o;s++){const a=e[s];al.setFromBufferAttribute(a),this.morphTargetsRelative?(Je.addVectors(Hn.min,al.min),Hn.expandByPoint(Je),Je.addVectors(Hn.max,al.max),Hn.expandByPoint(Je)):(Hn.expandByPoint(al.min),Hn.expandByPoint(al.max))}Hn.getCenter(n);let i=0;for(let s=0,o=t.count;s<o;s++)Je.fromBufferAttribute(t,s),i=Math.max(i,n.distanceToSquared(Je));if(e)for(let s=0,o=e.length;s<o;s++){const a=e[s],l=this.morphTargetsRelative;for(let h=0,u=a.count;h<u;h++)Je.fromBufferAttribute(a,h),l&&(Io.fromBufferAttribute(t,h),Je.add(Io)),i=Math.max(i,n.distanceToSquared(Je))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,i=e.position.array,s=e.normal.array,o=e.uv.array,a=i.length/3;e.tangent===void 0&&this.setAttribute("tangent",new je(new Float32Array(4*a),4));const l=e.tangent.array,h=[],u=[];for(let z=0;z<a;z++)h[z]=new H,u[z]=new H;const d=new H,f=new H,m=new H,_=new ht,x=new ht,w=new ht,v=new H,y=new H;function C(z,L,A){d.fromArray(i,z*3),f.fromArray(i,L*3),m.fromArray(i,A*3),_.fromArray(o,z*2),x.fromArray(o,L*2),w.fromArray(o,A*2),f.sub(d),m.sub(d),x.sub(_),w.sub(_);const D=1/(x.x*w.y-w.x*x.y);!isFinite(D)||(v.copy(f).multiplyScalar(w.y).addScaledVector(m,-x.y).multiplyScalar(D),y.copy(m).multiplyScalar(x.x).addScaledVector(f,-w.x).multiplyScalar(D),h[z].add(v),h[L].add(v),h[A].add(v),u[z].add(y),u[L].add(y),u[A].add(y))}let S=this.groups;S.length===0&&(S=[{start:0,count:n.length}]);for(let z=0,L=S.length;z<L;++z){const A=S[z],D=A.start,I=A.count;for(let B=D,k=D+I;B<k;B+=3)C(n[B+0],n[B+1],n[B+2])}const M=new H,E=new H,T=new H,R=new H;function F(z){T.fromArray(s,z*3),R.copy(T);const L=h[z];M.copy(L),M.sub(T.multiplyScalar(T.dot(L))).normalize(),E.crossVectors(R,L);const D=E.dot(u[z])<0?-1:1;l[z*4]=M.x,l[z*4+1]=M.y,l[z*4+2]=M.z,l[z*4+3]=D}for(let z=0,L=S.length;z<L;++z){const A=S[z],D=A.start,I=A.count;for(let B=D,k=D+I;B<k;B+=3)F(n[B+0]),F(n[B+1]),F(n[B+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new je(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let f=0,m=n.count;f<m;f++)n.setXYZ(f,0,0,0);const i=new H,s=new H,o=new H,a=new H,l=new H,h=new H,u=new H,d=new H;if(t)for(let f=0,m=t.count;f<m;f+=3){const _=t.getX(f+0),x=t.getX(f+1),w=t.getX(f+2);i.fromBufferAttribute(e,_),s.fromBufferAttribute(e,x),o.fromBufferAttribute(e,w),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),a.fromBufferAttribute(n,_),l.fromBufferAttribute(n,x),h.fromBufferAttribute(n,w),a.add(u),l.add(u),h.add(u),n.setXYZ(_,a.x,a.y,a.z),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(w,h.x,h.y,h.z)}else for(let f=0,m=e.count;f<m;f+=3)i.fromBufferAttribute(e,f+0),s.fromBufferAttribute(e,f+1),o.fromBufferAttribute(e,f+2),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),n.setXYZ(f+0,u.x,u.y,u.z),n.setXYZ(f+1,u.x,u.y,u.z),n.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(t.attributes[i]===void 0)continue;const o=n[i].array,a=t.attributes[i],l=a.array,h=a.itemSize*e,u=Math.min(l.length,o.length-h);for(let d=0,f=h;d<u;d++,f++)o[f]=l[d]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Je.fromBufferAttribute(t,e),Je.normalize(),t.setXYZ(e,Je.x,Je.y,Je.z)}toNonIndexed(){function t(a,l){const h=a.array,u=a.itemSize,d=a.normalized,f=new h.constructor(l.length*u);let m=0,_=0;for(let x=0,w=l.length;x<w;x++){a.isInterleavedBufferAttribute?m=l[x]*a.data.stride+a.offset:m=l[x]*u;for(let v=0;v<u;v++)f[_++]=h[m++]}return new je(f,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new de,n=this.index.array,i=this.attributes;for(const a in i){const l=i[a],h=t(l,n);e.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const l=[],h=s[a];for(let u=0,d=h.length;u<d;u++){const f=h[u],m=t(f,n);l.push(m)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const h=o[a];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(t[h]=l[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const l in n){const h=n[l];t.data.attributes[l]=h.toJSON(t.data)}const i={};let s=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],u=[];for(let d=0,f=h.length;d<f;d++){const m=h[d];u.push(m.toJSON(t.data))}u.length>0&&(i[l]=u,s=!0)}s&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const i=t.attributes;for(const h in i){const u=i[h];this.setAttribute(h,u.clone(e))}const s=t.morphAttributes;for(const h in s){const u=[],d=s[h];for(let f=0,m=d.length;f<m;f++)u.push(d[f].clone(e));this.morphAttributes[h]=u}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let h=0,u=o.length;h<u;h++){const d=o[h];this.addGroup(d.start,d.count,d.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}de.prototype.isBufferGeometry=!0;const zg=new Ot,No=new Ar,Ud=new Ao,Ns=new H,Fs=new H,Os=new H,Hd=new H,Wd=new H,Gd=new H,Jc=new H,Kc=new H,Qc=new H,th=new ht,eh=new ht,nh=new ht,qd=new H,ih=new H;class Cn extends le{constructor(t=new de,e=new Vd){super();this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const i=e[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Ud.copy(n.boundingSphere),Ud.applyMatrix4(s),t.ray.intersectsSphere(Ud)===!1)||(zg.copy(s).invert(),No.copy(t.ray).applyMatrix4(zg),n.boundingBox!==null&&No.intersectsBox(n.boundingBox)===!1))return;let o;if(n.isBufferGeometry){const a=n.index,l=n.attributes.position,h=n.morphAttributes.position,u=n.morphTargetsRelative,d=n.attributes.uv,f=n.attributes.uv2,m=n.groups,_=n.drawRange;if(a!==null)if(Array.isArray(i))for(let x=0,w=m.length;x<w;x++){const v=m[x],y=i[v.materialIndex],C=Math.max(v.start,_.start),S=Math.min(a.count,Math.min(v.start+v.count,_.start+_.count));for(let M=C,E=S;M<E;M+=3){const T=a.getX(M),R=a.getX(M+1),F=a.getX(M+2);o=sh(this,y,t,No,l,h,u,d,f,T,R,F),o&&(o.faceIndex=Math.floor(M/3),o.face.materialIndex=v.materialIndex,e.push(o))}}else{const x=Math.max(0,_.start),w=Math.min(a.count,_.start+_.count);for(let v=x,y=w;v<y;v+=3){const C=a.getX(v),S=a.getX(v+1),M=a.getX(v+2);o=sh(this,i,t,No,l,h,u,d,f,C,S,M),o&&(o.faceIndex=Math.floor(v/3),e.push(o))}}else if(l!==void 0)if(Array.isArray(i))for(let x=0,w=m.length;x<w;x++){const v=m[x],y=i[v.materialIndex],C=Math.max(v.start,_.start),S=Math.min(l.count,Math.min(v.start+v.count,_.start+_.count));for(let M=C,E=S;M<E;M+=3){const T=M,R=M+1,F=M+2;o=sh(this,y,t,No,l,h,u,d,f,T,R,F),o&&(o.faceIndex=Math.floor(M/3),o.face.materialIndex=v.materialIndex,e.push(o))}}else{const x=Math.max(0,_.start),w=Math.min(l.count,_.start+_.count);for(let v=x,y=w;v<y;v+=3){const C=v,S=v+1,M=v+2;o=sh(this,i,t,No,l,h,u,d,f,C,S,M),o&&(o.faceIndex=Math.floor(v/3),e.push(o))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}Cn.prototype.isMesh=!0;function aS(r,t,e,n,i,s,o,a){let l;if(t.side===Ge?l=n.intersectTriangle(o,s,i,!0,a):l=n.intersectTriangle(i,s,o,t.side!==mo,a),l===null)return null;ih.copy(a),ih.applyMatrix4(r.matrixWorld);const h=e.ray.origin.distanceTo(ih);return h<e.near||h>e.far?null:{distance:h,point:ih.clone(),object:r}}function sh(r,t,e,n,i,s,o,a,l,h,u,d){Ns.fromBufferAttribute(i,h),Fs.fromBufferAttribute(i,u),Os.fromBufferAttribute(i,d);const f=r.morphTargetInfluences;if(s&&f){Jc.set(0,0,0),Kc.set(0,0,0),Qc.set(0,0,0);for(let _=0,x=s.length;_<x;_++){const w=f[_],v=s[_];w!==0&&(Hd.fromBufferAttribute(v,h),Wd.fromBufferAttribute(v,u),Gd.fromBufferAttribute(v,d),o?(Jc.addScaledVector(Hd,w),Kc.addScaledVector(Wd,w),Qc.addScaledVector(Gd,w)):(Jc.addScaledVector(Hd.sub(Ns),w),Kc.addScaledVector(Wd.sub(Fs),w),Qc.addScaledVector(Gd.sub(Os),w)))}Ns.add(Jc),Fs.add(Kc),Os.add(Qc)}r.isSkinnedMesh&&(r.boneTransform(h,Ns),r.boneTransform(u,Fs),r.boneTransform(d,Os));const m=aS(r,t,e,n,Ns,Fs,Os,qd);if(m){a&&(th.fromBufferAttribute(a,h),eh.fromBufferAttribute(a,u),nh.fromBufferAttribute(a,d),m.uv=Be.getUV(qd,Ns,Fs,Os,th,eh,nh,new ht)),l&&(th.fromBufferAttribute(l,h),eh.fromBufferAttribute(l,u),nh.fromBufferAttribute(l,d),m.uv2=Be.getUV(qd,Ns,Fs,Os,th,eh,nh,new ht));const _={a:h,b:u,c:d,normal:new H,materialIndex:0};Be.getNormal(Ns,Fs,Os,_.normal),m.face=_}return m}class ll extends de{constructor(t=1,e=1,n=1,i=1,s=1,o=1){super();this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],h=[],u=[],d=[];let f=0,m=0;_("z","y","x",-1,-1,n,e,t,o,s,0),_("z","y","x",1,-1,n,e,-t,o,s,1),_("x","z","y",1,1,t,n,e,i,o,2),_("x","z","y",1,-1,t,n,-e,i,o,3),_("x","y","z",1,-1,t,e,n,i,s,4),_("x","y","z",-1,-1,t,e,-n,i,s,5),this.setIndex(l),this.setAttribute("position",new ce(h,3)),this.setAttribute("normal",new ce(u,3)),this.setAttribute("uv",new ce(d,2));function _(x,w,v,y,C,S,M,E,T,R,F){const z=S/T,L=M/R,A=S/2,D=M/2,I=E/2,B=T+1,k=R+1;let G=0,tt=0;const K=new H;for(let j=0;j<k;j++){const $=j*L-D;for(let st=0;st<B;st++){const rt=st*z-A;K[x]=rt*y,K[w]=$*C,K[v]=I,h.push(K.x,K.y,K.z),K[x]=0,K[w]=0,K[v]=E>0?1:-1,u.push(K.x,K.y,K.z),d.push(st/T),d.push(1-j/R),G+=1}}for(let j=0;j<R;j++)for(let $=0;$<T;$++){const st=f+$+B*j,rt=f+$+B*(j+1),xt=f+($+1)+B*(j+1),It=f+($+1)+B*j;l.push(st,rt,It),l.push(rt,xt,It),tt+=6}a.addGroup(m,tt,F),m+=tt,f+=G}}static fromJSON(t){return new ll(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Fo(r){const t={};for(const e in r){t[e]={};for(const n in r[e]){const i=r[e][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[e][n]=i.clone():Array.isArray(i)?t[e][n]=i.slice():t[e][n]=i}}return t}function pn(r){const t={};for(let e=0;e<r.length;e++){const n=Fo(r[e]);for(const i in n)t[i]=n[i]}return t}const lS={clone:Fo,merge:pn};var cS=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hS=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Pr extends dn{constructor(t){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=cS,this.fragmentShader=hS,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Fo(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?e.uniforms[i]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?e.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?e.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?e.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?e.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?e.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?e.uniforms[i]={type:"m4",value:o.toArray()}:e.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}Pr.prototype.isShaderMaterial=!0;class jd extends le{constructor(){super();this.type="Camera",this.matrixWorldInverse=new Ot,this.projectionMatrix=new Ot,this.projectionMatrixInverse=new Ot}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}jd.prototype.isCamera=!0;class An extends jd{constructor(t=50,e=1,n=.1,i=2e3){super();this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=yd*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(xd*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return yd*2*Math.atan(Math.tan(xd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,s,o){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(xd*.5*this.fov)/this.zoom,n=2*e,i=this.aspect*n,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,h=o.fullHeight;s+=o.offsetX*i/l,e-=o.offsetY*n/h,i*=o.width/l,n*=o.height/h}const a=this.filmOffset;a!==0&&(s+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}An.prototype.isPerspectiveCamera=!0;const Oo=90,zo=1;class $d extends le{constructor(t,e,n){super();if(this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const i=new An(Oo,zo,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new H(1,0,0)),this.add(i);const s=new An(Oo,zo,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new H(-1,0,0)),this.add(s);const o=new An(Oo,zo,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new H(0,1,0)),this.add(o);const a=new An(Oo,zo,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new H(0,-1,0)),this.add(a);const l=new An(Oo,zo,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new H(0,0,1)),this.add(l);const h=new An(Oo,zo,t,e);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new H(0,0,-1)),this.add(h)}update(t,e){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,s,o,a,l,h]=this.children,u=t.xr.enabled,d=t.getRenderTarget();t.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,s),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=f,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(d),t.xr.enabled=u}}class rh extends Ze{constructor(t,e,n,i,s,o,a,l,h,u){t=t!==void 0?t:[],e=e!==void 0?e:tl;super(t,e,n,i,s,o,a,l,h,u);this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}rh.prototype.isCubeTexture=!0;class Vg extends Kn{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n);super(t,t,e);e=e||{},this.texture=new rh(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:vn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=Ye,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ll(5,5,5),s=new Pr({name:"CubemapFromEquirect",uniforms:Fo(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ge,blending:Cs});s.uniforms.tEquirect.value=e;const o=new Cn(i,s),a=e.minFilter;return e.minFilter===Nc&&(e.minFilter=vn),new $d(1,10,this).update(t,o),e.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,n,i){const s=t.getRenderTarget();for(let o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(e,n,i);t.setRenderTarget(s)}}Vg.prototype.isWebGLCubeRenderTarget=!0;const Xd=new H,uS=new H,dS=new rn;class is{constructor(t=new H(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=Xd.subVectors(n,e).cross(uS.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(Xd),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:e.copy(n).multiplyScalar(s).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||dS.getNormalMatrix(t),i=this.coplanarPoint(Xd).applyMatrix4(t),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}is.prototype.isPlane=!0;const Vo=new Ao,oh=new H;class ah{constructor(t=new is,e=new is,n=new is,i=new is,s=new is,o=new is){this.planes=[t,e,n,i,s,o]}set(t,e,n,i,s,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],s=n[1],o=n[2],a=n[3],l=n[4],h=n[5],u=n[6],d=n[7],f=n[8],m=n[9],_=n[10],x=n[11],w=n[12],v=n[13],y=n[14],C=n[15];return e[0].setComponents(a-i,d-l,x-f,C-w).normalize(),e[1].setComponents(a+i,d+l,x+f,C+w).normalize(),e[2].setComponents(a+s,d+h,x+m,C+v).normalize(),e[3].setComponents(a-s,d-h,x-m,C-v).normalize(),e[4].setComponents(a-o,d-u,x-_,C-y).normalize(),e[5].setComponents(a+o,d+u,x+_,C+y).normalize(),this}intersectsObject(t){const e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Vo.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Vo)}intersectsSprite(t){return Vo.center.set(0,0,0),Vo.radius=.7071067811865476,Vo.applyMatrix4(t.matrixWorld),this.intersectsSphere(Vo)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let s=0;s<6;s++)if(e[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(oh.x=i.normal.x>0?t.max.x:t.min.x,oh.y=i.normal.y>0?t.max.y:t.min.y,oh.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(oh)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Bg(){let r=null,t=!1,e=null,n=null;function i(s,o){e(s,o),n=r.requestAnimationFrame(i)}return{start:function(){t!==!0&&e!==null&&(n=r.requestAnimationFrame(i),t=!0)},stop:function(){r.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){e=s},setContext:function(s){r=s}}}function pS(r,t){const e=t.isWebGL2,n=new WeakMap;function i(h,u){const d=h.array,f=h.usage,m=r.createBuffer();r.bindBuffer(u,m),r.bufferData(u,d,f),h.onUploadCallback();let _=5126;return d instanceof Float32Array?_=5126:d instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):d instanceof Uint16Array?h.isFloat16BufferAttribute?e?_=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):_=5123:d instanceof Int16Array?_=5122:d instanceof Uint32Array?_=5125:d instanceof Int32Array?_=5124:d instanceof Int8Array?_=5120:(d instanceof Uint8Array||d instanceof Uint8ClampedArray)&&(_=5121),{buffer:m,type:_,bytesPerElement:d.BYTES_PER_ELEMENT,version:h.version}}function s(h,u,d){const f=u.array,m=u.updateRange;r.bindBuffer(d,h),m.count===-1?r.bufferSubData(d,0,f):(e?r.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f,m.offset,m.count):r.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f.subarray(m.offset,m.offset+m.count)),m.count=-1)}function o(h){return h.isInterleavedBufferAttribute&&(h=h.data),n.get(h)}function a(h){h.isInterleavedBufferAttribute&&(h=h.data);const u=n.get(h);u&&(r.deleteBuffer(u.buffer),n.delete(h))}function l(h,u){if(h.isGLBufferAttribute){const f=n.get(h);(!f||f.version<h.version)&&n.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const d=n.get(h);d===void 0?n.set(h,i(h,u)):d.version<h.version&&(s(d.buffer,h,u),d.version=h.version)}return{get:o,remove:a,update:l}}class Yd extends de{constructor(t=1,e=1,n=1,i=1){super();this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const s=t/2,o=e/2,a=Math.floor(n),l=Math.floor(i),h=a+1,u=l+1,d=t/a,f=e/l,m=[],_=[],x=[],w=[];for(let v=0;v<u;v++){const y=v*f-o;for(let C=0;C<h;C++){const S=C*d-s;_.push(S,-y,0),x.push(0,0,1),w.push(C/a),w.push(1-v/l)}}for(let v=0;v<l;v++)for(let y=0;y<a;y++){const C=y+h*v,S=y+h*(v+1),M=y+1+h*(v+1),E=y+1+h*v;m.push(C,S,E),m.push(S,M,E)}this.setIndex(m),this.setAttribute("position",new ce(_,3)),this.setAttribute("normal",new ce(x,3)),this.setAttribute("uv",new ce(w,2))}static fromJSON(t){return new Yd(t.width,t.height,t.widthSegments,t.heightSegments)}}var fS=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,mS=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gS=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,_S=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,vS=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,xS=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,yS="vec3 transformed = vec3( position );",bS=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,wS=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,MS=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,SS=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,TS=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,ES=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,CS=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,AS=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,PS=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,RS=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,DS=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,LS=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,kS=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		return texture2D( envMap, uv ).rgb;
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,IS=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,NS=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,FS=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,OS=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,zS=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,VS="gl_FragColor = linearToOutputTexel( gl_FragColor );",BS=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,US=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		envColor = envMapTexelToLinear( envColor );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,HS=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,WS=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,GS=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,qS=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,jS=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,$S=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,XS=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,YS=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ZS=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,JS=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,KS=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,QS=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,tT=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,eT=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,nT=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,iT=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,sT=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,rT=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,oT=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,aT=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lT=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,cT=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,hT=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,uT=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,dT=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,pT=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,fT=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,mT=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,gT=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_T=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,vT=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,xT=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,yT=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,bT=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,wT=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,MT=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,ST=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,TT=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,ET=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,CT=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,AT=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,PT=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,RT=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,DT=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,LT=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,kT=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,IT=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,NT=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,FT=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,OT=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,zT=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,VT=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,BT=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,UT=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,HT=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,WT=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,GT=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,qT=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,jT=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,$T=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,XT=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,YT=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ZT=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,JT=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,KT=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,QT=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,tE=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( float roughness, float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,eE=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,nE=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,iE=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,sE=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,rE=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,oE=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,aE=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const lE=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cE=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,hE=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,uE=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,dE=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,pE=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,fE=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,mE=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,gE=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,_E=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vE=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,xE=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,yE=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,bE=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wE=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ME=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,SE=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,TE=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EE=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,CE=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,AE=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,PE=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RE=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,DE=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,LE=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kE=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IE=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,NE=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,FE=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,OE=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,zE=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,VE=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,te={alphamap_fragment:fS,alphamap_pars_fragment:mS,alphatest_fragment:gS,alphatest_pars_fragment:_S,aomap_fragment:vS,aomap_pars_fragment:xS,begin_vertex:yS,beginnormal_vertex:bS,bsdfs:wS,bumpmap_pars_fragment:MS,clipping_planes_fragment:SS,clipping_planes_pars_fragment:TS,clipping_planes_pars_vertex:ES,clipping_planes_vertex:CS,color_fragment:AS,color_pars_fragment:PS,color_pars_vertex:RS,color_vertex:DS,common:LS,cube_uv_reflection_fragment:kS,defaultnormal_vertex:IS,displacementmap_pars_vertex:NS,displacementmap_vertex:FS,emissivemap_fragment:OS,emissivemap_pars_fragment:zS,encodings_fragment:VS,encodings_pars_fragment:BS,envmap_fragment:US,envmap_common_pars_fragment:HS,envmap_pars_fragment:WS,envmap_pars_vertex:GS,envmap_physical_pars_fragment:eT,envmap_vertex:qS,fog_vertex:jS,fog_pars_vertex:$S,fog_fragment:XS,fog_pars_fragment:YS,gradientmap_pars_fragment:ZS,lightmap_fragment:JS,lightmap_pars_fragment:KS,lights_lambert_vertex:QS,lights_pars_begin:tT,lights_toon_fragment:nT,lights_toon_pars_fragment:iT,lights_phong_fragment:sT,lights_phong_pars_fragment:rT,lights_physical_fragment:oT,lights_physical_pars_fragment:aT,lights_fragment_begin:lT,lights_fragment_maps:cT,lights_fragment_end:hT,logdepthbuf_fragment:uT,logdepthbuf_pars_fragment:dT,logdepthbuf_pars_vertex:pT,logdepthbuf_vertex:fT,map_fragment:mT,map_pars_fragment:gT,map_particle_fragment:_T,map_particle_pars_fragment:vT,metalnessmap_fragment:xT,metalnessmap_pars_fragment:yT,morphnormal_vertex:bT,morphtarget_pars_vertex:wT,morphtarget_vertex:MT,normal_fragment_begin:ST,normal_fragment_maps:TT,normal_pars_fragment:ET,normal_pars_vertex:CT,normal_vertex:AT,normalmap_pars_fragment:PT,clearcoat_normal_fragment_begin:RT,clearcoat_normal_fragment_maps:DT,clearcoat_pars_fragment:LT,output_fragment:kT,packing:IT,premultiplied_alpha_fragment:NT,project_vertex:FT,dithering_fragment:OT,dithering_pars_fragment:zT,roughnessmap_fragment:VT,roughnessmap_pars_fragment:BT,shadowmap_pars_fragment:UT,shadowmap_pars_vertex:HT,shadowmap_vertex:WT,shadowmask_pars_fragment:GT,skinbase_vertex:qT,skinning_pars_vertex:jT,skinning_vertex:$T,skinnormal_vertex:XT,specularmap_fragment:YT,specularmap_pars_fragment:ZT,tonemapping_fragment:JT,tonemapping_pars_fragment:KT,transmission_fragment:QT,transmission_pars_fragment:tE,uv_pars_fragment:eE,uv_pars_vertex:nE,uv_vertex:iE,uv2_pars_fragment:sE,uv2_pars_vertex:rE,uv2_vertex:oE,worldpos_vertex:aE,background_vert:lE,background_frag:cE,cube_vert:hE,cube_frag:uE,depth_vert:dE,depth_frag:pE,distanceRGBA_vert:fE,distanceRGBA_frag:mE,equirect_vert:gE,equirect_frag:_E,linedashed_vert:vE,linedashed_frag:xE,meshbasic_vert:yE,meshbasic_frag:bE,meshlambert_vert:wE,meshlambert_frag:ME,meshmatcap_vert:SE,meshmatcap_frag:TE,meshnormal_vert:EE,meshnormal_frag:CE,meshphong_vert:AE,meshphong_frag:PE,meshphysical_vert:RE,meshphysical_frag:DE,meshtoon_vert:LE,meshtoon_frag:kE,points_vert:IE,points_frag:NE,shadow_vert:FE,shadow_frag:OE,sprite_vert:zE,sprite_frag:VE},Tt={common:{diffuse:{value:new kt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new rn},uv2Transform:{value:new rn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new kt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new kt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new rn}},sprite:{diffuse:{value:new kt(16777215)},opacity:{value:1},center:{value:new ht(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new rn}}},Di={basic:{uniforms:pn([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.fog]),vertexShader:te.meshbasic_vert,fragmentShader:te.meshbasic_frag},lambert:{uniforms:pn([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.fog,Tt.lights,{emissive:{value:new kt(0)}}]),vertexShader:te.meshlambert_vert,fragmentShader:te.meshlambert_frag},phong:{uniforms:pn([Tt.common,Tt.specularmap,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,Tt.lights,{emissive:{value:new kt(0)},specular:{value:new kt(1118481)},shininess:{value:30}}]),vertexShader:te.meshphong_vert,fragmentShader:te.meshphong_frag},standard:{uniforms:pn([Tt.common,Tt.envmap,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.roughnessmap,Tt.metalnessmap,Tt.fog,Tt.lights,{emissive:{value:new kt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:te.meshphysical_vert,fragmentShader:te.meshphysical_frag},toon:{uniforms:pn([Tt.common,Tt.aomap,Tt.lightmap,Tt.emissivemap,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.gradientmap,Tt.fog,Tt.lights,{emissive:{value:new kt(0)}}]),vertexShader:te.meshtoon_vert,fragmentShader:te.meshtoon_frag},matcap:{uniforms:pn([Tt.common,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,Tt.fog,{matcap:{value:null}}]),vertexShader:te.meshmatcap_vert,fragmentShader:te.meshmatcap_frag},points:{uniforms:pn([Tt.points,Tt.fog]),vertexShader:te.points_vert,fragmentShader:te.points_frag},dashed:{uniforms:pn([Tt.common,Tt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:te.linedashed_vert,fragmentShader:te.linedashed_frag},depth:{uniforms:pn([Tt.common,Tt.displacementmap]),vertexShader:te.depth_vert,fragmentShader:te.depth_frag},normal:{uniforms:pn([Tt.common,Tt.bumpmap,Tt.normalmap,Tt.displacementmap,{opacity:{value:1}}]),vertexShader:te.meshnormal_vert,fragmentShader:te.meshnormal_frag},sprite:{uniforms:pn([Tt.sprite,Tt.fog]),vertexShader:te.sprite_vert,fragmentShader:te.sprite_frag},background:{uniforms:{uvTransform:{value:new rn},t2D:{value:null}},vertexShader:te.background_vert,fragmentShader:te.background_frag},cube:{uniforms:pn([Tt.envmap,{opacity:{value:1}}]),vertexShader:te.cube_vert,fragmentShader:te.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:te.equirect_vert,fragmentShader:te.equirect_frag},distanceRGBA:{uniforms:pn([Tt.common,Tt.displacementmap,{referencePosition:{value:new H},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:te.distanceRGBA_vert,fragmentShader:te.distanceRGBA_frag},shadow:{uniforms:pn([Tt.lights,Tt.fog,{color:{value:new kt(0)},opacity:{value:1}}]),vertexShader:te.shadow_vert,fragmentShader:te.shadow_frag}};Di.physical={uniforms:pn([Di.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ht(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new kt(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ht},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new kt(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new kt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:te.meshphysical_vert,fragmentShader:te.meshphysical_frag};function BE(r,t,e,n,i){const s=new kt(0);let o=0,a,l,h=null,u=0,d=null;function f(_,x){let w=!1,v=x.isScene===!0?x.background:null;v&&v.isTexture&&(v=t.get(v));const y=r.xr,C=y.getSession&&y.getSession();C&&C.environmentBlendMode==="additive"&&(v=null),v===null?m(s,o):v&&v.isColor&&(m(v,1),w=!0),(r.autoClear||w)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),v&&(v.isCubeTexture||v.mapping===Ic)?(l===void 0&&(l=new Cn(new ll(1,1,1),new Pr({name:"BackgroundCubeMaterial",uniforms:Fo(Di.cube.uniforms),vertexShader:Di.cube.vertexShader,fragmentShader:Di.cube.fragmentShader,side:Ge,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(S,M,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(l)),l.material.uniforms.envMap.value=v,l.material.uniforms.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,(h!==v||u!==v.version||d!==r.toneMapping)&&(l.material.needsUpdate=!0,h=v,u=v.version,d=r.toneMapping),_.unshift(l,l.geometry,l.material,0,0,null)):v&&v.isTexture&&(a===void 0&&(a=new Cn(new Yd(2,2),new Pr({name:"BackgroundMaterial",uniforms:Fo(Di.background.uniforms),vertexShader:Di.background.vertexShader,fragmentShader:Di.background.fragmentShader,side:Ka,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(a)),a.material.uniforms.t2D.value=v,v.matrixAutoUpdate===!0&&v.updateMatrix(),a.material.uniforms.uvTransform.value.copy(v.matrix),(h!==v||u!==v.version||d!==r.toneMapping)&&(a.material.needsUpdate=!0,h=v,u=v.version,d=r.toneMapping),_.unshift(a,a.geometry,a.material,0,0,null))}function m(_,x){e.buffers.color.setClear(_.r,_.g,_.b,x,i)}return{getClearColor:function(){return s},setClearColor:function(_,x=1){s.set(_),o=x,m(s,o)},getClearAlpha:function(){return o},setClearAlpha:function(_){o=_,m(s,o)},render:f}}function UE(r,t,e,n){const i=r.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=x(null);let h=l;function u(D,I,B,k,G){let tt=!1;if(o){const K=_(k,B,I);h!==K&&(h=K,f(h.object)),tt=w(k,G),tt&&v(k,G)}else{const K=I.wireframe===!0;(h.geometry!==k.id||h.program!==B.id||h.wireframe!==K)&&(h.geometry=k.id,h.program=B.id,h.wireframe=K,tt=!0)}D.isInstancedMesh===!0&&(tt=!0),G!==null&&e.update(G,34963),tt&&(T(D,I,B,k),G!==null&&r.bindBuffer(34963,e.get(G).buffer))}function d(){return n.isWebGL2?r.createVertexArray():s.createVertexArrayOES()}function f(D){return n.isWebGL2?r.bindVertexArray(D):s.bindVertexArrayOES(D)}function m(D){return n.isWebGL2?r.deleteVertexArray(D):s.deleteVertexArrayOES(D)}function _(D,I,B){const k=B.wireframe===!0;let G=a[D.id];G===void 0&&(G={},a[D.id]=G);let tt=G[I.id];tt===void 0&&(tt={},G[I.id]=tt);let K=tt[k];return K===void 0&&(K=x(d()),tt[k]=K),K}function x(D){const I=[],B=[],k=[];for(let G=0;G<i;G++)I[G]=0,B[G]=0,k[G]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:I,enabledAttributes:B,attributeDivisors:k,object:D,attributes:{},index:null}}function w(D,I){const B=h.attributes,k=D.attributes;let G=0;for(const tt in k){const K=B[tt],j=k[tt];if(K===void 0||K.attribute!==j||K.data!==j.data)return!0;G++}return h.attributesNum!==G||h.index!==I}function v(D,I){const B={},k=D.attributes;let G=0;for(const tt in k){const K=k[tt],j={};j.attribute=K,K.data&&(j.data=K.data),B[tt]=j,G++}h.attributes=B,h.attributesNum=G,h.index=I}function y(){const D=h.newAttributes;for(let I=0,B=D.length;I<B;I++)D[I]=0}function C(D){S(D,0)}function S(D,I){const B=h.newAttributes,k=h.enabledAttributes,G=h.attributeDivisors;B[D]=1,k[D]===0&&(r.enableVertexAttribArray(D),k[D]=1),G[D]!==I&&((n.isWebGL2?r:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,I),G[D]=I)}function M(){const D=h.newAttributes,I=h.enabledAttributes;for(let B=0,k=I.length;B<k;B++)I[B]!==D[B]&&(r.disableVertexAttribArray(B),I[B]=0)}function E(D,I,B,k,G,tt){n.isWebGL2===!0&&(B===5124||B===5125)?r.vertexAttribIPointer(D,I,B,G,tt):r.vertexAttribPointer(D,I,B,k,G,tt)}function T(D,I,B,k){if(n.isWebGL2===!1&&(D.isInstancedMesh||k.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;y();const G=k.attributes,tt=B.getAttributes(),K=I.defaultAttributeValues;for(const j in tt){const $=tt[j];if($.location>=0){let st=G[j];if(st===void 0&&(j==="instanceMatrix"&&D.instanceMatrix&&(st=D.instanceMatrix),j==="instanceColor"&&D.instanceColor&&(st=D.instanceColor)),st!==void 0){const rt=st.normalized,xt=st.itemSize,It=e.get(st);if(It===void 0)continue;const Q=It.buffer,_t=It.type,Rt=It.bytesPerElement;if(st.isInterleavedBufferAttribute){const wt=st.data,at=wt.stride,qt=st.offset;if(wt&&wt.isInstancedInterleavedBuffer){for(let nt=0;nt<$.locationSize;nt++)S($.location+nt,wt.meshPerAttribute);D.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=wt.meshPerAttribute*wt.count)}else for(let nt=0;nt<$.locationSize;nt++)C($.location+nt);r.bindBuffer(34962,Q);for(let nt=0;nt<$.locationSize;nt++)E($.location+nt,xt/$.locationSize,_t,rt,at*Rt,(qt+xt/$.locationSize*nt)*Rt)}else{if(st.isInstancedBufferAttribute){for(let wt=0;wt<$.locationSize;wt++)S($.location+wt,st.meshPerAttribute);D.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=st.meshPerAttribute*st.count)}else for(let wt=0;wt<$.locationSize;wt++)C($.location+wt);r.bindBuffer(34962,Q);for(let wt=0;wt<$.locationSize;wt++)E($.location+wt,xt/$.locationSize,_t,rt,xt*Rt,xt/$.locationSize*wt*Rt)}}else if(K!==void 0){const rt=K[j];if(rt!==void 0)switch(rt.length){case 2:r.vertexAttrib2fv($.location,rt);break;case 3:r.vertexAttrib3fv($.location,rt);break;case 4:r.vertexAttrib4fv($.location,rt);break;default:r.vertexAttrib1fv($.location,rt)}}}}M()}function R(){L();for(const D in a){const I=a[D];for(const B in I){const k=I[B];for(const G in k)m(k[G].object),delete k[G];delete I[B]}delete a[D]}}function F(D){if(a[D.id]===void 0)return;const I=a[D.id];for(const B in I){const k=I[B];for(const G in k)m(k[G].object),delete k[G];delete I[B]}delete a[D.id]}function z(D){for(const I in a){const B=a[I];if(B[D.id]===void 0)continue;const k=B[D.id];for(const G in k)m(k[G].object),delete k[G];delete B[D.id]}}function L(){A(),h!==l&&(h=l,f(h.object))}function A(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:L,resetDefaultState:A,dispose:R,releaseStatesOfGeometry:F,releaseStatesOfProgram:z,initAttributes:y,enableAttribute:C,disableUnusedAttributes:M}}function HE(r,t,e,n){const i=n.isWebGL2;let s;function o(h){s=h}function a(h,u){r.drawArrays(s,h,u),e.update(u,s,1)}function l(h,u,d){if(d===0)return;let f,m;if(i)f=r,m="drawArraysInstanced";else if(f=t.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[m](s,h,u,d),e.update(u,s,d)}this.setMode=o,this.render=a,this.renderInstances=l}function WE(r,t,e){let n;function i(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const T=t.get("EXT_texture_filter_anisotropic");n=r.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(T){if(T==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return T==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext!="undefined"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&r instanceof WebGL2ComputeRenderingContext;let a=e.precision!==void 0?e.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const h=o||t.has("WEBGL_draw_buffers"),u=e.logarithmicDepthBuffer===!0,d=r.getParameter(34930),f=r.getParameter(35660),m=r.getParameter(3379),_=r.getParameter(34076),x=r.getParameter(34921),w=r.getParameter(36347),v=r.getParameter(36348),y=r.getParameter(36349),C=f>0,S=o||t.has("OES_texture_float"),M=C&&S,E=o?r.getParameter(36183):0;return{isWebGL2:o,drawBuffers:h,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:f,maxTextureSize:m,maxCubemapSize:_,maxAttributes:x,maxVertexUniforms:w,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:C,floatFragmentTextures:S,floatVertexTextures:M,maxSamples:E}}function GE(r){const t=this;let e=null,n=0,i=!1,s=!1;const o=new is,a=new rn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,f,m){const _=d.length!==0||f||n!==0||i;return i=f,e=u(d,m,0),n=d.length,_},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,h()},this.setState=function(d,f,m){const _=d.clippingPlanes,x=d.clipIntersection,w=d.clipShadows,v=r.get(d);if(!i||_===null||_.length===0||s&&!w)s?u(null):h();else{const y=s?0:n,C=y*4;let S=v.clippingState||null;l.value=S,S=u(_,f,C,m);for(let M=0;M!==C;++M)S[M]=e[M];v.clippingState=S,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=y}};function h(){l.value!==e&&(l.value=e,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(d,f,m,_){const x=d!==null?d.length:0;let w=null;if(x!==0){if(w=l.value,_!==!0||w===null){const v=m+x*4,y=f.matrixWorldInverse;a.getNormalMatrix(y),(w===null||w.length<v)&&(w=new Float32Array(v));for(let C=0,S=m;C!==x;++C,S+=4)o.copy(d[C]).applyMatrix4(y,a),o.normal.toArray(w,S),w[S+3]=o.constant}l.value=w,l.needsUpdate=!0}return t.numPlanes=x,t.numIntersection=0,w}}function qE(r){let t=new WeakMap;function e(o,a){return a===ud?o.mapping=tl:a===dd&&(o.mapping=el),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===ud||a===dd)if(t.has(o)){const l=t.get(o).texture;return e(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const h=r.getRenderTarget(),u=new Vg(l.height/2);return u.fromEquirectangularTexture(r,o),t.set(o,u),r.setRenderTarget(h),o.addEventListener("dispose",i),e(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=t.get(a);l!==void 0&&(t.delete(a),l.dispose())}function s(){t=new WeakMap}return{get:n,dispose:s}}class Zd extends jd{constructor(t=-1,e=1,n=1,i=-1,s=.1,o=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-t,o=n+t,a=i+e,l=i-e;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}Zd.prototype.isOrthographicCamera=!0;class lh extends Pr{constructor(t){super(t);this.type="RawShaderMaterial"}}lh.prototype.isRawShaderMaterial=!0;const Bo=4,zs=8,Li=Math.pow(2,zs),Ug=[.125,.215,.35,.446,.526,.582],Hg=zs-Bo+1+Ug.length,Uo=20,ch={[pi]:0,[bo]:1},Jd=new Zd,{_lodPlanes:cl,_sizeLods:Wg,_sigmas:hh}=$E(),Gg=new kt;let Kd=null;const Rr=(1+Math.sqrt(5))/2,Ho=1/Rr,qg=[new H(1,1,1),new H(-1,1,1),new H(1,1,-1),new H(-1,1,-1),new H(0,Rr,Ho),new H(0,Rr,-Ho),new H(Ho,0,Rr),new H(-Ho,0,Rr),new H(Rr,Ho,0),new H(-Rr,Ho,0)];class jE{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=XE(Uo),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){Kd=this._renderer.getRenderTarget();const s=this._allocateTargets();return this._sceneToCubeUV(t,n,i,s),e>0&&this._blur(s,0,0,e),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(t){return this._fromTexture(t)}fromCubemap(t){return this._fromTexture(t)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=Xg(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=$g(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let t=0;t<cl.length;t++)cl[t].dispose()}_cleanup(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Kd),t.scissorTest=!1,uh(t,0,0,t.width,t.height)}_fromTexture(t){Kd=this._renderer.getRenderTarget();const e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e}_allocateTargets(t){const e={magFilter:vn,minFilter:vn,generateMipmaps:!1,type:Mr,format:Ye,encoding:pi,depthBuffer:!1},n=jg(e);return n.depthBuffer=!t,this._pingPongRenderTarget=jg(e),n}_compileMaterial(t){const e=new Cn(cl[0],t);this._renderer.compile(e,Jd)}_sceneToCubeUV(t,e,n,i){const s=90,o=1,a=new An(s,o,e,n),l=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,f=u.toneMapping;u.getClearColor(Gg),u.toneMapping=As,u.autoClear=!1;const m=new Vd({name:"PMREM.Background",side:Ge,depthWrite:!1,depthTest:!1}),_=new Cn(new ll,m);let x=!1;const w=t.background;w?w.isColor&&(m.color.copy(w),t.background=null,x=!0):(m.color.copy(Gg),x=!0);for(let v=0;v<6;v++){const y=v%3;y==0?(a.up.set(0,l[v],0),a.lookAt(h[v],0,0)):y==1?(a.up.set(0,0,l[v]),a.lookAt(0,h[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,h[v])),uh(i,y*Li,v>2?Li:0,Li,Li),u.setRenderTarget(i),x&&u.render(_,a),u.render(t,a)}_.geometry.dispose(),_.material.dispose(),u.toneMapping=f,u.autoClear=d,t.background=w}_setEncoding(t,e){this._renderer.capabilities.isWebGL2===!0&&e.format===Ye&&e.type===Ji&&e.encoding===bo?t.value=ch[pi]:t.value=ch[e.encoding]}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===tl||t.mapping===el;i?this._cubemapShader==null&&(this._cubemapShader=Xg()):this._equirectShader==null&&(this._equirectShader=$g());const s=i?this._cubemapShader:this._equirectShader,o=new Cn(cl[0],s),a=s.uniforms;a.envMap.value=t,i||a.texelSize.value.set(1/t.image.width,1/t.image.height),this._setEncoding(a.inputEncoding,t),uh(e,0,0,3*Li,2*Li),n.setRenderTarget(e),n.render(o,Jd)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let i=1;i<Hg;i++){const s=Math.sqrt(hh[i]*hh[i]-hh[i-1]*hh[i-1]),o=qg[(i-1)%qg.length];this._blur(t,i-1,i,s,o)}e.autoClear=n}_blur(t,e,n,i,s){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,i,"latitudinal",s),this._halfBlur(o,t,n,n,i,"longitudinal",s)}_halfBlur(t,e,n,i,s,o,a){const l=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,d=new Cn(cl[i],h),f=h.uniforms,m=Wg[n]-1,_=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Uo-1),x=s/_,w=isFinite(s)?1+Math.floor(u*x):Uo;w>Uo&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Uo}`);const v=[];let y=0;for(let E=0;E<Uo;++E){const T=E/x,R=Math.exp(-T*T/2);v.push(R),E==0?y+=R:E<w&&(y+=2*R)}for(let E=0;E<v.length;E++)v[E]=v[E]/y;f.envMap.value=t.texture,f.samples.value=w,f.weights.value=v,f.latitudinal.value=o==="latitudinal",a&&(f.poleAxis.value=a),f.dTheta.value=_,f.mipInt.value=zs-n;const C=Wg[i],S=3*Math.max(0,Li-2*C),M=(i===0?0:2*Li)+2*C*(i>zs-Bo?i-zs+Bo:0);uh(e,S,M,3*C,2*C),l.setRenderTarget(e),l.render(d,Jd)}}function $E(){const r=[],t=[],e=[];let n=zs;for(let i=0;i<Hg;i++){const s=Math.pow(2,n);t.push(s);let o=1/s;i>zs-Bo?o=Ug[i-zs+Bo-1]:i==0&&(o=0),e.push(o);const a=1/(s-1),l=-a/2,h=1+a/2,u=[l,l,h,l,h,h,l,l,h,h,l,h],d=6,f=6,m=3,_=2,x=1,w=new Float32Array(m*f*d),v=new Float32Array(_*f*d),y=new Float32Array(x*f*d);for(let S=0;S<d;S++){const M=S%3*2/3-1,E=S>2?0:-1,T=[M,E,0,M+2/3,E,0,M+2/3,E+1,0,M,E,0,M+2/3,E+1,0,M,E+1,0];w.set(T,m*f*S),v.set(u,_*f*S);const R=[S,S,S,S,S,S];y.set(R,x*f*S)}const C=new de;C.setAttribute("position",new je(w,m)),C.setAttribute("uv",new je(v,_)),C.setAttribute("faceIndex",new je(y,x)),r.push(C),n>Bo&&n--}return{_lodPlanes:r,_sizeLods:t,_sigmas:e}}function jg(r){const t=new Kn(3*Li,3*Li,r);return t.texture.mapping=Ic,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function uh(r,t,e,n,i){r.viewport.set(t,e,n,i),r.scissor.set(t,e,n,i)}function XE(r){const t=new Float32Array(r),e=new H(0,1,0);return new lh({name:"SphericalGaussianBlur",defines:{n:r},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:e}},vertexShader:Qd(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${tp()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Cs,depthTest:!1,depthWrite:!1})}function $g(){const r=new ht(1,1);return new lh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:r},inputEncoding:{value:ch[pi]}},vertexShader:Qd(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${tp()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:Cs,depthTest:!1,depthWrite:!1})}function Xg(){return new lh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ch[pi]}},vertexShader:Qd(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${tp()}

			void main() {

				gl_FragColor = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) );

			}
		`,blending:Cs,depthTest:!1,depthWrite:!1})}function Qd(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function tp(){return`

		uniform int inputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else {

				return sRGBToLinear( value );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function YE(r){let t=new WeakMap,e=null;function n(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){const l=a.mapping,h=l===ud||l===dd,u=l===tl||l===el;if(h||u){if(t.has(a))return t.get(a).texture;{const d=a.image;if(h&&d&&d.height>0||u&&d&&i(d)){const f=r.getRenderTarget();e===null&&(e=new jE(r));const m=h?e.fromEquirectangular(a):e.fromCubemap(a);return t.set(a,m),r.setRenderTarget(f),a.addEventListener("dispose",s),m.texture}else return null}}}return a}function i(a){let l=0;const h=6;for(let u=0;u<h;u++)a[u]!==void 0&&l++;return l===h}function s(a){const l=a.target;l.removeEventListener("dispose",s);const h=t.get(l);h!==void 0&&(t.delete(l),h.dispose())}function o(){t=new WeakMap,e!==null&&(e.dispose(),e=null)}return{get:n,dispose:o}}function ZE(r){const t={};function e(n){if(t[n]!==void 0)return t[n];let i;switch(n){case"WEBGL_depth_texture":i=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=r.getExtension(n)}return t[n]=i,i}return{has:function(n){return e(n)!==null},init:function(n){n.isWebGL2?e("EXT_color_buffer_float"):(e("WEBGL_depth_texture"),e("OES_texture_float"),e("OES_texture_half_float"),e("OES_texture_half_float_linear"),e("OES_standard_derivatives"),e("OES_element_index_uint"),e("OES_vertex_array_object"),e("ANGLE_instanced_arrays")),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture")},get:function(n){const i=e(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function JE(r,t,e,n){const i={},s=new WeakMap;function o(d){const f=d.target;f.index!==null&&t.remove(f.index);for(const _ in f.attributes)t.remove(f.attributes[_]);f.removeEventListener("dispose",o),delete i[f.id];const m=s.get(f);m&&(t.remove(m),s.delete(f)),n.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,e.memory.geometries--}function a(d,f){return i[f.id]===!0||(f.addEventListener("dispose",o),i[f.id]=!0,e.memory.geometries++),f}function l(d){const f=d.attributes;for(const _ in f)t.update(f[_],34962);const m=d.morphAttributes;for(const _ in m){const x=m[_];for(let w=0,v=x.length;w<v;w++)t.update(x[w],34962)}}function h(d){const f=[],m=d.index,_=d.attributes.position;let x=0;if(m!==null){const y=m.array;x=m.version;for(let C=0,S=y.length;C<S;C+=3){const M=y[C+0],E=y[C+1],T=y[C+2];f.push(M,E,E,T,T,M)}}else{const y=_.array;x=_.version;for(let C=0,S=y.length/3-1;C<S;C+=3){const M=C+0,E=C+1,T=C+2;f.push(M,E,E,T,T,M)}}const w=new(Sg(f)>65535?Og:Fg)(f,1);w.version=x;const v=s.get(d);v&&t.remove(v),s.set(d,w)}function u(d){const f=s.get(d);if(f){const m=d.index;m!==null&&f.version<m.version&&h(d)}else h(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:u}}function KE(r,t,e,n){const i=n.isWebGL2;let s;function o(f){s=f}let a,l;function h(f){a=f.type,l=f.bytesPerElement}function u(f,m){r.drawElements(s,m,a,f*l),e.update(m,s,1)}function d(f,m,_){if(_===0)return;let x,w;if(i)x=r,w="drawElementsInstanced";else if(x=t.get("ANGLE_instanced_arrays"),w="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[w](s,m,a,f*l,_),e.update(m,s,_)}this.setMode=o,this.setIndex=h,this.render=u,this.renderInstances=d}function QE(r){const t={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(e.calls++,o){case 4:e.triangles+=a*(s/3);break;case 1:e.lines+=a*(s/2);break;case 3:e.lines+=a*(s-1);break;case 2:e.lines+=a*s;break;case 0:e.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0}return{memory:t,render:e,programs:null,autoReset:!0,reset:i,update:n}}class ep extends Ze{constructor(t=null,e=1,n=1,i=1){super(null);this.image={data:t,width:e,height:n,depth:i},this.magFilter=qe,this.minFilter=qe,this.wrapR=Bn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ep.prototype.isDataTexture2DArray=!0;function tC(r,t){return r[0]-t[0]}function eC(r,t){return Math.abs(t[1])-Math.abs(r[1])}function Yg(r,t){let e=1;const n=t.isInterleavedBufferAttribute?t.data.array:t.array;n instanceof Int8Array?e=127:n instanceof Int16Array?e=32767:n instanceof Int32Array?e=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),r.divideScalar(e)}function nC(r,t,e){const n={},i=new Float32Array(8),s=new WeakMap,o=new H,a=[];for(let h=0;h<8;h++)a[h]=[h,0];function l(h,u,d,f){const m=h.morphTargetInfluences;if(t.isWebGL2===!0){const _=u.morphAttributes.position.length;let x=s.get(u);if(x===void 0||x.count!==_){x!==void 0&&x.texture.dispose();const y=u.morphAttributes.normal!==void 0,C=u.morphAttributes.position,S=u.morphAttributes.normal||[],M=u.attributes.position.count,E=y===!0?2:1;let T=M*E,R=1;T>t.maxTextureSize&&(R=Math.ceil(T/t.maxTextureSize),T=t.maxTextureSize);const F=new Float32Array(T*R*4*_),z=new ep(F,T,R,_);z.format=Ye,z.type=Ps,z.needsUpdate=!0;const L=E*4;for(let A=0;A<_;A++){const D=C[A],I=S[A],B=T*R*4*A;for(let k=0;k<D.count;k++){o.fromBufferAttribute(D,k),D.normalized===!0&&Yg(o,D);const G=k*L;F[B+G+0]=o.x,F[B+G+1]=o.y,F[B+G+2]=o.z,F[B+G+3]=0,y===!0&&(o.fromBufferAttribute(I,k),I.normalized===!0&&Yg(o,I),F[B+G+4]=o.x,F[B+G+5]=o.y,F[B+G+6]=o.z,F[B+G+7]=0)}}x={count:_,texture:z,size:new ht(T,R)},s.set(u,x)}let w=0;for(let y=0;y<m.length;y++)w+=m[y];const v=u.morphTargetsRelative?1:1-w;f.getUniforms().setValue(r,"morphTargetBaseInfluence",v),f.getUniforms().setValue(r,"morphTargetInfluences",m),f.getUniforms().setValue(r,"morphTargetsTexture",x.texture,e),f.getUniforms().setValue(r,"morphTargetsTextureSize",x.size)}else{const _=m===void 0?0:m.length;let x=n[u.id];if(x===void 0||x.length!==_){x=[];for(let S=0;S<_;S++)x[S]=[S,0];n[u.id]=x}for(let S=0;S<_;S++){const M=x[S];M[0]=S,M[1]=m[S]}x.sort(eC);for(let S=0;S<8;S++)S<_&&x[S][1]?(a[S][0]=x[S][0],a[S][1]=x[S][1]):(a[S][0]=Number.MAX_SAFE_INTEGER,a[S][1]=0);a.sort(tC);const w=u.morphAttributes.position,v=u.morphAttributes.normal;let y=0;for(let S=0;S<8;S++){const M=a[S],E=M[0],T=M[1];E!==Number.MAX_SAFE_INTEGER&&T?(w&&u.getAttribute("morphTarget"+S)!==w[E]&&u.setAttribute("morphTarget"+S,w[E]),v&&u.getAttribute("morphNormal"+S)!==v[E]&&u.setAttribute("morphNormal"+S,v[E]),i[S]=T,y+=T):(w&&u.hasAttribute("morphTarget"+S)===!0&&u.deleteAttribute("morphTarget"+S),v&&u.hasAttribute("morphNormal"+S)===!0&&u.deleteAttribute("morphNormal"+S),i[S]=0)}const C=u.morphTargetsRelative?1:1-y;f.getUniforms().setValue(r,"morphTargetBaseInfluence",C),f.getUniforms().setValue(r,"morphTargetInfluences",i)}}return{update:l}}function iC(r,t,e,n){let i=new WeakMap;function s(l){const h=n.render.frame,u=l.geometry,d=t.get(l,u);return i.get(d)!==h&&(t.update(d),i.set(d,h)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),e.update(l.instanceMatrix,34962),l.instanceColor!==null&&e.update(l.instanceColor,34962)),d}function o(){i=new WeakMap}function a(l){const h=l.target;h.removeEventListener("dispose",a),e.remove(h.instanceMatrix),h.instanceColor!==null&&e.remove(h.instanceColor)}return{update:s,dispose:o}}class Zg extends Ze{constructor(t=null,e=1,n=1,i=1){super(null);this.image={data:t,width:e,height:n,depth:i},this.magFilter=qe,this.minFilter=qe,this.wrapR=Bn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Zg.prototype.isDataTexture3D=!0;const Jg=new Ze,Kg=new ep,Qg=new Zg,t_=new rh,e_=[],n_=[],i_=new Float32Array(16),s_=new Float32Array(9),r_=new Float32Array(4);function Wo(r,t,e){const n=r[0];if(n<=0||n>0)return r;const i=t*e;let s=e_[i];if(s===void 0&&(s=new Float32Array(i),e_[i]=s),t!==0){n.toArray(s,0);for(let o=1,a=0;o!==t;++o)a+=e,r[o].toArray(s,a)}return s}function xn(r,t){if(r.length!==t.length)return!1;for(let e=0,n=r.length;e<n;e++)if(r[e]!==t[e])return!1;return!0}function fn(r,t){for(let e=0,n=t.length;e<n;e++)r[e]=t[e]}function dh(r,t){let e=n_[t];e===void 0&&(e=new Int32Array(t),n_[t]=e);for(let n=0;n!==t;++n)e[n]=r.allocateTextureUnit();return e}function sC(r,t){const e=this.cache;e[0]!==t&&(r.uniform1f(this.addr,t),e[0]=t)}function rC(r,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(r.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(xn(e,t))return;r.uniform2fv(this.addr,t),fn(e,t)}}function oC(r,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(r.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(r.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(xn(e,t))return;r.uniform3fv(this.addr,t),fn(e,t)}}function aC(r,t){const e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(r.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(xn(e,t))return;r.uniform4fv(this.addr,t),fn(e,t)}}function lC(r,t){const e=this.cache,n=t.elements;if(n===void 0){if(xn(e,t))return;r.uniformMatrix2fv(this.addr,!1,t),fn(e,t)}else{if(xn(e,n))return;r_.set(n),r.uniformMatrix2fv(this.addr,!1,r_),fn(e,n)}}function cC(r,t){const e=this.cache,n=t.elements;if(n===void 0){if(xn(e,t))return;r.uniformMatrix3fv(this.addr,!1,t),fn(e,t)}else{if(xn(e,n))return;s_.set(n),r.uniformMatrix3fv(this.addr,!1,s_),fn(e,n)}}function hC(r,t){const e=this.cache,n=t.elements;if(n===void 0){if(xn(e,t))return;r.uniformMatrix4fv(this.addr,!1,t),fn(e,t)}else{if(xn(e,n))return;i_.set(n),r.uniformMatrix4fv(this.addr,!1,i_),fn(e,n)}}function uC(r,t){const e=this.cache;e[0]!==t&&(r.uniform1i(this.addr,t),e[0]=t)}function dC(r,t){const e=this.cache;xn(e,t)||(r.uniform2iv(this.addr,t),fn(e,t))}function pC(r,t){const e=this.cache;xn(e,t)||(r.uniform3iv(this.addr,t),fn(e,t))}function fC(r,t){const e=this.cache;xn(e,t)||(r.uniform4iv(this.addr,t),fn(e,t))}function mC(r,t){const e=this.cache;e[0]!==t&&(r.uniform1ui(this.addr,t),e[0]=t)}function gC(r,t){const e=this.cache;xn(e,t)||(r.uniform2uiv(this.addr,t),fn(e,t))}function _C(r,t){const e=this.cache;xn(e,t)||(r.uniform3uiv(this.addr,t),fn(e,t))}function vC(r,t){const e=this.cache;xn(e,t)||(r.uniform4uiv(this.addr,t),fn(e,t))}function xC(r,t,e){const n=this.cache,i=e.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),e.safeSetTexture2D(t||Jg,i)}function yC(r,t,e){const n=this.cache,i=e.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),e.setTexture3D(t||Qg,i)}function bC(r,t,e){const n=this.cache,i=e.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),e.safeSetTextureCube(t||t_,i)}function wC(r,t,e){const n=this.cache,i=e.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),e.setTexture2DArray(t||Kg,i)}function MC(r){switch(r){case 5126:return sC;case 35664:return rC;case 35665:return oC;case 35666:return aC;case 35674:return lC;case 35675:return cC;case 35676:return hC;case 5124:case 35670:return uC;case 35667:case 35671:return dC;case 35668:case 35672:return pC;case 35669:case 35673:return fC;case 5125:return mC;case 36294:return gC;case 36295:return _C;case 36296:return vC;case 35678:case 36198:case 36298:case 36306:case 35682:return xC;case 35679:case 36299:case 36307:return yC;case 35680:case 36300:case 36308:case 36293:return bC;case 36289:case 36303:case 36311:case 36292:return wC}}function SC(r,t){r.uniform1fv(this.addr,t)}function TC(r,t){const e=Wo(t,this.size,2);r.uniform2fv(this.addr,e)}function EC(r,t){const e=Wo(t,this.size,3);r.uniform3fv(this.addr,e)}function CC(r,t){const e=Wo(t,this.size,4);r.uniform4fv(this.addr,e)}function AC(r,t){const e=Wo(t,this.size,4);r.uniformMatrix2fv(this.addr,!1,e)}function PC(r,t){const e=Wo(t,this.size,9);r.uniformMatrix3fv(this.addr,!1,e)}function RC(r,t){const e=Wo(t,this.size,16);r.uniformMatrix4fv(this.addr,!1,e)}function DC(r,t){r.uniform1iv(this.addr,t)}function LC(r,t){r.uniform2iv(this.addr,t)}function kC(r,t){r.uniform3iv(this.addr,t)}function IC(r,t){r.uniform4iv(this.addr,t)}function NC(r,t){r.uniform1uiv(this.addr,t)}function FC(r,t){r.uniform2uiv(this.addr,t)}function OC(r,t){r.uniform3uiv(this.addr,t)}function zC(r,t){r.uniform4uiv(this.addr,t)}function VC(r,t,e){const n=t.length,i=dh(e,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)e.safeSetTexture2D(t[s]||Jg,i[s])}function BC(r,t,e){const n=t.length,i=dh(e,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)e.setTexture3D(t[s]||Qg,i[s])}function UC(r,t,e){const n=t.length,i=dh(e,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)e.safeSetTextureCube(t[s]||t_,i[s])}function HC(r,t,e){const n=t.length,i=dh(e,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)e.setTexture2DArray(t[s]||Kg,i[s])}function WC(r){switch(r){case 5126:return SC;case 35664:return TC;case 35665:return EC;case 35666:return CC;case 35674:return AC;case 35675:return PC;case 35676:return RC;case 5124:case 35670:return DC;case 35667:case 35671:return LC;case 35668:case 35672:return kC;case 35669:case 35673:return IC;case 5125:return NC;case 36294:return FC;case 36295:return OC;case 36296:return zC;case 35678:case 36198:case 36298:case 36306:case 35682:return VC;case 35679:case 36299:case 36307:return BC;case 35680:case 36300:case 36308:case 36293:return UC;case 36289:case 36303:case 36311:case 36292:return HC}}function GC(r,t,e){this.id=r,this.addr=e,this.cache=[],this.setValue=MC(t.type)}function o_(r,t,e){this.id=r,this.addr=e,this.cache=[],this.size=t.size,this.setValue=WC(t.type)}o_.prototype.updateCache=function(r){const t=this.cache;r instanceof Float32Array&&t.length!==r.length&&(this.cache=new Float32Array(r.length)),fn(t,r)};function a_(r){this.id=r,this.seq=[],this.map={}}a_.prototype.setValue=function(r,t,e){const n=this.seq;for(let i=0,s=n.length;i!==s;++i){const o=n[i];o.setValue(r,t[o.id],e)}};const np=/(\w+)(\])?(\[|\.)?/g;function l_(r,t){r.seq.push(t),r.map[t.id]=t}function qC(r,t,e){const n=r.name,i=n.length;for(np.lastIndex=0;;){const s=np.exec(n),o=np.lastIndex;let a=s[1];const l=s[2]==="]",h=s[3];if(l&&(a=a|0),h===void 0||h==="["&&o+2===i){l_(e,h===void 0?new GC(a,r,t):new o_(a,r,t));break}else{let d=e.map[a];d===void 0&&(d=new a_(a),l_(e,d)),e=d}}}function Vs(r,t){this.seq=[],this.map={};const e=r.getProgramParameter(t,35718);for(let n=0;n<e;++n){const i=r.getActiveUniform(t,n),s=r.getUniformLocation(t,i.name);qC(i,s,this)}}Vs.prototype.setValue=function(r,t,e,n){const i=this.map[t];i!==void 0&&i.setValue(r,e,n)};Vs.prototype.setOptional=function(r,t,e){const n=t[e];n!==void 0&&this.setValue(r,e,n)};Vs.upload=function(r,t,e,n){for(let i=0,s=t.length;i!==s;++i){const o=t[i],a=e[o.id];a.needsUpdate!==!1&&o.setValue(r,a.value,n)}};Vs.seqWithValue=function(r,t){const e=[];for(let n=0,i=r.length;n!==i;++n){const s=r[n];s.id in t&&e.push(s)}return e};function c_(r,t,e){const n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n}let jC=0;function $C(r){const t=r.split(`
`);for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join(`
`)}function h_(r){switch(r){case pi:return["Linear","( value )"];case bo:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function u_(r,t,e){const n=r.getShaderParameter(t,35713),i=r.getShaderInfoLog(t).trim();return n&&i===""?"":e.toUpperCase()+`

`+i+`

`+$C(r.getShaderSource(t))}function Dr(r,t){const e=h_(t);return"vec4 "+r+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function XC(r,t){const e=h_(t);return"vec4 "+r+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function YC(r,t){let e;switch(t){case HM:e="Linear";break;case WM:e="Reinhard";break;case GM:e="OptimizedCineon";break;case qM:e="ACESFilmic";break;case jM:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),e="Linear"}return"vec3 "+r+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function ZC(r){return[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap||r.transmission)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(hl).join(`
`)}function JC(r){const t=[];for(const e in r){const n=r[e];n!==!1&&t.push("#define "+e+" "+n)}return t.join(`
`)}function KC(r,t){const e={},n=r.getProgramParameter(t,35721);for(let i=0;i<n;i++){const s=r.getActiveAttrib(t,i),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),e[o]={type:s.type,location:r.getAttribLocation(t,o),locationSize:a}}return e}function hl(r){return r!==""}function d_(r,t){return r.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function p_(r,t){return r.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const QC=/^[ \t]*#include +<([\w\d./]+)>/gm;function ip(r){return r.replace(QC,tA)}function tA(r,t){const e=te[t];if(e===void 0)throw new Error("Can not resolve #include <"+t+">");return ip(e)}const eA=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,nA=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function f_(r){return r.replace(nA,m_).replace(eA,iA)}function iA(r,t,e,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),m_(r,t,e,n)}function m_(r,t,e,n){let i="";for(let s=parseInt(t);s<parseInt(e);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function g_(r){let t="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?t+=`
#define HIGH_PRECISION`:r.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function sA(r){let t="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===Qm?t="SHADOWMAP_TYPE_PCF":r.shadowMapType===yM?t="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Ja&&(t="SHADOWMAP_TYPE_VSM"),t}function rA(r){let t="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case tl:case el:t="ENVMAP_TYPE_CUBE";break;case Ic:case pd:t="ENVMAP_TYPE_CUBE_UV";break}return t}function oA(r){let t="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case el:case pd:t="ENVMAP_MODE_REFRACTION";break}return t}function aA(r){let t="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case kc:t="ENVMAP_BLENDING_MULTIPLY";break;case BM:t="ENVMAP_BLENDING_MIX";break;case UM:t="ENVMAP_BLENDING_ADD";break}return t}function lA(r,t,e,n){const i=r.getContext(),s=e.defines;let o=e.vertexShader,a=e.fragmentShader;const l=sA(e),h=rA(e),u=oA(e),d=aA(e),f=e.isWebGL2?"":ZC(e),m=JC(s),_=i.createProgram();let x,w,v=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(x=[m].filter(hl).join(`
`),x.length>0&&(x+=`
`),w=[f,m].filter(hl).join(`
`),w.length>0&&(w+=`
`)):(x=[g_(e),"#define SHADER_NAME "+e.shaderName,m,e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+u:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",e.specularColorMap?"#define USE_SPECULARCOLORMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEENCOLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.morphTargets&&e.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",e.morphTargets&&e.isWebGL2?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(hl).join(`
`),w=[f,g_(e),"#define SHADER_NAME "+e.shaderName,m,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+h:"",e.envMap?"#define "+u:"",e.envMap?"#define "+d:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.normalMap&&e.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",e.specularColorMap?"#define USE_SPECULARCOLORMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaTest?"#define USE_ALPHATEST":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEENCOLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUvs?"#define USE_UV":"",e.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+l:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&e.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==As?"#define TONE_MAPPING":"",e.toneMapping!==As?te.tonemapping_pars_fragment:"",e.toneMapping!==As?YC("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.format===Sr?"#define OPAQUE":"",te.encodings_pars_fragment,e.map?Dr("mapTexelToLinear",e.mapEncoding):"",e.matcap?Dr("matcapTexelToLinear",e.matcapEncoding):"",e.envMap?Dr("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMap?Dr("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.specularColorMap?Dr("specularColorMapTexelToLinear",e.specularColorMapEncoding):"",e.sheenColorMap?Dr("sheenColorMapTexelToLinear",e.sheenColorMapEncoding):"",e.lightMap?Dr("lightMapTexelToLinear",e.lightMapEncoding):"",XC("linearToOutputTexel",e.outputEncoding),e.depthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(hl).join(`
`)),o=ip(o),o=d_(o,e),o=p_(o,e),a=ip(a),a=d_(a,e),a=p_(a,e),o=f_(o),a=f_(a),e.isWebGL2&&e.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,w=["#define varying in",e.glslVersion===wg?"":"layout(location = 0) out highp vec4 pc_fragColor;",e.glslVersion===wg?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const y=v+x+o,C=v+w+a,S=c_(i,35633,y),M=c_(i,35632,C);if(i.attachShader(_,S),i.attachShader(_,M),e.index0AttributeName!==void 0?i.bindAttribLocation(_,0,e.index0AttributeName):e.morphTargets===!0&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_),r.debug.checkShaderErrors){const R=i.getProgramInfoLog(_).trim(),F=i.getShaderInfoLog(S).trim(),z=i.getShaderInfoLog(M).trim();let L=!0,A=!0;if(i.getProgramParameter(_,35714)===!1){L=!1;const D=u_(i,S,"vertex"),I=u_(i,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,35715)+`

Program Info Log: `+R+`
`+D+`
`+I)}else R!==""?console.warn("THREE.WebGLProgram: Program Info Log:",R):(F===""||z==="")&&(A=!1);A&&(this.diagnostics={runnable:L,programLog:R,vertexShader:{log:F,prefix:x},fragmentShader:{log:z,prefix:w}})}i.deleteShader(S),i.deleteShader(M);let E;this.getUniforms=function(){return E===void 0&&(E=new Vs(i,_)),E};let T;return this.getAttributes=function(){return T===void 0&&(T=KC(i,_)),T},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.name=e.shaderName,this.id=jC++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=S,this.fragmentShader=M,this}let cA=0;class hA{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return e.has(t)===!1&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(e.has(t)===!1){const n=new uA;e.set(t,n)}return e.get(t)}}class uA{constructor(){this.id=cA++,this.usedTimes=0}}function dA(r,t,e,n,i,s,o){const a=new Dd,l=new hA,h=[],u=i.isWebGL2,d=i.logarithmicDepthBuffer,f=i.floatVertexTextures,m=i.maxVertexUniforms,_=i.vertexTextures;let x=i.precision;const w={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(A){const I=A.skeleton.bones;if(f)return 1024;{const k=Math.floor((m-20)/4),G=Math.min(k,I.length);return G<I.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+I.length+" bones. This GPU supports "+G+"."),0):G}}function y(A){let D;return A&&A.isTexture?D=A.encoding:A&&A.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),D=A.texture.encoding):D=pi,u&&A&&A.isTexture&&A.format===Ye&&A.type===Ji&&A.encoding===bo&&(D=pi),D}function C(A,D,I,B,k){const G=B.fog,tt=A.isMeshStandardMaterial?B.environment:null,K=(A.isMeshStandardMaterial?e:t).get(A.envMap||tt),j=w[A.type],$=k.isSkinnedMesh?v(k):0;A.precision!==null&&(x=i.getMaxPrecision(A.precision),x!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",x,"instead."));let st,rt,xt,It;if(j){const at=Di[j];st=at.vertexShader,rt=at.fragmentShader}else st=A.vertexShader,rt=A.fragmentShader,l.update(A),xt=l.getVertexShaderID(A),It=l.getFragmentShaderID(A);const Q=r.getRenderTarget(),_t=A.alphaTest>0,Rt=A.clearcoat>0;return{isWebGL2:u,shaderID:j,shaderName:A.type,vertexShader:st,fragmentShader:rt,defines:A.defines,customVertexShaderID:xt,customFragmentShaderID:It,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:x,instancing:k.isInstancedMesh===!0,instancingColor:k.isInstancedMesh===!0&&k.instanceColor!==null,supportsVertexTextures:_,outputEncoding:Q!==null?y(Q.texture):r.outputEncoding,map:!!A.map,mapEncoding:y(A.map),matcap:!!A.matcap,matcapEncoding:y(A.matcap),envMap:!!K,envMapMode:K&&K.mapping,envMapEncoding:y(K),envMapCubeUV:!!K&&(K.mapping===Ic||K.mapping===pd),lightMap:!!A.lightMap,lightMapEncoding:y(A.lightMap),aoMap:!!A.aoMap,emissiveMap:!!A.emissiveMap,emissiveMapEncoding:y(A.emissiveMap),bumpMap:!!A.bumpMap,normalMap:!!A.normalMap,objectSpaceNormalMap:A.normalMapType===q1,tangentSpaceNormalMap:A.normalMapType===wo,clearcoat:Rt,clearcoatMap:Rt&&!!A.clearcoatMap,clearcoatRoughnessMap:Rt&&!!A.clearcoatRoughnessMap,clearcoatNormalMap:Rt&&!!A.clearcoatNormalMap,displacementMap:!!A.displacementMap,roughnessMap:!!A.roughnessMap,metalnessMap:!!A.metalnessMap,specularMap:!!A.specularMap,specularIntensityMap:!!A.specularIntensityMap,specularColorMap:!!A.specularColorMap,specularColorMapEncoding:y(A.specularColorMap),alphaMap:!!A.alphaMap,alphaTest:_t,gradientMap:!!A.gradientMap,sheen:A.sheen>0,sheenColorMap:!!A.sheenColorMap,sheenColorMapEncoding:y(A.sheenColorMap),sheenRoughnessMap:!!A.sheenRoughnessMap,transmission:A.transmission>0,transmissionMap:!!A.transmissionMap,thicknessMap:!!A.thicknessMap,combine:A.combine,vertexTangents:!!A.normalMap&&!!k.geometry&&!!k.geometry.attributes.tangent,vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!k.geometry&&!!k.geometry.attributes.color&&k.geometry.attributes.color.itemSize===4,vertexUvs:!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatMap||!!A.clearcoatRoughnessMap||!!A.clearcoatNormalMap||!!A.displacementMap||!!A.transmissionMap||!!A.thicknessMap||!!A.specularIntensityMap||!!A.specularColorMap||!!A.sheenColorMap||!!A.sheenRoughnessMap,uvsVertexOnly:!(!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatNormalMap||A.transmission>0||!!A.transmissionMap||!!A.thicknessMap||!!A.specularIntensityMap||!!A.specularColorMap||A.sheen>0||!!A.sheenColorMap||!!A.sheenRoughnessMap)&&!!A.displacementMap,fog:!!G,useFog:A.fog,fogExp2:G&&G.isFogExp2,flatShading:!!A.flatShading,sizeAttenuation:A.sizeAttenuation,logarithmicDepthBuffer:d,skinning:k.isSkinnedMesh===!0&&$>0,maxBones:$,useVertexTexture:f,morphTargets:!!k.geometry&&!!k.geometry.morphAttributes.position,morphNormals:!!k.geometry&&!!k.geometry.morphAttributes.normal,morphTargetsCount:!!k.geometry&&!!k.geometry.morphAttributes.position?k.geometry.morphAttributes.position.length:0,numDirLights:D.directional.length,numPointLights:D.point.length,numSpotLights:D.spot.length,numRectAreaLights:D.rectArea.length,numHemiLights:D.hemi.length,numDirLightShadows:D.directionalShadowMap.length,numPointLightShadows:D.pointShadowMap.length,numSpotLightShadows:D.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,format:A.format,dithering:A.dithering,shadowMapEnabled:r.shadowMap.enabled&&I.length>0,shadowMapType:r.shadowMap.type,toneMapping:A.toneMapped?r.toneMapping:As,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===mo,flipSided:A.side===Ge,depthPacking:A.depthPacking!==void 0?A.depthPacking:!1,index0AttributeName:A.index0AttributeName,extensionDerivatives:A.extensions&&A.extensions.derivatives,extensionFragDepth:A.extensions&&A.extensions.fragDepth,extensionDrawBuffers:A.extensions&&A.extensions.drawBuffers,extensionShaderTextureLOD:A.extensions&&A.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:A.customProgramCacheKey()}}function S(A){const D=[];if(A.shaderID?D.push(A.shaderID):(D.push(A.customVertexShaderID),D.push(A.customFragmentShaderID)),A.defines!==void 0)for(const I in A.defines)D.push(I),D.push(A.defines[I]);return A.isRawShaderMaterial===!1&&(M(D,A),E(D,A),D.push(r.outputEncoding)),D.push(A.customProgramCacheKey),D.join()}function M(A,D){A.push(D.precision),A.push(D.outputEncoding),A.push(D.mapEncoding),A.push(D.matcapEncoding),A.push(D.envMapMode),A.push(D.envMapEncoding),A.push(D.lightMapEncoding),A.push(D.emissiveMapEncoding),A.push(D.combine),A.push(D.vertexUvs),A.push(D.fogExp2),A.push(D.sizeAttenuation),A.push(D.maxBones),A.push(D.morphTargetsCount),A.push(D.numDirLights),A.push(D.numPointLights),A.push(D.numSpotLights),A.push(D.numHemiLights),A.push(D.numRectAreaLights),A.push(D.numDirLightShadows),A.push(D.numPointLightShadows),A.push(D.numSpotLightShadows),A.push(D.shadowMapType),A.push(D.toneMapping),A.push(D.numClippingPlanes),A.push(D.numClipIntersection),A.push(D.format),A.push(D.specularColorMapEncoding),A.push(D.sheenColorMapEncoding)}function E(A,D){a.disableAll(),D.isWebGL2&&a.enable(0),D.supportsVertexTextures&&a.enable(1),D.instancing&&a.enable(2),D.instancingColor&&a.enable(3),D.map&&a.enable(4),D.matcap&&a.enable(5),D.envMap&&a.enable(6),D.envMapCubeUV&&a.enable(7),D.lightMap&&a.enable(8),D.aoMap&&a.enable(9),D.emissiveMap&&a.enable(10),D.bumpMap&&a.enable(11),D.normalMap&&a.enable(12),D.objectSpaceNormalMap&&a.enable(13),D.tangentSpaceNormalMap&&a.enable(14),D.clearcoat&&a.enable(15),D.clearcoatMap&&a.enable(16),D.clearcoatRoughnessMap&&a.enable(17),D.clearcoatNormalMap&&a.enable(18),D.displacementMap&&a.enable(19),D.specularMap&&a.enable(20),D.roughnessMap&&a.enable(21),D.metalnessMap&&a.enable(22),D.gradientMap&&a.enable(23),D.alphaMap&&a.enable(24),D.alphaTest&&a.enable(25),D.vertexColors&&a.enable(26),D.vertexAlphas&&a.enable(27),D.vertexUvs&&a.enable(28),D.vertexTangents&&a.enable(29),D.uvsVertexOnly&&a.enable(30),D.fog&&a.enable(31),A.push(a.mask),a.disableAll(),D.useFog&&a.enable(0),D.flatShading&&a.enable(1),D.logarithmicDepthBuffer&&a.enable(2),D.skinning&&a.enable(3),D.useVertexTexture&&a.enable(4),D.morphTargets&&a.enable(5),D.morphNormals&&a.enable(6),D.premultipliedAlpha&&a.enable(7),D.shadowMapEnabled&&a.enable(8),D.physicallyCorrectLights&&a.enable(9),D.doubleSided&&a.enable(10),D.flipSided&&a.enable(11),D.depthPacking&&a.enable(12),D.dithering&&a.enable(13),D.specularIntensityMap&&a.enable(14),D.specularColorMap&&a.enable(15),D.transmission&&a.enable(16),D.transmissionMap&&a.enable(17),D.thicknessMap&&a.enable(18),D.sheen&&a.enable(19),D.sheenColorMap&&a.enable(20),D.sheenRoughnessMap&&a.enable(21),A.push(a.mask)}function T(A){const D=w[A.type];let I;if(D){const B=Di[D];I=lS.clone(B.uniforms)}else I=A.uniforms;return I}function R(A,D){let I;for(let B=0,k=h.length;B<k;B++){const G=h[B];if(G.cacheKey===D){I=G,++I.usedTimes;break}}return I===void 0&&(I=new lA(r,D,A,s),h.push(I)),I}function F(A){if(--A.usedTimes==0){const D=h.indexOf(A);h[D]=h[h.length-1],h.pop(),A.destroy()}}function z(A){l.remove(A)}function L(){l.dispose()}return{getParameters:C,getProgramCacheKey:S,getUniforms:T,acquireProgram:R,releaseProgram:F,releaseShaderCache:z,programs:h,dispose:L}}function pA(){let r=new WeakMap;function t(s){let o=r.get(s);return o===void 0&&(o={},r.set(s,o)),o}function e(s){r.delete(s)}function n(s,o,a){r.get(s)[o]=a}function i(){r=new WeakMap}return{get:t,remove:e,update:n,dispose:i}}function fA(r,t){return r.groupOrder!==t.groupOrder?r.groupOrder-t.groupOrder:r.renderOrder!==t.renderOrder?r.renderOrder-t.renderOrder:r.material.id!==t.material.id?r.material.id-t.material.id:r.z!==t.z?r.z-t.z:r.id-t.id}function __(r,t){return r.groupOrder!==t.groupOrder?r.groupOrder-t.groupOrder:r.renderOrder!==t.renderOrder?r.renderOrder-t.renderOrder:r.z!==t.z?t.z-r.z:r.id-t.id}function v_(){const r=[];let t=0;const e=[],n=[],i=[];function s(){t=0,e.length=0,n.length=0,i.length=0}function o(d,f,m,_,x,w){let v=r[t];return v===void 0?(v={id:d.id,object:d,geometry:f,material:m,groupOrder:_,renderOrder:d.renderOrder,z:x,group:w},r[t]=v):(v.id=d.id,v.object=d,v.geometry=f,v.material=m,v.groupOrder=_,v.renderOrder=d.renderOrder,v.z=x,v.group=w),t++,v}function a(d,f,m,_,x,w){const v=o(d,f,m,_,x,w);m.transmission>0?n.push(v):m.transparent===!0?i.push(v):e.push(v)}function l(d,f,m,_,x,w){const v=o(d,f,m,_,x,w);m.transmission>0?n.unshift(v):m.transparent===!0?i.unshift(v):e.unshift(v)}function h(d,f){e.length>1&&e.sort(d||fA),n.length>1&&n.sort(f||__),i.length>1&&i.sort(f||__)}function u(){for(let d=t,f=r.length;d<f;d++){const m=r[d];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:e,transmissive:n,transparent:i,init:s,push:a,unshift:l,finish:u,sort:h}}function mA(){let r=new WeakMap;function t(n,i){let s;return r.has(n)===!1?(s=new v_,r.set(n,[s])):i>=r.get(n).length?(s=new v_,r.get(n).push(s)):s=r.get(n)[i],s}function e(){r=new WeakMap}return{get:t,dispose:e}}function gA(){const r={};return{get:function(t){if(r[t.id]!==void 0)return r[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new H,color:new kt};break;case"SpotLight":e={position:new H,direction:new H,color:new kt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new H,color:new kt,distance:0,decay:0};break;case"HemisphereLight":e={direction:new H,skyColor:new kt,groundColor:new kt};break;case"RectAreaLight":e={color:new kt,position:new H,halfWidth:new H,halfHeight:new H};break}return r[t.id]=e,e}}}function _A(){const r={};return{get:function(t){if(r[t.id]!==void 0)return r[t.id];let e;switch(t.type){case"DirectionalLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"SpotLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":e={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[t.id]=e,e}}}let vA=0;function xA(r,t){return(t.castShadow?1:0)-(r.castShadow?1:0)}function yA(r,t){const e=new gA,n=_A(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)i.probe.push(new H);const s=new H,o=new Ot,a=new Ot;function l(u,d){let f=0,m=0,_=0;for(let F=0;F<9;F++)i.probe[F].set(0,0,0);let x=0,w=0,v=0,y=0,C=0,S=0,M=0,E=0;u.sort(xA);const T=d!==!0?Math.PI:1;for(let F=0,z=u.length;F<z;F++){const L=u[F],A=L.color,D=L.intensity,I=L.distance,B=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)f+=A.r*D*T,m+=A.g*D*T,_+=A.b*D*T;else if(L.isLightProbe)for(let k=0;k<9;k++)i.probe[k].addScaledVector(L.sh.coefficients[k],D);else if(L.isDirectionalLight){const k=e.get(L);if(k.color.copy(L.color).multiplyScalar(L.intensity*T),L.castShadow){const G=L.shadow,tt=n.get(L);tt.shadowBias=G.bias,tt.shadowNormalBias=G.normalBias,tt.shadowRadius=G.radius,tt.shadowMapSize=G.mapSize,i.directionalShadow[x]=tt,i.directionalShadowMap[x]=B,i.directionalShadowMatrix[x]=L.shadow.matrix,S++}i.directional[x]=k,x++}else if(L.isSpotLight){const k=e.get(L);if(k.position.setFromMatrixPosition(L.matrixWorld),k.color.copy(A).multiplyScalar(D*T),k.distance=I,k.coneCos=Math.cos(L.angle),k.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),k.decay=L.decay,L.castShadow){const G=L.shadow,tt=n.get(L);tt.shadowBias=G.bias,tt.shadowNormalBias=G.normalBias,tt.shadowRadius=G.radius,tt.shadowMapSize=G.mapSize,i.spotShadow[v]=tt,i.spotShadowMap[v]=B,i.spotShadowMatrix[v]=L.shadow.matrix,E++}i.spot[v]=k,v++}else if(L.isRectAreaLight){const k=e.get(L);k.color.copy(A).multiplyScalar(D),k.halfWidth.set(L.width*.5,0,0),k.halfHeight.set(0,L.height*.5,0),i.rectArea[y]=k,y++}else if(L.isPointLight){const k=e.get(L);if(k.color.copy(L.color).multiplyScalar(L.intensity*T),k.distance=L.distance,k.decay=L.decay,L.castShadow){const G=L.shadow,tt=n.get(L);tt.shadowBias=G.bias,tt.shadowNormalBias=G.normalBias,tt.shadowRadius=G.radius,tt.shadowMapSize=G.mapSize,tt.shadowCameraNear=G.camera.near,tt.shadowCameraFar=G.camera.far,i.pointShadow[w]=tt,i.pointShadowMap[w]=B,i.pointShadowMatrix[w]=L.shadow.matrix,M++}i.point[w]=k,w++}else if(L.isHemisphereLight){const k=e.get(L);k.skyColor.copy(L.color).multiplyScalar(D*T),k.groundColor.copy(L.groundColor).multiplyScalar(D*T),i.hemi[C]=k,C++}}y>0&&(t.isWebGL2||r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Tt.LTC_FLOAT_1,i.rectAreaLTC2=Tt.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Tt.LTC_HALF_1,i.rectAreaLTC2=Tt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=f,i.ambient[1]=m,i.ambient[2]=_;const R=i.hash;(R.directionalLength!==x||R.pointLength!==w||R.spotLength!==v||R.rectAreaLength!==y||R.hemiLength!==C||R.numDirectionalShadows!==S||R.numPointShadows!==M||R.numSpotShadows!==E)&&(i.directional.length=x,i.spot.length=v,i.rectArea.length=y,i.point.length=w,i.hemi.length=C,i.directionalShadow.length=S,i.directionalShadowMap.length=S,i.pointShadow.length=M,i.pointShadowMap.length=M,i.spotShadow.length=E,i.spotShadowMap.length=E,i.directionalShadowMatrix.length=S,i.pointShadowMatrix.length=M,i.spotShadowMatrix.length=E,R.directionalLength=x,R.pointLength=w,R.spotLength=v,R.rectAreaLength=y,R.hemiLength=C,R.numDirectionalShadows=S,R.numPointShadows=M,R.numSpotShadows=E,i.version=vA++)}function h(u,d){let f=0,m=0,_=0,x=0,w=0;const v=d.matrixWorldInverse;for(let y=0,C=u.length;y<C;y++){const S=u[y];if(S.isDirectionalLight){const M=i.directional[f];M.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),f++}else if(S.isSpotLight){const M=i.spot[_];M.position.setFromMatrixPosition(S.matrixWorld),M.position.applyMatrix4(v),M.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),_++}else if(S.isRectAreaLight){const M=i.rectArea[x];M.position.setFromMatrixPosition(S.matrixWorld),M.position.applyMatrix4(v),a.identity(),o.copy(S.matrixWorld),o.premultiply(v),a.extractRotation(o),M.halfWidth.set(S.width*.5,0,0),M.halfHeight.set(0,S.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),x++}else if(S.isPointLight){const M=i.point[m];M.position.setFromMatrixPosition(S.matrixWorld),M.position.applyMatrix4(v),m++}else if(S.isHemisphereLight){const M=i.hemi[w];M.direction.setFromMatrixPosition(S.matrixWorld),M.direction.transformDirection(v),M.direction.normalize(),w++}}}return{setup:l,setupView:h,state:i}}function x_(r,t){const e=new yA(r,t),n=[],i=[];function s(){n.length=0,i.length=0}function o(d){n.push(d)}function a(d){i.push(d)}function l(d){e.setup(n,d)}function h(d){e.setupView(n,d)}return{init:s,state:{lightsArray:n,shadowsArray:i,lights:e},setupLights:l,setupLightsView:h,pushLight:o,pushShadow:a}}function bA(r,t){let e=new WeakMap;function n(s,o=0){let a;return e.has(s)===!1?(a=new x_(r,t),e.set(s,[a])):o>=e.get(s).length?(a=new x_(r,t),e.get(s).push(a)):a=e.get(s)[o],a}function i(){e=new WeakMap}return{get:n,dispose:i}}class y_ extends dn{constructor(t){super();this.type="MeshDepthMaterial",this.depthPacking=W1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}y_.prototype.isMeshDepthMaterial=!0;class b_ extends dn{constructor(t){super();this.type="MeshDistanceMaterial",this.referencePosition=new H,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}b_.prototype.isMeshDistanceMaterial=!0;const wA=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,MA=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function w_(r,t,e){let n=new ah;const i=new ht,s=new ht,o=new ge,a=new y_({depthPacking:G1}),l=new b_,h={},u=e.maxTextureSize,d={0:Ge,1:Ka,2:mo},f=new Pr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ht},radius:{value:4}},vertexShader:wA,fragmentShader:MA}),m=f.clone();m.defines.HORIZONTAL_PASS=1;const _=new de;_.setAttribute("position",new je(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new Cn(_,f),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Qm,this.render=function(S,M,E){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||S.length===0)return;const T=r.getRenderTarget(),R=r.getActiveCubeFace(),F=r.getActiveMipmapLevel(),z=r.state;z.setBlending(Cs),z.buffers.color.setClear(1,1,1,1),z.buffers.depth.setTest(!0),z.setScissorTest(!1);for(let L=0,A=S.length;L<A;L++){const D=S[L],I=D.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;i.copy(I.mapSize);const B=I.getFrameExtents();if(i.multiply(B),s.copy(I.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/B.x),i.x=s.x*B.x,I.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/B.y),i.y=s.y*B.y,I.mapSize.y=s.y)),I.map===null&&!I.isPointLightShadow&&this.type===Ja){const G={minFilter:vn,magFilter:vn,format:Ye};I.map=new Kn(i.x,i.y,G),I.map.texture.name=D.name+".shadowMap",I.mapPass=new Kn(i.x,i.y,G),I.camera.updateProjectionMatrix()}if(I.map===null){const G={minFilter:qe,magFilter:qe,format:Ye};I.map=new Kn(i.x,i.y,G),I.map.texture.name=D.name+".shadowMap",I.camera.updateProjectionMatrix()}r.setRenderTarget(I.map),r.clear();const k=I.getViewportCount();for(let G=0;G<k;G++){const tt=I.getViewport(G);o.set(s.x*tt.x,s.y*tt.y,s.x*tt.z,s.y*tt.w),z.viewport(o),I.updateMatrices(D,G),n=I.getFrustum(),C(M,E,I.camera,D,this.type)}!I.isPointLightShadow&&this.type===Ja&&v(I,E),I.needsUpdate=!1}w.needsUpdate=!1,r.setRenderTarget(T,R,F)};function v(S,M){const E=t.update(x);f.defines.VSM_SAMPLES!==S.blurSamples&&(f.defines.VSM_SAMPLES=S.blurSamples,m.defines.VSM_SAMPLES=S.blurSamples,f.needsUpdate=!0,m.needsUpdate=!0),f.uniforms.shadow_pass.value=S.map.texture,f.uniforms.resolution.value=S.mapSize,f.uniforms.radius.value=S.radius,r.setRenderTarget(S.mapPass),r.clear(),r.renderBufferDirect(M,null,E,f,x,null),m.uniforms.shadow_pass.value=S.mapPass.texture,m.uniforms.resolution.value=S.mapSize,m.uniforms.radius.value=S.radius,r.setRenderTarget(S.map),r.clear(),r.renderBufferDirect(M,null,E,m,x,null)}function y(S,M,E,T,R,F,z){let L=null;const A=T.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(A!==void 0?L=A:L=T.isPointLight===!0?l:a,r.localClippingEnabled&&E.clipShadows===!0&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0){const D=L.uuid,I=E.uuid;let B=h[D];B===void 0&&(B={},h[D]=B);let k=B[I];k===void 0&&(k=L.clone(),B[I]=k),L=k}return L.visible=E.visible,L.wireframe=E.wireframe,z===Ja?L.side=E.shadowSide!==null?E.shadowSide:E.side:L.side=E.shadowSide!==null?E.shadowSide:d[E.side],L.alphaMap=E.alphaMap,L.alphaTest=E.alphaTest,L.clipShadows=E.clipShadows,L.clippingPlanes=E.clippingPlanes,L.clipIntersection=E.clipIntersection,L.displacementMap=E.displacementMap,L.displacementScale=E.displacementScale,L.displacementBias=E.displacementBias,L.wireframeLinewidth=E.wireframeLinewidth,L.linewidth=E.linewidth,T.isPointLight===!0&&L.isMeshDistanceMaterial===!0&&(L.referencePosition.setFromMatrixPosition(T.matrixWorld),L.nearDistance=R,L.farDistance=F),L}function C(S,M,E,T,R){if(S.visible===!1)return;if(S.layers.test(M.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&R===Ja)&&(!S.frustumCulled||n.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,S.matrixWorld);const L=t.update(S),A=S.material;if(Array.isArray(A)){const D=L.groups;for(let I=0,B=D.length;I<B;I++){const k=D[I],G=A[k.materialIndex];if(G&&G.visible){const tt=y(S,L,G,T,E.near,E.far,R);r.renderBufferDirect(E,null,L,tt,S,k)}}}else if(A.visible){const D=y(S,L,A,T,E.near,E.far,R);r.renderBufferDirect(E,null,L,D,S,null)}}const z=S.children;for(let L=0,A=z.length;L<A;L++)C(z[L],M,E,T,R)}}function SA(r,t,e){const n=e.isWebGL2;function i(){let V=!1;const dt=new ge;let ct=null;const Lt=new ge(0,0,0,0);return{setMask:function(At){ct!==At&&!V&&(r.colorMask(At,At,At,At),ct=At)},setLocked:function(At){V=At},setClear:function(At,Wt,Mt,Ft,Kt){Kt===!0&&(At*=Ft,Wt*=Ft,Mt*=Ft),dt.set(At,Wt,Mt,Ft),Lt.equals(dt)===!1&&(r.clearColor(At,Wt,Mt,Ft),Lt.copy(dt))},reset:function(){V=!1,ct=null,Lt.set(-1,0,0,0)}}}function s(){let V=!1,dt=null,ct=null,Lt=null;return{setTest:function(At){At?rt(2929):xt(2929)},setMask:function(At){dt!==At&&!V&&(r.depthMask(At),dt=At)},setFunc:function(At){if(ct!==At){if(At)switch(At){case kM:r.depthFunc(512);break;case IM:r.depthFunc(519);break;case NM:r.depthFunc(513);break;case hd:r.depthFunc(515);break;case FM:r.depthFunc(514);break;case OM:r.depthFunc(518);break;case zM:r.depthFunc(516);break;case VM:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);ct=At}},setLocked:function(At){V=At},setClear:function(At){Lt!==At&&(r.clearDepth(At),Lt=At)},reset:function(){V=!1,dt=null,ct=null,Lt=null}}}function o(){let V=!1,dt=null,ct=null,Lt=null,At=null,Wt=null,Mt=null,Ft=null,Kt=null;return{setTest:function(re){V||(re?rt(2960):xt(2960))},setMask:function(re){dt!==re&&!V&&(r.stencilMask(re),dt=re)},setFunc:function(re,Mn,Ne){(ct!==re||Lt!==Mn||At!==Ne)&&(r.stencilFunc(re,Mn,Ne),ct=re,Lt=Mn,At=Ne)},setOp:function(re,Mn,Ne){(Wt!==re||Mt!==Mn||Ft!==Ne)&&(r.stencilOp(re,Mn,Ne),Wt=re,Mt=Mn,Ft=Ne)},setLocked:function(re){V=re},setClear:function(re){Kt!==re&&(r.clearStencil(re),Kt=re)},reset:function(){V=!1,dt=null,ct=null,Lt=null,At=null,Wt=null,Mt=null,Ft=null,Kt=null}}}const a=new i,l=new s,h=new o;let u={},d={},f=null,m=!1,_=null,x=null,w=null,v=null,y=null,C=null,S=null,M=!1,E=null,T=null,R=null,F=null,z=null;const L=r.getParameter(35661);let A=!1,D=0;const I=r.getParameter(7938);I.indexOf("WebGL")!==-1?(D=parseFloat(/^WebGL (\d)/.exec(I)[1]),A=D>=1):I.indexOf("OpenGL ES")!==-1&&(D=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),A=D>=2);let B=null,k={};const G=r.getParameter(3088),tt=r.getParameter(2978),K=new ge().fromArray(G),j=new ge().fromArray(tt);function $(V,dt,ct){const Lt=new Uint8Array(4),At=r.createTexture();r.bindTexture(V,At),r.texParameteri(V,10241,9728),r.texParameteri(V,10240,9728);for(let Wt=0;Wt<ct;Wt++)r.texImage2D(dt+Wt,0,6408,1,1,0,6408,5121,Lt);return At}const st={};st[3553]=$(3553,3553,1),st[34067]=$(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),h.setClear(0),rt(2929),l.setFunc(hd),qt(!1),nt(Km),rt(2884),wt(Cs);function rt(V){u[V]!==!0&&(r.enable(V),u[V]=!0)}function xt(V){u[V]!==!1&&(r.disable(V),u[V]=!1)}function It(V,dt){return d[V]!==dt?(r.bindFramebuffer(V,dt),d[V]=dt,n&&(V===36009&&(d[36160]=dt),V===36160&&(d[36009]=dt)),!0):!1}function Q(V){return f!==V?(r.useProgram(V),f=V,!0):!1}const _t={[go]:32774,[wM]:32778,[MM]:32779};if(n)_t[sg]=32775,_t[rg]=32776;else{const V=t.get("EXT_blend_minmax");V!==null&&(_t[sg]=V.MIN_EXT,_t[rg]=V.MAX_EXT)}const Rt={[SM]:0,[TM]:1,[EM]:768,[og]:770,[LM]:776,[RM]:774,[AM]:772,[CM]:769,[ag]:771,[DM]:775,[PM]:773};function wt(V,dt,ct,Lt,At,Wt,Mt,Ft){if(V===Cs){m===!0&&(xt(3042),m=!1);return}if(m===!1&&(rt(3042),m=!0),V!==bM){if(V!==_||Ft!==M){if((x!==go||y!==go)&&(r.blendEquation(32774),x=go,y=go),Ft)switch(V){case Qa:r.blendFuncSeparate(1,771,1,771);break;case eg:r.blendFunc(1,1);break;case ng:r.blendFuncSeparate(0,0,769,771);break;case ig:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",V);break}else switch(V){case Qa:r.blendFuncSeparate(770,771,1,771);break;case eg:r.blendFunc(770,1);break;case ng:r.blendFunc(0,769);break;case ig:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",V);break}w=null,v=null,C=null,S=null,_=V,M=Ft}return}At=At||dt,Wt=Wt||ct,Mt=Mt||Lt,(dt!==x||At!==y)&&(r.blendEquationSeparate(_t[dt],_t[At]),x=dt,y=At),(ct!==w||Lt!==v||Wt!==C||Mt!==S)&&(r.blendFuncSeparate(Rt[ct],Rt[Lt],Rt[Wt],Rt[Mt]),w=ct,v=Lt,C=Wt,S=Mt),_=V,M=null}function at(V,dt){V.side===mo?xt(2884):rt(2884);let ct=V.side===Ge;dt&&(ct=!ct),qt(ct),V.blending===Qa&&V.transparent===!1?wt(Cs):wt(V.blending,V.blendEquation,V.blendSrc,V.blendDst,V.blendEquationAlpha,V.blendSrcAlpha,V.blendDstAlpha,V.premultipliedAlpha),l.setFunc(V.depthFunc),l.setTest(V.depthTest),l.setMask(V.depthWrite),a.setMask(V.colorWrite);const Lt=V.stencilWrite;h.setTest(Lt),Lt&&(h.setMask(V.stencilWriteMask),h.setFunc(V.stencilFunc,V.stencilRef,V.stencilFuncMask),h.setOp(V.stencilFail,V.stencilZFail,V.stencilZPass)),mt(V.polygonOffset,V.polygonOffsetFactor,V.polygonOffsetUnits),V.alphaToCoverage===!0?rt(32926):xt(32926)}function qt(V){E!==V&&(V?r.frontFace(2304):r.frontFace(2305),E=V)}function nt(V){V!==vM?(rt(2884),V!==T&&(V===Km?r.cullFace(1029):V===xM?r.cullFace(1028):r.cullFace(1032))):xt(2884),T=V}function ft(V){V!==R&&(A&&r.lineWidth(V),R=V)}function mt(V,dt,ct){V?(rt(32823),(F!==dt||z!==ct)&&(r.polygonOffset(dt,ct),F=dt,z=ct)):xt(32823)}function Z(V){V?rt(3089):xt(3089)}function it(V){V===void 0&&(V=33984+L-1),B!==V&&(r.activeTexture(V),B=V)}function Ct(V,dt){B===null&&it();let ct=k[B];ct===void 0&&(ct={type:void 0,texture:void 0},k[B]=ct),(ct.type!==V||ct.texture!==dt)&&(r.bindTexture(V,dt||st[V]),ct.type=V,ct.texture=dt)}function Et(){const V=k[B];V!==void 0&&V.type!==void 0&&(r.bindTexture(V.type,null),V.type=void 0,V.texture=void 0)}function St(){try{r.compressedTexImage2D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function Nt(){try{r.texSubImage2D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function U(){try{r.texSubImage3D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function N(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function ot(){try{r.texStorage2D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function pt(){try{r.texStorage3D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function bt(){try{r.texImage2D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function ut(){try{r.texImage3D.apply(r,arguments)}catch(V){console.error("THREE.WebGLState:",V)}}function Vt(V){K.equals(V)===!1&&(r.scissor(V.x,V.y,V.z,V.w),K.copy(V))}function Dt(V){j.equals(V)===!1&&(r.viewport(V.x,V.y,V.z,V.w),j.copy(V))}function W(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),n===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),u={},B=null,k={},d={},f=null,m=!1,_=null,x=null,w=null,v=null,y=null,C=null,S=null,M=!1,E=null,T=null,R=null,F=null,z=null,K.set(0,0,r.canvas.width,r.canvas.height),j.set(0,0,r.canvas.width,r.canvas.height),a.reset(),l.reset(),h.reset()}return{buffers:{color:a,depth:l,stencil:h},enable:rt,disable:xt,bindFramebuffer:It,useProgram:Q,setBlending:wt,setMaterial:at,setFlipSided:qt,setCullFace:nt,setLineWidth:ft,setPolygonOffset:mt,setScissorTest:Z,activeTexture:it,bindTexture:Ct,unbindTexture:Et,compressedTexImage2D:St,texImage2D:bt,texImage3D:ut,texStorage2D:ot,texStorage3D:pt,texSubImage2D:Nt,texSubImage3D:U,compressedTexSubImage2D:N,scissor:Vt,viewport:Dt,reset:W}}function TA(r,t,e,n,i,s,o){const a=i.isWebGL2,l=i.maxTextures,h=i.maxCubemapSize,u=i.maxTextureSize,d=i.maxSamples,m=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):void 0,_=new WeakMap;let x,w=!1;try{w=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(U,N){return w?new OffscreenCanvas(U,N):Uc("canvas")}function y(U,N,ot,pt){let bt=1;if((U.width>pt||U.height>pt)&&(bt=pt/Math.max(U.width,U.height)),bt<1||N===!0)if(typeof HTMLImageElement!="undefined"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&U instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&U instanceof ImageBitmap){const ut=N?X1:Math.floor,Vt=ut(bt*U.width),Dt=ut(bt*U.height);x===void 0&&(x=v(Vt,Dt));const W=ot?v(Vt,Dt):x;return W.width=Vt,W.height=Dt,W.getContext("2d").drawImage(U,0,0,Vt,Dt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+Vt+"x"+Dt+")."),W}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function C(U){return Mg(U.width)&&Mg(U.height)}function S(U){return a?!1:U.wrapS!==Bn||U.wrapT!==Bn||U.minFilter!==qe&&U.minFilter!==vn}function M(U,N){return U.generateMipmaps&&N&&U.minFilter!==qe&&U.minFilter!==vn}function E(U){r.generateMipmap(U)}function T(U,N,ot,pt){if(a===!1)return N;if(U!==null){if(r[U]!==void 0)return r[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let bt=N;return N===6403&&(ot===5126&&(bt=33326),ot===5131&&(bt=33325),ot===5121&&(bt=33321)),N===6407&&(ot===5126&&(bt=34837),ot===5131&&(bt=34843),ot===5121&&(bt=32849)),N===6408&&(ot===5126&&(bt=34836),ot===5131&&(bt=34842),ot===5121&&(bt=pt===bo?35907:32856)),(bt===33325||bt===33326||bt===34842||bt===34836)&&t.get("EXT_color_buffer_float"),bt}function R(U,N,ot){return M(U,ot)===!0||U.isFramebufferTexture&&U.minFilter!==qe&&U.minFilter!==vn?Math.log2(Math.max(N.width,N.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?N.mipmaps.length:1}function F(U){return U===qe||U===cg||U===hg?9728:9729}function z(U){const N=U.target;N.removeEventListener("dispose",z),A(N),N.isVideoTexture&&_.delete(N),o.memory.textures--}function L(U){const N=U.target;N.removeEventListener("dispose",L),D(N)}function A(U){const N=n.get(U);N.__webglInit!==void 0&&(r.deleteTexture(N.__webglTexture),n.remove(U))}function D(U){const N=U.texture,ot=n.get(U),pt=n.get(N);if(!!U){if(pt.__webglTexture!==void 0&&(r.deleteTexture(pt.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let bt=0;bt<6;bt++)r.deleteFramebuffer(ot.__webglFramebuffer[bt]),ot.__webglDepthbuffer&&r.deleteRenderbuffer(ot.__webglDepthbuffer[bt]);else r.deleteFramebuffer(ot.__webglFramebuffer),ot.__webglDepthbuffer&&r.deleteRenderbuffer(ot.__webglDepthbuffer),ot.__webglMultisampledFramebuffer&&r.deleteFramebuffer(ot.__webglMultisampledFramebuffer),ot.__webglColorRenderbuffer&&r.deleteRenderbuffer(ot.__webglColorRenderbuffer),ot.__webglDepthRenderbuffer&&r.deleteRenderbuffer(ot.__webglDepthRenderbuffer);if(U.isWebGLMultipleRenderTargets)for(let bt=0,ut=N.length;bt<ut;bt++){const Vt=n.get(N[bt]);Vt.__webglTexture&&(r.deleteTexture(Vt.__webglTexture),o.memory.textures--),n.remove(N[bt])}n.remove(N),n.remove(U)}}let I=0;function B(){I=0}function k(){const U=I;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),I+=1,U}function G(U,N){const ot=n.get(U);if(U.isVideoTexture&&it(U),U.version>0&&ot.__version!==U.version){const pt=U.image;if(pt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(pt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{It(ot,U,N);return}}e.activeTexture(33984+N),e.bindTexture(3553,ot.__webglTexture)}function tt(U,N){const ot=n.get(U);if(U.version>0&&ot.__version!==U.version){It(ot,U,N);return}e.activeTexture(33984+N),e.bindTexture(35866,ot.__webglTexture)}function K(U,N){const ot=n.get(U);if(U.version>0&&ot.__version!==U.version){It(ot,U,N);return}e.activeTexture(33984+N),e.bindTexture(32879,ot.__webglTexture)}function j(U,N){const ot=n.get(U);if(U.version>0&&ot.__version!==U.version){Q(ot,U,N);return}e.activeTexture(33984+N),e.bindTexture(34067,ot.__webglTexture)}const $={[fd]:10497,[Bn]:33071,[md]:33648},st={[qe]:9728,[cg]:9984,[hg]:9986,[vn]:9729,[$M]:9985,[Nc]:9987};function rt(U,N,ot){if(ot?(r.texParameteri(U,10242,$[N.wrapS]),r.texParameteri(U,10243,$[N.wrapT]),(U===32879||U===35866)&&r.texParameteri(U,32882,$[N.wrapR]),r.texParameteri(U,10240,st[N.magFilter]),r.texParameteri(U,10241,st[N.minFilter])):(r.texParameteri(U,10242,33071),r.texParameteri(U,10243,33071),(U===32879||U===35866)&&r.texParameteri(U,32882,33071),(N.wrapS!==Bn||N.wrapT!==Bn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(U,10240,F(N.magFilter)),r.texParameteri(U,10241,F(N.minFilter)),N.minFilter!==qe&&N.minFilter!==vn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const pt=t.get("EXT_texture_filter_anisotropic");if(N.type===Ps&&t.has("OES_texture_float_linear")===!1||a===!1&&N.type===Mr&&t.has("OES_texture_half_float_linear")===!1)return;(N.anisotropy>1||n.get(N).__currentAnisotropy)&&(r.texParameterf(U,pt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(N.anisotropy,i.getMaxAnisotropy())),n.get(N).__currentAnisotropy=N.anisotropy)}}function xt(U,N){U.__webglInit===void 0&&(U.__webglInit=!0,N.addEventListener("dispose",z),U.__webglTexture=r.createTexture(),o.memory.textures++)}function It(U,N,ot){let pt=3553;N.isDataTexture2DArray&&(pt=35866),N.isDataTexture3D&&(pt=32879),xt(U,N),e.activeTexture(33984+ot),e.bindTexture(pt,U.__webglTexture),r.pixelStorei(37440,N.flipY),r.pixelStorei(37441,N.premultiplyAlpha),r.pixelStorei(3317,N.unpackAlignment),r.pixelStorei(37443,0);const bt=S(N)&&C(N.image)===!1,ut=y(N.image,bt,!1,u),Vt=C(ut)||a,Dt=s.convert(N.format);let W=s.convert(N.type),V=T(N.internalFormat,Dt,W,N.encoding);rt(pt,N,Vt);let dt;const ct=N.mipmaps,Lt=a&&N.isVideoTexture!==!0,At=U.__version===void 0,Wt=R(N,ut,Vt);if(N.isDepthTexture)V=6402,a?N.type===Ps?V=36012:N.type===Fc?V=33190:N.type===_o?V=35056:V=33189:N.type===Ps&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),N.format===Tr&&V===6402&&N.type!==nl&&N.type!==Fc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),N.type=nl,W=s.convert(N.type)),N.format===vo&&V===6402&&(V=34041,N.type!==_o&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),N.type=_o,W=s.convert(N.type))),Lt&&At?e.texStorage2D(3553,1,V,ut.width,ut.height):e.texImage2D(3553,0,V,ut.width,ut.height,0,Dt,W,null);else if(N.isDataTexture)if(ct.length>0&&Vt){Lt&&At&&e.texStorage2D(3553,Wt,V,ct[0].width,ct[0].height);for(let Mt=0,Ft=ct.length;Mt<Ft;Mt++)dt=ct[Mt],Lt?e.texSubImage2D(3553,0,0,0,dt.width,dt.height,Dt,W,dt.data):e.texImage2D(3553,Mt,V,dt.width,dt.height,0,Dt,W,dt.data);N.generateMipmaps=!1}else Lt?(At&&e.texStorage2D(3553,Wt,V,ut.width,ut.height),e.texSubImage2D(3553,0,0,0,ut.width,ut.height,Dt,W,ut.data)):e.texImage2D(3553,0,V,ut.width,ut.height,0,Dt,W,ut.data);else if(N.isCompressedTexture){Lt&&At&&e.texStorage2D(3553,Wt,V,ct[0].width,ct[0].height);for(let Mt=0,Ft=ct.length;Mt<Ft;Mt++)dt=ct[Mt],N.format!==Ye&&N.format!==Sr?Dt!==null?Lt?e.compressedTexSubImage2D(3553,Mt,0,0,dt.width,dt.height,Dt,dt.data):e.compressedTexImage2D(3553,Mt,V,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Lt?e.texSubImage2D(3553,Mt,0,0,dt.width,dt.height,Dt,W,dt.data):e.texImage2D(3553,Mt,V,dt.width,dt.height,0,Dt,W,dt.data)}else if(N.isDataTexture2DArray)Lt?(At&&e.texStorage3D(35866,Wt,V,ut.width,ut.height,ut.depth),e.texSubImage3D(35866,0,0,0,0,ut.width,ut.height,ut.depth,Dt,W,ut.data)):e.texImage3D(35866,0,V,ut.width,ut.height,ut.depth,0,Dt,W,ut.data);else if(N.isDataTexture3D)Lt?(At&&e.texStorage3D(32879,Wt,V,ut.width,ut.height,ut.depth),e.texSubImage3D(32879,0,0,0,0,ut.width,ut.height,ut.depth,Dt,W,ut.data)):e.texImage3D(32879,0,V,ut.width,ut.height,ut.depth,0,Dt,W,ut.data);else if(N.isFramebufferTexture)Lt&&At?e.texStorage2D(3553,Wt,V,ut.width,ut.height):e.texImage2D(3553,0,V,ut.width,ut.height,0,Dt,W,null);else if(ct.length>0&&Vt){Lt&&At&&e.texStorage2D(3553,Wt,V,ct[0].width,ct[0].height);for(let Mt=0,Ft=ct.length;Mt<Ft;Mt++)dt=ct[Mt],Lt?e.texSubImage2D(3553,Mt,0,0,Dt,W,dt):e.texImage2D(3553,Mt,V,Dt,W,dt);N.generateMipmaps=!1}else Lt?(At&&e.texStorage2D(3553,Wt,V,ut.width,ut.height),e.texSubImage2D(3553,0,0,0,Dt,W,ut)):e.texImage2D(3553,0,V,Dt,W,ut);M(N,Vt)&&E(pt),U.__version=N.version,N.onUpdate&&N.onUpdate(N)}function Q(U,N,ot){if(N.image.length!==6)return;xt(U,N),e.activeTexture(33984+ot),e.bindTexture(34067,U.__webglTexture),r.pixelStorei(37440,N.flipY),r.pixelStorei(37441,N.premultiplyAlpha),r.pixelStorei(3317,N.unpackAlignment),r.pixelStorei(37443,0);const pt=N&&(N.isCompressedTexture||N.image[0].isCompressedTexture),bt=N.image[0]&&N.image[0].isDataTexture,ut=[];for(let Mt=0;Mt<6;Mt++)!pt&&!bt?ut[Mt]=y(N.image[Mt],!1,!0,h):ut[Mt]=bt?N.image[Mt].image:N.image[Mt];const Vt=ut[0],Dt=C(Vt)||a,W=s.convert(N.format),V=s.convert(N.type),dt=T(N.internalFormat,W,V,N.encoding),ct=a&&N.isVideoTexture!==!0,Lt=U.__version===void 0;let At=R(N,Vt,Dt);rt(34067,N,Dt);let Wt;if(pt){ct&&Lt&&e.texStorage2D(34067,At,dt,Vt.width,Vt.height);for(let Mt=0;Mt<6;Mt++){Wt=ut[Mt].mipmaps;for(let Ft=0;Ft<Wt.length;Ft++){const Kt=Wt[Ft];N.format!==Ye&&N.format!==Sr?W!==null?ct?e.compressedTexSubImage2D(34069+Mt,Ft,0,0,Kt.width,Kt.height,W,Kt.data):e.compressedTexImage2D(34069+Mt,Ft,dt,Kt.width,Kt.height,0,Kt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ct?e.texSubImage2D(34069+Mt,Ft,0,0,Kt.width,Kt.height,W,V,Kt.data):e.texImage2D(34069+Mt,Ft,dt,Kt.width,Kt.height,0,W,V,Kt.data)}}}else{Wt=N.mipmaps,ct&&Lt&&(Wt.length>0&&At++,e.texStorage2D(34067,At,dt,ut[0].width,ut[0].height));for(let Mt=0;Mt<6;Mt++)if(bt){ct?e.texSubImage2D(34069+Mt,0,0,0,ut[Mt].width,ut[Mt].height,W,V,ut[Mt].data):e.texImage2D(34069+Mt,0,dt,ut[Mt].width,ut[Mt].height,0,W,V,ut[Mt].data);for(let Ft=0;Ft<Wt.length;Ft++){const re=Wt[Ft].image[Mt].image;ct?e.texSubImage2D(34069+Mt,Ft+1,0,0,re.width,re.height,W,V,re.data):e.texImage2D(34069+Mt,Ft+1,dt,re.width,re.height,0,W,V,re.data)}}else{ct?e.texSubImage2D(34069+Mt,0,0,0,W,V,ut[Mt]):e.texImage2D(34069+Mt,0,dt,W,V,ut[Mt]);for(let Ft=0;Ft<Wt.length;Ft++){const Kt=Wt[Ft];ct?e.texSubImage2D(34069+Mt,Ft+1,0,0,W,V,Kt.image[Mt]):e.texImage2D(34069+Mt,Ft+1,dt,W,V,Kt.image[Mt])}}}M(N,Dt)&&E(34067),U.__version=N.version,N.onUpdate&&N.onUpdate(N)}function _t(U,N,ot,pt,bt){const ut=s.convert(ot.format),Vt=s.convert(ot.type),Dt=T(ot.internalFormat,ut,Vt,ot.encoding);n.get(N).__hasExternalTextures||(bt===32879||bt===35866?e.texImage3D(bt,0,Dt,N.width,N.height,N.depth,0,ut,Vt,null):e.texImage2D(bt,0,Dt,N.width,N.height,0,ut,Vt,null)),e.bindFramebuffer(36160,U),N.useRenderToTexture?m.framebufferTexture2DMultisampleEXT(36160,pt,bt,n.get(ot).__webglTexture,0,Z(N)):r.framebufferTexture2D(36160,pt,bt,n.get(ot).__webglTexture,0),e.bindFramebuffer(36160,null)}function Rt(U,N,ot){if(r.bindRenderbuffer(36161,U),N.depthBuffer&&!N.stencilBuffer){let pt=33189;if(ot||N.useRenderToTexture){const bt=N.depthTexture;bt&&bt.isDepthTexture&&(bt.type===Ps?pt=36012:bt.type===Fc&&(pt=33190));const ut=Z(N);N.useRenderToTexture?m.renderbufferStorageMultisampleEXT(36161,ut,pt,N.width,N.height):r.renderbufferStorageMultisample(36161,ut,pt,N.width,N.height)}else r.renderbufferStorage(36161,pt,N.width,N.height);r.framebufferRenderbuffer(36160,36096,36161,U)}else if(N.depthBuffer&&N.stencilBuffer){const pt=Z(N);ot&&N.useRenderbuffer?r.renderbufferStorageMultisample(36161,pt,35056,N.width,N.height):N.useRenderToTexture?m.renderbufferStorageMultisampleEXT(36161,pt,35056,N.width,N.height):r.renderbufferStorage(36161,34041,N.width,N.height),r.framebufferRenderbuffer(36160,33306,36161,U)}else{const pt=N.isWebGLMultipleRenderTargets===!0?N.texture[0]:N.texture,bt=s.convert(pt.format),ut=s.convert(pt.type),Vt=T(pt.internalFormat,bt,ut,pt.encoding),Dt=Z(N);ot&&N.useRenderbuffer?r.renderbufferStorageMultisample(36161,Dt,Vt,N.width,N.height):N.useRenderToTexture?m.renderbufferStorageMultisampleEXT(36161,Dt,Vt,N.width,N.height):r.renderbufferStorage(36161,Vt,N.width,N.height)}r.bindRenderbuffer(36161,null)}function wt(U,N){if(N&&N.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,U),!(N.depthTexture&&N.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(N.depthTexture).__webglTexture||N.depthTexture.image.width!==N.width||N.depthTexture.image.height!==N.height)&&(N.depthTexture.image.width=N.width,N.depthTexture.image.height=N.height,N.depthTexture.needsUpdate=!0),G(N.depthTexture,0);const pt=n.get(N.depthTexture).__webglTexture,bt=Z(N);if(N.depthTexture.format===Tr)N.useRenderToTexture?m.framebufferTexture2DMultisampleEXT(36160,36096,3553,pt,0,bt):r.framebufferTexture2D(36160,36096,3553,pt,0);else if(N.depthTexture.format===vo)N.useRenderToTexture?m.framebufferTexture2DMultisampleEXT(36160,33306,3553,pt,0,bt):r.framebufferTexture2D(36160,33306,3553,pt,0);else throw new Error("Unknown depthTexture format")}function at(U){const N=n.get(U),ot=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!N.__autoAllocateDepthBuffer){if(ot)throw new Error("target.depthTexture not supported in Cube render targets");wt(N.__webglFramebuffer,U)}else if(ot){N.__webglDepthbuffer=[];for(let pt=0;pt<6;pt++)e.bindFramebuffer(36160,N.__webglFramebuffer[pt]),N.__webglDepthbuffer[pt]=r.createRenderbuffer(),Rt(N.__webglDepthbuffer[pt],U,!1)}else e.bindFramebuffer(36160,N.__webglFramebuffer),N.__webglDepthbuffer=r.createRenderbuffer(),Rt(N.__webglDepthbuffer,U,!1);e.bindFramebuffer(36160,null)}function qt(U,N,ot){const pt=n.get(U);N!==void 0&&_t(pt.__webglFramebuffer,U,U.texture,36064,3553),ot!==void 0&&at(U)}function nt(U){const N=U.texture,ot=n.get(U),pt=n.get(N);U.addEventListener("dispose",L),U.isWebGLMultipleRenderTargets!==!0&&(pt.__webglTexture===void 0&&(pt.__webglTexture=r.createTexture()),pt.__version=N.version,o.memory.textures++);const bt=U.isWebGLCubeRenderTarget===!0,ut=U.isWebGLMultipleRenderTargets===!0,Vt=N.isDataTexture3D||N.isDataTexture2DArray,Dt=C(U)||a;if(a&&N.format===Sr&&(N.type===Ps||N.type===Mr)&&(N.format=Ye,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),bt){ot.__webglFramebuffer=[];for(let W=0;W<6;W++)ot.__webglFramebuffer[W]=r.createFramebuffer()}else if(ot.__webglFramebuffer=r.createFramebuffer(),ut)if(i.drawBuffers){const W=U.texture;for(let V=0,dt=W.length;V<dt;V++){const ct=n.get(W[V]);ct.__webglTexture===void 0&&(ct.__webglTexture=r.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(U.useRenderbuffer)if(a){ot.__webglMultisampledFramebuffer=r.createFramebuffer(),ot.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,ot.__webglColorRenderbuffer);const W=s.convert(N.format),V=s.convert(N.type),dt=T(N.internalFormat,W,V,N.encoding),ct=Z(U);r.renderbufferStorageMultisample(36161,ct,dt,U.width,U.height),e.bindFramebuffer(36160,ot.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,ot.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),U.depthBuffer&&(ot.__webglDepthRenderbuffer=r.createRenderbuffer(),Rt(ot.__webglDepthRenderbuffer,U,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(bt){e.bindTexture(34067,pt.__webglTexture),rt(34067,N,Dt);for(let W=0;W<6;W++)_t(ot.__webglFramebuffer[W],U,N,36064,34069+W);M(N,Dt)&&E(34067),e.unbindTexture()}else if(ut){const W=U.texture;for(let V=0,dt=W.length;V<dt;V++){const ct=W[V],Lt=n.get(ct);e.bindTexture(3553,Lt.__webglTexture),rt(3553,ct,Dt),_t(ot.__webglFramebuffer,U,ct,36064+V,3553),M(ct,Dt)&&E(3553)}e.unbindTexture()}else{let W=3553;Vt&&(a?W=N.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),e.bindTexture(W,pt.__webglTexture),rt(W,N,Dt),_t(ot.__webglFramebuffer,U,N,36064,W),M(N,Dt)&&E(W),e.unbindTexture()}U.depthBuffer&&at(U)}function ft(U){const N=C(U)||a,ot=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let pt=0,bt=ot.length;pt<bt;pt++){const ut=ot[pt];if(M(ut,N)){const Vt=U.isWebGLCubeRenderTarget?34067:3553,Dt=n.get(ut).__webglTexture;e.bindTexture(Vt,Dt),E(Vt),e.unbindTexture()}}}function mt(U){if(U.useRenderbuffer)if(a){const N=U.width,ot=U.height;let pt=16384;const bt=[36064],ut=U.stencilBuffer?33306:36096;U.depthBuffer&&bt.push(ut),U.ignoreDepthForMultisampleCopy||(U.depthBuffer&&(pt|=256),U.stencilBuffer&&(pt|=1024));const Vt=n.get(U);e.bindFramebuffer(36008,Vt.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Vt.__webglFramebuffer),U.ignoreDepthForMultisampleCopy&&(r.invalidateFramebuffer(36008,[ut]),r.invalidateFramebuffer(36009,[ut])),r.blitFramebuffer(0,0,N,ot,0,0,N,ot,pt,9728),r.invalidateFramebuffer(36008,bt),e.bindFramebuffer(36008,null),e.bindFramebuffer(36009,Vt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Z(U){return a&&(U.useRenderbuffer||U.useRenderToTexture)?Math.min(d,U.samples):0}function it(U){const N=o.render.frame;_.get(U)!==N&&(_.set(U,N),U.update())}let Ct=!1,Et=!1;function St(U,N){U&&U.isWebGLRenderTarget&&(Ct===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ct=!0),U=U.texture),G(U,N)}function Nt(U,N){U&&U.isWebGLCubeRenderTarget&&(Et===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Et=!0),U=U.texture),j(U,N)}this.allocateTextureUnit=k,this.resetTextureUnits=B,this.setTexture2D=G,this.setTexture2DArray=tt,this.setTexture3D=K,this.setTextureCube=j,this.rebindTextures=qt,this.setupRenderTarget=nt,this.updateRenderTargetMipmap=ft,this.updateMultisampleRenderTarget=mt,this.setupDepthRenderbuffer=at,this.setupFrameBufferTexture=_t,this.safeSetTexture2D=St,this.safeSetTextureCube=Nt}function EA(r,t,e){const n=e.isWebGL2;function i(s){let o;if(s===Ji)return 5121;if(s===JM)return 32819;if(s===KM)return 32820;if(s===QM)return 33635;if(s===XM)return 5120;if(s===YM)return 5122;if(s===nl)return 5123;if(s===ZM)return 5124;if(s===Fc)return 5125;if(s===Ps)return 5126;if(s===Mr)return n?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===t1)return 6406;if(s===Sr)return 6407;if(s===Ye)return 6408;if(s===e1)return 6409;if(s===n1)return 6410;if(s===Tr)return 6402;if(s===vo)return 34041;if(s===i1)return 6403;if(s===s1)return 36244;if(s===r1)return 33319;if(s===o1)return 33320;if(s===a1)return 36248;if(s===l1)return 36249;if(s===ug||s===dg||s===pg||s===fg)if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===ug)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===dg)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===pg)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===fg)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===mg||s===gg||s===_g||s===vg)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===mg)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===gg)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===_g)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===vg)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===c1)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((s===xg||s===yg)&&(o=t.get("WEBGL_compressed_texture_etc"),o!==null)){if(s===xg)return o.COMPRESSED_RGB8_ETC2;if(s===yg)return o.COMPRESSED_RGBA8_ETC2_EAC}if(s===h1||s===u1||s===d1||s===p1||s===f1||s===m1||s===g1||s===_1||s===v1||s===x1||s===y1||s===b1||s===w1||s===M1||s===T1||s===E1||s===C1||s===A1||s===P1||s===R1||s===D1||s===L1||s===k1||s===I1||s===N1||s===F1||s===O1||s===z1)return o=t.get("WEBGL_compressed_texture_astc"),o!==null?s:null;if(s===S1)return o=t.get("EXT_texture_compression_bptc"),o!==null?s:null;if(s===_o)return n?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:i}}class M_ extends An{constructor(t=[]){super();this.cameras=t}}M_.prototype.isArrayCamera=!0;class ul extends le{constructor(){super();this.type="Group"}}ul.prototype.isGroup=!0;const CA={type:"move"};class sp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ul,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ul,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new H,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new H),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ul,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new H,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new H),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,h=this._hand;if(t&&e.session.visibilityState!=="visible-blurred")if(a!==null&&(i=e.getPose(t.targetRaySpace,n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(CA))),h&&t.hand){o=!0;for(const x of t.hand.values()){const w=e.getJointPose(x,n);if(h.joints[x.jointName]===void 0){const y=new ul;y.matrixAutoUpdate=!1,y.visible=!1,h.joints[x.jointName]=y,h.add(y)}const v=h.joints[x.jointName];w!==null&&(v.matrix.fromArray(w.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=w.radius),v.visible=w!==null}const u=h.joints["index-finger-tip"],d=h.joints["thumb-tip"],f=u.position.distanceTo(d.position),m=.02,_=.005;h.inputState.pinching&&f>m+_?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!h.inputState.pinching&&f<=m-_&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(s=e.getPose(t.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),h!==null&&(h.visible=o!==null),this}}class rp extends Ze{constructor(t,e,n,i,s,o,a,l,h,u){if(u=u!==void 0?u:Tr,u!==Tr&&u!==vo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===Tr&&(n=nl),n===void 0&&u===vo&&(n=_o);super(null,i,s,o,a,l,u,n,h);this.image={width:t,height:e},this.magFilter=a!==void 0?a:qe,this.minFilter=l!==void 0?l:qe,this.flipY=!1,this.generateMipmaps=!1}}rp.prototype.isDepthTexture=!0;class AA extends Rs{constructor(t,e){super();const n=this;let i=null,s=1,o=null,a="local-floor";const l=t.extensions.has("WEBGL_multisampled_render_to_texture");let h=null,u=null,d=null,f=null,m=!1,_=null;const x=e.getContextAttributes();let w=null,v=null;const y=[],C=new Map,S=new An;S.layers.enable(1),S.viewport=new ge;const M=new An;M.layers.enable(2),M.viewport=new ge;const E=[S,M],T=new M_;T.layers.enable(1),T.layers.enable(2);let R=null,F=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(j){let $=y[j];return $===void 0&&($=new sp,y[j]=$),$.getTargetRaySpace()},this.getControllerGrip=function(j){let $=y[j];return $===void 0&&($=new sp,y[j]=$),$.getGripSpace()},this.getHand=function(j){let $=y[j];return $===void 0&&($=new sp,y[j]=$),$.getHandSpace()};function z(j){const $=C.get(j.inputSource);$&&$.dispatchEvent({type:j.type,data:j.inputSource})}function L(){C.forEach(function(j,$){j.disconnect($)}),C.clear(),R=null,F=null,t.setRenderTarget(w),f=null,d=null,u=null,i=null,v=null,K.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(j){s=j,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(j){a=j,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return _},this.getSession=function(){return i},this.setSession=async function(j){if(i=j,i!==null){if(w=t.getRenderTarget(),i.addEventListener("select",z),i.addEventListener("selectstart",z),i.addEventListener("selectend",z),i.addEventListener("squeeze",z),i.addEventListener("squeezestart",z),i.addEventListener("squeezeend",z),i.addEventListener("end",L),i.addEventListener("inputsourceschange",A),x.xrCompatible!==!0&&await e.makeXRCompatible(),i.renderState.layers===void 0||t.capabilities.isWebGL2===!1){const $={antialias:i.renderState.layers===void 0?x.antialias:!0,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,e,$),i.updateRenderState({baseLayer:f}),v=new Kn(f.framebufferWidth,f.framebufferHeight,{format:Ye,type:Ji,encoding:t.outputEncoding})}else{m=x.antialias;let $=null,st=null,rt=null;x.depth&&(rt=x.stencil?35056:33190,$=x.stencil?vo:Tr,st=x.stencil?_o:nl);const xt={colorFormat:x.alpha||m?32856:32849,depthFormat:rt,scaleFactor:s};u=new XRWebGLBinding(i,e),d=u.createProjectionLayer(xt),i.updateRenderState({layers:[d]}),m?v=new Md(d.textureWidth,d.textureHeight,{format:Ye,type:Ji,depthTexture:new rp(d.textureWidth,d.textureHeight,st,void 0,void 0,void 0,void 0,void 0,void 0,$),stencilBuffer:x.stencil,ignoreDepth:d.ignoreDepthValues,useRenderToTexture:l,encoding:t.outputEncoding}):v=new Kn(d.textureWidth,d.textureHeight,{format:x.alpha?Ye:Sr,type:Ji,depthTexture:new rp(d.textureWidth,d.textureHeight,st,void 0,void 0,void 0,void 0,void 0,void 0,$),stencilBuffer:x.stencil,ignoreDepth:d.ignoreDepthValues,encoding:t.outputEncoding})}this.setFoveation(1),o=await i.requestReferenceSpace(a),K.setContext(i),K.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function A(j){const $=i.inputSources;for(let st=0;st<y.length;st++)C.set($[st],y[st]);for(let st=0;st<j.removed.length;st++){const rt=j.removed[st],xt=C.get(rt);xt&&(xt.dispatchEvent({type:"disconnected",data:rt}),C.delete(rt))}for(let st=0;st<j.added.length;st++){const rt=j.added[st],xt=C.get(rt);xt&&xt.dispatchEvent({type:"connected",data:rt})}}const D=new H,I=new H;function B(j,$,st){D.setFromMatrixPosition($.matrixWorld),I.setFromMatrixPosition(st.matrixWorld);const rt=D.distanceTo(I),xt=$.projectionMatrix.elements,It=st.projectionMatrix.elements,Q=xt[14]/(xt[10]-1),_t=xt[14]/(xt[10]+1),Rt=(xt[9]+1)/xt[5],wt=(xt[9]-1)/xt[5],at=(xt[8]-1)/xt[0],qt=(It[8]+1)/It[0],nt=Q*at,ft=Q*qt,mt=rt/(-at+qt),Z=mt*-at;$.matrixWorld.decompose(j.position,j.quaternion,j.scale),j.translateX(Z),j.translateZ(mt),j.matrixWorld.compose(j.position,j.quaternion,j.scale),j.matrixWorldInverse.copy(j.matrixWorld).invert();const it=Q+mt,Ct=_t+mt,Et=nt-Z,St=ft+(rt-Z),Nt=Rt*_t/Ct*it,U=wt*_t/Ct*it;j.projectionMatrix.makePerspective(Et,St,Nt,U,it,Ct)}function k(j,$){$===null?j.matrixWorld.copy(j.matrix):j.matrixWorld.multiplyMatrices($.matrixWorld,j.matrix),j.matrixWorldInverse.copy(j.matrixWorld).invert()}this.updateCamera=function(j){if(i===null)return;T.near=M.near=S.near=j.near,T.far=M.far=S.far=j.far,(R!==T.near||F!==T.far)&&(i.updateRenderState({depthNear:T.near,depthFar:T.far}),R=T.near,F=T.far);const $=j.parent,st=T.cameras;k(T,$);for(let xt=0;xt<st.length;xt++)k(st[xt],$);T.matrixWorld.decompose(T.position,T.quaternion,T.scale),j.position.copy(T.position),j.quaternion.copy(T.quaternion),j.scale.copy(T.scale),j.matrix.copy(T.matrix),j.matrixWorld.copy(T.matrixWorld);const rt=j.children;for(let xt=0,It=rt.length;xt<It;xt++)rt[xt].updateMatrixWorld(!0);st.length===2?B(T,S,M):T.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return T},this.getFoveation=function(){if(d!==null)return d.fixedFoveation;if(f!==null)return f.fixedFoveation},this.setFoveation=function(j){d!==null&&(d.fixedFoveation=j),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=j)};let G=null;function tt(j,$){if(h=$.getViewerPose(o),_=$,h!==null){const rt=h.views;f!==null&&(t.setRenderTargetFramebuffer(v,f.framebuffer),t.setRenderTarget(v));let xt=!1;rt.length!==T.cameras.length&&(T.cameras.length=0,xt=!0);for(let It=0;It<rt.length;It++){const Q=rt[It];let _t=null;if(f!==null)_t=f.getViewport(Q);else{const wt=u.getViewSubImage(d,Q);_t=wt.viewport,It===0&&(t.setRenderTargetTextures(v,wt.colorTexture,d.ignoreDepthValues?void 0:wt.depthStencilTexture),t.setRenderTarget(v))}const Rt=E[It];Rt.matrix.fromArray(Q.transform.matrix),Rt.projectionMatrix.fromArray(Q.projectionMatrix),Rt.viewport.set(_t.x,_t.y,_t.width,_t.height),It===0&&T.matrix.copy(Rt.matrix),xt===!0&&T.cameras.push(Rt)}}const st=i.inputSources;for(let rt=0;rt<y.length;rt++){const xt=y[rt],It=st[rt];xt.update(It,$,o)}G&&G(j,$),_=null}const K=new Bg;K.setAnimationLoop(tt),this.setAnimationLoop=function(j){G=j},this.dispose=function(){}}}function PA(r){function t(v,y){v.fogColor.value.copy(y.color),y.isFog?(v.fogNear.value=y.near,v.fogFar.value=y.far):y.isFogExp2&&(v.fogDensity.value=y.density)}function e(v,y,C,S,M){y.isMeshBasicMaterial?n(v,y):y.isMeshLambertMaterial?(n(v,y),l(v,y)):y.isMeshToonMaterial?(n(v,y),u(v,y)):y.isMeshPhongMaterial?(n(v,y),h(v,y)):y.isMeshStandardMaterial?(n(v,y),y.isMeshPhysicalMaterial?f(v,y,M):d(v,y)):y.isMeshMatcapMaterial?(n(v,y),m(v,y)):y.isMeshDepthMaterial?(n(v,y),_(v,y)):y.isMeshDistanceMaterial?(n(v,y),x(v,y)):y.isMeshNormalMaterial?(n(v,y),w(v,y)):y.isLineBasicMaterial?(i(v,y),y.isLineDashedMaterial&&s(v,y)):y.isPointsMaterial?o(v,y,C,S):y.isSpriteMaterial?a(v,y):y.isShadowMaterial?(v.color.value.copy(y.color),v.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function n(v,y){v.opacity.value=y.opacity,y.color&&v.diffuse.value.copy(y.color),y.emissive&&v.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(v.map.value=y.map),y.alphaMap&&(v.alphaMap.value=y.alphaMap),y.specularMap&&(v.specularMap.value=y.specularMap),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);const C=r.get(y).envMap;C&&(v.envMap.value=C,v.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=y.reflectivity,v.ior.value=y.ior,v.refractionRatio.value=y.refractionRatio),y.lightMap&&(v.lightMap.value=y.lightMap,v.lightMapIntensity.value=y.lightMapIntensity),y.aoMap&&(v.aoMap.value=y.aoMap,v.aoMapIntensity.value=y.aoMapIntensity);let S;y.map?S=y.map:y.specularMap?S=y.specularMap:y.displacementMap?S=y.displacementMap:y.normalMap?S=y.normalMap:y.bumpMap?S=y.bumpMap:y.roughnessMap?S=y.roughnessMap:y.metalnessMap?S=y.metalnessMap:y.alphaMap?S=y.alphaMap:y.emissiveMap?S=y.emissiveMap:y.clearcoatMap?S=y.clearcoatMap:y.clearcoatNormalMap?S=y.clearcoatNormalMap:y.clearcoatRoughnessMap?S=y.clearcoatRoughnessMap:y.specularIntensityMap?S=y.specularIntensityMap:y.specularColorMap?S=y.specularColorMap:y.transmissionMap?S=y.transmissionMap:y.thicknessMap?S=y.thicknessMap:y.sheenColorMap?S=y.sheenColorMap:y.sheenRoughnessMap&&(S=y.sheenRoughnessMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),v.uvTransform.value.copy(S.matrix));let M;y.aoMap?M=y.aoMap:y.lightMap&&(M=y.lightMap),M!==void 0&&(M.isWebGLRenderTarget&&(M=M.texture),M.matrixAutoUpdate===!0&&M.updateMatrix(),v.uv2Transform.value.copy(M.matrix))}function i(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity}function s(v,y){v.dashSize.value=y.dashSize,v.totalSize.value=y.dashSize+y.gapSize,v.scale.value=y.scale}function o(v,y,C,S){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.size.value=y.size*C,v.scale.value=S*.5,y.map&&(v.map.value=y.map),y.alphaMap&&(v.alphaMap.value=y.alphaMap),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);let M;y.map?M=y.map:y.alphaMap&&(M=y.alphaMap),M!==void 0&&(M.matrixAutoUpdate===!0&&M.updateMatrix(),v.uvTransform.value.copy(M.matrix))}function a(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.rotation.value=y.rotation,y.map&&(v.map.value=y.map),y.alphaMap&&(v.alphaMap.value=y.alphaMap),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);let C;y.map?C=y.map:y.alphaMap&&(C=y.alphaMap),C!==void 0&&(C.matrixAutoUpdate===!0&&C.updateMatrix(),v.uvTransform.value.copy(C.matrix))}function l(v,y){y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap)}function h(v,y){v.specular.value.copy(y.specular),v.shininess.value=Math.max(y.shininess,1e-4),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap),y.bumpMap&&(v.bumpMap.value=y.bumpMap,v.bumpScale.value=y.bumpScale,y.side===Ge&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,v.normalScale.value.copy(y.normalScale),y.side===Ge&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias)}function u(v,y){y.gradientMap&&(v.gradientMap.value=y.gradientMap),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap),y.bumpMap&&(v.bumpMap.value=y.bumpMap,v.bumpScale.value=y.bumpScale,y.side===Ge&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,v.normalScale.value.copy(y.normalScale),y.side===Ge&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias)}function d(v,y){v.roughness.value=y.roughness,v.metalness.value=y.metalness,y.roughnessMap&&(v.roughnessMap.value=y.roughnessMap),y.metalnessMap&&(v.metalnessMap.value=y.metalnessMap),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap),y.bumpMap&&(v.bumpMap.value=y.bumpMap,v.bumpScale.value=y.bumpScale,y.side===Ge&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,v.normalScale.value.copy(y.normalScale),y.side===Ge&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),r.get(y).envMap&&(v.envMapIntensity.value=y.envMapIntensity)}function f(v,y,C){d(v,y),v.ior.value=y.ior,y.sheen>0&&(v.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),v.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(v.sheenColorMap.value=y.sheenColorMap),y.sheenRoughnessMap&&(v.sheenRoughnessMap.value=y.sheenRoughnessMap)),y.clearcoat>0&&(v.clearcoat.value=y.clearcoat,v.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(v.clearcoatMap.value=y.clearcoatMap),y.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap),y.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),v.clearcoatNormalMap.value=y.clearcoatNormalMap,y.side===Ge&&v.clearcoatNormalScale.value.negate())),y.transmission>0&&(v.transmission.value=y.transmission,v.transmissionSamplerMap.value=C.texture,v.transmissionSamplerSize.value.set(C.width,C.height),y.transmissionMap&&(v.transmissionMap.value=y.transmissionMap),v.thickness.value=y.thickness,y.thicknessMap&&(v.thicknessMap.value=y.thicknessMap),v.attenuationDistance.value=y.attenuationDistance,v.attenuationColor.value.copy(y.attenuationColor)),v.specularIntensity.value=y.specularIntensity,v.specularColor.value.copy(y.specularColor),y.specularIntensityMap&&(v.specularIntensityMap.value=y.specularIntensityMap),y.specularColorMap&&(v.specularColorMap.value=y.specularColorMap)}function m(v,y){y.matcap&&(v.matcap.value=y.matcap),y.bumpMap&&(v.bumpMap.value=y.bumpMap,v.bumpScale.value=y.bumpScale,y.side===Ge&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,v.normalScale.value.copy(y.normalScale),y.side===Ge&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias)}function _(v,y){y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias)}function x(v,y){y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),v.referencePosition.value.copy(y.referencePosition),v.nearDistance.value=y.nearDistance,v.farDistance.value=y.farDistance}function w(v,y){y.bumpMap&&(v.bumpMap.value=y.bumpMap,v.bumpScale.value=y.bumpScale,y.side===Ge&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,v.normalScale.value.copy(y.normalScale),y.side===Ge&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias)}return{refreshFogUniforms:t,refreshMaterialUniforms:e}}function RA(){const r=Uc("canvas");return r.style.display="block",r}function pe(r={}){const t=r.canvas!==void 0?r.canvas:RA(),e=r.context!==void 0?r.context:null,n=r.alpha!==void 0?r.alpha:!1,i=r.depth!==void 0?r.depth:!0,s=r.stencil!==void 0?r.stencil:!0,o=r.antialias!==void 0?r.antialias:!1,a=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,l=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,h=r.powerPreference!==void 0?r.powerPreference:"default",u=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let d=null,f=null;const m=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=pi,this.physicallyCorrectLights=!1,this.toneMapping=As,this.toneMappingExposure=1;const x=this;let w=!1,v=0,y=0,C=null,S=-1,M=null;const E=new ge,T=new ge;let R=null,F=t.width,z=t.height,L=1,A=null,D=null;const I=new ge(0,0,F,z),B=new ge(0,0,F,z);let k=!1;const G=[],tt=new ah;let K=!1,j=!1,$=null;const st=new Ot,rt=new H,xt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function It(){return C===null?L:1}let Q=e;function _t(O,X){for(let et=0;et<O.length;et++){const J=O[et],lt=t.getContext(J,X);if(lt!==null)return lt}return null}try{const O={alpha:n,depth:i,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${cd}`),t.addEventListener("webglcontextlost",Lt,!1),t.addEventListener("webglcontextrestored",At,!1),Q===null){const X=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&X.shift(),Q=_t(X,O),Q===null)throw _t(X)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let Rt,wt,at,qt,nt,ft,mt,Z,it,Ct,Et,St,Nt,U,N,ot,pt,bt,ut,Vt,Dt,W,V;function dt(){Rt=new ZE(Q),wt=new WE(Q,Rt,r),Rt.init(wt),W=new EA(Q,Rt,wt),at=new SA(Q,Rt,wt),G[0]=1029,qt=new QE(Q),nt=new pA,ft=new TA(Q,Rt,at,nt,wt,W,qt),mt=new qE(x),Z=new YE(x),it=new pS(Q,wt),V=new UE(Q,Rt,it,wt),Ct=new JE(Q,it,qt,V),Et=new iC(Q,Ct,it,qt),ut=new nC(Q,wt,ft),ot=new GE(nt),St=new dA(x,mt,Z,Rt,wt,V,ot),Nt=new PA(nt),U=new mA,N=new bA(Rt,wt),bt=new BE(x,mt,at,Et,a),pt=new w_(x,Et,wt),Vt=new HE(Q,Rt,qt,wt),Dt=new KE(Q,Rt,qt,wt),qt.programs=St.programs,x.capabilities=wt,x.extensions=Rt,x.properties=nt,x.renderLists=U,x.shadowMap=pt,x.state=at,x.info=qt}dt();const ct=new AA(x,Q);this.xr=ct,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){const O=Rt.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=Rt.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(O){O!==void 0&&(L=O,this.setSize(F,z,!1))},this.getSize=function(O){return O.set(F,z)},this.setSize=function(O,X,et){if(ct.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}F=O,z=X,t.width=Math.floor(O*L),t.height=Math.floor(X*L),et!==!1&&(t.style.width=O+"px",t.style.height=X+"px"),this.setViewport(0,0,O,X)},this.getDrawingBufferSize=function(O){return O.set(F*L,z*L).floor()},this.setDrawingBufferSize=function(O,X,et){F=O,z=X,L=et,t.width=Math.floor(O*et),t.height=Math.floor(X*et),this.setViewport(0,0,O,X)},this.getCurrentViewport=function(O){return O.copy(E)},this.getViewport=function(O){return O.copy(I)},this.setViewport=function(O,X,et,J){O.isVector4?I.set(O.x,O.y,O.z,O.w):I.set(O,X,et,J),at.viewport(E.copy(I).multiplyScalar(L).floor())},this.getScissor=function(O){return O.copy(B)},this.setScissor=function(O,X,et,J){O.isVector4?B.set(O.x,O.y,O.z,O.w):B.set(O,X,et,J),at.scissor(T.copy(B).multiplyScalar(L).floor())},this.getScissorTest=function(){return k},this.setScissorTest=function(O){at.setScissorTest(k=O)},this.setOpaqueSort=function(O){A=O},this.setTransparentSort=function(O){D=O},this.getClearColor=function(O){return O.copy(bt.getClearColor())},this.setClearColor=function(){bt.setClearColor.apply(bt,arguments)},this.getClearAlpha=function(){return bt.getClearAlpha()},this.setClearAlpha=function(){bt.setClearAlpha.apply(bt,arguments)},this.clear=function(O,X,et){let J=0;(O===void 0||O)&&(J|=16384),(X===void 0||X)&&(J|=256),(et===void 0||et)&&(J|=1024),Q.clear(J)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Lt,!1),t.removeEventListener("webglcontextrestored",At,!1),U.dispose(),N.dispose(),nt.dispose(),mt.dispose(),Z.dispose(),Et.dispose(),V.dispose(),St.dispose(),ct.dispose(),ct.removeEventListener("sessionstart",Mn),ct.removeEventListener("sessionend",Ne),$&&($.dispose(),$=null),ui.stop()};function Lt(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function At(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const O=qt.autoReset,X=pt.enabled,et=pt.autoUpdate,J=pt.needsUpdate,lt=pt.type;dt(),qt.autoReset=O,pt.enabled=X,pt.autoUpdate=et,pt.needsUpdate=J,pt.type=lt}function Wt(O){const X=O.target;X.removeEventListener("dispose",Wt),Mt(X)}function Mt(O){Ft(O),nt.remove(O)}function Ft(O){const X=nt.get(O).programs;X!==void 0&&(X.forEach(function(et){St.releaseProgram(et)}),O.isShaderMaterial&&St.releaseShaderCache(O))}this.renderBufferDirect=function(O,X,et,J,lt,Ht){X===null&&(X=xt);const jt=lt.isMesh&&lt.matrixWorld.determinant()<0,Yt=Iu(O,X,et,J,lt);at.setMaterial(J,jt);let Gt=et.index;const Jt=et.attributes.position;if(Gt===null){if(Jt===void 0||Jt.count===0)return}else if(Gt.count===0)return;let Zt=1;J.wireframe===!0&&(Gt=Ct.getWireframeAttribute(et),Zt=2),V.setup(lt,J,Yt,et,Gt);let Qt,Ee=Vt;Gt!==null&&(Qt=it.get(Gt),Ee=Dt,Ee.setIndex(Qt));const Ai=Gt!==null?Gt.count:Jt.count,xs=et.drawRange.start*Zt,se=et.drawRange.count*Zt,zn=Ht!==null?Ht.start*Zt:0,ue=Ht!==null?Ht.count*Zt:1/0,hn=Math.max(xs,zn),io=Math.min(Ai,xs+se,zn+ue)-1,Xn=Math.max(0,io-hn+1);if(Xn!==0){if(lt.isMesh)J.wireframe===!0?(at.setLineWidth(J.wireframeLinewidth*It()),Ee.setMode(1)):Ee.setMode(4);else if(lt.isLine){let Yn=J.linewidth;Yn===void 0&&(Yn=1),at.setLineWidth(Yn*It()),lt.isLineSegments?Ee.setMode(1):lt.isLineLoop?Ee.setMode(2):Ee.setMode(3)}else lt.isPoints?Ee.setMode(0):lt.isSprite&&Ee.setMode(4);if(lt.isInstancedMesh)Ee.renderInstances(hn,Xn,lt.count);else if(et.isInstancedBufferGeometry){const Yn=Math.min(et.instanceCount,et._maxInstanceCount);Ee.renderInstances(hn,Xn,Yn)}else Ee.render(hn,Xn)}},this.compile=function(O,X){f=N.get(O),f.init(),_.push(f),O.traverseVisible(function(et){et.isLight&&et.layers.test(X.layers)&&(f.pushLight(et),et.castShadow&&f.pushShadow(et))}),f.setupLights(x.physicallyCorrectLights),O.traverse(function(et){const J=et.material;if(J)if(Array.isArray(J))for(let lt=0;lt<J.length;lt++){const Ht=J[lt];gr(Ht,O,et)}else gr(J,O,et)}),_.pop(),f=null};let Kt=null;function re(O){Kt&&Kt(O)}function Mn(){ui.stop()}function Ne(){ui.start()}const ui=new Bg;ui.setAnimationLoop(re),typeof window!="undefined"&&ui.setContext(window),this.setAnimationLoop=function(O){Kt=O,ct.setAnimationLoop(O),O===null?ui.stop():ui.start()},ct.addEventListener("sessionstart",Mn),ct.addEventListener("sessionend",Ne),this.render=function(O,X){if(X!==void 0&&X.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(w===!0)return;O.autoUpdate===!0&&O.updateMatrixWorld(),X.parent===null&&X.updateMatrixWorld(),ct.enabled===!0&&ct.isPresenting===!0&&(ct.cameraAutoUpdate===!0&&ct.updateCamera(X),X=ct.getCamera()),O.isScene===!0&&O.onBeforeRender(x,O,X,C),f=N.get(O,_.length),f.init(),_.push(f),st.multiplyMatrices(X.projectionMatrix,X.matrixWorldInverse),tt.setFromProjectionMatrix(st),j=this.localClippingEnabled,K=ot.init(this.clippingPlanes,j,X),d=U.get(O,m.length),d.init(),m.push(d),di(O,X,0,x.sortObjects),d.finish(),x.sortObjects===!0&&d.sort(A,D),K===!0&&ot.beginShadows();const et=f.state.shadowsArray;if(pt.render(et,O,X),K===!0&&ot.endShadows(),this.info.autoReset===!0&&this.info.reset(),bt.render(d,O),f.setupLights(x.physicallyCorrectLights),X.isArrayCamera){const J=X.cameras;for(let lt=0,Ht=J.length;lt<Ht;lt++){const jt=J[lt];yc(d,O,jt,jt.viewport)}}else yc(d,O,X);C!==null&&(ft.updateMultisampleRenderTarget(C),ft.updateRenderTargetMipmap(C)),O.isScene===!0&&O.onAfterRender(x,O,X),at.buffers.depth.setTest(!0),at.buffers.depth.setMask(!0),at.buffers.color.setMask(!0),at.setPolygonOffset(!1),V.resetDefaultState(),S=-1,M=null,_.pop(),_.length>0?f=_[_.length-1]:f=null,m.pop(),m.length>0?d=m[m.length-1]:d=null};function di(O,X,et,J){if(O.visible===!1)return;if(O.layers.test(X.layers)){if(O.isGroup)et=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(X);else if(O.isLight)f.pushLight(O),O.castShadow&&f.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||tt.intersectsSprite(O)){J&&rt.setFromMatrixPosition(O.matrixWorld).applyMatrix4(st);const jt=Et.update(O),Yt=O.material;Yt.visible&&d.push(O,jt,Yt,et,rt.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(O.isSkinnedMesh&&O.skeleton.frame!==qt.render.frame&&(O.skeleton.update(),O.skeleton.frame=qt.render.frame),!O.frustumCulled||tt.intersectsObject(O))){J&&rt.setFromMatrixPosition(O.matrixWorld).applyMatrix4(st);const jt=Et.update(O),Yt=O.material;if(Array.isArray(Yt)){const Gt=jt.groups;for(let Jt=0,Zt=Gt.length;Jt<Zt;Jt++){const Qt=Gt[Jt],Ee=Yt[Qt.materialIndex];Ee&&Ee.visible&&d.push(O,jt,Ee,et,rt.z,Qt)}}else Yt.visible&&d.push(O,jt,Yt,et,rt.z,null)}}const Ht=O.children;for(let jt=0,Yt=Ht.length;jt<Yt;jt++)di(Ht[jt],X,et,J)}function yc(O,X,et,J){const lt=O.opaque,Ht=O.transmissive,jt=O.transparent;f.setupLightsView(et),Ht.length>0&&fr(lt,X,et),J&&at.viewport(E.copy(J)),lt.length>0&&mr(lt,X,et),Ht.length>0&&mr(Ht,X,et),jt.length>0&&mr(jt,X,et)}function fr(O,X,et){if($===null){const jt=o===!0&&wt.isWebGL2===!0?Md:Kn;$=new jt(1024,1024,{generateMipmaps:!0,type:W.convert(Mr)!==null?Mr:Ji,minFilter:Nc,magFilter:qe,wrapS:Bn,wrapT:Bn,useRenderToTexture:Rt.has("WEBGL_multisampled_render_to_texture")})}const J=x.getRenderTarget();x.setRenderTarget($),x.clear();const lt=x.toneMapping;x.toneMapping=As,mr(O,X,et),x.toneMapping=lt,ft.updateMultisampleRenderTarget($),ft.updateRenderTargetMipmap($),x.setRenderTarget(J)}function mr(O,X,et){const J=X.isScene===!0?X.overrideMaterial:null;for(let lt=0,Ht=O.length;lt<Ht;lt++){const jt=O[lt],Yt=jt.object,Gt=jt.geometry,Jt=J===null?jt.material:J,Zt=jt.group;Yt.layers.test(et.layers)&&eo(Yt,X,et,Gt,Jt,Zt)}}function eo(O,X,et,J,lt,Ht){O.onBeforeRender(x,X,et,J,lt,Ht),O.modelViewMatrix.multiplyMatrices(et.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),lt.onBeforeRender(x,X,et,J,O,Ht),lt.transparent===!0&&lt.side===mo?(lt.side=Ge,lt.needsUpdate=!0,x.renderBufferDirect(et,X,J,lt,O,Ht),lt.side=Ka,lt.needsUpdate=!0,x.renderBufferDirect(et,X,J,lt,O,Ht),lt.side=mo):x.renderBufferDirect(et,X,J,lt,O,Ht),O.onAfterRender(x,X,et,J,lt,Ht)}function gr(O,X,et){X.isScene!==!0&&(X=xt);const J=nt.get(O),lt=f.state.lights,Ht=f.state.shadowsArray,jt=lt.state.version,Yt=St.getParameters(O,lt.state,Ht,X,et),Gt=St.getProgramCacheKey(Yt);let Jt=J.programs;J.environment=O.isMeshStandardMaterial?X.environment:null,J.fog=X.fog,J.envMap=(O.isMeshStandardMaterial?Z:mt).get(O.envMap||J.environment),Jt===void 0&&(O.addEventListener("dispose",Wt),Jt=new Map,J.programs=Jt);let Zt=Jt.get(Gt);if(Zt!==void 0){if(J.currentProgram===Zt&&J.lightsStateVersion===jt)return no(O,Yt),Zt}else Yt.uniforms=St.getUniforms(O),O.onBuild(et,Yt,x),O.onBeforeCompile(Yt,x),Zt=St.acquireProgram(Yt,Gt),Jt.set(Gt,Zt),J.uniforms=Yt.uniforms;const Qt=J.uniforms;(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&(Qt.clippingPlanes=ot.uniform),no(O,Yt),J.needsLights=Fu(O),J.lightsStateVersion=jt,J.needsLights&&(Qt.ambientLightColor.value=lt.state.ambient,Qt.lightProbe.value=lt.state.probe,Qt.directionalLights.value=lt.state.directional,Qt.directionalLightShadows.value=lt.state.directionalShadow,Qt.spotLights.value=lt.state.spot,Qt.spotLightShadows.value=lt.state.spotShadow,Qt.rectAreaLights.value=lt.state.rectArea,Qt.ltc_1.value=lt.state.rectAreaLTC1,Qt.ltc_2.value=lt.state.rectAreaLTC2,Qt.pointLights.value=lt.state.point,Qt.pointLightShadows.value=lt.state.pointShadow,Qt.hemisphereLights.value=lt.state.hemi,Qt.directionalShadowMap.value=lt.state.directionalShadowMap,Qt.directionalShadowMatrix.value=lt.state.directionalShadowMatrix,Qt.spotShadowMap.value=lt.state.spotShadowMap,Qt.spotShadowMatrix.value=lt.state.spotShadowMatrix,Qt.pointShadowMap.value=lt.state.pointShadowMap,Qt.pointShadowMatrix.value=lt.state.pointShadowMatrix);const Ee=Zt.getUniforms(),Ai=Vs.seqWithValue(Ee.seq,Qt);return J.currentProgram=Zt,J.uniformsList=Ai,Zt}function no(O,X){const et=nt.get(O);et.outputEncoding=X.outputEncoding,et.instancing=X.instancing,et.skinning=X.skinning,et.morphTargets=X.morphTargets,et.morphNormals=X.morphNormals,et.morphTargetsCount=X.morphTargetsCount,et.numClippingPlanes=X.numClippingPlanes,et.numIntersection=X.numClipIntersection,et.vertexAlphas=X.vertexAlphas,et.vertexTangents=X.vertexTangents,et.toneMapping=X.toneMapping}function Iu(O,X,et,J,lt){X.isScene!==!0&&(X=xt),ft.resetTextureUnits();const Ht=X.fog,jt=J.isMeshStandardMaterial?X.environment:null,Yt=C===null?x.outputEncoding:C.texture.encoding,Gt=(J.isMeshStandardMaterial?Z:mt).get(J.envMap||jt),Jt=J.vertexColors===!0&&!!et.attributes.color&&et.attributes.color.itemSize===4,Zt=!!J.normalMap&&!!et.attributes.tangent,Qt=!!et.morphAttributes.position,Ee=!!et.morphAttributes.normal,Ai=et.morphAttributes.position?et.morphAttributes.position.length:0,xs=J.toneMapped?x.toneMapping:As,se=nt.get(J),zn=f.state.lights;if(K===!0&&(j===!0||O!==M)){const un=O===M&&J.id===S;ot.setState(J,O,un)}let ue=!1;J.version===se.__version?(se.needsLights&&se.lightsStateVersion!==zn.state.version||se.outputEncoding!==Yt||lt.isInstancedMesh&&se.instancing===!1||!lt.isInstancedMesh&&se.instancing===!0||lt.isSkinnedMesh&&se.skinning===!1||!lt.isSkinnedMesh&&se.skinning===!0||se.envMap!==Gt||J.fog&&se.fog!==Ht||se.numClippingPlanes!==void 0&&(se.numClippingPlanes!==ot.numPlanes||se.numIntersection!==ot.numIntersection)||se.vertexAlphas!==Jt||se.vertexTangents!==Zt||se.morphTargets!==Qt||se.morphNormals!==Ee||se.toneMapping!==xs||wt.isWebGL2===!0&&se.morphTargetsCount!==Ai)&&(ue=!0):(ue=!0,se.__version=J.version);let hn=se.currentProgram;ue===!0&&(hn=gr(J,X,lt));let io=!1,Xn=!1,Yn=!1;const We=hn.getUniforms(),ys=se.uniforms;if(at.useProgram(hn.program)&&(io=!0,Xn=!0,Yn=!0),J.id!==S&&(S=J.id,Xn=!0),io||M!==O){if(We.setValue(Q,"projectionMatrix",O.projectionMatrix),wt.logarithmicDepthBuffer&&We.setValue(Q,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),M!==O&&(M=O,Xn=!0,Yn=!0),J.isShaderMaterial||J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshStandardMaterial||J.envMap){const un=We.map.cameraPosition;un!==void 0&&un.setValue(Q,rt.setFromMatrixPosition(O.matrixWorld))}(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial)&&We.setValue(Q,"isOrthographic",O.isOrthographicCamera===!0),(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial||J.isShadowMaterial||lt.isSkinnedMesh)&&We.setValue(Q,"viewMatrix",O.matrixWorldInverse)}if(lt.isSkinnedMesh){We.setOptional(Q,lt,"bindMatrix"),We.setOptional(Q,lt,"bindMatrixInverse");const un=lt.skeleton;un&&(wt.floatVertexTextures?(un.boneTexture===null&&un.computeBoneTexture(),We.setValue(Q,"boneTexture",un.boneTexture,ft),We.setValue(Q,"boneTextureSize",un.boneTextureSize)):We.setOptional(Q,un,"boneMatrices"))}return!!et&&(et.morphAttributes.position!==void 0||et.morphAttributes.normal!==void 0)&&ut.update(lt,et,J,hn),(Xn||se.receiveShadow!==lt.receiveShadow)&&(se.receiveShadow=lt.receiveShadow,We.setValue(Q,"receiveShadow",lt.receiveShadow)),Xn&&(We.setValue(Q,"toneMappingExposure",x.toneMappingExposure),se.needsLights&&Nu(ys,Yn),Ht&&J.fog&&Nt.refreshFogUniforms(ys,Ht),Nt.refreshMaterialUniforms(ys,J,L,z,$),Vs.upload(Q,se.uniformsList,ys,ft)),J.isShaderMaterial&&J.uniformsNeedUpdate===!0&&(Vs.upload(Q,se.uniformsList,ys,ft),J.uniformsNeedUpdate=!1),J.isSpriteMaterial&&We.setValue(Q,"center",lt.center),We.setValue(Q,"modelViewMatrix",lt.modelViewMatrix),We.setValue(Q,"normalMatrix",lt.normalMatrix),We.setValue(Q,"modelMatrix",lt.matrixWorld),hn}function Nu(O,X){O.ambientLightColor.needsUpdate=X,O.lightProbe.needsUpdate=X,O.directionalLights.needsUpdate=X,O.directionalLightShadows.needsUpdate=X,O.pointLights.needsUpdate=X,O.pointLightShadows.needsUpdate=X,O.spotLights.needsUpdate=X,O.spotLightShadows.needsUpdate=X,O.rectAreaLights.needsUpdate=X,O.hemisphereLights.needsUpdate=X}function Fu(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(O,X,et){nt.get(O.texture).__webglTexture=X,nt.get(O.depthTexture).__webglTexture=et;const J=nt.get(O);J.__hasExternalTextures=!0,J.__hasExternalTextures&&(J.__autoAllocateDepthBuffer=et===void 0,J.__autoAllocateDepthBuffer||O.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),O.useRenderToTexture=!1,O.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(O,X){const et=nt.get(O);et.__webglFramebuffer=X,et.__useDefaultFramebuffer=X===void 0},this.setRenderTarget=function(O,X=0,et=0){C=O,v=X,y=et;let J=!0;if(O){const Gt=nt.get(O);Gt.__useDefaultFramebuffer!==void 0?(at.bindFramebuffer(36160,null),J=!1):Gt.__webglFramebuffer===void 0?ft.setupRenderTarget(O):Gt.__hasExternalTextures&&ft.rebindTextures(O,nt.get(O.texture).__webglTexture,nt.get(O.depthTexture).__webglTexture)}let lt=null,Ht=!1,jt=!1;if(O){const Gt=O.texture;(Gt.isDataTexture3D||Gt.isDataTexture2DArray)&&(jt=!0);const Jt=nt.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(lt=Jt[X],Ht=!0):O.useRenderbuffer?lt=nt.get(O).__webglMultisampledFramebuffer:lt=Jt,E.copy(O.viewport),T.copy(O.scissor),R=O.scissorTest}else E.copy(I).multiplyScalar(L).floor(),T.copy(B).multiplyScalar(L).floor(),R=k;if(at.bindFramebuffer(36160,lt)&&wt.drawBuffers&&J){let Gt=!1;if(O)if(O.isWebGLMultipleRenderTargets){const Jt=O.texture;if(G.length!==Jt.length||G[0]!==36064){for(let Zt=0,Qt=Jt.length;Zt<Qt;Zt++)G[Zt]=36064+Zt;G.length=Jt.length,Gt=!0}}else(G.length!==1||G[0]!==36064)&&(G[0]=36064,G.length=1,Gt=!0);else(G.length!==1||G[0]!==1029)&&(G[0]=1029,G.length=1,Gt=!0);Gt&&(wt.isWebGL2?Q.drawBuffers(G):Rt.get("WEBGL_draw_buffers").drawBuffersWEBGL(G))}if(at.viewport(E),at.scissor(T),at.setScissorTest(R),Ht){const Gt=nt.get(O.texture);Q.framebufferTexture2D(36160,36064,34069+X,Gt.__webglTexture,et)}else if(jt){const Gt=nt.get(O.texture),Jt=X||0;Q.framebufferTextureLayer(36160,36064,Gt.__webglTexture,et||0,Jt)}S=-1},this.readRenderTargetPixels=function(O,X,et,J,lt,Ht,jt){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Yt=nt.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&jt!==void 0&&(Yt=Yt[jt]),Yt){at.bindFramebuffer(36160,Yt);try{const Gt=O.texture,Jt=Gt.format,Zt=Gt.type;if(Jt!==Ye&&W.convert(Jt)!==Q.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Qt=Zt===Mr&&(Rt.has("EXT_color_buffer_half_float")||wt.isWebGL2&&Rt.has("EXT_color_buffer_float"));if(Zt!==Ji&&W.convert(Zt)!==Q.getParameter(35738)&&!(Zt===Ps&&(wt.isWebGL2||Rt.has("OES_texture_float")||Rt.has("WEBGL_color_buffer_float")))&&!Qt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Q.checkFramebufferStatus(36160)===36053?X>=0&&X<=O.width-J&&et>=0&&et<=O.height-lt&&Q.readPixels(X,et,J,lt,W.convert(Jt),W.convert(Zt),Ht):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Gt=C!==null?nt.get(C).__webglFramebuffer:null;at.bindFramebuffer(36160,Gt)}}},this.copyFramebufferToTexture=function(O,X,et=0){if(X.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}const J=Math.pow(2,-et),lt=Math.floor(X.image.width*J),Ht=Math.floor(X.image.height*J);ft.setTexture2D(X,0),Q.copyTexSubImage2D(3553,et,0,0,O.x,O.y,lt,Ht),at.unbindTexture()},this.copyTextureToTexture=function(O,X,et,J=0){const lt=X.image.width,Ht=X.image.height,jt=W.convert(et.format),Yt=W.convert(et.type);ft.setTexture2D(et,0),Q.pixelStorei(37440,et.flipY),Q.pixelStorei(37441,et.premultiplyAlpha),Q.pixelStorei(3317,et.unpackAlignment),X.isDataTexture?Q.texSubImage2D(3553,J,O.x,O.y,lt,Ht,jt,Yt,X.image.data):X.isCompressedTexture?Q.compressedTexSubImage2D(3553,J,O.x,O.y,X.mipmaps[0].width,X.mipmaps[0].height,jt,X.mipmaps[0].data):Q.texSubImage2D(3553,J,O.x,O.y,jt,Yt,X.image),J===0&&et.generateMipmaps&&Q.generateMipmap(3553),at.unbindTexture()},this.copyTextureToTexture3D=function(O,X,et,J,lt=0){if(x.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ht=O.max.x-O.min.x+1,jt=O.max.y-O.min.y+1,Yt=O.max.z-O.min.z+1,Gt=W.convert(J.format),Jt=W.convert(J.type);let Zt;if(J.isDataTexture3D)ft.setTexture3D(J,0),Zt=32879;else if(J.isDataTexture2DArray)ft.setTexture2DArray(J,0),Zt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Q.pixelStorei(37440,J.flipY),Q.pixelStorei(37441,J.premultiplyAlpha),Q.pixelStorei(3317,J.unpackAlignment);const Qt=Q.getParameter(3314),Ee=Q.getParameter(32878),Ai=Q.getParameter(3316),xs=Q.getParameter(3315),se=Q.getParameter(32877),zn=et.isCompressedTexture?et.mipmaps[0]:et.image;Q.pixelStorei(3314,zn.width),Q.pixelStorei(32878,zn.height),Q.pixelStorei(3316,O.min.x),Q.pixelStorei(3315,O.min.y),Q.pixelStorei(32877,O.min.z),et.isDataTexture||et.isDataTexture3D?Q.texSubImage3D(Zt,lt,X.x,X.y,X.z,Ht,jt,Yt,Gt,Jt,zn.data):et.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Q.compressedTexSubImage3D(Zt,lt,X.x,X.y,X.z,Ht,jt,Yt,Gt,zn.data)):Q.texSubImage3D(Zt,lt,X.x,X.y,X.z,Ht,jt,Yt,Gt,Jt,zn),Q.pixelStorei(3314,Qt),Q.pixelStorei(32878,Ee),Q.pixelStorei(3316,Ai),Q.pixelStorei(3315,xs),Q.pixelStorei(32877,se),lt===0&&J.generateMipmaps&&Q.generateMipmap(Zt),at.unbindTexture()},this.initTexture=function(O){ft.setTexture2D(O,0),at.unbindTexture()},this.resetState=function(){v=0,y=0,C=null,at.reset(),V.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}pe.prototype.isWebGLRenderer=!0;class DA extends pe{}DA.prototype.isWebGL1Renderer=!0;class S_ extends le{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}}S_.prototype.isScene=!0;class dl{constructor(t,e){this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=il,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ri()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,s=this.stride;i<s;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ri()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ri()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}dl.prototype.isInterleavedBuffer=!0;const Fe=new H;class pl{constructor(t,e,n,i=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Fe.x=this.getX(e),Fe.y=this.getY(e),Fe.z=this.getZ(e),Fe.applyMatrix4(t),this.setXYZ(e,Fe.x,Fe.y,Fe.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Fe.x=this.getX(e),Fe.y=this.getY(e),Fe.z=this.getZ(e),Fe.applyNormalMatrix(t),this.setXYZ(e,Fe.x,Fe.y,Fe.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Fe.x=this.getX(e),Fe.y=this.getY(e),Fe.z=this.getZ(e),Fe.transformDirection(t),this.setXYZ(e,Fe.x,Fe.y,Fe.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=s,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)e.push(this.data.array[i+s])}return new je(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new pl(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)e.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}pl.prototype.isInterleavedBufferAttribute=!0;class T_ extends dn{constructor(t){super();this.type="SpriteMaterial",this.color=new kt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}T_.prototype.isSpriteMaterial=!0;let Go;const fl=new H,qo=new H,jo=new H,$o=new ht,ml=new ht,E_=new Ot,ph=new H,gl=new H,fh=new H,C_=new ht,op=new ht,A_=new ht;class LA extends le{constructor(t){super();if(this.type="Sprite",Go===void 0){Go=new de;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new dl(e,5);Go.setIndex([0,1,2,0,2,3]),Go.setAttribute("position",new pl(n,3,0,!1)),Go.setAttribute("uv",new pl(n,2,3,!1))}this.geometry=Go,this.material=t!==void 0?t:new T_,this.center=new ht(.5,.5)}raycast(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),qo.setFromMatrixScale(this.matrixWorld),E_.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),jo.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&qo.multiplyScalar(-jo.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const o=this.center;mh(ph.set(-.5,-.5,0),jo,o,qo,i,s),mh(gl.set(.5,-.5,0),jo,o,qo,i,s),mh(fh.set(.5,.5,0),jo,o,qo,i,s),C_.set(0,0),op.set(1,0),A_.set(1,1);let a=t.ray.intersectTriangle(ph,gl,fh,!1,fl);if(a===null&&(mh(gl.set(-.5,.5,0),jo,o,qo,i,s),op.set(0,1),a=t.ray.intersectTriangle(ph,fh,gl,!1,fl),a===null))return;const l=t.ray.origin.distanceTo(fl);l<t.near||l>t.far||e.push({distance:l,point:fl.clone(),uv:Be.getUV(fl,ph,gl,fh,C_,op,A_,new ht),face:null,object:this})}copy(t){return super.copy(t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}LA.prototype.isSprite=!0;function mh(r,t,e,n,i,s){$o.subVectors(r,e).addScalar(.5).multiply(n),i!==void 0?(ml.x=s*$o.x-i*$o.y,ml.y=i*$o.x+s*$o.y):ml.copy($o),r.copy(t),r.x+=ml.x,r.y+=ml.y,r.applyMatrix4(E_)}const P_=new H,R_=new ge,D_=new ge,kA=new H,L_=new Ot;class k_ extends Cn{constructor(t,e){super(t,e);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ot,this.bindMatrixInverse=new Ot}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new ge,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,i=this.geometry;R_.fromBufferAttribute(i.attributes.skinIndex,t),D_.fromBufferAttribute(i.attributes.skinWeight,t),P_.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let s=0;s<4;s++){const o=D_.getComponent(s);if(o!==0){const a=R_.getComponent(s);L_.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(kA.copy(P_).applyMatrix4(L_),o)}}return e.applyMatrix4(this.bindMatrixInverse)}}k_.prototype.isSkinnedMesh=!0;class IA extends le{constructor(){super();this.type="Bone"}}IA.prototype.isBone=!0;class NA extends Ze{constructor(t=null,e=1,n=1,i,s,o,a,l,h=qe,u=qe,d,f){super(null,o,a,l,h,u,i,s,d,f);this.image={data:t,width:e,height:n},this.magFilter=h,this.minFilter=u,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}NA.prototype.isDataTexture=!0;class ap extends je{constructor(t,e,n,i=1){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(t,e,n);this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}ap.prototype.isInstancedBufferAttribute=!0;const I_=new Ot,N_=new Ot,gh=[],_l=new Cn;class FA extends Cn{constructor(t,e,n){super(t,e);this.instanceMatrix=new ap(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,t*3)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,t*16)}raycast(t,e){const n=this.matrixWorld,i=this.count;if(_l.geometry=this.geometry,_l.material=this.material,_l.material!==void 0)for(let s=0;s<i;s++){this.getMatrixAt(s,I_),N_.multiplyMatrices(n,I_),_l.matrixWorld=N_,_l.raycast(t,gh);for(let o=0,a=gh.length;o<a;o++){const l=gh[o];l.instanceId=s,l.object=this,e.push(l)}gh.length=0}}setColorAt(t,e){this.instanceColor===null&&(this.instanceColor=new ap(new Float32Array(this.instanceMatrix.count*3),3)),e.toArray(this.instanceColor.array,t*3)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,t*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}FA.prototype.isInstancedMesh=!0;class Xo extends dn{constructor(t){super();this.type="LineBasicMaterial",this.color=new kt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}}Xo.prototype.isLineBasicMaterial=!0;const F_=new H,O_=new H,z_=new Ot,lp=new Ar,_h=new Ao;class cp extends le{constructor(t=new de,e=new Xo){super();this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[0];for(let i=1,s=e.count;i<s;i++)F_.fromBufferAttribute(e,i-1),O_.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=F_.distanceTo(O_);t.setAttribute("lineDistance",new ce(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,s=t.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),_h.copy(n.boundingSphere),_h.applyMatrix4(i),_h.radius+=s,t.ray.intersectsSphere(_h)===!1)return;z_.copy(i).invert(),lp.copy(t.ray).applyMatrix4(z_);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new H,u=new H,d=new H,f=new H,m=this.isLineSegments?2:1;if(n.isBufferGeometry){const _=n.index,w=n.attributes.position;if(_!==null){const v=Math.max(0,o.start),y=Math.min(_.count,o.start+o.count);for(let C=v,S=y-1;C<S;C+=m){const M=_.getX(C),E=_.getX(C+1);if(h.fromBufferAttribute(w,M),u.fromBufferAttribute(w,E),lp.distanceSqToSegment(h,u,f,d)>l)continue;f.applyMatrix4(this.matrixWorld);const R=t.ray.origin.distanceTo(f);R<t.near||R>t.far||e.push({distance:R,point:d.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),y=Math.min(w.count,o.start+o.count);for(let C=v,S=y-1;C<S;C+=m){if(h.fromBufferAttribute(w,C),u.fromBufferAttribute(w,C+1),lp.distanceSqToSegment(h,u,f,d)>l)continue;f.applyMatrix4(this.matrixWorld);const E=t.ray.origin.distanceTo(f);E<t.near||E>t.far||e.push({distance:E,point:d.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const i=e[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}cp.prototype.isLine=!0;const V_=new H,B_=new H;class vh extends cp{constructor(t,e){super(t,e);this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[];for(let i=0,s=e.count;i<s;i+=2)V_.fromBufferAttribute(e,i),B_.fromBufferAttribute(e,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+V_.distanceTo(B_);t.setAttribute("lineDistance",new ce(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}vh.prototype.isLineSegments=!0;class OA extends cp{constructor(t,e){super(t,e);this.type="LineLoop"}}OA.prototype.isLineLoop=!0;class U_ extends dn{constructor(t){super();this.type="PointsMaterial",this.color=new kt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}}U_.prototype.isPointsMaterial=!0;const H_=new Ot,hp=new Ar,xh=new Ao,yh=new H;class zA extends le{constructor(t=new de,e=new U_){super();this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,s=t.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),xh.copy(n.boundingSphere),xh.applyMatrix4(i),xh.radius+=s,t.ray.intersectsSphere(xh)===!1)return;H_.copy(i).invert(),hp.copy(t.ray).applyMatrix4(H_);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(n.isBufferGeometry){const h=n.index,d=n.attributes.position;if(h!==null){const f=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);for(let _=f,x=m;_<x;_++){const w=h.getX(_);yh.fromBufferAttribute(d,w),W_(yh,w,l,i,t,e,this)}}else{const f=Math.max(0,o.start),m=Math.min(d.count,o.start+o.count);for(let _=f,x=m;_<x;_++)yh.fromBufferAttribute(d,_),W_(yh,_,l,i,t,e,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const i=e[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}zA.prototype.isPoints=!0;function W_(r,t,e,n,i,s,o){const a=hp.distanceSqToPoint(r);if(a<e){const l=new H;hp.closestPointToPoint(r,l),l.applyMatrix4(n);const h=i.ray.origin.distanceTo(l);if(h<i.near||h>i.far)return;s.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:t,face:null,object:o})}}class VA extends Ze{constructor(t,e,n,i,s,o,a,l,h){super(t,e,n,i,s,o,a,l,h);this.format=a!==void 0?a:Sr,this.minFilter=o!==void 0?o:vn,this.magFilter=s!==void 0?s:vn,this.generateMipmaps=!1;const u=this;function d(){u.needsUpdate=!0,t.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}VA.prototype.isVideoTexture=!0;class BA extends Ze{constructor(t,e,n){super({width:t,height:e});this.format=n,this.magFilter=qe,this.minFilter=qe,this.generateMipmaps=!1,this.needsUpdate=!0}}BA.prototype.isFramebufferTexture=!0;class UA extends Ze{constructor(t,e,n,i,s,o,a,l,h,u,d,f){super(null,o,a,l,h,u,i,s,d,f);this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}UA.prototype.isCompressedTexture=!0;class HA extends Ze{constructor(t,e,n,i,s,o,a,l,h){super(t,e,n,i,s,o,a,l,h);this.needsUpdate=!0}}HA.prototype.isCanvasTexture=!0;class up extends de{constructor(t=1,e=1,n=1,i=8,s=1,o=!1,a=0,l=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const h=this;i=Math.floor(i),s=Math.floor(s);const u=[],d=[],f=[],m=[];let _=0;const x=[],w=n/2;let v=0;y(),o===!1&&(t>0&&C(!0),e>0&&C(!1)),this.setIndex(u),this.setAttribute("position",new ce(d,3)),this.setAttribute("normal",new ce(f,3)),this.setAttribute("uv",new ce(m,2));function y(){const S=new H,M=new H;let E=0;const T=(e-t)/n;for(let R=0;R<=s;R++){const F=[],z=R/s,L=z*(e-t)+t;for(let A=0;A<=i;A++){const D=A/i,I=D*l+a,B=Math.sin(I),k=Math.cos(I);M.x=L*B,M.y=-z*n+w,M.z=L*k,d.push(M.x,M.y,M.z),S.set(B,T,k).normalize(),f.push(S.x,S.y,S.z),m.push(D,1-z),F.push(_++)}x.push(F)}for(let R=0;R<i;R++)for(let F=0;F<s;F++){const z=x[F][R],L=x[F+1][R],A=x[F+1][R+1],D=x[F][R+1];u.push(z,L,D),u.push(L,A,D),E+=6}h.addGroup(v,E,0),v+=E}function C(S){const M=_,E=new ht,T=new H;let R=0;const F=S===!0?t:e,z=S===!0?1:-1;for(let A=1;A<=i;A++)d.push(0,w*z,0),f.push(0,z,0),m.push(.5,.5),_++;const L=_;for(let A=0;A<=i;A++){const I=A/i*l+a,B=Math.cos(I),k=Math.sin(I);T.x=F*k,T.y=w*z,T.z=F*B,d.push(T.x,T.y,T.z),f.push(0,z,0),E.x=B*.5+.5,E.y=k*.5*z+.5,m.push(E.x,E.y),_++}for(let A=0;A<i;A++){const D=M+A,I=L+A;S===!0?u.push(I,I+1,D):u.push(I+1,I,D),R+=3}h.addGroup(v,R,S===!0?1:2),v+=R}}static fromJSON(t){return new up(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class G_ extends up{constructor(t=1,e=1,n=8,i=1,s=!1,o=0,a=Math.PI*2){super(0,t,e,n,i,s,o,a);this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(t){return new G_(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class dp extends de{constructor(t=[],e=[],n=1,i=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i};const s=[],o=[];a(i),h(n),u(),this.setAttribute("position",new ce(s,3)),this.setAttribute("normal",new ce(s.slice(),3)),this.setAttribute("uv",new ce(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(y){const C=new H,S=new H,M=new H;for(let E=0;E<e.length;E+=3)m(e[E+0],C),m(e[E+1],S),m(e[E+2],M),l(C,S,M,y)}function l(y,C,S,M){const E=M+1,T=[];for(let R=0;R<=E;R++){T[R]=[];const F=y.clone().lerp(S,R/E),z=C.clone().lerp(S,R/E),L=E-R;for(let A=0;A<=L;A++)A===0&&R===E?T[R][A]=F:T[R][A]=F.clone().lerp(z,A/L)}for(let R=0;R<E;R++)for(let F=0;F<2*(E-R)-1;F++){const z=Math.floor(F/2);F%2==0?(f(T[R][z+1]),f(T[R+1][z]),f(T[R][z])):(f(T[R][z+1]),f(T[R+1][z+1]),f(T[R+1][z]))}}function h(y){const C=new H;for(let S=0;S<s.length;S+=3)C.x=s[S+0],C.y=s[S+1],C.z=s[S+2],C.normalize().multiplyScalar(y),s[S+0]=C.x,s[S+1]=C.y,s[S+2]=C.z}function u(){const y=new H;for(let C=0;C<s.length;C+=3){y.x=s[C+0],y.y=s[C+1],y.z=s[C+2];const S=w(y)/2/Math.PI+.5,M=v(y)/Math.PI+.5;o.push(S,1-M)}_(),d()}function d(){for(let y=0;y<o.length;y+=6){const C=o[y+0],S=o[y+2],M=o[y+4],E=Math.max(C,S,M),T=Math.min(C,S,M);E>.9&&T<.1&&(C<.2&&(o[y+0]+=1),S<.2&&(o[y+2]+=1),M<.2&&(o[y+4]+=1))}}function f(y){s.push(y.x,y.y,y.z)}function m(y,C){const S=y*3;C.x=t[S+0],C.y=t[S+1],C.z=t[S+2]}function _(){const y=new H,C=new H,S=new H,M=new H,E=new ht,T=new ht,R=new ht;for(let F=0,z=0;F<s.length;F+=9,z+=6){y.set(s[F+0],s[F+1],s[F+2]),C.set(s[F+3],s[F+4],s[F+5]),S.set(s[F+6],s[F+7],s[F+8]),E.set(o[z+0],o[z+1]),T.set(o[z+2],o[z+3]),R.set(o[z+4],o[z+5]),M.copy(y).add(C).add(S).divideScalar(3);const L=w(M);x(E,z+0,y,L),x(T,z+2,C,L),x(R,z+4,S,L)}}function x(y,C,S,M){M<0&&y.x===1&&(o[C]=y.x-1),S.x===0&&S.z===0&&(o[C]=M/2/Math.PI+.5)}function w(y){return Math.atan2(y.z,-y.x)}function v(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}static fromJSON(t){return new dp(t.vertices,t.indices,t.radius,t.details)}}new H;new H;new H;new Be;class ti{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),s=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),s+=n.distanceTo(i),e.push(s),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const s=n.length;let o;e?o=e:o=t*n[s-1];let a=0,l=s-1,h;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),h=n[i]-o,h<0)a=i+1;else if(h>0)l=i-1;else{l=i;break}if(i=l,n[i]===o)return i/(s-1);const u=n[i],f=n[i+1]-u,m=(o-u)/f;return(i+m)/(s-1)}getTangent(t,e){const n=1e-4;let i=t-n,s=t+n;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=e||(o.isVector2?new ht:new H);return l.copy(a).sub(o).normalize(),l}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new H,i=[],s=[],o=[],a=new H,l=new Ot;for(let m=0;m<=t;m++){const _=m/t;i[m]=this.getTangentAt(_,new H)}s[0]=new H,o[0]=new H;let h=Number.MAX_VALUE;const u=Math.abs(i[0].x),d=Math.abs(i[0].y),f=Math.abs(i[0].z);u<=h&&(h=u,n.set(1,0,0)),d<=h&&(h=d,n.set(0,1,0)),f<=h&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let m=1;m<=t;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(i[m-1],i[m]),a.length()>Number.EPSILON){a.normalize();const _=Math.acos(En(i[m-1].dot(i[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,_))}o[m].crossVectors(i[m],s[m])}if(e===!0){let m=Math.acos(En(s[0].dot(s[t]),-1,1));m/=t,i[0].dot(a.crossVectors(s[0],s[t]))>0&&(m=-m);for(let _=1;_<=t;_++)s[_].applyMatrix4(l.makeRotationAxis(i[_],m*_)),o[_].crossVectors(i[_],s[_])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class bh extends ti{constructor(t=0,e=0,n=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super();this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(t,e){const n=e||new ht,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+t*s;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),f=l-this.aX,m=h-this.aY;l=f*u-m*d+this.aX,h=f*d+m*u+this.aY}return n.set(l,h)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}bh.prototype.isEllipseCurve=!0;class q_ extends bh{constructor(t,e,n,i,s,o){super(t,e,n,n,i,s,o);this.type="ArcCurve"}}q_.prototype.isArcCurve=!0;function pp(){let r=0,t=0,e=0,n=0;function i(s,o,a,l){r=s,t=a,e=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,h){i(o,a,h*(a-s),h*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,h,u,d){let f=(o-s)/h-(a-s)/(h+u)+(a-o)/u,m=(a-o)/u-(l-o)/(u+d)+(l-a)/d;f*=u,m*=u,i(o,a,f,m)},calc:function(s){const o=s*s,a=o*s;return r+t*s+e*o+n*a}}}const wh=new H,fp=new pp,mp=new pp,gp=new pp;class j_ extends ti{constructor(t=[],e=!1,n="centripetal",i=.5){super();this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new H){const n=e,i=this.points,s=i.length,o=(s-(this.closed?0:1))*t;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let h,u;this.closed||a>0?h=i[(a-1)%s]:(wh.subVectors(i[0],i[1]).add(i[0]),h=wh);const d=i[a%s],f=i[(a+1)%s];if(this.closed||a+2<s?u=i[(a+2)%s]:(wh.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=wh),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let _=Math.pow(h.distanceToSquared(d),m),x=Math.pow(d.distanceToSquared(f),m),w=Math.pow(f.distanceToSquared(u),m);x<1e-4&&(x=1),_<1e-4&&(_=x),w<1e-4&&(w=x),fp.initNonuniformCatmullRom(h.x,d.x,f.x,u.x,_,x,w),mp.initNonuniformCatmullRom(h.y,d.y,f.y,u.y,_,x,w),gp.initNonuniformCatmullRom(h.z,d.z,f.z,u.z,_,x,w)}else this.curveType==="catmullrom"&&(fp.initCatmullRom(h.x,d.x,f.x,u.x,this.tension),mp.initCatmullRom(h.y,d.y,f.y,u.y,this.tension),gp.initCatmullRom(h.z,d.z,f.z,u.z,this.tension));return n.set(fp.calc(l),mp.calc(l),gp.calc(l)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(new H().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}j_.prototype.isCatmullRomCurve3=!0;function $_(r,t,e,n,i){const s=(n-t)*.5,o=(i-e)*.5,a=r*r,l=r*a;return(2*e-2*n+s+o)*l+(-3*e+3*n-2*s-o)*a+s*r+e}function WA(r,t){const e=1-r;return e*e*t}function GA(r,t){return 2*(1-r)*r*t}function qA(r,t){return r*r*t}function vl(r,t,e,n){return WA(r,t)+GA(r,e)+qA(r,n)}function jA(r,t){const e=1-r;return e*e*e*t}function $A(r,t){const e=1-r;return 3*e*e*r*t}function XA(r,t){return 3*(1-r)*r*r*t}function YA(r,t){return r*r*r*t}function xl(r,t,e,n,i){return jA(r,t)+$A(r,e)+XA(r,n)+YA(r,i)}class _p extends ti{constructor(t=new ht,e=new ht,n=new ht,i=new ht){super();this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new ht){const n=e,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(xl(t,i.x,s.x,o.x,a.x),xl(t,i.y,s.y,o.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}_p.prototype.isCubicBezierCurve=!0;class X_ extends ti{constructor(t=new H,e=new H,n=new H,i=new H){super();this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new H){const n=e,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(xl(t,i.x,s.x,o.x,a.x),xl(t,i.y,s.y,o.y,a.y),xl(t,i.z,s.z,o.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}X_.prototype.isCubicBezierCurve3=!0;class Mh extends ti{constructor(t=new ht,e=new ht){super();this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new ht){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new ht;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Mh.prototype.isLineCurve=!0;class ZA extends ti{constructor(t=new H,e=new H){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new H){const n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class vp extends ti{constructor(t=new ht,e=new ht,n=new ht){super();this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new ht){const n=e,i=this.v0,s=this.v1,o=this.v2;return n.set(vl(t,i.x,s.x,o.x),vl(t,i.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}vp.prototype.isQuadraticBezierCurve=!0;class Y_ extends ti{constructor(t=new H,e=new H,n=new H){super();this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new H){const n=e,i=this.v0,s=this.v1,o=this.v2;return n.set(vl(t,i.x,s.x,o.x),vl(t,i.y,s.y,o.y),vl(t,i.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Y_.prototype.isQuadraticBezierCurve3=!0;class xp extends ti{constructor(t=[]){super();this.type="SplineCurve",this.points=t}getPoint(t,e=new ht){const n=e,i=this.points,s=(i.length-1)*t,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],h=i[o],u=i[o>i.length-2?i.length-1:o+1],d=i[o>i.length-3?i.length-1:o+2];return n.set($_(a,l.x,h.x,u.x,d.x),$_(a,l.y,h.y,u.y,d.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(new ht().fromArray(i))}return this}}xp.prototype.isSplineCurve=!0;var Z_=Object.freeze({__proto__:null,ArcCurve:q_,CatmullRomCurve3:j_,CubicBezierCurve:_p,CubicBezierCurve3:X_,EllipseCurve:bh,LineCurve:Mh,LineCurve3:ZA,QuadraticBezierCurve:vp,QuadraticBezierCurve3:Y_,SplineCurve:xp});class JA extends ti{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Mh(e,t))}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const o=i[s]-n,a=this.curves[s],l=a.getLength(),h=l===0?0:1-o/l;return a.getPointAt(h,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o&&o.isEllipseCurve?t*2:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,l=o.getPoints(a);for(let h=0;h<l.length;h++){const u=l[h];n&&n.equals(u)||(e.push(u),n=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const i=t.curves[e];this.curves.push(new Z_[i.type]().fromJSON(i))}return this}}class yp extends JA{constructor(t){super();this.type="Path",this.currentPoint=new ht,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Mh(this.currentPoint.clone(),new ht(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const s=new vp(this.currentPoint.clone(),new ht(t,e),new ht(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,s,o){const a=new _p(this.currentPoint.clone(),new ht(t,e),new ht(n,i),new ht(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new xp(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(t+a,e+l,n,i,s,o),this}absarc(t,e,n,i,s,o){return this.absellipse(t,e,n,n,i,s,o),this}ellipse(t,e,n,i,s,o,a,l){const h=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+h,e+u,n,i,s,o,a,l),this}absellipse(t,e,n,i,s,o,a,l){const h=new bh(t,e,n,i,s,o,a,l);if(this.curves.length>0){const d=h.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(h);const u=h.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class yl extends yp{constructor(t){super(t);this.uuid=Ri(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const i=t.holes[e];this.holes.push(new yp().fromJSON(i))}return this}}const KA={triangulate:function(r,t,e=2){const n=t&&t.length,i=n?t[0]*e:r.length;let s=J_(r,0,i,e,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,h,u,d,f,m;if(n&&(s=i2(r,t,s,e)),r.length>80*e){a=h=r[0],l=u=r[1];for(let _=e;_<i;_+=e)d=r[_],f=r[_+1],d<a&&(a=d),f<l&&(l=f),d>h&&(h=d),f>u&&(u=f);m=Math.max(h-a,u-l),m=m!==0?1/m:0}return bl(s,o,e,a,l,m),o}};function J_(r,t,e,n,i){let s,o;if(i===f2(r,t,e,n)>0)for(s=t;s<e;s+=n)o=tv(s,r[s],r[s+1],o);else for(s=e-n;s>=t;s-=n)o=tv(s,r[s],r[s+1],o);return o&&Sh(o,o.next)&&(Ml(o),o=o.next),o}function Bs(r,t){if(!r)return r;t||(t=r);let e=r,n;do if(n=!1,!e.steiner&&(Sh(e,e.next)||Le(e.prev,e,e.next)===0)){if(Ml(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function bl(r,t,e,n,i,s,o){if(!r)return;!o&&s&&l2(r,n,i,s);let a=r,l,h;for(;r.prev!==r.next;){if(l=r.prev,h=r.next,s?t2(r,n,i,s):QA(r)){t.push(l.i/e),t.push(r.i/e),t.push(h.i/e),Ml(r),r=h.next,a=h.next;continue}if(r=h,r===a){o?o===1?(r=e2(Bs(r),t,e),bl(r,t,e,n,i,s,2)):o===2&&n2(r,t,e,n,i,s):bl(Bs(r),t,e,n,i,s,1);break}}}function QA(r){const t=r.prev,e=r,n=r.next;if(Le(t,e,n)>=0)return!1;let i=r.next.next;for(;i!==r.prev;){if(Yo(t.x,t.y,e.x,e.y,n.x,n.y,i.x,i.y)&&Le(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function t2(r,t,e,n){const i=r.prev,s=r,o=r.next;if(Le(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,l=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,h=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,u=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,d=bp(a,l,t,e,n),f=bp(h,u,t,e,n);let m=r.prevZ,_=r.nextZ;for(;m&&m.z>=d&&_&&_.z<=f;){if(m!==r.prev&&m!==r.next&&Yo(i.x,i.y,s.x,s.y,o.x,o.y,m.x,m.y)&&Le(m.prev,m,m.next)>=0||(m=m.prevZ,_!==r.prev&&_!==r.next&&Yo(i.x,i.y,s.x,s.y,o.x,o.y,_.x,_.y)&&Le(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;m&&m.z>=d;){if(m!==r.prev&&m!==r.next&&Yo(i.x,i.y,s.x,s.y,o.x,o.y,m.x,m.y)&&Le(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;_&&_.z<=f;){if(_!==r.prev&&_!==r.next&&Yo(i.x,i.y,s.x,s.y,o.x,o.y,_.x,_.y)&&Le(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function e2(r,t,e){let n=r;do{const i=n.prev,s=n.next.next;!Sh(i,s)&&K_(i,n,n.next,s)&&wl(i,s)&&wl(s,i)&&(t.push(i.i/e),t.push(n.i/e),t.push(s.i/e),Ml(n),Ml(n.next),n=r=s),n=n.next}while(n!==r);return Bs(n)}function n2(r,t,e,n,i,s){let o=r;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&u2(o,a)){let l=Q_(o,a);o=Bs(o,o.next),l=Bs(l,l.next),bl(o,t,e,n,i,s),bl(l,t,e,n,i,s);return}a=a.next}o=o.next}while(o!==r)}function i2(r,t,e,n){const i=[];let s,o,a,l,h;for(s=0,o=t.length;s<o;s++)a=t[s]*n,l=s<o-1?t[s+1]*n:r.length,h=J_(r,a,l,n,!1),h===h.next&&(h.steiner=!0),i.push(h2(h));for(i.sort(s2),s=0;s<i.length;s++)r2(i[s],e),e=Bs(e,e.next);return e}function s2(r,t){return r.x-t.x}function r2(r,t){if(t=o2(r,t),t){const e=Q_(t,r);Bs(t,t.next),Bs(e,e.next)}}function o2(r,t){let e=t;const n=r.x,i=r.y;let s=-1/0,o;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){const f=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(f<=n&&f>s){if(s=f,f===n){if(i===e.y)return e;if(i===e.next.y)return e.next}o=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!o)return null;if(n===s)return o;const a=o,l=o.x,h=o.y;let u=1/0,d;e=o;do n>=e.x&&e.x>=l&&n!==e.x&&Yo(i<h?n:s,i,l,h,i<h?s:n,i,e.x,e.y)&&(d=Math.abs(i-e.y)/(n-e.x),wl(e,r)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&a2(o,e)))&&(o=e,u=d)),e=e.next;while(e!==a);return o}function a2(r,t){return Le(r.prev,r,t.prev)<0&&Le(t.next,r,r.next)<0}function l2(r,t,e,n){let i=r;do i.z===null&&(i.z=bp(i.x,i.y,t,e,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,c2(i)}function c2(r){let t,e,n,i,s,o,a,l,h=1;do{for(e=r,r=null,s=null,o=0;e;){for(o++,n=e,a=0,t=0;t<h&&(a++,n=n.nextZ,!!n);t++);for(l=h;a>0||l>0&&n;)a!==0&&(l===0||!n||e.z<=n.z)?(i=e,e=e.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;e=n}s.nextZ=null,h*=2}while(o>1);return r}function bp(r,t,e,n,i){return r=32767*(r-e)*i,t=32767*(t-n)*i,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function h2(r){let t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Yo(r,t,e,n,i,s,o,a){return(i-o)*(t-a)-(r-o)*(s-a)>=0&&(r-o)*(n-a)-(e-o)*(t-a)>=0&&(e-o)*(s-a)-(i-o)*(n-a)>=0}function u2(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!d2(r,t)&&(wl(r,t)&&wl(t,r)&&p2(r,t)&&(Le(r.prev,r,t.prev)||Le(r,t.prev,t))||Sh(r,t)&&Le(r.prev,r,r.next)>0&&Le(t.prev,t,t.next)>0)}function Le(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function Sh(r,t){return r.x===t.x&&r.y===t.y}function K_(r,t,e,n){const i=Eh(Le(r,t,e)),s=Eh(Le(r,t,n)),o=Eh(Le(e,n,r)),a=Eh(Le(e,n,t));return!!(i!==s&&o!==a||i===0&&Th(r,e,t)||s===0&&Th(r,n,t)||o===0&&Th(e,r,n)||a===0&&Th(e,t,n))}function Th(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function Eh(r){return r>0?1:r<0?-1:0}function d2(r,t){let e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&K_(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function wl(r,t){return Le(r.prev,r,r.next)<0?Le(r,t,r.next)>=0&&Le(r,r.prev,t)>=0:Le(r,t,r.prev)<0||Le(r,r.next,t)<0}function p2(r,t){let e=r,n=!1;const i=(r.x+t.x)/2,s=(r.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&i<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==r);return n}function Q_(r,t){const e=new wp(r.i,r.x,r.y),n=new wp(t.i,t.x,t.y),i=r.next,s=t.prev;return r.next=t,t.prev=r,e.next=i,i.prev=e,n.next=e,e.prev=n,s.next=n,n.prev=s,n}function tv(r,t,e,n){const i=new wp(r,t,e);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Ml(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function wp(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function f2(r,t,e,n){let i=0;for(let s=t,o=e-n;s<e;s+=n)i+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return i}class Us{static area(t){const e=t.length;let n=0;for(let i=e-1,s=0;s<e;i=s++)n+=t[i].x*t[s].y-t[s].x*t[i].y;return n*.5}static isClockWise(t){return Us.area(t)<0}static triangulateShape(t,e){const n=[],i=[],s=[];ev(t),nv(n,t);let o=t.length;e.forEach(ev);for(let l=0;l<e.length;l++)i.push(o),o+=e[l].length,nv(n,e[l]);const a=KA.triangulate(n,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function ev(r){const t=r.length;t>2&&r[t-1].equals(r[0])&&r.pop()}function nv(r,t){for(let e=0;e<t.length;e++)r.push(t[e].x),r.push(t[e].y)}class Zo extends de{constructor(t=new yl([new ht(.5,.5),new ht(-.5,.5),new ht(-.5,-.5),new ht(.5,-.5)]),e={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],s=[];for(let a=0,l=t.length;a<l;a++){const h=t[a];o(h)}this.setAttribute("position",new ce(i,3)),this.setAttribute("uv",new ce(s,2)),this.computeVertexNormals();function o(a){const l=[],h=e.curveSegments!==void 0?e.curveSegments:12,u=e.steps!==void 0?e.steps:1;let d=e.depth!==void 0?e.depth:1,f=e.bevelEnabled!==void 0?e.bevelEnabled:!0,m=e.bevelThickness!==void 0?e.bevelThickness:.2,_=e.bevelSize!==void 0?e.bevelSize:m-.1,x=e.bevelOffset!==void 0?e.bevelOffset:0,w=e.bevelSegments!==void 0?e.bevelSegments:3;const v=e.extrudePath,y=e.UVGenerator!==void 0?e.UVGenerator:m2;e.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=e.amount);let C,S=!1,M,E,T,R;v&&(C=v.getSpacedPoints(u),S=!0,f=!1,M=v.computeFrenetFrames(u,!1),E=new H,T=new H,R=new H),f||(w=0,m=0,_=0,x=0);const F=a.extractPoints(h);let z=F.shape;const L=F.holes;if(!Us.isClockWise(z)){z=z.reverse();for(let nt=0,ft=L.length;nt<ft;nt++){const mt=L[nt];Us.isClockWise(mt)&&(L[nt]=mt.reverse())}}const D=Us.triangulateShape(z,L),I=z;for(let nt=0,ft=L.length;nt<ft;nt++){const mt=L[nt];z=z.concat(mt)}function B(nt,ft,mt){return ft||console.error("THREE.ExtrudeGeometry: vec does not exist"),ft.clone().multiplyScalar(mt).add(nt)}const k=z.length,G=D.length;function tt(nt,ft,mt){let Z,it,Ct;const Et=nt.x-ft.x,St=nt.y-ft.y,Nt=mt.x-nt.x,U=mt.y-nt.y,N=Et*Et+St*St,ot=Et*U-St*Nt;if(Math.abs(ot)>Number.EPSILON){const pt=Math.sqrt(N),bt=Math.sqrt(Nt*Nt+U*U),ut=ft.x-St/pt,Vt=ft.y+Et/pt,Dt=mt.x-U/bt,W=mt.y+Nt/bt,V=((Dt-ut)*U-(W-Vt)*Nt)/(Et*U-St*Nt);Z=ut+Et*V-nt.x,it=Vt+St*V-nt.y;const dt=Z*Z+it*it;if(dt<=2)return new ht(Z,it);Ct=Math.sqrt(dt/2)}else{let pt=!1;Et>Number.EPSILON?Nt>Number.EPSILON&&(pt=!0):Et<-Number.EPSILON?Nt<-Number.EPSILON&&(pt=!0):Math.sign(St)===Math.sign(U)&&(pt=!0),pt?(Z=-St,it=Et,Ct=Math.sqrt(N)):(Z=Et,it=St,Ct=Math.sqrt(N/2))}return new ht(Z/Ct,it/Ct)}const K=[];for(let nt=0,ft=I.length,mt=ft-1,Z=nt+1;nt<ft;nt++,mt++,Z++)mt===ft&&(mt=0),Z===ft&&(Z=0),K[nt]=tt(I[nt],I[mt],I[Z]);const j=[];let $,st=K.concat();for(let nt=0,ft=L.length;nt<ft;nt++){const mt=L[nt];$=[];for(let Z=0,it=mt.length,Ct=it-1,Et=Z+1;Z<it;Z++,Ct++,Et++)Ct===it&&(Ct=0),Et===it&&(Et=0),$[Z]=tt(mt[Z],mt[Ct],mt[Et]);j.push($),st=st.concat($)}for(let nt=0;nt<w;nt++){const ft=nt/w,mt=m*Math.cos(ft*Math.PI/2),Z=_*Math.sin(ft*Math.PI/2)+x;for(let it=0,Ct=I.length;it<Ct;it++){const Et=B(I[it],K[it],Z);_t(Et.x,Et.y,-mt)}for(let it=0,Ct=L.length;it<Ct;it++){const Et=L[it];$=j[it];for(let St=0,Nt=Et.length;St<Nt;St++){const U=B(Et[St],$[St],Z);_t(U.x,U.y,-mt)}}}const rt=_+x;for(let nt=0;nt<k;nt++){const ft=f?B(z[nt],st[nt],rt):z[nt];S?(T.copy(M.normals[0]).multiplyScalar(ft.x),E.copy(M.binormals[0]).multiplyScalar(ft.y),R.copy(C[0]).add(T).add(E),_t(R.x,R.y,R.z)):_t(ft.x,ft.y,0)}for(let nt=1;nt<=u;nt++)for(let ft=0;ft<k;ft++){const mt=f?B(z[ft],st[ft],rt):z[ft];S?(T.copy(M.normals[nt]).multiplyScalar(mt.x),E.copy(M.binormals[nt]).multiplyScalar(mt.y),R.copy(C[nt]).add(T).add(E),_t(R.x,R.y,R.z)):_t(mt.x,mt.y,d/u*nt)}for(let nt=w-1;nt>=0;nt--){const ft=nt/w,mt=m*Math.cos(ft*Math.PI/2),Z=_*Math.sin(ft*Math.PI/2)+x;for(let it=0,Ct=I.length;it<Ct;it++){const Et=B(I[it],K[it],Z);_t(Et.x,Et.y,d+mt)}for(let it=0,Ct=L.length;it<Ct;it++){const Et=L[it];$=j[it];for(let St=0,Nt=Et.length;St<Nt;St++){const U=B(Et[St],$[St],Z);S?_t(U.x,U.y+C[u-1].y,C[u-1].x+mt):_t(U.x,U.y,d+mt)}}}xt(),It();function xt(){const nt=i.length/3;if(f){let ft=0,mt=k*ft;for(let Z=0;Z<G;Z++){const it=D[Z];Rt(it[2]+mt,it[1]+mt,it[0]+mt)}ft=u+w*2,mt=k*ft;for(let Z=0;Z<G;Z++){const it=D[Z];Rt(it[0]+mt,it[1]+mt,it[2]+mt)}}else{for(let ft=0;ft<G;ft++){const mt=D[ft];Rt(mt[2],mt[1],mt[0])}for(let ft=0;ft<G;ft++){const mt=D[ft];Rt(mt[0]+k*u,mt[1]+k*u,mt[2]+k*u)}}n.addGroup(nt,i.length/3-nt,0)}function It(){const nt=i.length/3;let ft=0;Q(I,ft),ft+=I.length;for(let mt=0,Z=L.length;mt<Z;mt++){const it=L[mt];Q(it,ft),ft+=it.length}n.addGroup(nt,i.length/3-nt,1)}function Q(nt,ft){let mt=nt.length;for(;--mt>=0;){const Z=mt;let it=mt-1;it<0&&(it=nt.length-1);for(let Ct=0,Et=u+w*2;Ct<Et;Ct++){const St=k*Ct,Nt=k*(Ct+1),U=ft+Z+St,N=ft+it+St,ot=ft+it+Nt,pt=ft+Z+Nt;wt(U,N,ot,pt)}}}function _t(nt,ft,mt){l.push(nt),l.push(ft),l.push(mt)}function Rt(nt,ft,mt){at(nt),at(ft),at(mt);const Z=i.length/3,it=y.generateTopUV(n,i,Z-3,Z-2,Z-1);qt(it[0]),qt(it[1]),qt(it[2])}function wt(nt,ft,mt,Z){at(nt),at(ft),at(Z),at(ft),at(mt),at(Z);const it=i.length/3,Ct=y.generateSideWallUV(n,i,it-6,it-3,it-2,it-1);qt(Ct[0]),qt(Ct[1]),qt(Ct[3]),qt(Ct[1]),qt(Ct[2]),qt(Ct[3])}function at(nt){i.push(l[nt*3+0]),i.push(l[nt*3+1]),i.push(l[nt*3+2])}function qt(nt){s.push(nt.x),s.push(nt.y)}}}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,n=this.parameters.options;return g2(e,n,t)}static fromJSON(t,e){const n=[];for(let s=0,o=t.shapes.length;s<o;s++){const a=e[t.shapes[s]];n.push(a)}const i=t.options.extrudePath;return i!==void 0&&(t.options.extrudePath=new Z_[i.type]().fromJSON(i)),new Zo(n,t.options)}}const m2={generateTopUV:function(r,t,e,n,i){const s=t[e*3],o=t[e*3+1],a=t[n*3],l=t[n*3+1],h=t[i*3],u=t[i*3+1];return[new ht(s,o),new ht(a,l),new ht(h,u)]},generateSideWallUV:function(r,t,e,n,i,s){const o=t[e*3],a=t[e*3+1],l=t[e*3+2],h=t[n*3],u=t[n*3+1],d=t[n*3+2],f=t[i*3],m=t[i*3+1],_=t[i*3+2],x=t[s*3],w=t[s*3+1],v=t[s*3+2];return Math.abs(a-u)<Math.abs(o-h)?[new ht(o,1-l),new ht(h,1-d),new ht(f,1-_),new ht(x,1-v)]:[new ht(a,1-l),new ht(u,1-d),new ht(m,1-_),new ht(w,1-v)]}};function g2(r,t,e){if(e.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];e.shapes.push(s.uuid)}else e.shapes.push(r.uuid);return t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}class iv extends dp{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,t,e);this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new iv(t.radius,t.detail)}}class Mp extends de{constructor(t=new yl([new ht(0,.5),new ht(-.5,-.5),new ht(.5,-.5)]),e=12){super();this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(t)===!1)h(t);else for(let u=0;u<t.length;u++)h(t[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new ce(i,3)),this.setAttribute("normal",new ce(s,3)),this.setAttribute("uv",new ce(o,2));function h(u){const d=i.length/3,f=u.extractPoints(e);let m=f.shape;const _=f.holes;Us.isClockWise(m)===!1&&(m=m.reverse());for(let w=0,v=_.length;w<v;w++){const y=_[w];Us.isClockWise(y)===!0&&(_[w]=y.reverse())}const x=Us.triangulateShape(m,_);for(let w=0,v=_.length;w<v;w++){const y=_[w];m=m.concat(y)}for(let w=0,v=m.length;w<v;w++){const y=m[w];i.push(y.x,y.y,0),s.push(0,0,1),o.push(y.x,y.y)}for(let w=0,v=x.length;w<v;w++){const y=x[w],C=y[0]+d,S=y[1]+d,M=y[2]+d;n.push(C,S,M),l+=3}}}toJSON(){const t=super.toJSON(),e=this.parameters.shapes;return _2(e,t)}static fromJSON(t,e){const n=[];for(let i=0,s=t.shapes.length;i<s;i++){const o=e[t.shapes[i]];n.push(o)}return new Mp(n,t.curveSegments)}}function _2(r,t){if(t.shapes=[],Array.isArray(r))for(let e=0,n=r.length;e<n;e++){const i=r[e];t.shapes.push(i.uuid)}else t.shapes.push(r.uuid);return t}class sv extends de{constructor(t=1,e=32,n=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let h=0;const u=[],d=new H,f=new H,m=[],_=[],x=[],w=[];for(let v=0;v<=n;v++){const y=[],C=v/n;let S=0;v==0&&o==0?S=.5/e:v==n&&l==Math.PI&&(S=-.5/e);for(let M=0;M<=e;M++){const E=M/e;d.x=-t*Math.cos(i+E*s)*Math.sin(o+C*a),d.y=t*Math.cos(o+C*a),d.z=t*Math.sin(i+E*s)*Math.sin(o+C*a),_.push(d.x,d.y,d.z),f.copy(d).normalize(),x.push(f.x,f.y,f.z),w.push(E+S,1-C),y.push(h++)}u.push(y)}for(let v=0;v<n;v++)for(let y=0;y<e;y++){const C=u[v][y+1],S=u[v][y],M=u[v+1][y],E=u[v+1][y+1];(v!==0||o>0)&&m.push(C,S,E),(v!==n-1||l<Math.PI)&&m.push(S,M,E)}this.setIndex(m),this.setAttribute("position",new ce(_,3)),this.setAttribute("normal",new ce(x,3)),this.setAttribute("uv",new ce(w,2))}static fromJSON(t){return new sv(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class v2 extends dn{constructor(t){super();this.type="ShadowMaterial",this.color=new kt(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}v2.prototype.isShadowMaterial=!0;class rv extends dn{constructor(t){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new kt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}rv.prototype.isMeshStandardMaterial=!0;class x2 extends rv{constructor(t){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ht(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return En(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new kt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new kt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new kt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}x2.prototype.isMeshPhysicalMaterial=!0;class y2 extends dn{constructor(t){super();this.type="MeshPhongMaterial",this.color=new kt(16777215),this.specular=new kt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}y2.prototype.isMeshPhongMaterial=!0;class b2 extends dn{constructor(t){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new kt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}b2.prototype.isMeshToonMaterial=!0;class w2 extends dn{constructor(t){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}w2.prototype.isMeshNormalMaterial=!0;class M2 extends dn{constructor(t){super();this.type="MeshLambertMaterial",this.color=new kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=kc,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}M2.prototype.isMeshLambertMaterial=!0;class S2 extends dn{constructor(t){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new kt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wo,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}}S2.prototype.isMeshMatcapMaterial=!0;class T2 extends Xo{constructor(t){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}T2.prototype.isLineDashedMaterial=!0;const Pe={arraySlice:function(r,t,e){return Pe.isTypedArray(r)?new r.constructor(r.subarray(t,e!==void 0?e:r.length)):r.slice(t,e)},convertArray:function(r,t,e){return!r||!e&&r.constructor===t?r:typeof t.BYTES_PER_ELEMENT=="number"?new t(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function t(i,s){return r[i]-r[s]}const e=r.length,n=new Array(e);for(let i=0;i!==e;++i)n[i]=i;return n.sort(t),n},sortedArray:function(r,t,e){const n=r.length,i=new r.constructor(n);for(let s=0,o=0;o!==n;++s){const a=e[s]*t;for(let l=0;l!==t;++l)i[o++]=r[a+l]}return i},flattenJSON:function(r,t,e,n){let i=1,s=r[0];for(;s!==void 0&&s[n]===void 0;)s=r[i++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(t.push(s.time),e.push.apply(e,o)),s=r[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(t.push(s.time),o.toArray(e,e.length)),s=r[i++];while(s!==void 0);else do o=s[n],o!==void 0&&(t.push(s.time),e.push(o)),s=r[i++];while(s!==void 0)},subclip:function(r,t,e,n,i=30){const s=r.clone();s.name=t;const o=[];for(let l=0;l<s.tracks.length;++l){const h=s.tracks[l],u=h.getValueSize(),d=[],f=[];for(let m=0;m<h.times.length;++m){const _=h.times[m]*i;if(!(_<e||_>=n)){d.push(h.times[m]);for(let x=0;x<u;++x)f.push(h.values[m*u+x])}}d.length!==0&&(h.times=Pe.convertArray(d,h.times.constructor),h.values=Pe.convertArray(f,h.values.constructor),o.push(h))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(r,t=0,e=r,n=30){n<=0&&(n=30);const i=e.tracks.length,s=t/n;for(let o=0;o<i;++o){const a=e.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const h=r.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(h===void 0)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let f=0;const m=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=m/3);const _=a.times.length-1;let x;if(s<=a.times[0]){const v=u,y=d-u;x=Pe.arraySlice(a.values,v,y)}else if(s>=a.times[_]){const v=_*d+u,y=v+d-u;x=Pe.arraySlice(a.values,v,y)}else{const v=a.createInterpolant(),y=u,C=d-u;v.evaluate(s),x=Pe.arraySlice(v.resultBuffer,y,C)}l==="quaternion"&&new on().fromArray(x).normalize().conjugate().toArray(x);const w=h.times.length;for(let v=0;v<w;++v){const y=v*m+f;if(l==="quaternion")on.multiplyQuaternionsFlat(h.values,y,x,0,h.values,y);else{const C=m-f*2;for(let S=0;S<C;++S)h.values[y+S]-=x[S]}}}return r.blendMode=bg,r}};class Hs{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],s=e[n-1];t:{e:{let o;n:{i:if(!(t<i)){for(let a=n+2;;){if(i===void 0){if(t<s)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,s)}if(n===a)break;if(s=i,i=e[++n],t<i)break e}o=e.length;break n}if(!(t>=s)){const a=e[1];t<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===l)break;if(i=s,s=e[--n-1],t>=s)break e}o=n,n=0;break n}break t}for(;n<o;){const a=n+o>>>1;t<e[a]?o=a:n=a+1}if(i=e[n],s=e[n-1],s===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(i===void 0)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,s,t)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=t*i;for(let o=0;o!==i;++o)e[o]=n[s+o];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Hs.prototype.beforeStart_=Hs.prototype.copySampleValue_;Hs.prototype.afterEnd_=Hs.prototype.copySampleValue_;class E2 extends Hs{constructor(t,e,n,i){super(t,e,n,i);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:xo,endingEnd:xo}}intervalChanged_(t,e,n){const i=this.parameterPositions;let s=t-2,o=t+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case yo:s=t,a=2*e-n;break;case Vc:s=i.length-2,a=e+i[s]-i[s+1];break;default:s=t,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case yo:o=t,l=2*n-e;break;case Vc:o=1,l=n+i[1]-i[0];break;default:o=t-1,l=e}const h=(n-e)*.5,u=this.valueSize;this._weightPrev=h/(e-a),this._weightNext=h/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(t,e,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=this._offsetPrev,d=this._offsetNext,f=this._weightPrev,m=this._weightNext,_=(n-e)/(i-e),x=_*_,w=x*_,v=-f*w+2*f*x-f*_,y=(1+f)*w+(-1.5-2*f)*x+(-.5+f)*_+1,C=(-1-m)*w+(1.5+m)*x+.5*_,S=m*w-m*x;for(let M=0;M!==a;++M)s[M]=v*o[u+M]+y*o[h+M]+C*o[l+M]+S*o[d+M];return s}}class ov extends Hs{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=t*a,h=l-a,u=(n-e)/(i-e),d=1-u;for(let f=0;f!==a;++f)s[f]=o[h+f]*d+o[l+f]*u;return s}}class C2 extends Hs{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class ki{constructor(t,e,n,i){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Pe.convertArray(e,this.TimeBufferType),this.values=Pe.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Pe.convertArray(t.times,Array),values:Pe.convertArray(t.values,Array)};const i=t.getInterpolation();i!==t.DefaultInterpolation&&(n.interpolation=i)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new C2(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new ov(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new E2(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Oc:e=this.InterpolantFactoryMethodDiscrete;break;case zc:e=this.InterpolantFactoryMethodLinear;break;case gd:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Oc;case this.InterpolantFactoryMethodLinear:return zc;case this.InterpolantFactoryMethodSmooth:return gd}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(t!==1){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let s=0,o=i-1;for(;s!==i&&n[s]<t;)++s;for(;o!==-1&&n[o]>e;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Pe.arraySlice(n,s,o),this.values=Pe.arraySlice(this.values,s*a,o*a)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),t=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),t=!1;break}o=l}if(i!==void 0&&Pe.isTypedArray(i))for(let a=0,l=i.length;a!==l;++a){const h=i[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),t=!1;break}}return t}optimize(){const t=Pe.arraySlice(this.times),e=Pe.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===gd,s=t.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const h=t[a],u=t[a+1];if(h!==u&&(a!==1||h!==t[0]))if(i)l=!0;else{const d=a*n,f=d-n,m=d+n;for(let _=0;_!==n;++_){const x=e[d+_];if(x!==e[f+_]||x!==e[m+_]){l=!0;break}}}if(l){if(a!==o){t[o]=t[a];const d=a*n,f=o*n;for(let m=0;m!==n;++m)e[f+m]=e[d+m]}++o}}if(s>0){t[o]=t[s];for(let a=s*n,l=o*n,h=0;h!==n;++h)e[l+h]=e[a+h];++o}return o!==t.length?(this.times=Pe.arraySlice(t,0,o),this.values=Pe.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=Pe.arraySlice(this.times,0),e=Pe.arraySlice(this.values,0),n=this.constructor,i=new n(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}ki.prototype.TimeBufferType=Float32Array;ki.prototype.ValueBufferType=Float32Array;ki.prototype.DefaultInterpolation=zc;class Jo extends ki{}Jo.prototype.ValueTypeName="bool";Jo.prototype.ValueBufferType=Array;Jo.prototype.DefaultInterpolation=Oc;Jo.prototype.InterpolantFactoryMethodLinear=void 0;Jo.prototype.InterpolantFactoryMethodSmooth=void 0;class av extends ki{}av.prototype.ValueTypeName="color";class Ch extends ki{}Ch.prototype.ValueTypeName="number";class A2 extends Hs{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-e)/(i-e);let h=t*a;for(let u=h+a;h!==u;h+=4)on.slerpFlat(s,0,o,h-a,o,h,l);return s}}class Sl extends ki{InterpolantFactoryMethodLinear(t){return new A2(this.times,this.values,this.getValueSize(),t)}}Sl.prototype.ValueTypeName="quaternion";Sl.prototype.DefaultInterpolation=zc;Sl.prototype.InterpolantFactoryMethodSmooth=void 0;class Ko extends ki{}Ko.prototype.ValueTypeName="string";Ko.prototype.ValueBufferType=Array;Ko.prototype.DefaultInterpolation=Oc;Ko.prototype.InterpolantFactoryMethodLinear=void 0;Ko.prototype.InterpolantFactoryMethodSmooth=void 0;class Ah extends ki{}Ah.prototype.ValueTypeName="vector";class lv{constructor(t,e=-1,n,i=_d){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=Ri(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let o=0,a=n.length;o!==a;++o)e.push(R2(n[o]).scale(i));const s=new this(t.name,t.duration,e,t.blendMode);return s.uuid=t.uuid,s}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let s=0,o=n.length;s!==o;++s)e.push(ki.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const s=e.length,o=[];for(let a=0;a<s;a++){let l=[],h=[];l.push((a+s-1)%s,a,(a+1)%s),h.push(0,1,0);const u=Pe.getKeyframeOrder(l);l=Pe.sortedArray(l,1,u),h=Pe.sortedArray(h,1,u),!i&&l[0]===0&&(l.push(s),h.push(h[0])),o.push(new Ch(".morphTargetInfluences["+e[a].name+"]",l,h).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const i=t;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=t.length;a<l;a++){const h=t[a],u=h.name.match(s);if(u&&u.length>1){const d=u[1];let f=i[d];f||(i[d]=f=[]),f.push(h)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],e,n));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(d,f,m,_,x){if(m.length!==0){const w=[],v=[];Pe.flattenJSON(m,w,v,_),w.length!==0&&x.push(new d(f,w,v))}},i=[],s=t.name||"default",o=t.fps||30,a=t.blendMode;let l=t.length||-1;const h=t.hierarchy||[];for(let d=0;d<h.length;d++){const f=h[d].keys;if(!(!f||f.length===0))if(f[0].morphTargets){const m={};let _;for(_=0;_<f.length;_++)if(f[_].morphTargets)for(let x=0;x<f[_].morphTargets.length;x++)m[f[_].morphTargets[x]]=-1;for(const x in m){const w=[],v=[];for(let y=0;y!==f[_].morphTargets.length;++y){const C=f[_];w.push(C.time),v.push(C.morphTarget===x?1:0)}i.push(new Ch(".morphTargetInfluence["+x+"]",w,v))}l=m.length*(o||1)}else{const m=".bones["+e[d].name+"]";n(Ah,m+".position",f,"pos",i),n(Sl,m+".quaternion",f,"rot",i),n(Ah,m+".scale",f,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const t=this.tracks;let e=0;for(let n=0,i=t.length;n!==i;++n){const s=this.tracks[n];e=Math.max(e,s.times[s.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function P2(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ch;case"vector":case"vector2":case"vector3":case"vector4":return Ah;case"color":return av;case"quaternion":return Sl;case"bool":case"boolean":return Jo;case"string":return Ko}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function R2(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=P2(r.type);if(r.times===void 0){const e=[],n=[];Pe.flattenJSON(r.keys,e,n,"value"),r.times=e,r.values=n}return t.parse!==void 0?t.parse(r):new t(r.name,r.times,r.values,r.interpolation)}const Qo={enabled:!1,files:{},add:function(r,t){this.enabled!==!1&&(this.files[r]=t)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class D2{constructor(t,e,n){const i=this;let s=!1,o=0,a=0,l;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return h.push(u,d),this},this.removeHandler=function(u){const d=h.indexOf(u);return d!==-1&&h.splice(d,2),this},this.getHandler=function(u){for(let d=0,f=h.length;d<f;d+=2){const m=h[d],_=h[d+1];if(m.global&&(m.lastIndex=0),m.test(u))return _}return null}}}const L2=new D2;class Ws{constructor(t){this.manager=t!==void 0?t:L2,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(i,s){n.load(t,i,e,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const ss={};class k2 extends Ws{constructor(t){super(t)}load(t,e,n,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=Qo.get(t);if(s!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(s),this.manager.itemEnd(t)},0),s;if(ss[t]!==void 0){ss[t].push({onLoad:e,onProgress:n,onError:i});return}ss[t]=[],ss[t].push({onLoad:e,onProgress:n,onError:i});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(o).then(a=>{if(a.status===200||a.status===0){if(a.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||a.body.getReader===void 0)return a;const l=ss[t],h=a.body.getReader(),u=a.headers.get("Content-Length"),d=u?parseInt(u):0,f=d!==0;let m=0;const _=new ReadableStream({start(x){w();function w(){h.read().then(({done:v,value:y})=>{if(v)x.close();else{m+=y.byteLength;const C=new ProgressEvent("progress",{lengthComputable:f,loaded:m,total:d});for(let S=0,M=l.length;S<M;S++){const E=l[S];E.onProgress&&E.onProgress(C)}x.enqueue(y),w()}})}}});return new Response(_)}else throw Error(`fetch for "${a.url}" responded with ${a.status}: ${a.statusText}`)}).then(a=>{switch(this.responseType){case"arraybuffer":return a.arrayBuffer();case"blob":return a.blob();case"document":return a.text().then(l=>new DOMParser().parseFromString(l,this.mimeType));case"json":return a.json();default:return a.text()}}).then(a=>{Qo.add(t,a);const l=ss[t];delete ss[t];for(let h=0,u=l.length;h<u;h++){const d=l[h];d.onLoad&&d.onLoad(a)}}).catch(a=>{const l=ss[t];if(l===void 0)throw this.manager.itemError(t),a;delete ss[t];for(let h=0,u=l.length;h<u;h++){const d=l[h];d.onError&&d.onError(a)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class cv extends Ws{constructor(t){super(t)}load(t,e,n,i){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,o=Qo.get(t);if(o!==void 0)return s.manager.itemStart(t),setTimeout(function(){e&&e(o),s.manager.itemEnd(t)},0),o;const a=Uc("img");function l(){u(),Qo.add(t,this),e&&e(this),s.manager.itemEnd(t)}function h(d){u(),i&&i(d),s.manager.itemError(t),s.manager.itemEnd(t)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(t),a.src=t,a}}class I2 extends Ws{constructor(t){super(t)}load(t,e,n,i){const s=new rh,o=new cv(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(h){o.load(t[h],function(u){s.images[h]=u,a++,a===6&&(s.needsUpdate=!0,e&&e(s))},void 0,i)}for(let h=0;h<t.length;++h)l(h);return s}}class N2 extends Ws{constructor(t){super(t)}load(t,e,n,i){const s=new Ze,o=new cv(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(a){s.image=a,s.needsUpdate=!0,e!==void 0&&e(s)},n,i),s}}class Ii extends le{constructor(t,e=1){super();this.type="Light",this.color=new kt(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}Ii.prototype.isLight=!0;class F2 extends Ii{constructor(t,e,n){super(t,n);this.type="HemisphereLight",this.position.copy(le.DefaultUp),this.updateMatrix(),this.groundColor=new kt(e)}copy(t){return Ii.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}F2.prototype.isHemisphereLight=!0;const hv=new Ot,uv=new H,dv=new H;class Sp{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ht(512,512),this.map=null,this.mapPass=null,this.matrix=new Ot,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ah,this._frameExtents=new ht(1,1),this._viewportCount=1,this._viewports=[new ge(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;uv.setFromMatrixPosition(t.matrixWorld),e.position.copy(uv),dv.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(dv),e.updateMatrixWorld(),hv.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(hv),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class pv extends Sp{constructor(){super(new An(50,1,.5,500));this.focus=1}updateMatrices(t){const e=this.camera,n=yd*2*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=t.distance||e.far;(n!==e.fov||i!==e.aspect||s!==e.far)&&(e.fov=n,e.aspect=i,e.far=s,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}pv.prototype.isSpotLightShadow=!0;class O2 extends Ii{constructor(t,e,n=0,i=Math.PI/3,s=0,o=1){super(t,e);this.type="SpotLight",this.position.copy(le.DefaultUp),this.updateMatrix(),this.target=new le,this.distance=n,this.angle=i,this.penumbra=s,this.decay=o,this.shadow=new pv}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}O2.prototype.isSpotLight=!0;const fv=new Ot,Tl=new H,Tp=new H;class mv extends Sp{constructor(){super(new An(90,1,.5,500));this._frameExtents=new ht(4,2),this._viewportCount=6,this._viewports=[new ge(2,1,1,1),new ge(0,1,1,1),new ge(3,1,1,1),new ge(1,1,1,1),new ge(3,0,1,1),new ge(1,0,1,1)],this._cubeDirections=[new H(1,0,0),new H(-1,0,0),new H(0,0,1),new H(0,0,-1),new H(0,1,0),new H(0,-1,0)],this._cubeUps=[new H(0,1,0),new H(0,1,0),new H(0,1,0),new H(0,1,0),new H(0,0,1),new H(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,s=t.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Tl.setFromMatrixPosition(t.matrixWorld),n.position.copy(Tl),Tp.copy(n.position),Tp.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Tp),n.updateMatrixWorld(),i.makeTranslation(-Tl.x,-Tl.y,-Tl.z),fv.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fv)}}mv.prototype.isPointLightShadow=!0;class z2 extends Ii{constructor(t,e,n=0,i=1){super(t,e);this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new mv}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}z2.prototype.isPointLight=!0;class gv extends Sp{constructor(){super(new Zd(-5,5,5,-5,.5,500))}}gv.prototype.isDirectionalLightShadow=!0;class V2 extends Ii{constructor(t,e){super(t,e);this.type="DirectionalLight",this.position.copy(le.DefaultUp),this.updateMatrix(),this.target=new le,this.shadow=new gv}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}V2.prototype.isDirectionalLight=!0;class B2 extends Ii{constructor(t,e){super(t,e);this.type="AmbientLight"}}B2.prototype.isAmbientLight=!0;class U2 extends Ii{constructor(t,e,n=10,i=10){super(t,e);this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}U2.prototype.isRectAreaLight=!0;class _v{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new H)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,s=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*i),e.addScaledVector(o[2],.488603*s),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],1.092548*(n*i)),e.addScaledVector(o[5],1.092548*(i*s)),e.addScaledVector(o[6],.315392*(3*s*s-1)),e.addScaledVector(o[7],1.092548*(n*s)),e.addScaledVector(o[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,s=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],2*.511664*i),e.addScaledVector(o[2],2*.511664*s),e.addScaledVector(o[3],2*.511664*n),e.addScaledVector(o[4],2*.429043*n*i),e.addScaledVector(o[5],2*.429043*i*s),e.addScaledVector(o[6],.743125*s*s-.247708),e.addScaledVector(o[7],2*.429043*n*s),e.addScaledVector(o[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+i*3);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+i*3);return t}static getBasisAt(t,e){const n=t.x,i=t.y,s=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*s,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*s,e[6]=.315392*(3*s*s-1),e[7]=1.092548*n*s,e[8]=.546274*(n*n-i*i)}}_v.prototype.isSphericalHarmonics3=!0;class Ep extends Ii{constructor(t=new _v,e=1){super(void 0,e);this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}Ep.prototype.isLightProbe=!0;class H2{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let e="";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return e===-1?"./":t.substr(0,e+1)}static resolveURL(t,e){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class W2 extends de{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}W2.prototype.isInstancedBufferGeometry=!0;class G2 extends Ws{constructor(t){super(t);typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,o=Qo.get(t);if(o!==void 0)return s.manager.itemStart(t),setTimeout(function(){e&&e(o),s.manager.itemEnd(t)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Qo.add(t,l),e&&e(l),s.manager.itemEnd(t)}).catch(function(l){i&&i(l),s.manager.itemError(t),s.manager.itemEnd(t)}),s.manager.itemStart(t)}}G2.prototype.isImageBitmapLoader=!0;let Ph;const q2={getContext:function(){return Ph===void 0&&(Ph=new(window.AudioContext||window.webkitAudioContext)),Ph},setContext:function(r){Ph=r}};class j2 extends Ws{constructor(t){super(t)}load(t,e,n,i){const s=this,o=new k2(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(a){try{const l=a.slice(0);q2.getContext().decodeAudioData(l,function(u){e(u)})}catch(l){i?i(l):console.error(l),s.manager.itemError(t)}},n,i)}}class $2 extends Ep{constructor(t,e,n=1){super(void 0,n);const i=new kt().set(t),s=new kt().set(e),o=new H(i.r,i.g,i.b),a=new H(s.r,s.g,s.b),l=Math.sqrt(Math.PI),h=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(h)}}$2.prototype.isHemisphereLightProbe=!0;class X2 extends Ep{constructor(t,e=1){super(void 0,e);const n=new kt().set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}X2.prototype.isAmbientLightProbe=!0;class Y2 extends le{constructor(t){super();this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class Z2{constructor(t,e,n){this.binding=t,this.valueSize=n;let i,s,o;switch(e){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,s=t*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)n[s+a]=n[a];o=e}else{o+=e;const a=e/o;this._mixBufferRegion(n,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=e*this._origIndex;this._mixBufferRegion(n,i,l,1-s,e)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let l=e,h=e+e;l!==h;++l)if(n[l]!==n[l+e]){a.setValue(n,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let s=n,o=i;s!==o;++s)e[s]=e[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,s){if(i>=.5)for(let o=0;o!==s;++o)t[e+o]=t[n+o]}_slerp(t,e,n,i){on.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,s){const o=this._workIndex*s;on.multiplyQuaternionsFlat(t,o,t,e,t,n),on.slerpFlat(t,e,t,e,t,o,i)}_lerp(t,e,n,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=e+a;t[l]=t[l]*o+t[n+a]*i}}_lerpAdditive(t,e,n,i,s){for(let o=0;o!==s;++o){const a=e+o;t[a]=t[a]+t[n+o]*i}}}const Cp="\\[\\]\\.:\\/",J2=new RegExp("["+Cp+"]","g"),Ap="[^"+Cp+"]",K2="[^"+Cp.replace("\\.","")+"]",Q2=/((?:WC+[\/:])*)/.source.replace("WC",Ap),tP=/(WCOD+)?/.source.replace("WCOD",K2),eP=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ap),nP=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ap),iP=new RegExp("^"+Q2+tP+eP+nP+"$"),sP=["material","materials","bones"];class rP{constructor(t,e,n){const i=n||he.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}class he{constructor(t,e,n){this.path=e,this.parsedPath=n||he.parseTrackName(e),this.node=he.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new he.Composite(t,e,n):new he(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(J2,"")}static parseTrackName(t){const e=iP.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);sP.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===e||a.uuid===e)return a;const l=n(a.children);if(l)return l}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let s=e.propertyIndex;if(t||(t=he.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let h=e.objectIndex;switch(n){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===h){h=u;break}break;default:if(t[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[n]}if(h!==void 0){if(t[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[h]}}const o=t[i];if(o===void 0){const h=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t);return}let a=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}he.Composite=rP;he.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};he.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};he.prototype.GetterByBindingType=[he.prototype._getValue_direct,he.prototype._getValue_array,he.prototype._getValue_arrayElement,he.prototype._getValue_toArray];he.prototype.SetterByBindingTypeAndVersioning=[[he.prototype._setValue_direct,he.prototype._setValue_direct_setNeedsUpdate,he.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[he.prototype._setValue_array,he.prototype._setValue_array_setNeedsUpdate,he.prototype._setValue_array_setMatrixWorldNeedsUpdate],[he.prototype._setValue_arrayElement,he.prototype._setValue_arrayElement_setNeedsUpdate,he.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[he.prototype._setValue_fromArray,he.prototype._setValue_fromArray_setNeedsUpdate,he.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class oP{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const s=e.tracks,o=s.length,a=new Array(o),l={endingStart:xo,endingEnd:xo};for(let h=0;h!==o;++h){const u=s[h].createInterpolant(null);a[h]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=B1,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const i=this._clip.duration,s=t._clip.duration,o=s/i,a=i/s;t.warp(1,o,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=s,l[1]=s+n,h[0]=t/o,h[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled){this._updateWeight(t);return}const s=this._startTime;if(s!==null){const l=(t-s)*n;if(l<0||n===0)return;this._startTime=null,e=n*l}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const l=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case bg:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),h[u].accumulateAdditive(a);break;case _d:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),h[u].accumulate(i,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,s=this._loopCount;const o=n===U1;if(t===0)return s===-1?i:o&&(s&1)==1?e-i:i;if(n===V1){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else if(i<0)i=0;else{this.time=i;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=e||i<0){const a=Math.floor(i/e);i-=e*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){const h=t<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)==1)return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=yo,i.endingEnd=yo):(t?i.endingStart=this.zeroSlopeAtStart?yo:xo:i.endingStart=Vc,e?i.endingEnd=this.zeroSlopeAtEnd?yo:xo:i.endingEnd=Vc)}_scheduleFading(t,e,n){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=e,a[1]=s+t,l[1]=n,this}}class aP extends Rs{constructor(t){super();this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,s=i.length,o=t._propertyBindings,a=t._interpolants,l=n.uuid,h=this._bindingsByRootAndName;let u=h[l];u===void 0&&(u={},h[l]=u);for(let d=0;d!==s;++d){const f=i[d],m=f.name;let _=u[m];if(_!==void 0)o[d]=_;else{if(_=o[d],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,l,m));continue}const x=e&&e._propertyBindings[d].binding.parsedPath;_=new Z2(he.create(n,m,x),f.ValueTypeName,f.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,l,m),o[d]=_}a[d].resultBuffer=_.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const n=(t._localRoot||this._root).uuid,i=t._clip.uuid,s=this._actionsByClip[i];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,i,n)}const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const s=e[n];s.useCount++==0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const s=e[n];--s.useCount==0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,s=this._actionsByClip;let o=s[e];if(o===void 0)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[e]=o;else{const a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const s=t._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,h=l[l.length-1],u=t._byClipCacheIndex;h._byClipCacheIndex=u,l[u]=h,l.pop(),t._byClipCacheIndex=null;const d=a.actionByRoot,f=(t._localRoot||this._root).uuid;delete d[f],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const s=e[n];--s.referenceCount==0&&this._removeInactiveBinding(s)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,s=e[i];t._cacheIndex=i,e[i]=t,s._cacheIndex=n,e[n]=s}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,s=e[i];t._cacheIndex=i,e[i]=t,s._cacheIndex=n,e[n]=s}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[e];o===void 0&&(o={},i[e]=o),o[n]=t,t._cacheIndex=s.length,s.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[i],l=e[e.length-1],h=t._cacheIndex;l._cacheIndex=h,e[h]=l,e.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,s=e[i];t._cacheIndex=i,e[i]=t,s._cacheIndex=n,e[n]=s}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,s=e[i];t._cacheIndex=i,e[i]=t,s._cacheIndex=n,e[n]=s}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return n===void 0&&(n=new ov(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,s=e[i];t.__cacheIndex=i,e[i]=t,s.__cacheIndex=n,e[n]=s}clipAction(t,e,n){const i=e||this._root,s=i.uuid;let o=typeof t=="string"?lv.findByName(i,t):t;const a=o!==null?o.uuid:t,l=this._actionsByClip[a];let h=null;if(n===void 0&&(o!==null?n=o.blendMode:n=_d),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===n)return d;h=l.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const u=new oP(this,o,e,n);return this._bindAction(u,h),this._addInactiveAction(u,a,s),u}existingAction(t,e){const n=e||this._root,i=n.uuid,s=typeof t=="string"?lv.findByName(n,t):t,o=s?s.uuid:t,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const t=this._actions,e=this._nActiveActions;for(let n=e-1;n>=0;--n)t[n].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,s=Math.sign(t),o=this._accuIndex^=1;for(let h=0;h!==n;++h)e[h]._update(i,t,s,o);const a=this._bindings,l=this._nActiveBindings;for(let h=0;h!==l;++h)a[h].apply(o);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const h=o[a];this._deactivateAction(h);const u=h._cacheIndex,d=e[e.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,d._cacheIndex=u,e[u]=d,e.pop(),this._removeInactiveBindingsForAction(h)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[e];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[e];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(t,e){const n=this.existingAction(t,e);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}aP.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class lP extends dl{constructor(t,e,n=1){super(t,e);this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}lP.prototype.isInstancedInterleavedBuffer=!0;class qN{constructor(t,e,n=0,i=1/0){this.ray=new Ar(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new Dd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return Pp(t,this,n,e),n.sort(vv),n}intersectObjects(t,e=!0,n=[]){for(let i=0,s=t.length;i<s;i++)Pp(t[i],this,n,e);return n.sort(vv),n}}function vv(r,t){return r.distance-t.distance}function Pp(r,t,e,n){if(r.layers.test(t.layers)&&r.raycast(t,e),n===!0){const i=r.children;for(let s=0,o=i.length;s<o;s++)Pp(i[s],t,e,!0)}}class xv{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(En(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const Gs=new H,Rh=new Ot,Rp=new Ot;class cP extends vh{constructor(t){const e=yv(t),n=new de,i=[],s=[],o=new kt(0,0,1),a=new kt(0,1,0);for(let h=0;h<e.length;h++){const u=e[h];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new ce(i,3)),n.setAttribute("color",new ce(s,3));const l=new Xo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l);this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");Rp.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<e.length;s++){const a=e[s];a.parent&&a.parent.isBone&&(Rh.multiplyMatrices(Rp,a.matrixWorld),Gs.setFromMatrixPosition(Rh),i.setXYZ(o,Gs.x,Gs.y,Gs.z),Rh.multiplyMatrices(Rp,a.parent.matrixWorld),Gs.setFromMatrixPosition(Rh),i.setXYZ(o+1,Gs.x,Gs.y,Gs.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function yv(r){const t=[];r&&r.isBone&&t.push(r);for(let e=0;e<r.children.length;e++)t.push.apply(t,yv(r.children[e]));return t}class hP extends vh{constructor(t=10,e=10,n=4473924,i=8947848){n=new kt(n),i=new kt(i);const s=e/2,o=t/e,a=t/2,l=[],h=[];for(let f=0,m=0,_=-a;f<=e;f++,_+=o){l.push(-a,0,_,a,0,_),l.push(_,0,-a,_,0,a);const x=f===s?n:i;x.toArray(h,m),m+=3,x.toArray(h,m),m+=3,x.toArray(h,m),m+=3,x.toArray(h,m),m+=3}const u=new de;u.setAttribute("position",new ce(l,3)),u.setAttribute("color",new ce(h,3));const d=new Xo({vertexColors:!0,toneMapped:!1});super(u,d);this.type="GridHelper"}}class jN extends vh{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new de;i.setAttribute("position",new ce(e,3)),i.setAttribute("color",new ce(n,3));const s=new Xo({vertexColors:!0,toneMapped:!1});super(i,s);this.type="AxesHelper"}setColors(t,e,n){const i=new kt,s=this.geometry.attributes.color.array;return i.set(t),i.toArray(s,0),i.toArray(s,3),i.set(e),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const uP=new Float32Array(1);new Int32Array(uP.buffer);ti.create=function(r,t){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(ti.prototype),r.prototype.constructor=r,r.prototype.getPoint=t,r};yp.prototype.fromPoints=function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)};hP.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};cP.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Ws.prototype.extractUrlBase=function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),H2.extractUrlBase(r)};Ws.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};fi.prototype.center=function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)};fi.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};fi.prototype.isIntersectionBox=function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};fi.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)};fi.prototype.size=function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)};Ao.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};ah.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)};rn.prototype.flattenToArrayOffset=function(r,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,t)};rn.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)};rn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};rn.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)};rn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};rn.prototype.getInverse=function(r){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()};Ot.prototype.extractPosition=function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)};Ot.prototype.flattenToArrayOffset=function(r,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,t)};Ot.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new H().setFromMatrixColumn(this,3)};Ot.prototype.setRotationFromQuaternion=function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)};Ot.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};Ot.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ot.prototype.multiplyVector4=function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ot.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};Ot.prototype.rotateAxis=function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)};Ot.prototype.crossVector=function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ot.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};Ot.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};Ot.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};Ot.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};Ot.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};Ot.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};Ot.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};Ot.prototype.makeFrustum=function(r,t,e,n,i,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,t,n,e,i,s)};Ot.prototype.getInverse=function(r){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()};is.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)};on.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)};on.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};Ar.prototype.isIntersectionBox=function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};Ar.prototype.isIntersectionPlane=function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)};Ar.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)};Be.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};Be.prototype.barycoordFromPoint=function(r,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,t)};Be.prototype.midpoint=function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)};Be.prototypenormal=function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)};Be.prototype.plane=function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)};Be.barycoordFromPoint=function(r,t,e,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Be.getBarycoord(r,t,e,n,i)};Be.normal=function(r,t,e,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Be.getNormal(r,t,e,n)};yl.prototype.extractAllPoints=function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)};yl.prototype.extrude=function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Zo(this,r)};yl.prototype.makeGeometry=function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Mp(this,r)};ht.prototype.fromAttribute=function(r,t,e){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,t,e)};ht.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)};ht.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};H.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};H.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};H.prototype.getPositionFromMatrix=function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)};H.prototype.getScaleFromMatrix=function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)};H.prototype.getColumnFromMatrix=function(r,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,r)};H.prototype.applyProjection=function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)};H.prototype.fromAttribute=function(r,t,e){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,t,e)};H.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)};H.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};ge.prototype.fromAttribute=function(r,t,e){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,t,e)};ge.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};le.prototype.getChildByName=function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)};le.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};le.prototype.translate=function(r,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,r)};le.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};le.prototype.applyMatrix=function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)};Object.defineProperties(le.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Cn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(Cn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),H1},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});k_.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};An.prototype.setLens=function(r,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(r)};Object.defineProperties(Ii.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}});Object.defineProperties(je.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Bc},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Bc)}}});je.prototype.setDynamic=function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?Bc:il),this};je.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},je.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};de.prototype.addIndex=function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)};de.prototype.addAttribute=function(r,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new je(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(r,t)};de.prototype.addDrawCall=function(r,t,e){e!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,t)};de.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};de.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};de.prototype.removeAttribute=function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)};de.prototype.applyMatrix=function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)};Object.defineProperties(de.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});dl.prototype.setDynamic=function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?Bc:il),this};dl.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Zo.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};Zo.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};Zo.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};S_.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};Object.defineProperties(dn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new kt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===tg}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(Pr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}});pe.prototype.clearTarget=function(r,t,e,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(t,e,n)};pe.prototype.animate=function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)};pe.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};pe.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};pe.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};pe.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};pe.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};pe.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};pe.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};pe.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};pe.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};pe.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};pe.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};pe.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};pe.prototype.enableScissorTest=function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)};pe.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};pe.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};pe.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};pe.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};pe.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};pe.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};pe.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};pe.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};pe.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};pe.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(pe.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?bo:pi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});Object.defineProperties(w_.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Kn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}});Y2.prototype.load=function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return new j2().load(r,function(n){t.setBuffer(n)}),this};$d.prototype.updateCubeMap=function(r,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,t)};$d.prototype.clear=function(r,t,e,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(r,t,e,n)};So.crossOrigin=void 0;So.loadTexture=function(r,t,e,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new N2;i.setCrossOrigin(this.crossOrigin);const s=i.load(r,e,void 0,n);return t&&(s.mapping=t),s};So.loadTextureCube=function(r,t,e,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new I2;i.setCrossOrigin(this.crossOrigin);const s=i.load(r,e,void 0,n);return t&&(s.mapping=t),s};So.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};So.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cd}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cd);const bv=new H,dP=new on,wv=new H;class Mv extends le{constructor(t=document.createElement("div")){super();this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&e.element.parentNode!==null&&e.element.parentNode.removeChild(e.element)})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}}Mv.prototype.isCSS3DObject=!0;class pP extends Mv{constructor(t){super(t);this.rotation2D=0}copy(t,e){return super.copy(t,e),this.rotation2D=t.rotation2D,this}}pP.prototype.isCSS3DSprite=!0;const Ni=new Ot,fP=new Ot;class $N{constructor(t={}){const e=this;let n,i,s,o;const a={camera:{fov:0,style:""},objects:new WeakMap},l=t.element!==void 0?t.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l;const h=document.createElement("div");h.style.transformStyle="preserve-3d",h.style.pointerEvents="none",l.appendChild(h),this.getSize=function(){return{width:n,height:i}},this.render=function(_,x){const w=x.projectionMatrix.elements[5]*o;a.camera.fov!==w&&(l.style.perspective=x.isPerspectiveCamera?w+"px":"",a.camera.fov=w),_.autoUpdate===!0&&_.updateMatrixWorld(),x.parent===null&&x.updateMatrixWorld();let v,y;x.isOrthographicCamera&&(v=-(x.right+x.left)/2,y=(x.top+x.bottom)/2);const S=(x.isOrthographicCamera?"scale("+w+")translate("+u(v)+"px,"+u(y)+"px)"+d(x.matrixWorldInverse):"translateZ("+w+"px)"+d(x.matrixWorldInverse))+"translate("+s+"px,"+o+"px)";a.camera.style!==S&&(h.style.transform=S,a.camera.style=S),m(_,_,x)},this.setSize=function(_,x){n=_,i=x,s=n/2,o=i/2,l.style.width=_+"px",l.style.height=x+"px",h.style.width=_+"px",h.style.height=x+"px"};function u(_){return Math.abs(_)<1e-10?0:_}function d(_){const x=_.elements;return"matrix3d("+u(x[0])+","+u(-x[1])+","+u(x[2])+","+u(x[3])+","+u(x[4])+","+u(-x[5])+","+u(x[6])+","+u(x[7])+","+u(x[8])+","+u(-x[9])+","+u(x[10])+","+u(x[11])+","+u(x[12])+","+u(-x[13])+","+u(x[14])+","+u(x[15])+")"}function f(_){const x=_.elements,w="matrix3d("+u(x[0])+","+u(x[1])+","+u(x[2])+","+u(x[3])+","+u(-x[4])+","+u(-x[5])+","+u(-x[6])+","+u(-x[7])+","+u(x[8])+","+u(x[9])+","+u(x[10])+","+u(x[11])+","+u(x[12])+","+u(x[13])+","+u(x[14])+","+u(x[15])+")";return"translate(-50%,-50%)"+w}function m(_,x,w,v){if(_.isCSS3DObject){_.onBeforeRender(e,x,w);let y;_.isCSS3DSprite?(Ni.copy(w.matrixWorldInverse),Ni.transpose(),_.rotation2D!==0&&Ni.multiply(fP.makeRotationZ(_.rotation2D)),_.matrixWorld.decompose(bv,dP,wv),Ni.setPosition(bv),Ni.scale(wv),Ni.elements[3]=0,Ni.elements[7]=0,Ni.elements[11]=0,Ni.elements[15]=1,y=f(Ni)):y=f(_.matrixWorld);const C=_.element,S=a.objects.get(_);if(S===void 0||S.style!==y){C.style.transform=y;const M={style:y};a.objects.set(_,M)}C.style.display=_.visible?"":"none",C.parentNode!==h&&h.appendChild(C),_.onAfterRender(e,x,w)}for(let y=0,C=_.children.length;y<C;y++)m(_.children[y],x,w)}}}const Sv={type:"change"},Dp={type:"start"},Tv={type:"end"};class XN extends Rs{constructor(t,e){super();e===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new H,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:po.ROTATE,MIDDLE:po.DOLLY,RIGHT:po.PAN},this.touches={ONE:fo.ROTATE,TWO:fo.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(W){W.addEventListener("keydown",U),this._domElementKeyEvents=W},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Sv),n.update(),s=i.NONE},this.update=function(){const W=new H,V=new on().setFromUnitVectors(t.up,new H(0,1,0)),dt=V.clone().invert(),ct=new H,Lt=new on,At=2*Math.PI;return function(){const Mt=n.object.position;W.copy(Mt).sub(n.target),W.applyQuaternion(V),a.setFromVector3(W),n.autoRotate&&s===i.NONE&&F(T()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Ft=n.minAzimuthAngle,Kt=n.maxAzimuthAngle;return isFinite(Ft)&&isFinite(Kt)&&(Ft<-Math.PI?Ft+=At:Ft>Math.PI&&(Ft-=At),Kt<-Math.PI?Kt+=At:Kt>Math.PI&&(Kt-=At),Ft<=Kt?a.theta=Math.max(Ft,Math.min(Kt,a.theta)):a.theta=a.theta>(Ft+Kt)/2?Math.max(Ft,a.theta):Math.min(Kt,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=h,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),n.enableDamping===!0?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),W.setFromSpherical(a),W.applyQuaternion(dt),Mt.copy(n.target).add(W),n.object.lookAt(n.target),n.enableDamping===!0?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),h=1,d||ct.distanceToSquared(n.object.position)>o||8*(1-Lt.dot(n.object.quaternion))>o?(n.dispatchEvent(Sv),ct.copy(n.object.position),Lt.copy(n.object.quaternion),d=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",pt),n.domElement.removeEventListener("pointerdown",mt),n.domElement.removeEventListener("pointercancel",Ct),n.domElement.removeEventListener("wheel",Nt),n.domElement.removeEventListener("pointermove",Z),n.domElement.removeEventListener("pointerup",it),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",U)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=i.NONE;const o=1e-6,a=new xv,l=new xv;let h=1;const u=new H;let d=!1;const f=new ht,m=new ht,_=new ht,x=new ht,w=new ht,v=new ht,y=new ht,C=new ht,S=new ht,M=[],E={};function T(){return 2*Math.PI/60/60*n.autoRotateSpeed}function R(){return Math.pow(.95,n.zoomSpeed)}function F(W){l.theta-=W}function z(W){l.phi-=W}const L=function(){const W=new H;return function(dt,ct){W.setFromMatrixColumn(ct,0),W.multiplyScalar(-dt),u.add(W)}}(),A=function(){const W=new H;return function(dt,ct){n.screenSpacePanning===!0?W.setFromMatrixColumn(ct,1):(W.setFromMatrixColumn(ct,0),W.crossVectors(n.object.up,W)),W.multiplyScalar(dt),u.add(W)}}(),D=function(){const W=new H;return function(dt,ct){const Lt=n.domElement;if(n.object.isPerspectiveCamera){const At=n.object.position;W.copy(At).sub(n.target);let Wt=W.length();Wt*=Math.tan(n.object.fov/2*Math.PI/180),L(2*dt*Wt/Lt.clientHeight,n.object.matrix),A(2*ct*Wt/Lt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(L(dt*(n.object.right-n.object.left)/n.object.zoom/Lt.clientWidth,n.object.matrix),A(ct*(n.object.top-n.object.bottom)/n.object.zoom/Lt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function I(W){n.object.isPerspectiveCamera?h/=W:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*W)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function B(W){n.object.isPerspectiveCamera?h*=W:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/W)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function k(W){f.set(W.clientX,W.clientY)}function G(W){y.set(W.clientX,W.clientY)}function tt(W){x.set(W.clientX,W.clientY)}function K(W){m.set(W.clientX,W.clientY),_.subVectors(m,f).multiplyScalar(n.rotateSpeed);const V=n.domElement;F(2*Math.PI*_.x/V.clientHeight),z(2*Math.PI*_.y/V.clientHeight),f.copy(m),n.update()}function j(W){C.set(W.clientX,W.clientY),S.subVectors(C,y),S.y>0?I(R()):S.y<0&&B(R()),y.copy(C),n.update()}function $(W){w.set(W.clientX,W.clientY),v.subVectors(w,x).multiplyScalar(n.panSpeed),D(v.x,v.y),x.copy(w),n.update()}function st(W){W.deltaY<0?B(R()):W.deltaY>0&&I(R()),n.update()}function rt(W){let V=!1;switch(W.code){case n.keys.UP:D(0,n.keyPanSpeed),V=!0;break;case n.keys.BOTTOM:D(0,-n.keyPanSpeed),V=!0;break;case n.keys.LEFT:D(n.keyPanSpeed,0),V=!0;break;case n.keys.RIGHT:D(-n.keyPanSpeed,0),V=!0;break}V&&(W.preventDefault(),n.update())}function xt(){if(M.length===1)f.set(M[0].pageX,M[0].pageY);else{const W=.5*(M[0].pageX+M[1].pageX),V=.5*(M[0].pageY+M[1].pageY);f.set(W,V)}}function It(){if(M.length===1)x.set(M[0].pageX,M[0].pageY);else{const W=.5*(M[0].pageX+M[1].pageX),V=.5*(M[0].pageY+M[1].pageY);x.set(W,V)}}function Q(){const W=M[0].pageX-M[1].pageX,V=M[0].pageY-M[1].pageY,dt=Math.sqrt(W*W+V*V);y.set(0,dt)}function _t(){n.enableZoom&&Q(),n.enablePan&&It()}function Rt(){n.enableZoom&&Q(),n.enableRotate&&xt()}function wt(W){if(M.length==1)m.set(W.pageX,W.pageY);else{const dt=Dt(W),ct=.5*(W.pageX+dt.x),Lt=.5*(W.pageY+dt.y);m.set(ct,Lt)}_.subVectors(m,f).multiplyScalar(n.rotateSpeed);const V=n.domElement;F(2*Math.PI*_.x/V.clientHeight),z(2*Math.PI*_.y/V.clientHeight),f.copy(m)}function at(W){if(M.length===1)w.set(W.pageX,W.pageY);else{const V=Dt(W),dt=.5*(W.pageX+V.x),ct=.5*(W.pageY+V.y);w.set(dt,ct)}v.subVectors(w,x).multiplyScalar(n.panSpeed),D(v.x,v.y),x.copy(w)}function qt(W){const V=Dt(W),dt=W.pageX-V.x,ct=W.pageY-V.y,Lt=Math.sqrt(dt*dt+ct*ct);C.set(0,Lt),S.set(0,Math.pow(C.y/y.y,n.zoomSpeed)),I(S.y),y.copy(C)}function nt(W){n.enableZoom&&qt(W),n.enablePan&&at(W)}function ft(W){n.enableZoom&&qt(W),n.enableRotate&&wt(W)}function mt(W){n.enabled!==!1&&(M.length===0&&(n.domElement.setPointerCapture(W.pointerId),n.domElement.addEventListener("pointermove",Z),n.domElement.addEventListener("pointerup",it)),bt(W),W.pointerType==="touch"?N(W):Et(W))}function Z(W){n.enabled!==!1&&(W.pointerType==="touch"?ot(W):St(W))}function it(W){ut(W),M.length===0&&(n.domElement.releasePointerCapture(W.pointerId),n.domElement.removeEventListener("pointermove",Z),n.domElement.removeEventListener("pointerup",it)),n.dispatchEvent(Tv),s=i.NONE}function Ct(W){ut(W)}function Et(W){let V;switch(W.button){case 0:V=n.mouseButtons.LEFT;break;case 1:V=n.mouseButtons.MIDDLE;break;case 2:V=n.mouseButtons.RIGHT;break;default:V=-1}switch(V){case po.DOLLY:if(n.enableZoom===!1)return;G(W),s=i.DOLLY;break;case po.ROTATE:if(W.ctrlKey||W.metaKey||W.shiftKey){if(n.enablePan===!1)return;tt(W),s=i.PAN}else{if(n.enableRotate===!1)return;k(W),s=i.ROTATE}break;case po.PAN:if(W.ctrlKey||W.metaKey||W.shiftKey){if(n.enableRotate===!1)return;k(W),s=i.ROTATE}else{if(n.enablePan===!1)return;tt(W),s=i.PAN}break;default:s=i.NONE}s!==i.NONE&&n.dispatchEvent(Dp)}function St(W){if(n.enabled!==!1)switch(s){case i.ROTATE:if(n.enableRotate===!1)return;K(W);break;case i.DOLLY:if(n.enableZoom===!1)return;j(W);break;case i.PAN:if(n.enablePan===!1)return;$(W);break}}function Nt(W){n.enabled===!1||n.enableZoom===!1||s!==i.NONE||(W.preventDefault(),n.dispatchEvent(Dp),st(W),n.dispatchEvent(Tv))}function U(W){n.enabled===!1||n.enablePan===!1||rt(W)}function N(W){switch(Vt(W),M.length){case 1:switch(n.touches.ONE){case fo.ROTATE:if(n.enableRotate===!1)return;xt(),s=i.TOUCH_ROTATE;break;case fo.PAN:if(n.enablePan===!1)return;It(),s=i.TOUCH_PAN;break;default:s=i.NONE}break;case 2:switch(n.touches.TWO){case fo.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;_t(),s=i.TOUCH_DOLLY_PAN;break;case fo.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Rt(),s=i.TOUCH_DOLLY_ROTATE;break;default:s=i.NONE}break;default:s=i.NONE}s!==i.NONE&&n.dispatchEvent(Dp)}function ot(W){switch(Vt(W),s){case i.TOUCH_ROTATE:if(n.enableRotate===!1)return;wt(W),n.update();break;case i.TOUCH_PAN:if(n.enablePan===!1)return;at(W),n.update();break;case i.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;nt(W),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ft(W),n.update();break;default:s=i.NONE}}function pt(W){n.enabled!==!1&&W.preventDefault()}function bt(W){M.push(W)}function ut(W){delete E[W.pointerId];for(let V=0;V<M.length;V++)if(M[V].pointerId==W.pointerId){M.splice(V,1);return}}function Vt(W){let V=E[W.pointerId];V===void 0&&(V=new ht,E[W.pointerId]=V),V.set(W.pageX,W.pageY)}function Dt(W){const V=W.pointerId===M[0].pointerId?M[1]:M[0];return E[V.pointerId]}n.domElement.addEventListener("contextmenu",pt),n.domElement.addEventListener("pointerdown",mt),n.domElement.addEventListener("pointercancel",Ct),n.domElement.addEventListener("wheel",Nt,{passive:!1}),this.update()}}/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.16.0
 * @author George Michael Brower
 * @license MIT
 */class Fi{constructor(t,e,n,i,s="div"){this.parent=t,this.object=e,this.property=n,this._disabled=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(i),this.$name=document.createElement("div"),this.$name.classList.add("name"),Fi.nextNameID=Fi.nextNameID||0,this.$name.id=`lil-gui-name-${++Fi.nextNameID}`,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(t){return this._name=t,this.$name.innerHTML=t,this}onChange(t){return this._onChange=t,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return t===this._disabled?this:(this._disabled=t,this.domElement.classList.toggle("disabled",t),this.$disable.toggleAttribute("disabled",t),this)}options(t){const e=this.parent.add(this.object,this.property,t);return e.name(this._name),this.destroy(),e}min(t){return this}max(t){return this}step(t){return this}listen(t=!0){return this._listening=t,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback),this.updateDisplay()}getValue(){return this.object[this.property]}setValue(t){return this.object[this.property]=t,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(t){return this.setValue(t),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class mP extends Fi{constructor(t,e,n){super(t,e,n,"boolean","label");this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function Lp(r){let t,e;return(t=r.match(/(#|0x)?([a-f0-9]{6})/i))?e=t[2]:(t=r.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?e=parseInt(t[1]).toString(16).padStart(2,0)+parseInt(t[2]).toString(16).padStart(2,0)+parseInt(t[3]).toString(16).padStart(2,0):(t=r.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(e=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),e?"#"+e:!1}const gP={isPrimitive:!0,match:r=>typeof r=="string",fromHexString:Lp,toHexString:Lp},El={isPrimitive:!0,match:r=>typeof r=="number",fromHexString:r=>parseInt(r.substring(1),16),toHexString:r=>"#"+r.toString(16).padStart(6,0)},_P={isPrimitive:!1,match:Array.isArray,fromHexString(r,t,e=1){const n=El.fromHexString(r);t[0]=(n>>16&255)/255*e,t[1]=(n>>8&255)/255*e,t[2]=(n&255)/255*e},toHexString([r,t,e],n=1){n=255/n;const i=r*n<<16^t*n<<8^e*n<<0;return El.toHexString(i)}},vP={isPrimitive:!1,match:r=>Object(r)===r,fromHexString(r,t,e=1){const n=El.fromHexString(r);t.r=(n>>16&255)/255*e,t.g=(n>>8&255)/255*e,t.b=(n&255)/255*e},toHexString({r,g:t,b:e},n=1){n=255/n;const i=r*n<<16^t*n<<8^e*n<<0;return El.toHexString(i)}},xP=[gP,El,_P,vP];function yP(r){return xP.find(t=>t.match(r))}class bP extends Fi{constructor(t,e,n,i){super(t,e,n,"color");this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=yP(this.initialValue),this._rgbScale=i,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=Lp(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(t){if(this._format.isPrimitive){const e=this._format.fromHexString(t);this.setValue(e)}else this._format.fromHexString(t,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(t){return this._setValueFromHexString(t),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class kp extends Fi{constructor(t,e,n){super(t,e,n,"function");this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",i=>{i.preventDefault(),this.getValue().call(this.object)}),this.$button.addEventListener("touchstart",()=>{}),this.$disable=this.$button}}class wP extends Fi{constructor(t,e,n,i,s,o){super(t,e,n,"number");this._initInput(),this.min(i),this.max(s);const a=o!==void 0;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}min(t){return this._min=t,this._onUpdateMinMax(),this}max(t){return this._max=t,this._onUpdateMinMax(),this}step(t,e=!0){return this._step=t,this._stepExplicit=e,this}updateDisplay(){const t=this.getValue();if(this._hasSlider){let e=(t-this._min)/(this._max-this._min);e=Math.max(0,Math.min(e,1)),this.$fill.style.width=e*100+"%"}return this._inputFocused||(this.$input.value=t),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=()=>{const v=parseFloat(this.$input.value);isNaN(v)||this.setValue(this._clamp(v))},e=v=>{const y=parseFloat(this.$input.value);isNaN(y)||(this._snapClampSetValue(y+v),this.$input.value=this.getValue())},n=v=>{v.code==="Enter"&&this.$input.blur(),v.code==="ArrowUp"&&(v.preventDefault(),e(this._step*this._arrowKeyMultiplier(v))),v.code==="ArrowDown"&&(v.preventDefault(),e(this._step*this._arrowKeyMultiplier(v)*-1))},i=v=>{this._inputFocused&&(v.preventDefault(),e(this._step*this._normalizeMouseWheel(v)))};let s=!1,o,a,l,h,u;const d=5,f=v=>{o=v.clientX,a=l=v.clientY,s=!0,h=this.getValue(),u=0,window.addEventListener("mousemove",m),window.addEventListener("mouseup",_)},m=v=>{if(s){const y=v.clientX-o,C=v.clientY-a;Math.abs(C)>d?(v.preventDefault(),this.$input.blur(),s=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(y)>d&&_()}s||(u-=(v.clientY-l)*this._step*this._arrowKeyMultiplier(v),h+u>this._max?u=this._max-h:h+u<this._min&&(u=this._min-h),this._snapClampSetValue(h+u)),l=v.clientY},_=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",_)},x=()=>{this._inputFocused=!0},w=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",t),this.$input.addEventListener("keydown",n),this.$input.addEventListener("wheel",i),this.$input.addEventListener("mousedown",f),this.$input.addEventListener("focus",x),this.$input.addEventListener("blur",w)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=(v,y,C,S,M)=>(v-y)/(C-y)*(M-S)+S,e=v=>{const y=this.$slider.getBoundingClientRect();let C=t(v,y.left,y.right,this._min,this._max);this._snapClampSetValue(C)},n=v=>{this._setDraggingStyle(!0),e(v.clientX),window.addEventListener("mousemove",i),window.addEventListener("mouseup",s)},i=v=>{e(v.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",s)};let o=!1,a,l;const h=v=>{v.preventDefault(),this._setDraggingStyle(!0),e(v.touches[0].clientX),o=!1},u=v=>{v.touches.length>1||(this._hasScrollBar?(a=v.touches[0].clientX,l=v.touches[0].clientY,o=!0):h(v),window.addEventListener("touchmove",d),window.addEventListener("touchend",f))},d=v=>{if(o){const y=v.touches[0].clientX-a,C=v.touches[0].clientY-l;Math.abs(y)>Math.abs(C)?h(v):(window.removeEventListener("touchmove",d),window.removeEventListener("touchend",f))}else v.preventDefault(),e(v.touches[0].clientX)},f=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",d),window.removeEventListener("touchend",f)},m=this._callOnFinishChange.bind(this),_=400;let x;const w=v=>{if(Math.abs(v.deltaX)<Math.abs(v.deltaY)&&this._hasScrollBar)return;v.preventDefault();const C=this._normalizeMouseWheel(v)*this._step;this._snapClampSetValue(this.getValue()+C),this.$input.value=this.getValue(),clearTimeout(x),x=setTimeout(m,_)};this.$slider.addEventListener("mousedown",n),this.$slider.addEventListener("touchstart",u),this.$slider.addEventListener("wheel",w)}_setDraggingStyle(t,e="horizontal"){this.$slider&&this.$slider.classList.toggle("active",t),document.body.classList.toggle("lil-gui-dragging",t),document.body.classList.toggle(`lil-gui-${e}`,t)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(t){let{deltaX:e,deltaY:n}=t;return Math.floor(t.deltaY)!==t.deltaY&&t.wheelDelta&&(e=0,n=-t.wheelDelta/120,n*=this._stepExplicit?1:10),e+-n}_arrowKeyMultiplier(t){let e=this._stepExplicit?1:10;return t.shiftKey?e*=10:t.altKey&&(e/=10),e}_snap(t){const e=Math.round(t/this._step)*this._step;return parseFloat(e.toPrecision(15))}_clamp(t){return t<this._min&&(t=this._min),t>this._max&&(t=this._max),t}_snapClampSetValue(t){this.setValue(this._clamp(this._snap(t)))}get _hasScrollBar(){const t=this.parent.root.$children;return t.scrollHeight>t.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class MP extends Fi{constructor(t,e,n,i){super(t,e,n,"option");this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(i)?i:Object.values(i),this._names=Array.isArray(i)?i:Object.keys(i),this._names.forEach(s=>{const o=document.createElement("option");o.innerHTML=s,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const t=this.getValue(),e=this._values.indexOf(t);return this.$select.selectedIndex=e,this.$display.innerHTML=e===-1?t:this._names[e],this}}class SP extends Fi{constructor(t,e,n){super(t,e,n,"string");this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",i=>{i.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}const TP=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  background-color: var(--background-color);
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean .widget {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "\u2195";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background-color: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background-color: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background-color: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "\u25BE";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "\u25B8";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui input {
  -webkit-tap-highlight-color: transparent;
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input::-webkit-outer-spin-button,
.lil-gui input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
.lil-gui input[type=number] {
  -moz-appearance: textfield;
}
.lil-gui input[type=checkbox] {
  appearance: none;
  -webkit-appearance: none;
  height: var(--checkbox-size);
  width: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "\u2713";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  -webkit-tap-highlight-color: transparent;
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: 1px solid var(--widget-color);
  text-align: center;
  line-height: calc(var(--widget-height) - 4px);
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
    border-color: var(--hover-color);
  }
  .lil-gui button:focus {
    border-color: var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function EP(r){const t=document.createElement("style");t.innerHTML=r;const e=document.querySelector("head link[rel=stylesheet], head style");e?document.head.insertBefore(t,e):document.head.appendChild(t)}let Ev=!1;class Cv{constructor({parent:t,autoPlace:e=t===void 0,container:n,width:i,title:s="Controls",injectStyles:o=!0,touchStyles:a=!0}={}){if(this.parent=t,this.root=t?t.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{(l.code==="Enter"||l.code==="Space")&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),a&&this.domElement.classList.add("allow-touch-styles"),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),!Ev&&o&&(EP(TP),Ev=!0),n?n.appendChild(this.domElement):e&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),i&&this.domElement.style.setProperty("--width",i+"px"),this.domElement.addEventListener("keydown",l=>l.stopPropagation()),this.domElement.addEventListener("keyup",l=>l.stopPropagation())}add(t,e,n,i,s){if(Object(n)===n)return new MP(this,t,e,n);const o=t[e];switch(typeof o){case"number":return new wP(this,t,e,n,i,s);case"boolean":return new mP(this,t,e);case"string":return new SP(this,t,e);case"function":return new kp(this,t,e)}console.error(`gui.add failed
	property:`,e,`
	object:`,t,`
	value:`,o)}addColor(t,e,n=1){return new bP(this,t,e,n)}addFolder(t){return new Cv({parent:this,title:t})}load(t,e=!0){return t.controllers&&this.controllers.forEach(n=>{n instanceof kp||n._name in t.controllers&&n.load(t.controllers[n._name])}),e&&t.folders&&this.folders.forEach(n=>{n._title in t.folders&&n.load(t.folders[n._title])}),this}save(t=!0){const e={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof kp)){if(n._name in e.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);e.controllers[n._name]=n.save()}}),t&&this.folders.forEach(n=>{if(n._title in e.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);e.folders[n._title]=n.save()}),e}open(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}show(t=!0){return this._hidden=!t,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const e=this.$children.clientHeight;this.$children.style.height=e+"px",this.domElement.classList.add("transition");const n=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);const i=t?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!t),requestAnimationFrame(()=>{this.$children.style.height=i+"px"})}),this}title(t){return this._title=t,this.$title.innerHTML=t,this}reset(t=!0){return(t?this.controllersRecursive():this.controllers).forEach(n=>n.reset()),this}onChange(t){return this._onChange=t,this}_callOnChange(t){this.parent&&this.parent._callOnChange(t),this._onChange!==void 0&&this._onChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}onFinishChange(t){return this._onFinishChange=t,this}_callOnFinishChange(t){this.parent&&this.parent._callOnFinishChange(t),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(t=>t.destroy())}controllersRecursive(){let t=Array.from(this.controllers);return this.folders.forEach(e=>{t=t.concat(e.controllersRecursive())}),t}foldersRecursive(){let t=Array.from(this.folders);return this.folders.forEach(e=>{t=t.concat(e.foldersRecursive())}),t}}const an=[];for(let r=0;r<256;r++)an[r]=(r<16?"0":"")+r.toString(16);function Av(){const r=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(an[r&255]+an[r>>8&255]+an[r>>16&255]+an[r>>24&255]+"-"+an[t&255]+an[t>>8&255]+"-"+an[t>>16&15|64]+an[t>>24&255]+"-"+an[e&63|128]+an[e>>8&255]+"-"+an[e>>16&255]+an[e>>24&255]+an[n&255]+an[n>>8&255]+an[n>>16&255]+an[n>>24&255]).toUpperCase()}function Oi(r,t,e){return Math.max(t,Math.min(e,r))}function CP(r,t){return(r%t+t)%t}function Ip(r,t,e){return(1-e)*r+e*t}class ta{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,s,o,a){let l=n[i+0],h=n[i+1],u=n[i+2],d=n[i+3];const f=s[o+0],m=s[o+1],_=s[o+2],x=s[o+3];if(a===0){t[e+0]=l,t[e+1]=h,t[e+2]=u,t[e+3]=d;return}if(a===1){t[e+0]=f,t[e+1]=m,t[e+2]=_,t[e+3]=x;return}if(d!==x||l!==f||h!==m||u!==_){let w=1-a;const v=l*f+h*m+u*_+d*x,y=v>=0?1:-1,C=1-v*v;if(C>Number.EPSILON){const M=Math.sqrt(C),E=Math.atan2(M,v*y);w=Math.sin(w*E)/M,a=Math.sin(a*E)/M}const S=a*y;if(l=l*w+f*S,h=h*w+m*S,u=u*w+_*S,d=d*w+x*S,w===1-a){const M=1/Math.sqrt(l*l+h*h+u*u+d*d);l*=M,h*=M,u*=M,d*=M}}t[e]=l,t[e+1]=h,t[e+2]=u,t[e+3]=d}static multiplyQuaternionsFlat(t,e,n,i,s,o){const a=n[i],l=n[i+1],h=n[i+2],u=n[i+3],d=s[o],f=s[o+1],m=s[o+2],_=s[o+3];return t[e]=a*_+u*d+l*m-h*f,t[e+1]=l*_+u*f+h*d-a*m,t[e+2]=h*_+u*m+a*f-l*d,t[e+3]=u*_-a*d-l*f-h*m,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,s=t._z,o=t._order,a=Math.cos,l=Math.sin,h=a(n/2),u=a(i/2),d=a(s/2),f=l(n/2),m=l(i/2),_=l(s/2);switch(o){case"XYZ":this._x=f*u*d+h*m*_,this._y=h*m*d-f*u*_,this._z=h*u*_+f*m*d,this._w=h*u*d-f*m*_;break;case"YXZ":this._x=f*u*d+h*m*_,this._y=h*m*d-f*u*_,this._z=h*u*_-f*m*d,this._w=h*u*d+f*m*_;break;case"ZXY":this._x=f*u*d-h*m*_,this._y=h*m*d+f*u*_,this._z=h*u*_+f*m*d,this._w=h*u*d-f*m*_;break;case"ZYX":this._x=f*u*d-h*m*_,this._y=h*m*d+f*u*_,this._z=h*u*_-f*m*d,this._w=h*u*d+f*m*_;break;case"YZX":this._x=f*u*d+h*m*_,this._y=h*m*d+f*u*_,this._z=h*u*_-f*m*d,this._w=h*u*d-f*m*_;break;case"XZY":this._x=f*u*d-h*m*_,this._y=h*m*d-f*u*_,this._z=h*u*_+f*m*d,this._w=h*u*d+f*m*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],s=e[8],o=e[1],a=e[5],l=e[9],h=e[2],u=e[6],d=e[10],f=n+a+d;if(f>0){const m=.5/Math.sqrt(f+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-h)*m,this._z=(o-i)*m}else if(n>a&&n>d){const m=2*Math.sqrt(1+n-a-d);this._w=(u-l)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+h)/m}else if(a>d){const m=2*Math.sqrt(1+a-n-d);this._w=(s-h)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+d-n-a);this._w=(o-i)/m,this._x=(s+h)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Oi(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return e!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,s=t._z,o=t._w,a=e._x,l=e._y,h=e._z,u=e._w;return this._x=n*u+o*a+i*h-s*l,this._y=i*u+o*l+s*a-n*h,this._z=s*u+o*h+n*l-i*a,this._w=o*u-n*a-i*l-s*h,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,i=this._y,s=this._z,o=this._w;let a=o*t._w+n*t._x+i*t._y+s*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*n+e*this._x,this._y=m*i+e*this._y,this._z=m*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(l),u=Math.atan2(h,a),d=Math.sin((1-e)*u)/h,f=Math.sin(e*u)/h;return this._w=o*d+this._w*f,this._x=n*d+this._x*f,this._y=i*d+this._y*f,this._z=s*d+this._z*f,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(s),n*Math.cos(s),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}ta.prototype.isQuaternion=!0;class Pt{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Pv.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Pv.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6]*i,this.y=s[1]*e+s[4]*n+s[7]*i,this.z=s[2]*e+s[5]*n+s[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,s=t.elements,o=1/(s[3]*e+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*e+s[4]*n+s[8]*i+s[12])*o,this.y=(s[1]*e+s[5]*n+s[9]*i+s[13])*o,this.z=(s[2]*e+s[6]*n+s[10]*i+s[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,s=t.x,o=t.y,a=t.z,l=t.w,h=l*e+o*i-a*n,u=l*n+a*e-s*i,d=l*i+s*n-o*e,f=-s*e-o*n-a*i;return this.x=h*l+f*-s+u*-a-d*-o,this.y=u*l+f*-o+d*-s-h*-a,this.z=d*l+f*-a+h*-o-u*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i,this.y=s[1]*e+s[5]*n+s[9]*i,this.z=s[2]*e+s[6]*n+s[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return e!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,s=t.z,o=e.x,a=e.y,l=e.z;return this.x=i*l-s*a,this.y=s*o-n*l,this.z=n*a-i*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Np.copy(this).projectOnVector(t),this.sub(Np)}reflect(t){return this.sub(Np.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Oi(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Pt.prototype.isVector3=!0;const Np=new Pt,Pv=new ta;class ea{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*n-o*i+t.x,this.y=s*i+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ea.prototype.isVector2=!0;class na{constructor(t=new Pt(1/0,1/0,1/0),e=new Pt(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=t.length;l<h;l+=3){const u=t[l],d=t[l+1],f=t[l+2];u<e&&(e=u),d<n&&(n=d),f<i&&(i=f),u>s&&(s=u),d>o&&(o=d),f>a&&(a=f)}return this.min.set(e,n,i),this.max.set(s,o,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,h=t.count;l<h;l++){const u=t.getX(l),d=t.getY(l),f=t.getZ(l);u<e&&(e=u),d<n&&(n=d),f<i&&(i=f),u>s&&(s=u),d>o&&(o=d),f>a&&(a=f)}return this.min.set(e,n,i),this.max.set(s,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Cl.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;e!==void 0&&(e.boundingBox===null&&e.computeBoundingBox(),Fp.copy(e.boundingBox),Fp.applyMatrix4(t.matrixWorld),this.union(Fp));const n=t.children;for(let i=0,s=n.length;i<s;i++)this.expandByObject(n[i]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Cl),Cl.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Al),Dh.subVectors(this.max,Al),ia.subVectors(t.a,Al),sa.subVectors(t.b,Al),ra.subVectors(t.c,Al),qs.subVectors(sa,ia),js.subVectors(ra,sa),Lr.subVectors(ia,ra);let e=[0,-qs.z,qs.y,0,-js.z,js.y,0,-Lr.z,Lr.y,qs.z,0,-qs.x,js.z,0,-js.x,Lr.z,0,-Lr.x,-qs.y,qs.x,0,-js.y,js.x,0,-Lr.y,Lr.x,0];return!Op(e,ia,sa,ra,Dh)||(e=[1,0,0,0,1,0,0,0,1],!Op(e,ia,sa,ra,Dh))?!1:(Lh.crossVectors(qs,js),e=[Lh.x,Lh.y,Lh.z],Op(e,ia,sa,ra,Dh))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Cl.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Cl).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(rs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),rs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),rs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),rs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),rs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),rs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),rs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),rs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(rs),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}na.prototype.isBox3=!0;const rs=[new Pt,new Pt,new Pt,new Pt,new Pt,new Pt,new Pt,new Pt],Cl=new Pt,Fp=new na,ia=new Pt,sa=new Pt,ra=new Pt,qs=new Pt,js=new Pt,Lr=new Pt,Al=new Pt,Dh=new Pt,Lh=new Pt,kr=new Pt;function Op(r,t,e,n,i){for(let s=0,o=r.length-3;s<=o;s+=3){kr.fromArray(r,s);const a=i.x*Math.abs(kr.x)+i.y*Math.abs(kr.y)+i.z*Math.abs(kr.z),l=t.dot(kr),h=e.dot(kr),u=n.dot(kr);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>a)return!1}return!0}class Rv{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const i=this._listeners[t];if(i!==void 0){const s=i.indexOf(e);s!==-1&&i.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const i=n.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,t);t.target=null}}}class Dv{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,e){return e!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return e!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,s=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*s,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*s,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*s,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,s;const o=.01,a=.1,l=t.elements,h=l[0],u=l[4],d=l[8],f=l[1],m=l[5],_=l[9],x=l[2],w=l[6],v=l[10];if(Math.abs(u-f)<o&&Math.abs(d-x)<o&&Math.abs(_-w)<o){if(Math.abs(u+f)<a&&Math.abs(d+x)<a&&Math.abs(_+w)<a&&Math.abs(h+m+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const C=(h+1)/2,S=(m+1)/2,M=(v+1)/2,E=(u+f)/4,T=(d+x)/4,R=(_+w)/4;return C>S&&C>M?C<o?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(C),i=E/n,s=T/n):S>M?S<o?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(S),n=E/i,s=R/i):M<o?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(M),n=T/s,i=R/s),this.set(n,i,s,e),this}let y=Math.sqrt((w-_)*(w-_)+(d-x)*(d-x)+(f-u)*(f-u));return Math.abs(y)<.001&&(y=1),this.x=(w-_)/y,this.y=(d-x)/y,this.z=(f-u)/y,this.w=Math.acos((h+m+v-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Dv.prototype.isVector4=!0;const Lv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vi={h:0,s:0,l:0},kh={h:0,s:0,l:0};function zp(r,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+(t-r)*6*e:e<1/2?t:e<2/3?r+(t-r)*6*(2/3-e):r}function Vp(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Bp(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class oa{constructor(t,e,n){return e===void 0&&n===void 0?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=CP(t,1),e=Oi(e,0,1),n=Oi(n,0,1),e===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,s=2*n-i;this.r=zp(s,i,t+1/3),this.g=zp(s,i,t),this.b=zp(s,i,t-1/3)}return this}setStyle(t){function e(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let i;const s=n[1],o=n[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const a=parseFloat(i[1])/360,l=parseInt(i[2],10)/100,h=parseInt(i[3],10)/100;return e(i[4]),this.setHSL(a,l,h)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const i=n[1],s=i.length;if(s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=Lv[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Vp(t.r),this.g=Vp(t.g),this.b=Vp(t.b),this}copyLinearToSRGB(t){return this.r=Bp(t.r),this.g=Bp(t.g),this.b=Bp(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,i=this.b,s=Math.max(e,n,i),o=Math.min(e,n,i);let a,l;const h=(o+s)/2;if(o===s)a=0,l=0;else{const u=s-o;switch(l=h<=.5?u/(s+o):u/(2-s-o),s){case e:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-e)/u+2;break;case i:a=(e-n)/u+4;break}a/=6}return t.h=a,t.s=l,t.l=h,t}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(t,e,n){return this.getHSL(vi),vi.h+=t,vi.s+=e,vi.l+=n,this.setHSL(vi.h,vi.s,vi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(vi),t.getHSL(kh);const n=Ip(vi.h,kh.h,e),i=Ip(vi.s,kh.s,e),s=Ip(vi.l,kh.l,e);return this.setHSL(n,i,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}oa.NAMES=Lv;oa.prototype.isColor=!0;oa.prototype.r=1;oa.prototype.g=1;oa.prototype.b=1;const kv=35044,we=new Pt,Ih=new ea;class $s{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=kv,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new oa),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new ea),e[n++]=o.x,e[n++]=o.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new Pt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,s=t.length;i<s;i++){let o=t[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new Dv),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)Ih.fromBufferAttribute(this,e),Ih.applyMatrix3(t),this.setXY(e,Ih.x,Ih.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)we.fromBufferAttribute(this,e),we.applyMatrix3(t),this.setXYZ(e,we.x,we.y,we.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)we.x=this.getX(e),we.y=this.getY(e),we.z=this.getZ(e),we.applyMatrix4(t),this.setXYZ(e,we.x,we.y,we.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)we.x=this.getX(e),we.y=this.getY(e),we.z=this.getZ(e),we.applyNormalMatrix(t),this.setXYZ(e,we.x,we.y,we.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)we.x=this.getX(e),we.y=this.getY(e),we.z=this.getZ(e),we.transformDirection(t),this.setXYZ(e,we.x,we.y,we.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,s){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==kv&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}}$s.prototype.isBufferAttribute=!0;class AP extends $s{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class PP extends $s{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class RP extends $s{constructor(t,e,n){super(new Uint16Array(t),e,n)}}RP.prototype.isFloat16BufferAttribute=!0;class DP extends $s{constructor(t,e,n){super(new Float32Array(t),e,n)}}const LP=new na,Iv=new Pt,Nh=new Pt,Up=new Pt;class kP{constructor(t=new Pt,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):LP.setFromPoints(t).getCenter(n);let i=0;for(let s=0,o=t.length;s<o;s++)i=Math.max(i,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Up.subVectors(t,this.center);const e=Up.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),i=(n-this.radius)*.5;this.center.add(Up.multiplyScalar(i/n)),this.radius+=i}return this}union(t){return this.center.equals(t.center)===!0?Nh.set(0,0,1).multiplyScalar(t.radius):Nh.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Iv.copy(t.center).add(Nh)),this.expandByPoint(Iv.copy(t.center).sub(Nh)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}class zi{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,s,o,a,l,h,u,d,f,m,_,x,w){const v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=h,v[6]=u,v[10]=d,v[14]=f,v[3]=m,v[7]=_,v[11]=x,v[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new zi().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/aa.setFromMatrixColumn(t,0).length(),s=1/aa.setFromMatrixColumn(t,1).length(),o=1/aa.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,s=t.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(i),h=Math.sin(i),u=Math.cos(s),d=Math.sin(s);if(t.order==="XYZ"){const f=o*u,m=o*d,_=a*u,x=a*d;e[0]=l*u,e[4]=-l*d,e[8]=h,e[1]=m+_*h,e[5]=f-x*h,e[9]=-a*l,e[2]=x-f*h,e[6]=_+m*h,e[10]=o*l}else if(t.order==="YXZ"){const f=l*u,m=l*d,_=h*u,x=h*d;e[0]=f+x*a,e[4]=_*a-m,e[8]=o*h,e[1]=o*d,e[5]=o*u,e[9]=-a,e[2]=m*a-_,e[6]=x+f*a,e[10]=o*l}else if(t.order==="ZXY"){const f=l*u,m=l*d,_=h*u,x=h*d;e[0]=f-x*a,e[4]=-o*d,e[8]=_+m*a,e[1]=m+_*a,e[5]=o*u,e[9]=x-f*a,e[2]=-o*h,e[6]=a,e[10]=o*l}else if(t.order==="ZYX"){const f=o*u,m=o*d,_=a*u,x=a*d;e[0]=l*u,e[4]=_*h-m,e[8]=f*h+x,e[1]=l*d,e[5]=x*h+f,e[9]=m*h-_,e[2]=-h,e[6]=a*l,e[10]=o*l}else if(t.order==="YZX"){const f=o*l,m=o*h,_=a*l,x=a*h;e[0]=l*u,e[4]=x-f*d,e[8]=_*d+m,e[1]=d,e[5]=o*u,e[9]=-a*u,e[2]=-h*u,e[6]=m*d+_,e[10]=f-x*d}else if(t.order==="XZY"){const f=o*l,m=o*h,_=a*l,x=a*h;e[0]=l*u,e[4]=-d,e[8]=h*u,e[1]=f*d+x,e[5]=o*u,e[9]=m*d-_,e[2]=_*d-m,e[6]=a*u,e[10]=x*d+f}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(IP,t,NP)}lookAt(t,e,n){const i=this.elements;return Wn.subVectors(t,e),Wn.lengthSq()===0&&(Wn.z=1),Wn.normalize(),Xs.crossVectors(n,Wn),Xs.lengthSq()===0&&(Math.abs(n.z)===1?Wn.x+=1e-4:Wn.z+=1e-4,Wn.normalize(),Xs.crossVectors(n,Wn)),Xs.normalize(),Fh.crossVectors(Wn,Xs),i[0]=Xs.x,i[4]=Fh.x,i[8]=Wn.x,i[1]=Xs.y,i[5]=Fh.y,i[9]=Wn.y,i[2]=Xs.z,i[6]=Fh.z,i[10]=Wn.z,this}multiply(t,e){return e!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,s=this.elements,o=n[0],a=n[4],l=n[8],h=n[12],u=n[1],d=n[5],f=n[9],m=n[13],_=n[2],x=n[6],w=n[10],v=n[14],y=n[3],C=n[7],S=n[11],M=n[15],E=i[0],T=i[4],R=i[8],F=i[12],z=i[1],L=i[5],A=i[9],D=i[13],I=i[2],B=i[6],k=i[10],G=i[14],tt=i[3],K=i[7],j=i[11],$=i[15];return s[0]=o*E+a*z+l*I+h*tt,s[4]=o*T+a*L+l*B+h*K,s[8]=o*R+a*A+l*k+h*j,s[12]=o*F+a*D+l*G+h*$,s[1]=u*E+d*z+f*I+m*tt,s[5]=u*T+d*L+f*B+m*K,s[9]=u*R+d*A+f*k+m*j,s[13]=u*F+d*D+f*G+m*$,s[2]=_*E+x*z+w*I+v*tt,s[6]=_*T+x*L+w*B+v*K,s[10]=_*R+x*A+w*k+v*j,s[14]=_*F+x*D+w*G+v*$,s[3]=y*E+C*z+S*I+M*tt,s[7]=y*T+C*L+S*B+M*K,s[11]=y*R+C*A+S*k+M*j,s[15]=y*F+C*D+S*G+M*$,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],s=t[12],o=t[1],a=t[5],l=t[9],h=t[13],u=t[2],d=t[6],f=t[10],m=t[14],_=t[3],x=t[7],w=t[11],v=t[15];return _*(+s*l*d-i*h*d-s*a*f+n*h*f+i*a*m-n*l*m)+x*(+e*l*m-e*h*f+s*o*f-i*o*m+i*h*u-s*l*u)+w*(+e*h*d-e*a*m-s*o*d+n*o*m+s*a*u-n*h*u)+v*(-i*a*u-e*l*d+e*a*f+i*o*d-n*o*f+n*l*u)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8],d=t[9],f=t[10],m=t[11],_=t[12],x=t[13],w=t[14],v=t[15],y=d*w*h-x*f*h+x*l*m-a*w*m-d*l*v+a*f*v,C=_*f*h-u*w*h-_*l*m+o*w*m+u*l*v-o*f*v,S=u*x*h-_*d*h+_*a*m-o*x*m-u*a*v+o*d*v,M=_*d*l-u*x*l-_*a*f+o*x*f+u*a*w-o*d*w,E=e*y+n*C+i*S+s*M;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/E;return t[0]=y*T,t[1]=(x*f*s-d*w*s-x*i*m+n*w*m+d*i*v-n*f*v)*T,t[2]=(a*w*s-x*l*s+x*i*h-n*w*h-a*i*v+n*l*v)*T,t[3]=(d*l*s-a*f*s-d*i*h+n*f*h+a*i*m-n*l*m)*T,t[4]=C*T,t[5]=(u*w*s-_*f*s+_*i*m-e*w*m-u*i*v+e*f*v)*T,t[6]=(_*l*s-o*w*s-_*i*h+e*w*h+o*i*v-e*l*v)*T,t[7]=(o*f*s-u*l*s+u*i*h-e*f*h-o*i*m+e*l*m)*T,t[8]=S*T,t[9]=(_*d*s-u*x*s-_*n*m+e*x*m+u*n*v-e*d*v)*T,t[10]=(o*x*s-_*a*s+_*n*h-e*x*h-o*n*v+e*a*v)*T,t[11]=(u*a*s-o*d*s-u*n*h+e*d*h+o*n*m-e*a*m)*T,t[12]=M*T,t[13]=(u*x*i-_*d*i+_*n*f-e*x*f-u*n*w+e*d*w)*T,t[14]=(_*a*i-o*x*i-_*n*l+e*x*l+o*n*w-e*a*w)*T,t[15]=(o*d*i-u*a*i+u*n*l-e*d*l-o*n*f+e*a*f)*T,this}scale(t){const e=this.elements,n=t.x,i=t.y,s=t.z;return e[0]*=n,e[4]*=i,e[8]*=s,e[1]*=n,e[5]*=i,e[9]*=s,e[2]*=n,e[6]*=i,e[10]*=s,e[3]*=n,e[7]*=i,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),s=1-n,o=t.x,a=t.y,l=t.z,h=s*o,u=s*a;return this.set(h*o+n,h*a-i*l,h*l+i*a,0,h*a+i*l,u*a+n,u*l-i*o,0,h*l-i*a,u*l+i*o,s*l*l+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,s,o){return this.set(1,n,s,0,t,1,o,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,s=e._x,o=e._y,a=e._z,l=e._w,h=s+s,u=o+o,d=a+a,f=s*h,m=s*u,_=s*d,x=o*u,w=o*d,v=a*d,y=l*h,C=l*u,S=l*d,M=n.x,E=n.y,T=n.z;return i[0]=(1-(x+v))*M,i[1]=(m+S)*M,i[2]=(_-C)*M,i[3]=0,i[4]=(m-S)*E,i[5]=(1-(f+v))*E,i[6]=(w+y)*E,i[7]=0,i[8]=(_+C)*T,i[9]=(w-y)*T,i[10]=(1-(f+x))*T,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let s=aa.set(i[0],i[1],i[2]).length();const o=aa.set(i[4],i[5],i[6]).length(),a=aa.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],xi.copy(this);const h=1/s,u=1/o,d=1/a;return xi.elements[0]*=h,xi.elements[1]*=h,xi.elements[2]*=h,xi.elements[4]*=u,xi.elements[5]*=u,xi.elements[6]*=u,xi.elements[8]*=d,xi.elements[9]*=d,xi.elements[10]*=d,e.setFromRotationMatrix(xi),n.x=s,n.y=o,n.z=a,this}makePerspective(t,e,n,i,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,l=2*s/(e-t),h=2*s/(n-i),u=(e+t)/(e-t),d=(n+i)/(n-i),f=-(o+s)/(o-s),m=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=h,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,i,s,o){const a=this.elements,l=1/(e-t),h=1/(n-i),u=1/(o-s),d=(e+t)*l,f=(n+i)*h,m=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*h,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}zi.prototype.isMatrix4=!0;const aa=new Pt,xi=new zi,IP=new Pt(0,0,0),NP=new Pt(1,1,1),Xs=new Pt,Fh=new Pt,Wn=new Pt,Nv=new zi,Fv=new ta;class la{constructor(t=0,e=0,n=0,i=la.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,s=i[0],o=i[4],a=i[8],l=i[1],h=i[5],u=i[9],d=i[2],f=i[6],m=i[10];switch(e){case"XYZ":this._y=Math.asin(Oi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(f,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Oi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Oi(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Oi(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(Oi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-Oi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Nv.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Nv,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Fv.setFromEuler(this),this.setFromQuaternion(Fv,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new Pt(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}la.prototype.isEuler=!0;la.DefaultOrder="XYZ";la.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class FP{constructor(){this.mask=1|0}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=4294967295|0}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!=0}isEnabled(t){return(this.mask&(1<<t|0))!=0}}class Hp{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,s,o,a,l,h){const u=this.elements;return u[0]=t,u[1]=i,u[2]=a,u[3]=e,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,s=this.elements,o=n[0],a=n[3],l=n[6],h=n[1],u=n[4],d=n[7],f=n[2],m=n[5],_=n[8],x=i[0],w=i[3],v=i[6],y=i[1],C=i[4],S=i[7],M=i[2],E=i[5],T=i[8];return s[0]=o*x+a*y+l*M,s[3]=o*w+a*C+l*E,s[6]=o*v+a*S+l*T,s[1]=h*x+u*y+d*M,s[4]=h*w+u*C+d*E,s[7]=h*v+u*S+d*T,s[2]=f*x+m*y+_*M,s[5]=f*w+m*C+_*E,s[8]=f*v+m*S+_*T,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8];return e*o*u-e*a*h-n*s*u+n*a*l+i*s*h-i*o*l}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],h=t[7],u=t[8],d=u*o-a*h,f=a*l-u*s,m=h*s-o*l,_=e*d+n*f+i*m;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/_;return t[0]=d*x,t[1]=(i*h-u*n)*x,t[2]=(a*n-i*o)*x,t[3]=f*x,t[4]=(u*e-i*l)*x,t[5]=(i*s-a*e)*x,t[6]=m*x,t[7]=(n*l-h*e)*x,t[8]=(o*e-n*s)*x,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,s,o,a){const l=Math.cos(s),h=Math.sin(s);return this.set(n*l,n*h,-n*(l*o+h*a)+o+t,-i*h,i*l,-i*(-h*o+l*a)+a+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],h=i[4],u=i[7];return i[0]=e*s+n*l,i[3]=e*o+n*h,i[6]=e*a+n*u,i[1]=-n*s+e*l,i[4]=-n*o+e*h,i[7]=-n*a+e*u,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}Hp.prototype.isMatrix3=!0;let OP=0;const Ov=new Pt,ca=new ta,os=new zi,Oh=new Pt,Pl=new Pt,zP=new Pt,VP=new ta,zv=new Pt(1,0,0),Vv=new Pt(0,1,0),Bv=new Pt(0,0,1),BP={type:"added"},Uv={type:"removed"};class Ir extends Rv{constructor(){super();Object.defineProperty(this,"id",{value:OP++}),this.uuid=Av(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ir.DefaultUp.clone();const t=new Pt,e=new la,n=new ta,i=new Pt(1,1,1);function s(){n.setFromEuler(e,!1)}function o(){e.setFromQuaternion(n,void 0,!1)}e._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new zi},normalMatrix:{value:new Hp}}),this.matrix=new zi,this.matrixWorld=new zi,this.matrixAutoUpdate=Ir.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new FP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return ca.setFromAxisAngle(t,e),this.quaternion.multiply(ca),this}rotateOnWorldAxis(t,e){return ca.setFromAxisAngle(t,e),this.quaternion.premultiply(ca),this}rotateX(t){return this.rotateOnAxis(zv,t)}rotateY(t){return this.rotateOnAxis(Vv,t)}rotateZ(t){return this.rotateOnAxis(Bv,t)}translateOnAxis(t,e){return Ov.copy(t).applyQuaternion(this.quaternion),this.position.add(Ov.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(zv,t)}translateY(t){return this.translateOnAxis(Vv,t)}translateZ(t){return this.translateOnAxis(Bv,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(os.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Oh.copy(t):Oh.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Pl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?os.lookAt(Pl,Oh,this.up):os.lookAt(Oh,Pl,this.up),this.quaternion.setFromRotationMatrix(os),i&&(os.extractRotation(i.matrixWorld),ca.setFromRotationMatrix(os),this.quaternion.premultiply(ca.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(BP)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Uv)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Uv)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),os.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),os.multiply(t.parent.matrixWorld)),t.applyMatrix4(os),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pl,t,zP),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Pl,VP,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,u=l.length;h<u;h++){const d=l[h];s(t.shapes,d)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(s(t.materials,this.material[l]));i.material=a}else i.material=s(t.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(t.animations,l))}}if(e){const a=o(t.geometries),l=o(t.materials),h=o(t.textures),u=o(t.images),d=o(t.shapes),f=o(t.skeletons),m=o(t.animations);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),d.length>0&&(n.shapes=d),f.length>0&&(n.skeletons=f),m.length>0&&(n.animations=m)}return n.object=i,n;function o(a){const l=[];for(const h in a){const u=a[h];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const i=t.children[n];this.add(i.clone())}return this}}Ir.DefaultUp=new Pt(0,1,0);Ir.DefaultMatrixAutoUpdate=!0;Ir.prototype.isObject3D=!0;function UP(r){if(r.length===0)return-1/0;let t=r[0];for(let e=1,n=r.length;e<n;++e)r[e]>t&&(t=r[e]);return t}let HP=0;const ei=new zi,Wp=new Ir,ha=new Pt,Gn=new na,Rl=new na,Ke=new Pt;class Gp extends Rv{constructor(){super();Object.defineProperty(this,"id",{value:HP++}),this.uuid=Av(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(UP(t)>65535?PP:AP)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Hp().getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return ei.makeRotationFromQuaternion(t),this.applyMatrix4(ei),this}rotateX(t){return ei.makeRotationX(t),this.applyMatrix4(ei),this}rotateY(t){return ei.makeRotationY(t),this.applyMatrix4(ei),this}rotateZ(t){return ei.makeRotationZ(t),this.applyMatrix4(ei),this}translate(t,e,n){return ei.makeTranslation(t,e,n),this.applyMatrix4(ei),this}scale(t,e,n){return ei.makeScale(t,e,n),this.applyMatrix4(ei),this}lookAt(t){return Wp.lookAt(t),Wp.updateMatrix(),this.applyMatrix4(Wp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ha).negate(),this.translate(ha.x,ha.y,ha.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const s=t[n];e.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new DP(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new na);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Pt(-1/0,-1/0,-1/0),new Pt(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++){const s=e[n];Gn.setFromBufferAttribute(s),this.morphTargetsRelative?(Ke.addVectors(this.boundingBox.min,Gn.min),this.boundingBox.expandByPoint(Ke),Ke.addVectors(this.boundingBox.max,Gn.max),this.boundingBox.expandByPoint(Ke)):(this.boundingBox.expandByPoint(Gn.min),this.boundingBox.expandByPoint(Gn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new kP);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Pt,1/0);return}if(t){const n=this.boundingSphere.center;if(Gn.setFromBufferAttribute(t),e)for(let s=0,o=e.length;s<o;s++){const a=e[s];Rl.setFromBufferAttribute(a),this.morphTargetsRelative?(Ke.addVectors(Gn.min,Rl.min),Gn.expandByPoint(Ke),Ke.addVectors(Gn.max,Rl.max),Gn.expandByPoint(Ke)):(Gn.expandByPoint(Rl.min),Gn.expandByPoint(Rl.max))}Gn.getCenter(n);let i=0;for(let s=0,o=t.count;s<o;s++)Ke.fromBufferAttribute(t,s),i=Math.max(i,n.distanceToSquared(Ke));if(e)for(let s=0,o=e.length;s<o;s++){const a=e[s],l=this.morphTargetsRelative;for(let h=0,u=a.count;h<u;h++)Ke.fromBufferAttribute(a,h),l&&(ha.fromBufferAttribute(t,h),Ke.add(ha)),i=Math.max(i,n.distanceToSquared(Ke))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,i=e.position.array,s=e.normal.array,o=e.uv.array,a=i.length/3;e.tangent===void 0&&this.setAttribute("tangent",new $s(new Float32Array(4*a),4));const l=e.tangent.array,h=[],u=[];for(let z=0;z<a;z++)h[z]=new Pt,u[z]=new Pt;const d=new Pt,f=new Pt,m=new Pt,_=new ea,x=new ea,w=new ea,v=new Pt,y=new Pt;function C(z,L,A){d.fromArray(i,z*3),f.fromArray(i,L*3),m.fromArray(i,A*3),_.fromArray(o,z*2),x.fromArray(o,L*2),w.fromArray(o,A*2),f.sub(d),m.sub(d),x.sub(_),w.sub(_);const D=1/(x.x*w.y-w.x*x.y);!isFinite(D)||(v.copy(f).multiplyScalar(w.y).addScaledVector(m,-x.y).multiplyScalar(D),y.copy(m).multiplyScalar(x.x).addScaledVector(f,-w.x).multiplyScalar(D),h[z].add(v),h[L].add(v),h[A].add(v),u[z].add(y),u[L].add(y),u[A].add(y))}let S=this.groups;S.length===0&&(S=[{start:0,count:n.length}]);for(let z=0,L=S.length;z<L;++z){const A=S[z],D=A.start,I=A.count;for(let B=D,k=D+I;B<k;B+=3)C(n[B+0],n[B+1],n[B+2])}const M=new Pt,E=new Pt,T=new Pt,R=new Pt;function F(z){T.fromArray(s,z*3),R.copy(T);const L=h[z];M.copy(L),M.sub(T.multiplyScalar(T.dot(L))).normalize(),E.crossVectors(R,L);const D=E.dot(u[z])<0?-1:1;l[z*4]=M.x,l[z*4+1]=M.y,l[z*4+2]=M.z,l[z*4+3]=D}for(let z=0,L=S.length;z<L;++z){const A=S[z],D=A.start,I=A.count;for(let B=D,k=D+I;B<k;B+=3)F(n[B+0]),F(n[B+1]),F(n[B+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new $s(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let f=0,m=n.count;f<m;f++)n.setXYZ(f,0,0,0);const i=new Pt,s=new Pt,o=new Pt,a=new Pt,l=new Pt,h=new Pt,u=new Pt,d=new Pt;if(t)for(let f=0,m=t.count;f<m;f+=3){const _=t.getX(f+0),x=t.getX(f+1),w=t.getX(f+2);i.fromBufferAttribute(e,_),s.fromBufferAttribute(e,x),o.fromBufferAttribute(e,w),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),a.fromBufferAttribute(n,_),l.fromBufferAttribute(n,x),h.fromBufferAttribute(n,w),a.add(u),l.add(u),h.add(u),n.setXYZ(_,a.x,a.y,a.z),n.setXYZ(x,l.x,l.y,l.z),n.setXYZ(w,h.x,h.y,h.z)}else for(let f=0,m=e.count;f<m;f+=3)i.fromBufferAttribute(e,f+0),s.fromBufferAttribute(e,f+1),o.fromBufferAttribute(e,f+2),u.subVectors(o,s),d.subVectors(i,s),u.cross(d),n.setXYZ(f+0,u.x,u.y,u.z),n.setXYZ(f+1,u.x,u.y,u.z),n.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(t.attributes[i]===void 0)continue;const o=n[i].array,a=t.attributes[i],l=a.array,h=a.itemSize*e,u=Math.min(l.length,o.length-h);for(let d=0,f=h;d<u;d++,f++)o[f]=l[d]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Ke.fromBufferAttribute(t,e),Ke.normalize(),t.setXYZ(e,Ke.x,Ke.y,Ke.z)}toNonIndexed(){function t(a,l){const h=a.array,u=a.itemSize,d=a.normalized,f=new h.constructor(l.length*u);let m=0,_=0;for(let x=0,w=l.length;x<w;x++){a.isInterleavedBufferAttribute?m=l[x]*a.data.stride+a.offset:m=l[x]*u;for(let v=0;v<u;v++)f[_++]=h[m++]}return new $s(f,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Gp,n=this.index.array,i=this.attributes;for(const a in i){const l=i[a],h=t(l,n);e.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const l=[],h=s[a];for(let u=0,d=h.length;u<d;u++){const f=h[u],m=t(f,n);l.push(m)}e.morphAttributes[a]=l}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const h=o[a];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(t[h]=l[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const l in n){const h=n[l];t.data.attributes[l]=h.toJSON(t.data)}const i={};let s=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],u=[];for(let d=0,f=h.length;d<f;d++){const m=h[d];u.push(m.toJSON(t.data))}u.length>0&&(i[l]=u,s=!0)}s&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const i=t.attributes;for(const h in i){const u=i[h];this.setAttribute(h,u.clone(e))}const s=t.morphAttributes;for(const h in s){const u=[],d=s[h];for(let f=0,m=d.length;f<m;f++)u.push(d[f].clone(e));this.morphAttributes[h]=u}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let h=0,u=o.length;h<u;h++){const d=o[h];this.addGroup(d.start,d.count,d.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Gp.prototype.isBufferGeometry=!0;var WP=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Hv={exports:{}};/*! Tweakpane 3.0.7 (c) 2016 cocopon, licensed under the MIT license. */(function(r,t){(function(e,n){n(t)})(WP,function(e){class n{constructor(c){const[p,b]=c.split("-"),P=p.split(".");this.major=parseInt(P[0],10),this.minor=parseInt(P[1],10),this.patch=parseInt(P[2],10),this.prerelease=b!=null?b:null}toString(){const c=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[c,this.prerelease].join("-"):c}}class i{constructor(c){this.controller_=c}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(c){this.controller_.viewProps.set("disabled",c)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(c){this.controller_.viewProps.set("hidden",c)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class s{constructor(c){this.target=c}}class o extends s{constructor(c,p,b,P){super(c);this.value=p,this.presetKey=b,this.last=P!=null?P:!0}}class a extends s{constructor(c,p,b){super(c);this.value=p,this.presetKey=b}}class l extends s{constructor(c,p){super(c);this.expanded=p}}function h(g){return g}function u(g){return g==null}function d(g,c){if(g.length!==c.length)return!1;for(let p=0;p<g.length;p++)if(g[p]!==c[p])return!1;return!0}const f={alreadydisposed:()=>"View has been already disposed",invalidparams:g=>`Invalid parameters for '${g.name}'`,nomatchingcontroller:g=>`No matching controller for '${g.key}'`,nomatchingview:g=>`No matching view for '${JSON.stringify(g.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:g=>`Property '${g.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class m{constructor(c){var p;this.message=(p=f[c.type](h(c.context)))!==null&&p!==void 0?p:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=c.type}static alreadyDisposed(){return new m({type:"alreadydisposed"})}static notBindable(){return new m({type:"notbindable"})}static propertyNotFound(c){return new m({type:"propertynotfound",context:{name:c}})}static shouldNeverHappen(){return new m({type:"shouldneverhappen"})}}class _{constructor(c,p,b){this.obj_=c,this.key_=p,this.presetKey_=b!=null?b:p}static isBindable(c){return!(c===null||typeof c!="object")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(c){this.obj_[this.key_]=c}writeProperty(c,p){const b=this.read();if(!_.isBindable(b))throw m.notBindable();if(!(c in b))throw m.propertyNotFound(c);b[c]=p}}class x extends i{get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}get title(){var c;return(c=this.controller_.valueController.props.get("title"))!==null&&c!==void 0?c:""}set title(c){this.controller_.valueController.props.set("title",c)}on(c,p){const b=p.bind(this);return this.controller_.valueController.emitter.on(c,()=>{b(new s(this))}),this}}class w{constructor(){this.observers_={}}on(c,p){let b=this.observers_[c];return b||(b=this.observers_[c]=[]),b.push({handler:p}),this}off(c,p){const b=this.observers_[c];return b&&(this.observers_[c]=b.filter(P=>P.handler!==p)),this}emit(c,p){const b=this.observers_[c];!b||b.forEach(P=>{P.handler(p)})}}const v="tp";function y(g){return(p,b)=>[v,"-",g,"v",p?`_${p}`:"",b?`-${b}`:""].join("")}function C(g,c){return p=>c(g(p))}function S(g){return g.rawValue}function M(g,c){g.emitter.on("change",C(S,c)),c(g.rawValue)}function E(g,c,p){M(g.value(c),p)}function T(g,c,p){p?g.classList.add(c):g.classList.remove(c)}function R(g,c){return p=>{T(g,c,p)}}function F(g,c){M(g,p=>{c.textContent=p!=null?p:""})}const z=y("btn");class L{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(z()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("button");b.classList.add(z("b")),p.viewProps.bindDisabled(b),this.element.appendChild(b),this.buttonElement=b;const P=c.createElement("div");P.classList.add(z("t")),F(p.props.value("title"),P),this.buttonElement.appendChild(P)}}class A{constructor(c,p){this.emitter=new w,this.onClick_=this.onClick_.bind(this),this.props=p.props,this.viewProps=p.viewProps,this.view=new L(c,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class D{constructor(c,p){var b;this.constraint_=p==null?void 0:p.constraint,this.equals_=(b=p==null?void 0:p.equals)!==null&&b!==void 0?b:(P,q)=>P===q,this.emitter=new w,this.rawValue_=c}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(c){this.setRawValue(c,{forceEmit:!1,last:!0})}setRawValue(c,p){const b=p!=null?p:{forceEmit:!1,last:!0},P=this.constraint_?this.constraint_.constrain(c):c;!!this.equals_(this.rawValue_,P)&&!b.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=P,this.emitter.emit("change",{options:b,rawValue:P,sender:this}))}}class I{constructor(c){this.emitter=new w,this.value_=c}get rawValue(){return this.value_}set rawValue(c){this.setRawValue(c,{forceEmit:!1,last:!0})}setRawValue(c,p){const b=p!=null?p:{forceEmit:!1,last:!0};this.value_===c&&!b.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=c,this.emitter.emit("change",{options:b,rawValue:this.value_,sender:this}))}}function B(g,c){const p=c==null?void 0:c.constraint,b=c==null?void 0:c.equals;return!p&&!b?new I(g):new D(g,c)}class k{constructor(c){this.emitter=new w,this.valMap_=c;for(const p in this.valMap_)this.valMap_[p].emitter.on("change",()=>{this.emitter.emit("change",{key:p,sender:this})})}static createCore(c){return Object.keys(c).reduce((b,P)=>Object.assign(b,{[P]:B(c[P])}),{})}static fromObject(c){const p=this.createCore(c);return new k(p)}get(c){return this.valMap_[c].rawValue}set(c,p){this.valMap_[c].rawValue=p}value(c){return this.valMap_[c]}}function G(g,c){const b=Object.keys(c).reduce((P,q)=>{if(P===void 0)return;const yt=c[q](g[q]);return yt.succeeded?Object.assign(Object.assign({},P),{[q]:yt.value}):void 0},{});return h(b)}function tt(g,c){return g.reduce((p,b)=>{if(p===void 0)return;const P=c(b);if(!(!P.succeeded||P.value===void 0))return[...p,P.value]},[])}function K(g){return g===null?!1:typeof g=="object"}function j(g){return c=>p=>{if(!c&&p===void 0)return{succeeded:!1,value:void 0};if(c&&p===void 0)return{succeeded:!0,value:void 0};const b=g(p);return b!==void 0?{succeeded:!0,value:b}:{succeeded:!1,value:void 0}}}function $(g){return{custom:c=>j(c)(g),boolean:j(c=>typeof c=="boolean"?c:void 0)(g),number:j(c=>typeof c=="number"?c:void 0)(g),string:j(c=>typeof c=="string"?c:void 0)(g),function:j(c=>typeof c=="function"?c:void 0)(g),constant:c=>j(p=>p===c?c:void 0)(g),raw:j(c=>c)(g),object:c=>j(p=>{if(!!K(p))return G(p,c)})(g),array:c=>j(p=>{if(!!Array.isArray(p))return tt(p,c)})(g)}}const st={optional:$(!0),required:$(!1)};function rt(g,c){const p=st.required.object(c)(g);return p.succeeded?p.value:void 0}function xt(g){return g&&g.parentElement&&g.parentElement.removeChild(g),null}function It(){return["veryfirst","first","last","verylast"]}const Q=y(""),_t={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Rt{constructor(c){this.parent_=null,this.blade=c.blade,this.view=c.view,this.viewProps=c.viewProps;const p=this.view.element;this.blade.value("positions").emitter.on("change",()=>{It().forEach(b=>{p.classList.remove(Q(void 0,_t[b]))}),this.blade.get("positions").forEach(b=>{p.classList.add(Q(void 0,_t[b]))})}),this.viewProps.handleDispose(()=>{xt(p)})}get parent(){return this.parent_}}const wt="http://www.w3.org/2000/svg";function at(g){g.offsetHeight}function qt(g,c){const p=g.style.transition;g.style.transition="none",c(),g.style.transition=p}function nt(g){return g.ontouchstart!==void 0}function ft(){return new Function("return this")()}function mt(){return h(ft()).document}function Z(g){const c=g.ownerDocument.defaultView;return c&&"document"in c?g.getContext("2d"):null}const it={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Ct(g,c){const p=g.createElementNS(wt,"svg");return p.innerHTML=it[c],p}function Et(g,c,p){g.insertBefore(c,g.children[p])}function St(g){g.parentElement&&g.parentElement.removeChild(g)}function Nt(g){for(;g.children.length>0;)g.removeChild(g.children[0])}function U(g){for(;g.childNodes.length>0;)g.removeChild(g.childNodes[0])}function N(g){return g.relatedTarget?h(g.relatedTarget):"explicitOriginalTarget"in g?g.explicitOriginalTarget:null}const ot=y("lbl");function pt(g,c){const p=g.createDocumentFragment();return c.split(`
`).map(P=>g.createTextNode(P)).forEach((P,q)=>{q>0&&p.appendChild(g.createElement("br")),p.appendChild(P)}),p}class bt{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(ot()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("div");b.classList.add(ot("l")),E(p.props,"label",q=>{u(q)?this.element.classList.add(ot(void 0,"nol")):(this.element.classList.remove(ot(void 0,"nol")),U(b),b.appendChild(pt(c,q)))}),this.element.appendChild(b),this.labelElement=b;const P=c.createElement("div");P.classList.add(ot("v")),this.element.appendChild(P),this.valueElement=P}}class ut extends Rt{constructor(c,p){const b=p.valueController.viewProps;super(Object.assign(Object.assign({},p),{view:new bt(c,{props:p.props,viewProps:b}),viewProps:b}));this.props=p.props,this.valueController=p.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const Vt={id:"button",type:"blade",accept(g){const c=st,p=rt(g,{title:c.required.string,view:c.required.constant("button"),label:c.optional.string});return p?{params:p}:null},controller(g){return new ut(g.document,{blade:g.blade,props:k.fromObject({label:g.params.label}),valueController:new A(g.document,{props:k.fromObject({title:g.params.title}),viewProps:g.viewProps})})},api(g){return!(g.controller instanceof ut)||!(g.controller.valueController instanceof A)?null:new x(g.controller)}};class Dt extends Rt{constructor(c){super(c);this.value=c.value}}function W(){return new k({positions:B([],{equals:d})})}class V extends k{constructor(c){super(c)}static create(c){const p={completed:!0,expanded:c,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},b=k.createCore(p);return new V(b)}get styleExpanded(){var c;return(c=this.get("temporaryExpanded"))!==null&&c!==void 0?c:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const c=this.get("expandedHeight");return this.get("shouldFixHeight")&&!u(c)?`${c}px`:"auto"}bindExpandedClass(c,p){E(this,"expanded",()=>{this.styleExpanded?c.classList.add(p):c.classList.remove(p)})}}function dt(g,c){let p=0;return qt(c,()=>{g.set("expandedHeight",null),g.set("temporaryExpanded",!0),at(c),p=c.clientHeight,g.set("temporaryExpanded",null),at(c)}),p}function ct(g,c){c.style.height=g.styleHeight}function Lt(g,c){g.value("expanded").emitter.on("beforechange",()=>{g.set("completed",!1),u(g.get("expandedHeight"))&&g.set("expandedHeight",dt(g,c)),g.set("shouldFixHeight",!0),at(c)}),g.emitter.on("change",()=>{ct(g,c)}),ct(g,c),c.addEventListener("transitionend",p=>{p.propertyName==="height"&&(g.set("shouldFixHeight",!1),g.set("expandedHeight",null),g.set("completed",!0))})}class At extends i{constructor(c,p){super(c);this.rackApi_=p}}function Wt(g,c){return g.addBlade(Object.assign(Object.assign({},c),{view:"button"}))}function Mt(g,c){return g.addBlade(Object.assign(Object.assign({},c),{view:"folder"}))}function Ft(g,c){const p=c||{};return g.addBlade(Object.assign(Object.assign({},p),{view:"separator"}))}function Kt(g,c){return g.addBlade(Object.assign(Object.assign({},c),{view:"tab"}))}class re{constructor(c){this.emitter=new w,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=c}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(c){for(const p of this.allItems())if(c(p))return p;return null}includes(c){return this.cache_.has(c)}add(c,p){if(this.includes(c))throw m.shouldNeverHappen();const b=p!==void 0?p:this.items_.length;this.items_.splice(b,0,c),this.cache_.add(c);const P=this.extract_(c);P&&(P.emitter.on("add",this.onSubListAdd_),P.emitter.on("remove",this.onSubListRemove_),P.allItems().forEach(q=>{this.cache_.add(q)})),this.emitter.emit("add",{index:b,item:c,root:this,target:this})}remove(c){const p=this.items_.indexOf(c);if(p<0)return;this.items_.splice(p,1),this.cache_.delete(c);const b=this.extract_(c);b&&(b.emitter.off("add",this.onSubListAdd_),b.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:p,item:c,root:this,target:this})}onSubListAdd_(c){this.cache_.add(c.item),this.emitter.emit("add",{index:c.index,item:c.item,root:this,target:c.target})}onSubListRemove_(c){this.cache_.delete(c.item),this.emitter.emit("remove",{index:c.index,item:c.item,root:this,target:c.target})}}class Mn extends i{constructor(c){super(c);this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new w,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(c){const p=c.sender.target.read();this.emitter_.emit("change",{event:new o(this,h(p),this.controller_.binding.target.presetKey,c.options.last)})}}class Ne extends ut{constructor(c,p){super(c,p);this.binding=p.binding}}class ui extends i{constructor(c){super(c);this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new w,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(c){const p=c.sender.target.read();this.emitter_.emit("update",{event:new a(this,h(p),this.controller_.binding.target.presetKey)})}}class di extends ut{constructor(c,p){super(c,p);this.binding=p.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function yc(g){return g instanceof eo?g.apiSet_:g instanceof At?g.rackApi_.apiSet_:null}function fr(g,c){const p=g.find(b=>b.controller_===c);if(!p)throw m.shouldNeverHappen();return p}function mr(g,c,p){if(!_.isBindable(g))throw m.notBindable();return new _(g,c,p)}class eo extends i{constructor(c,p){super(c);this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new w,this.apiSet_=new re(yc),this.pool_=p;const b=this.controller_.rack;b.emitter.on("add",this.onRackAdd_),b.emitter.on("remove",this.onRackRemove_),b.emitter.on("inputchange",this.onRackInputChange_),b.emitter.on("monitorupdate",this.onRackMonitorUpdate_),b.children.forEach(P=>{this.setUpApi_(P)})}get children(){return this.controller_.rack.children.map(c=>fr(this.apiSet_,c))}addInput(c,p,b){const P=b||{},q=this.controller_.view.element.ownerDocument,Y=this.pool_.createInput(q,mr(c,p,P.presetKey),P),yt=new Mn(Y);return this.add(yt,P.index)}addMonitor(c,p,b){const P=b||{},q=this.controller_.view.element.ownerDocument,Y=this.pool_.createMonitor(q,mr(c,p),P),yt=new ui(Y);return h(this.add(yt,P.index))}addFolder(c){return Mt(this,c)}addButton(c){return Wt(this,c)}addSeparator(c){return Ft(this,c)}addTab(c){return Kt(this,c)}add(c,p){this.controller_.rack.add(c.controller_,p);const b=this.apiSet_.find(P=>P.controller_===c.controller_);return b&&this.apiSet_.remove(b),this.apiSet_.add(c),c}remove(c){this.controller_.rack.remove(c.controller_)}addBlade(c){const p=this.controller_.view.element.ownerDocument,b=this.pool_.createBlade(p,c),P=this.pool_.createBladeApi(b);return this.add(P,c.index)}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}setUpApi_(c){this.apiSet_.find(b=>b.controller_===c)||this.apiSet_.add(this.pool_.createBladeApi(c))}onRackAdd_(c){this.setUpApi_(c.bladeController)}onRackRemove_(c){if(c.isRoot){const p=fr(this.apiSet_,c.bladeController);this.apiSet_.remove(p)}}onRackInputChange_(c){const p=c.bladeController;if(p instanceof Ne){const b=fr(this.apiSet_,p),P=p.binding;this.emitter_.emit("change",{event:new o(b,h(P.target.read()),P.target.presetKey,c.options.last)})}else if(p instanceof Dt){const b=fr(this.apiSet_,p);this.emitter_.emit("change",{event:new o(b,p.value.rawValue,void 0,c.options.last)})}}onRackMonitorUpdate_(c){if(!(c.bladeController instanceof di))throw m.shouldNeverHappen();const p=fr(this.apiSet_,c.bladeController),b=c.bladeController.binding;this.emitter_.emit("update",{event:new a(p,h(b.target.read()),b.target.presetKey)})}}class gr extends At{constructor(c,p){super(c,new eo(c.rackController,p));this.emitter_=new w,this.controller_.foldable.value("expanded").emitter.on("change",b=>{this.emitter_.emit("fold",{event:new l(this,b.sender.rawValue)})}),this.rackApi_.on("change",b=>{this.emitter_.emit("change",{event:b})}),this.rackApi_.on("update",b=>{this.emitter_.emit("update",{event:b})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(c){this.controller_.foldable.set("expanded",c)}get title(){return this.controller_.props.get("title")}set title(c){this.controller_.props.set("title",c)}get children(){return this.rackApi_.children}addInput(c,p,b){return this.rackApi_.addInput(c,p,b)}addMonitor(c,p,b){return this.rackApi_.addMonitor(c,p,b)}addFolder(c){return this.rackApi_.addFolder(c)}addButton(c){return this.rackApi_.addButton(c)}addSeparator(c){return this.rackApi_.addSeparator(c)}addTab(c){return this.rackApi_.addTab(c)}add(c,p){return this.rackApi_.add(c,p)}remove(c){this.rackApi_.remove(c)}addBlade(c){return this.rackApi_.addBlade(c)}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}}class no extends Rt{constructor(c){super({blade:c.blade,view:c.view,viewProps:c.rackController.viewProps});this.rackController=c.rackController}}class Iu{constructor(c,p){const b=y(p.viewName);this.element=c.createElement("div"),this.element.classList.add(b()),p.viewProps.bindClassModifiers(this.element)}}function Nu(g,c){for(let p=0;p<g.length;p++){const b=g[p];if(b instanceof Ne&&b.binding===c)return b}return null}function Fu(g,c){for(let p=0;p<g.length;p++){const b=g[p];if(b instanceof di&&b.binding===c)return b}return null}function O(g,c){for(let p=0;p<g.length;p++){const b=g[p];if(b instanceof Dt&&b.value===c)return b}return null}function X(g){return g instanceof lt?g.rack:g instanceof no?g.rackController.rack:null}function et(g){const c=X(g);return c?c.bcSet_:null}class J{constructor(c){var p;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new w,this.blade_=c!=null?c:null,(p=this.blade_)===null||p===void 0||p.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new re(et),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(c,p){c.parent&&c.parent.remove(c),c.parent_=this,this.bcSet_.add(c,p)}remove(c){c.parent_=null,this.bcSet_.remove(c)}find(c){return h(this.bcSet_.allItems().filter(p=>p instanceof c))}onSetAdd_(c){this.updatePositions_();const p=c.target===c.root;if(this.emitter.emit("add",{bladeController:c.item,index:c.index,isRoot:p,sender:this}),!p)return;const b=c.item;if(b.viewProps.emitter.on("change",this.onChildViewPropsChange_),b.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),b.viewProps.handleDispose(this.onChildDispose_),b instanceof Ne)b.binding.emitter.on("change",this.onChildInputChange_);else if(b instanceof di)b.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(b instanceof Dt)b.value.emitter.on("change",this.onChildValueChange_);else{const P=X(b);if(P){const q=P.emitter;q.on("layout",this.onDescendantLayout_),q.on("inputchange",this.onDescendantInputChange_),q.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(c){this.updatePositions_();const p=c.target===c.root;if(this.emitter.emit("remove",{bladeController:c.item,isRoot:p,sender:this}),!p)return;const b=c.item;if(b instanceof Ne)b.binding.emitter.off("change",this.onChildInputChange_);else if(b instanceof di)b.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(b instanceof Dt)b.value.emitter.off("change",this.onChildValueChange_);else{const P=X(b);if(P){const q=P.emitter;q.off("layout",this.onDescendantLayout_),q.off("inputchange",this.onDescendantInputChange_),q.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const c=this.bcSet_.items.filter(P=>!P.viewProps.get("hidden")),p=c[0],b=c[c.length-1];this.bcSet_.items.forEach(P=>{const q=[];P===p&&(q.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&q.push("veryfirst")),P===b&&(q.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&q.push("verylast")),P.blade.set("positions",q)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(c){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(p=>p.viewProps.get("disposed")).forEach(p=>{this.bcSet_.remove(p)})}onChildInputChange_(c){const p=Nu(this.find(Ne),c.sender);if(!p)throw m.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:p,options:c.options,sender:this})}onChildMonitorUpdate_(c){const p=Fu(this.find(di),c.sender);if(!p)throw m.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:p,sender:this})}onChildValueChange_(c){const p=O(this.find(Dt),c.sender);if(!p)throw m.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:p,options:c.options,sender:this})}onDescendantLayout_(c){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(c){this.emitter.emit("inputchange",{bladeController:c.bladeController,options:c.options,sender:this})}onDescendantMonitorUpdate_(c){this.emitter.emit("monitorupdate",{bladeController:c.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class lt extends Rt{constructor(c,p){super(Object.assign(Object.assign({},p),{view:new Iu(c,{viewName:"brk",viewProps:p.viewProps})}));this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const b=new J(p.root?void 0:p.blade);b.emitter.on("add",this.onRackAdd_),b.emitter.on("remove",this.onRackRemove_),this.rack=b,this.viewProps.handleDispose(()=>{for(let P=this.rack.children.length-1;P>=0;P--)this.rack.children[P].viewProps.set("disposed",!0)})}onRackAdd_(c){!c.isRoot||Et(this.view.element,c.bladeController.view.element,c.index)}onRackRemove_(c){!c.isRoot||St(c.bladeController.view.element)}}const Ht=y("cnt");class jt{constructor(c,p){this.className_=y(p.viewName||"fld"),this.element=c.createElement("div"),this.element.classList.add(this.className_(),Ht()),p.viewProps.bindClassModifiers(this.element),this.foldable_=p.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),E(this.foldable_,"completed",R(this.element,this.className_(void 0,"cpl")));const b=c.createElement("button");b.classList.add(this.className_("b")),E(p.props,"title",yt=>{u(yt)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),p.viewProps.bindDisabled(b),this.element.appendChild(b),this.buttonElement=b;const P=c.createElement("div");P.classList.add(this.className_("t")),F(p.props.value("title"),P),this.buttonElement.appendChild(P),this.titleElement=P;const q=c.createElement("div");q.classList.add(this.className_("m")),this.buttonElement.appendChild(q);const Y=p.containerElement;Y.classList.add(this.className_("c")),this.element.appendChild(Y),this.containerElement=Y}}class Yt extends no{constructor(c,p){var b;const P=V.create((b=p.expanded)!==null&&b!==void 0?b:!0),q=new lt(c,{blade:p.blade,root:p.root,viewProps:p.viewProps});super(Object.assign(Object.assign({},p),{rackController:q,view:new jt(c,{containerElement:q.view.element,foldable:P,props:p.props,viewName:p.root?"rot":void 0,viewProps:p.viewProps})}));this.onTitleClick_=this.onTitleClick_.bind(this),this.props=p.props,this.foldable=P,Lt(this.foldable,this.view.containerElement),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Gt={id:"folder",type:"blade",accept(g){const c=st,p=rt(g,{title:c.required.string,view:c.required.constant("folder"),expanded:c.optional.boolean});return p?{params:p}:null},controller(g){return new Yt(g.document,{blade:g.blade,expanded:g.params.expanded,props:k.fromObject({title:g.params.title}),viewProps:g.viewProps})},api(g){return g.controller instanceof Yt?new gr(g.controller,g.pool):null}};class Jt extends Dt{constructor(c,p){const b=p.valueController.viewProps;super(Object.assign(Object.assign({},p),{value:p.valueController.value,view:new bt(c,{props:p.props,viewProps:b}),viewProps:b}));this.props=p.props,this.valueController=p.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Zt extends i{}const Qt=y("spr");class Ee{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(Qt()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("hr");b.classList.add(Qt("r")),this.element.appendChild(b)}}class Ai extends Rt{constructor(c,p){super(Object.assign(Object.assign({},p),{view:new Ee(c,{viewProps:p.viewProps})}))}}const xs={id:"separator",type:"blade",accept(g){const p=rt(g,{view:st.required.constant("separator")});return p?{params:p}:null},controller(g){return new Ai(g.document,{blade:g.blade,viewProps:g.viewProps})},api(g){return g.controller instanceof Ai?new Zt(g.controller):null}},se=y("");function zn(g,c){return R(g,se(void 0,c))}class ue extends k{constructor(c){super(c)}static create(c){var p,b;const P=c!=null?c:{},q={disabled:(p=P.disabled)!==null&&p!==void 0?p:!1,disposed:!1,hidden:(b=P.hidden)!==null&&b!==void 0?b:!1},Y=k.createCore(q);return new ue(Y)}bindClassModifiers(c){E(this,"disabled",zn(c,"disabled")),E(this,"hidden",zn(c,"hidden"))}bindDisabled(c){E(this,"disabled",p=>{c.disabled=p})}bindTabIndex(c){E(this,"disabled",p=>{c.tabIndex=p?-1:0})}handleDispose(c){this.value("disposed").emitter.on("change",p=>{p&&c()})}}const hn=y("tbi");class io{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(hn()),p.viewProps.bindClassModifiers(this.element),E(p.props,"selected",q=>{q?this.element.classList.add(hn(void 0,"sel")):this.element.classList.remove(hn(void 0,"sel"))});const b=c.createElement("button");b.classList.add(hn("b")),p.viewProps.bindDisabled(b),this.element.appendChild(b),this.buttonElement=b;const P=c.createElement("div");P.classList.add(hn("t")),F(p.props.value("title"),P),this.buttonElement.appendChild(P),this.titleElement=P}}class Xn{constructor(c,p){this.emitter=new w,this.onClick_=this.onClick_.bind(this),this.props=p.props,this.viewProps=p.viewProps,this.view=new io(c,{props:p.props,viewProps:p.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Yn{constructor(c,p){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Xn(c,{props:p.itemProps,viewProps:ue.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new lt(c,{blade:W(),viewProps:ue.create()}),this.props=p.props,E(this.props,"selected",b=>{this.itemController.props.set("selected",b),this.contentController.viewProps.set("hidden",!b)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class We{constructor(c,p){this.controller_=c,this.rackApi_=p}get title(){var c;return(c=this.controller_.itemController.props.get("title"))!==null&&c!==void 0?c:""}set title(c){this.controller_.itemController.props.set("title",c)}get selected(){return this.controller_.props.get("selected")}set selected(c){this.controller_.props.set("selected",c)}get children(){return this.rackApi_.children}addButton(c){return this.rackApi_.addButton(c)}addFolder(c){return this.rackApi_.addFolder(c)}addSeparator(c){return this.rackApi_.addSeparator(c)}addTab(c){return this.rackApi_.addTab(c)}add(c,p){this.rackApi_.add(c,p)}remove(c){this.rackApi_.remove(c)}addInput(c,p,b){return this.rackApi_.addInput(c,p,b)}addMonitor(c,p,b){return this.rackApi_.addMonitor(c,p,b)}addBlade(c){return this.rackApi_.addBlade(c)}}class ys extends At{constructor(c,p){super(c,new eo(c.rackController,p));this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new w,this.pageApiMap_=new Map,this.rackApi_.on("change",b=>{this.emitter_.emit("change",{event:b})}),this.rackApi_.on("update",b=>{this.emitter_.emit("update",{event:b})}),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(b=>{this.setUpPageApi_(b)})}get pages(){return this.controller_.pageSet.items.map(c=>{const p=this.pageApiMap_.get(c);if(!p)throw m.shouldNeverHappen();return p})}addPage(c){const p=this.controller_.view.element.ownerDocument,b=new Yn(p,{itemProps:k.fromObject({selected:!1,title:c.title}),props:k.fromObject({selected:!1})});this.controller_.add(b,c.index);const P=this.pageApiMap_.get(b);if(!P)throw m.shouldNeverHappen();return P}removePage(c){this.controller_.remove(c)}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}setUpPageApi_(c){const p=this.rackApi_.apiSet_.find(P=>P.controller_===c.contentController);if(!p)throw m.shouldNeverHappen();const b=new We(c,p);this.pageApiMap_.set(c,b)}onPageAdd_(c){this.setUpPageApi_(c.item)}onPageRemove_(c){if(!this.pageApiMap_.get(c.item))throw m.shouldNeverHappen();this.pageApiMap_.delete(c.item)}}const un=y("tab");class Ty{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(un(),Ht()),p.viewProps.bindClassModifiers(this.element),M(p.empty,R(this.element,un(void 0,"nop")));const b=c.createElement("div");b.classList.add(un("i")),this.element.appendChild(b),this.itemsElement=b;const P=p.contentsElement;P.classList.add(un("c")),this.element.appendChild(P),this.contentsElement=P}}class hm extends no{constructor(c,p){const b=new lt(c,{blade:p.blade,viewProps:p.viewProps}),P=B(!0);super({blade:p.blade,rackController:b,view:new Ty(c,{contentsElement:b.view.element,empty:P,viewProps:p.viewProps})});this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new re(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=P,this.applyPages_()}get pageSet(){return this.pageSet_}add(c,p){this.pageSet_.add(c,p!=null?p:this.pageSet_.items.length)}remove(c){this.pageSet_.remove(this.pageSet_.items[c])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=this.pageSet_.items.length===0}onPageAdd_(c){const p=c.item;Et(this.view.itemsElement,p.itemController.view.element,c.index),this.rackController.rack.add(p.contentController,c.index),p.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(c){const p=c.item;St(p.itemController.view.element),this.rackController.rack.remove(p.contentController),p.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(this.pageSet_.items.length===0)return;const c=this.pageSet_.items.findIndex(p=>p.props.get("selected"));c<0?this.pageSet_.items.forEach((p,b)=>{p.props.set("selected",b===0)}):this.pageSet_.items.forEach((p,b)=>{p.props.set("selected",b===c)})}onPageSelectedChange_(c){if(c.rawValue){const p=this.pageSet_.items.findIndex(b=>b.props.value("selected")===c.sender);this.pageSet_.items.forEach((b,P)=>{b.props.set("selected",P===p)})}else this.keepSelection_()}}const um={id:"tab",type:"blade",accept(g){const c=st,p=rt(g,{pages:c.required.array(c.required.object({title:c.required.string})),view:c.required.constant("tab")});return!p||p.pages.length===0?null:{params:p}},controller(g){const c=new hm(g.document,{blade:g.blade,viewProps:g.viewProps});return g.params.pages.forEach(p=>{const b=new Yn(g.document,{itemProps:k.fromObject({selected:!1,title:p.title}),props:k.fromObject({selected:!1})});c.add(b)}),c},api(g){return g.controller instanceof hm?new ys(g.controller,g.pool):null}};function Ey(g,c){const p=g.accept(c.params);if(!p)return null;const b=st.optional.boolean(c.params.disabled).value,P=st.optional.boolean(c.params.hidden).value;return g.controller({blade:W(),document:c.document,params:h(Object.assign(Object.assign({},p.params),{disabled:b,hidden:P})),viewProps:ue.create({disabled:b,hidden:P})})}class Cy{constructor(){this.disabled=!1,this.emitter=new w}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Ay{constructor(c,p){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=c,this.emitter=new w,this.interval_=p,this.setTimer_()}get disabled(){return this.disabled_}set disabled(c){this.disabled_=c,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const c=this.doc_.defaultView;c&&c.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const c=this.doc_.defaultView;c&&(this.timerId_=c.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class _r{constructor(c){this.constraints=c}constrain(c){return this.constraints.reduce((p,b)=>b.constrain(p),c)}}function Pi(g,c){if(g instanceof c)return g;if(g instanceof _r){const p=g.constraints.reduce((b,P)=>b||(P instanceof c?P:null),null);if(p)return p}return null}class za{constructor(c){this.options=c}constrain(c){const p=this.options;return p.length===0||p.filter(P=>P.value===c).length>0?c:p[0].value}}class Vn{constructor(c){this.maxValue=c.max,this.minValue=c.min}constrain(c){let p=c;return u(this.minValue)||(p=Math.max(p,this.minValue)),u(this.maxValue)||(p=Math.min(p,this.maxValue)),p}}class vr{constructor(c){this.step=c}constrain(c){return(c<0?-Math.round(-c/this.step):Math.round(c/this.step))*this.step}}const Ou=y("lst");class Py{constructor(c,p){this.onValueChange_=this.onValueChange_.bind(this),this.props_=p.props,this.element=c.createElement("div"),this.element.classList.add(Ou()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("select");b.classList.add(Ou("s")),E(this.props_,"options",q=>{Nt(b),q.forEach((Y,yt)=>{const zt=c.createElement("option");zt.dataset.index=String(yt),zt.textContent=Y.text,zt.value=String(Y.value),b.appendChild(zt)})}),p.viewProps.bindDisabled(b),this.element.appendChild(b),this.selectElement=b;const P=c.createElement("div");P.classList.add(Ou("m")),P.appendChild(Ct(c,"dropdown")),this.element.appendChild(P),p.value.emitter.on("change",this.onValueChange_),this.value_=p.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Va{constructor(c,p){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=p.props,this.value=p.value,this.viewProps=p.viewProps,this.view=new Py(c,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(c){const b=h(c.currentTarget).selectedOptions.item(0);if(!b)return;const P=Number(b.dataset.index);this.value.rawValue=this.props.get("options")[P].value}}const dm=y("pop");class Ry{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(dm()),p.viewProps.bindClassModifiers(this.element),M(p.shows,R(this.element,dm(void 0,"v")))}}class pm{constructor(c,p){this.shows=B(!1),this.viewProps=p.viewProps,this.view=new Ry(c,{shows:this.shows,viewProps:this.viewProps})}}const fm=y("txt");class Dy{constructor(c,p){this.onChange_=this.onChange_.bind(this),this.element=c.createElement("div"),this.element.classList.add(fm()),p.viewProps.bindClassModifiers(this.element),this.props_=p.props,this.props_.emitter.on("change",this.onChange_);const b=c.createElement("input");b.classList.add(fm("i")),b.type="text",p.viewProps.bindDisabled(b),this.element.appendChild(b),this.inputElement=b,p.value.emitter.on("change",this.onChange_),this.value_=p.value,this.refresh()}refresh(){const c=this.props_.get("formatter");this.inputElement.value=c(this.value_.rawValue)}onChange_(){this.refresh()}}class bc{constructor(c,p){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=p.parser,this.props=p.props,this.value=p.value,this.viewProps=p.viewProps,this.view=new Dy(c,{props:p.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(c){const b=h(c.currentTarget).value,P=this.parser_(b);u(P)||(this.value.rawValue=P),this.view.refresh()}}function Ly(g){return String(g)}function mm(g){return g==="false"?!1:!!g}function gm(g){return Ly(g)}class ky{constructor(c){this.text=c}evaluate(){return Number(this.text)}toString(){return this.text}}const Iy={"**":(g,c)=>Math.pow(g,c),"*":(g,c)=>g*c,"/":(g,c)=>g/c,"%":(g,c)=>g%c,"+":(g,c)=>g+c,"-":(g,c)=>g-c,"<<":(g,c)=>g<<c,">>":(g,c)=>g>>c,">>>":(g,c)=>g>>>c,"&":(g,c)=>g&c,"^":(g,c)=>g^c,"|":(g,c)=>g|c};class Ny{constructor(c,p,b){this.left=p,this.operator=c,this.right=b}evaluate(){const c=Iy[this.operator];if(!c)throw new Error(`unexpected binary operator: '${this.operator}`);return c(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Fy={"+":g=>g,"-":g=>-g,"~":g=>~g};class Oy{constructor(c,p){this.operator=c,this.expression=p}evaluate(){const c=Fy[this.operator];if(!c)throw new Error(`unexpected unary operator: '${this.operator}`);return c(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function zu(g){return(c,p)=>{for(let b=0;b<g.length;b++){const P=g[b](c,p);if(P!=="")return P}return""}}function Ba(g,c){var p;const b=g.substr(c).match(/^\s+/);return(p=b&&b[0])!==null&&p!==void 0?p:""}function zy(g,c){const p=g.substr(c,1);return p.match(/^[1-9]$/)?p:""}function Ua(g,c){var p;const b=g.substr(c).match(/^[0-9]+/);return(p=b&&b[0])!==null&&p!==void 0?p:""}function Vy(g,c){const p=Ua(g,c);if(p!=="")return p;const b=g.substr(c,1);if(c+=1,b!=="-"&&b!=="+")return"";const P=Ua(g,c);return P===""?"":b+P}function Vu(g,c){const p=g.substr(c,1);if(c+=1,p.toLowerCase()!=="e")return"";const b=Vy(g,c);return b===""?"":p+b}function _m(g,c){const p=g.substr(c,1);if(p==="0")return p;const b=zy(g,c);return c+=b.length,b===""?"":b+Ua(g,c)}function By(g,c){const p=_m(g,c);if(c+=p.length,p==="")return"";const b=g.substr(c,1);if(c+=b.length,b!==".")return"";const P=Ua(g,c);return c+=P.length,p+b+P+Vu(g,c)}function Uy(g,c){const p=g.substr(c,1);if(c+=p.length,p!==".")return"";const b=Ua(g,c);return c+=b.length,b===""?"":p+b+Vu(g,c)}function Hy(g,c){const p=_m(g,c);return c+=p.length,p===""?"":p+Vu(g,c)}const Wy=zu([By,Uy,Hy]);function Gy(g,c){var p;const b=g.substr(c).match(/^[01]+/);return(p=b&&b[0])!==null&&p!==void 0?p:""}function qy(g,c){const p=g.substr(c,2);if(c+=p.length,p.toLowerCase()!=="0b")return"";const b=Gy(g,c);return b===""?"":p+b}function jy(g,c){var p;const b=g.substr(c).match(/^[0-7]+/);return(p=b&&b[0])!==null&&p!==void 0?p:""}function $y(g,c){const p=g.substr(c,2);if(c+=p.length,p.toLowerCase()!=="0o")return"";const b=jy(g,c);return b===""?"":p+b}function Xy(g,c){var p;const b=g.substr(c).match(/^[0-9a-f]+/i);return(p=b&&b[0])!==null&&p!==void 0?p:""}function Yy(g,c){const p=g.substr(c,2);if(c+=p.length,p.toLowerCase()!=="0x")return"";const b=Xy(g,c);return b===""?"":p+b}const Zy=zu([qy,$y,Yy]),Jy=zu([Zy,Wy]);function Ky(g,c){const p=Jy(g,c);return c+=p.length,p===""?null:{evaluable:new ky(p),cursor:c}}function Qy(g,c){const p=g.substr(c,1);if(c+=p.length,p!=="(")return null;const b=xm(g,c);if(!b)return null;c=b.cursor,c+=Ba(g,c).length;const P=g.substr(c,1);return c+=P.length,P!==")"?null:{evaluable:b.evaluable,cursor:c}}function tb(g,c){return Ky(g,c)||Qy(g,c)}function vm(g,c){const p=tb(g,c);if(p)return p;const b=g.substr(c,1);if(c+=b.length,b!=="+"&&b!=="-"&&b!=="~")return null;const P=vm(g,c);return P?(c=P.cursor,{cursor:c,evaluable:new Oy(b,P.evaluable)}):null}function eb(g,c,p){p+=Ba(c,p).length;const b=g.filter(P=>c.startsWith(P,p))[0];return b?(p+=b.length,p+=Ba(c,p).length,{cursor:p,operator:b}):null}function nb(g,c){return(p,b)=>{const P=g(p,b);if(!P)return null;b=P.cursor;let q=P.evaluable;for(;;){const Y=eb(c,p,b);if(!Y)break;b=Y.cursor;const yt=g(p,b);if(!yt)return null;b=yt.cursor,q=new Ny(Y.operator,q,yt.evaluable)}return q?{cursor:b,evaluable:q}:null}}const ib=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((g,c)=>nb(g,c),vm);function xm(g,c){return c+=Ba(g,c).length,ib(g,c)}function sb(g){const c=xm(g,0);return!c||c.cursor+Ba(g,c.cursor).length!==g.length?null:c.evaluable}function Yi(g){var c;const p=sb(g);return(c=p==null?void 0:p.evaluate())!==null&&c!==void 0?c:null}function ym(g){if(typeof g=="number")return g;if(typeof g=="string"){const c=Yi(g);if(!u(c))return c}return 0}function rb(g){return String(g)}function Sn(g){return c=>c.toFixed(Math.max(Math.min(g,20),0))}const ob=Sn(0);function wc(g){return ob(g)+"%"}function bm(g){return String(g)}function Bu(g){return g}function wm(g,c){for(;g.length<c;)g.push(void 0)}function ab(g){const c=[];return wm(c,g),B(c)}function lb(g){const c=g.indexOf(void 0);return h(c<0?g:g.slice(0,c))}function cb(g,c){const p=[...lb(g),c];return p.length>g.length?p.splice(0,p.length-g.length):wm(p,g.length),p}function Ha({primary:g,secondary:c,forward:p,backward:b}){let P=!1;function q(Y){P||(P=!0,Y(),P=!1)}g.emitter.on("change",Y=>{q(()=>{c.setRawValue(p(g,c),Y.options)})}),c.emitter.on("change",Y=>{q(()=>{g.setRawValue(b(g,c),Y.options)}),q(()=>{c.setRawValue(p(g,c),Y.options)})}),q(()=>{c.setRawValue(p(g,c),{forceEmit:!1,last:!0})})}function Tn(g,c){const p=g*(c.altKey?.1:1)*(c.shiftKey?10:1);return c.upKey?+p:c.downKey?-p:0}function Wa(g){return{altKey:g.altKey,downKey:g.key==="ArrowDown",shiftKey:g.shiftKey,upKey:g.key==="ArrowUp"}}function Zi(g){return{altKey:g.altKey,downKey:g.key==="ArrowLeft",shiftKey:g.shiftKey,upKey:g.key==="ArrowRight"}}function hb(g){return g==="ArrowUp"||g==="ArrowDown"}function Mm(g){return hb(g)||g==="ArrowLeft"||g==="ArrowRight"}function Uu(g,c){const p=c.ownerDocument.defaultView,b=c.getBoundingClientRect();return{x:g.pageX-((p&&p.scrollX||0)+b.left),y:g.pageY-((p&&p.scrollY||0)+b.top)}}class xr{constructor(c){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=c,this.emitter=new w,c.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),c.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),c.addEventListener("touchend",this.onTouchEnd_),c.addEventListener("mousedown",this.onMouseDown_)}computePosition_(c){const p=this.elem_.getBoundingClientRect();return{bounds:{width:p.width,height:p.height},point:c?{x:c.x,y:c.y}:null}}onMouseDown_(c){var p;c.preventDefault(),(p=c.currentTarget)===null||p===void 0||p.focus();const b=this.elem_.ownerDocument;b.addEventListener("mousemove",this.onDocumentMouseMove_),b.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:c.altKey,data:this.computePosition_(Uu(c,this.elem_)),sender:this,shiftKey:c.shiftKey})}onDocumentMouseMove_(c){this.emitter.emit("move",{altKey:c.altKey,data:this.computePosition_(Uu(c,this.elem_)),sender:this,shiftKey:c.shiftKey})}onDocumentMouseUp_(c){const p=this.elem_.ownerDocument;p.removeEventListener("mousemove",this.onDocumentMouseMove_),p.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:c.altKey,data:this.computePosition_(Uu(c,this.elem_)),sender:this,shiftKey:c.shiftKey})}onTouchStart_(c){c.preventDefault();const p=c.targetTouches.item(0),b=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:c.altKey,data:this.computePosition_(p?{x:p.clientX-b.left,y:p.clientY-b.top}:void 0),sender:this,shiftKey:c.shiftKey}),this.lastTouch_=p}onTouchMove_(c){const p=c.targetTouches.item(0),b=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:c.altKey,data:this.computePosition_(p?{x:p.clientX-b.left,y:p.clientY-b.top}:void 0),sender:this,shiftKey:c.shiftKey}),this.lastTouch_=p}onTouchEnd_(c){var p;const b=(p=c.targetTouches.item(0))!==null&&p!==void 0?p:this.lastTouch_,P=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:c.altKey,data:this.computePosition_(b?{x:b.clientX-P.left,y:b.clientY-P.top}:void 0),sender:this,shiftKey:c.shiftKey})}}function Ce(g,c,p,b,P){const q=(g-c)/(p-c);return b+q*(P-b)}function Sm(g){return String(g.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ae(g,c,p){return Math.min(Math.max(g,c),p)}function Hu(g,c){return(g%c+c)%c}const Zn=y("txt");class ub{constructor(c,p){this.onChange_=this.onChange_.bind(this),this.props_=p.props,this.props_.emitter.on("change",this.onChange_),this.element=c.createElement("div"),this.element.classList.add(Zn(),Zn(void 0,"num")),p.arrayPosition&&this.element.classList.add(Zn(void 0,p.arrayPosition)),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("input");b.classList.add(Zn("i")),b.type="text",p.viewProps.bindDisabled(b),this.element.appendChild(b),this.inputElement=b,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=p.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Zn()),this.inputElement.classList.add(Zn("i"));const P=c.createElement("div");P.classList.add(Zn("k")),this.element.appendChild(P),this.knobElement=P;const q=c.createElementNS(wt,"svg");q.classList.add(Zn("g")),this.knobElement.appendChild(q);const Y=c.createElementNS(wt,"path");Y.classList.add(Zn("gb")),q.appendChild(Y),this.guideBodyElem_=Y;const yt=c.createElementNS(wt,"path");yt.classList.add(Zn("gh")),q.appendChild(yt),this.guideHeadElem_=yt;const zt=c.createElement("div");zt.classList.add(y("tt")()),this.knobElement.appendChild(zt),this.tooltipElem_=zt,p.value.emitter.on("change",this.onChange_),this.value=p.value,this.refresh()}onDraggingChange_(c){if(c.rawValue===null){this.element.classList.remove(Zn(void 0,"drg"));return}this.element.classList.add(Zn(void 0,"drg"));const p=c.rawValue/this.props_.get("draggingScale"),b=p+(p>0?-1:p<0?1:0),P=Ae(-b,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${b+P},0 L${b},4 L${b+P},8`,`M ${p},-1 L${p},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${p},4`);const q=this.props_.get("formatter");this.tooltipElem_.textContent=q(this.value.rawValue),this.tooltipElem_.style.left=`${p}px`}refresh(){const c=this.props_.get("formatter");this.inputElement.value=c(this.value.rawValue)}onChange_(){this.refresh()}}class Ga{constructor(c,p){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=p.baseStep,this.parser_=p.parser,this.props=p.props,this.value=p.value,this.viewProps=p.viewProps,this.dragging_=B(null),this.view=new ub(c,{arrayPosition:p.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const b=new xr(this.view.knobElement);b.emitter.on("down",this.onPointerDown_),b.emitter.on("move",this.onPointerMove_),b.emitter.on("up",this.onPointerUp_)}onInputChange_(c){const b=h(c.currentTarget).value,P=this.parser_(b);u(P)||(this.value.rawValue=P),this.view.refresh()}onInputKeyDown_(c){const p=Tn(this.baseStep_,Wa(c));p!==0&&this.value.setRawValue(this.value.rawValue+p,{forceEmit:!1,last:!1})}onInputKeyUp_(c){Tn(this.baseStep_,Wa(c))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(c){if(!c.point)return null;const p=c.point.x-c.bounds.width/2;return this.originRawValue_+p*this.props.get("draggingScale")}onPointerMove_(c){const p=this.computeDraggingValue_(c.data);p!==null&&(this.value.setRawValue(p,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(c){const p=this.computeDraggingValue_(c.data);p!==null&&(this.value.setRawValue(p,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Wu=y("sld");class db{constructor(c,p){this.onChange_=this.onChange_.bind(this),this.props_=p.props,this.props_.emitter.on("change",this.onChange_),this.element=c.createElement("div"),this.element.classList.add(Wu()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("div");b.classList.add(Wu("t")),p.viewProps.bindTabIndex(b),this.element.appendChild(b),this.trackElement=b;const P=c.createElement("div");P.classList.add(Wu("k")),this.trackElement.appendChild(P),this.knobElement=P,p.value.emitter.on("change",this.onChange_),this.value=p.value,this.update_()}update_(){const c=Ae(Ce(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${c}%`}onChange_(){this.update_()}}class pb{constructor(c,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=p.baseStep,this.value=p.value,this.viewProps=p.viewProps,this.props=p.props,this.view=new db(c,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xr(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(c,p){!c.point||this.value.setRawValue(Ce(Ae(c.point.x,0,c.bounds.width),0,c.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),p)}onPointerDownOrMove_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerUp_(c){this.handlePointerEvent_(c.data,{forceEmit:!0,last:!0})}onKeyDown_(c){const p=Tn(this.baseStep_,Zi(c));p!==0&&this.value.setRawValue(this.value.rawValue+p,{forceEmit:!1,last:!1})}onKeyUp_(c){Tn(this.baseStep_,Zi(c))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Gu=y("sldtxt");class fb{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(Gu());const b=c.createElement("div");b.classList.add(Gu("s")),this.sliderView_=p.sliderView,b.appendChild(this.sliderView_.element),this.element.appendChild(b);const P=c.createElement("div");P.classList.add(Gu("t")),this.textView_=p.textView,P.appendChild(this.textView_.element),this.element.appendChild(P)}}class qu{constructor(c,p){this.value=p.value,this.viewProps=p.viewProps,this.sliderC_=new pb(c,{baseStep:p.baseStep,props:p.sliderProps,value:p.value,viewProps:this.viewProps}),this.textC_=new Ga(c,{baseStep:p.baseStep,parser:p.parser,props:p.textProps,value:p.value,viewProps:p.viewProps}),this.view=new fb(c,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function qa(g,c){g.write(c)}function Mc(g){const c=st;if(Array.isArray(g))return c.required.array(c.required.object({text:c.required.string,value:c.required.raw}))(g).value;if(typeof g=="object")return c.required.raw(g).value}function Tm(g){if(g==="inline"||g==="popup")return g}function bs(g){const c=st;return c.required.object({max:c.optional.number,min:c.optional.number,step:c.optional.number})(g).value}function Em(g){if(Array.isArray(g))return g;const c=[];return Object.keys(g).forEach(p=>{c.push({text:p,value:g[p]})}),c}function ju(g){return u(g)?null:new za(Em(h(g)))}function $u(g){const c=g?Pi(g,za):null;return c?c.options:null}function mb(g){const c=g?Pi(g,vr):null;return c?c.step:null}function Sc(g,c){const p=g&&Pi(g,vr);return p?Sm(p.step):Math.max(Sm(c),2)}function so(g){const c=mb(g);return c!=null?c:1}function ro(g,c){var p;const b=g&&Pi(g,vr),P=Math.abs((p=b==null?void 0:b.step)!==null&&p!==void 0?p:c);return P===0?.1:Math.pow(10,Math.floor(Math.log10(P))-1)}const Tc=y("ckb");class gb{constructor(c,p){this.onValueChange_=this.onValueChange_.bind(this),this.element=c.createElement("div"),this.element.classList.add(Tc()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("label");b.classList.add(Tc("l")),this.element.appendChild(b);const P=c.createElement("input");P.classList.add(Tc("i")),P.type="checkbox",b.appendChild(P),this.inputElement=P,p.viewProps.bindDisabled(this.inputElement);const q=c.createElement("div");q.classList.add(Tc("w")),b.appendChild(q);const Y=Ct(c,"check");q.appendChild(Y),p.value.emitter.on("change",this.onValueChange_),this.value=p.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class _b{constructor(c,p){this.onInputChange_=this.onInputChange_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new gb(c,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(c){const p=h(c.currentTarget);this.value.rawValue=p.checked}}function vb(g){const c=[],p=ju(g.options);return p&&c.push(p),new _r(c)}const xb={id:"input-bool",type:"input",accept:(g,c)=>{if(typeof g!="boolean")return null;const b=rt(c,{options:st.optional.custom(Mc)});return b?{initialValue:g,params:b}:null},binding:{reader:g=>mm,constraint:g=>vb(g.params),writer:g=>qa},controller:g=>{var c;const p=g.document,b=g.value,P=g.constraint;return P&&Pi(P,za)?new Va(p,{props:k.fromObject({options:(c=$u(P))!==null&&c!==void 0?c:[]}),value:b,viewProps:g.viewProps}):new _b(p,{value:b,viewProps:g.viewProps})}},yr=y("col");class yb{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(yr()),p.foldable.bindExpandedClass(this.element,yr(void 0,"expanded")),E(p.foldable,"completed",R(this.element,yr(void 0,"cpl")));const b=c.createElement("div");b.classList.add(yr("h")),this.element.appendChild(b);const P=c.createElement("div");P.classList.add(yr("s")),b.appendChild(P),this.swatchElement=P;const q=c.createElement("div");if(q.classList.add(yr("t")),b.appendChild(q),this.textElement=q,p.pickerLayout==="inline"){const Y=c.createElement("div");Y.classList.add(yr("p")),this.element.appendChild(Y),this.pickerElement=Y}else this.pickerElement=null}}function bb(g,c,p){const b=Ae(g/255,0,1),P=Ae(c/255,0,1),q=Ae(p/255,0,1),Y=Math.max(b,P,q),yt=Math.min(b,P,q),zt=Y-yt;let $t=0,oe=0;const ae=(yt+Y)/2;return zt!==0&&(oe=zt/(1-Math.abs(Y+yt-1)),b===Y?$t=(P-q)/zt:P===Y?$t=2+(q-b)/zt:$t=4+(b-P)/zt,$t=$t/6+($t<0?1:0)),[$t*360,oe*100,ae*100]}function wb(g,c,p){const b=(g%360+360)%360,P=Ae(c/100,0,1),q=Ae(p/100,0,1),Y=(1-Math.abs(2*q-1))*P,yt=Y*(1-Math.abs(b/60%2-1)),zt=q-Y/2;let $t,oe,ae;return b>=0&&b<60?[$t,oe,ae]=[Y,yt,0]:b>=60&&b<120?[$t,oe,ae]=[yt,Y,0]:b>=120&&b<180?[$t,oe,ae]=[0,Y,yt]:b>=180&&b<240?[$t,oe,ae]=[0,yt,Y]:b>=240&&b<300?[$t,oe,ae]=[yt,0,Y]:[$t,oe,ae]=[Y,0,yt],[($t+zt)*255,(oe+zt)*255,(ae+zt)*255]}function Mb(g,c,p){const b=Ae(g/255,0,1),P=Ae(c/255,0,1),q=Ae(p/255,0,1),Y=Math.max(b,P,q),yt=Math.min(b,P,q),zt=Y-yt;let $t;zt===0?$t=0:Y===b?$t=60*(((P-q)/zt%6+6)%6):Y===P?$t=60*((q-b)/zt+2):$t=60*((b-P)/zt+4);const oe=Y===0?0:zt/Y,ae=Y;return[$t,oe*100,ae*100]}function Cm(g,c,p){const b=Hu(g,360),P=Ae(c/100,0,1),q=Ae(p/100,0,1),Y=q*P,yt=Y*(1-Math.abs(b/60%2-1)),zt=q-Y;let $t,oe,ae;return b>=0&&b<60?[$t,oe,ae]=[Y,yt,0]:b>=60&&b<120?[$t,oe,ae]=[yt,Y,0]:b>=120&&b<180?[$t,oe,ae]=[0,Y,yt]:b>=180&&b<240?[$t,oe,ae]=[0,yt,Y]:b>=240&&b<300?[$t,oe,ae]=[yt,0,Y]:[$t,oe,ae]=[Y,0,yt],[($t+zt)*255,(oe+zt)*255,(ae+zt)*255]}function Sb(g,c,p){const b=p+c*(100-Math.abs(2*p-100))/(2*100);return[g,b!==0?c*(100-Math.abs(2*p-100))/b:0,p+c*(100-Math.abs(2*p-100))/(2*100)]}function Tb(g,c,p){const b=100-Math.abs(p*(200-c)/100-100);return[g,b!==0?c*p/b:0,p*(200-c)/(2*100)]}function oo(g){return[g[0],g[1],g[2]]}function Am(g,c){return[g[0],g[1],g[2],c]}const Eb={hsl:{hsl:(g,c,p)=>[g,c,p],hsv:Sb,rgb:wb},hsv:{hsl:Tb,hsv:(g,c,p)=>[g,c,p],rgb:Cm},rgb:{hsl:bb,hsv:Mb,rgb:(g,c,p)=>[g,c,p]}};function Cb(g,c,p){return Eb[c][p](...g)}const Ab={hsl:g=>{var c;return[Hu(g[0],360),Ae(g[1],0,100),Ae(g[2],0,100),Ae((c=g[3])!==null&&c!==void 0?c:1,0,1)]},hsv:g=>{var c;return[Hu(g[0],360),Ae(g[1],0,100),Ae(g[2],0,100),Ae((c=g[3])!==null&&c!==void 0?c:1,0,1)]},rgb:g=>{var c;return[Ae(g[0],0,255),Ae(g[1],0,255),Ae(g[2],0,255),Ae((c=g[3])!==null&&c!==void 0?c:1,0,1)]}};function Ec(g,c){return typeof g!="object"||u(g)?!1:c in g&&typeof g[c]=="number"}class ee{constructor(c,p){this.mode_=p,this.comps_=Ab[p](c)}static black(){return new ee([0,0,0],"rgb")}static fromObject(c){const p="a"in c?[c.r,c.g,c.b,c.a]:[c.r,c.g,c.b];return new ee(p,"rgb")}static toRgbaObject(c){return c.toRgbaObject()}static isRgbColorObject(c){return Ec(c,"r")&&Ec(c,"g")&&Ec(c,"b")}static isRgbaColorObject(c){return this.isRgbColorObject(c)&&Ec(c,"a")}static isColorObject(c){return this.isRgbColorObject(c)}static equals(c,p){if(c.mode_!==p.mode_)return!1;const b=c.comps_,P=p.comps_;for(let q=0;q<b.length;q++)if(b[q]!==P[q])return!1;return!0}get mode(){return this.mode_}getComponents(c){return Am(Cb(oo(this.comps_),this.mode_,c||this.mode_),this.comps_[3])}toRgbaObject(){const c=this.getComponents("rgb");return{r:c[0],g:c[1],b:c[2],a:c[3]}}}const ws=y("colp");class Pb{constructor(c,p){this.alphaViews_=null,this.element=c.createElement("div"),this.element.classList.add(ws());const b=c.createElement("div");b.classList.add(ws("hsv"));const P=c.createElement("div");P.classList.add(ws("sv")),this.svPaletteView_=p.svPaletteView,P.appendChild(this.svPaletteView_.element),b.appendChild(P);const q=c.createElement("div");q.classList.add(ws("h")),this.hPaletteView_=p.hPaletteView,q.appendChild(this.hPaletteView_.element),b.appendChild(q),this.element.appendChild(b);const Y=c.createElement("div");if(Y.classList.add(ws("rgb")),this.textView_=p.textView,Y.appendChild(this.textView_.element),this.element.appendChild(Y),p.alphaViews){this.alphaViews_={palette:p.alphaViews.palette,text:p.alphaViews.text};const yt=c.createElement("div");yt.classList.add(ws("a"));const zt=c.createElement("div");zt.classList.add(ws("ap")),zt.appendChild(this.alphaViews_.palette.element),yt.appendChild(zt);const $t=c.createElement("div");$t.classList.add(ws("at")),$t.appendChild(this.alphaViews_.text.element),yt.appendChild($t),this.element.appendChild(yt)}}get allFocusableElements(){const c=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(p=>p.inputElement)];return this.alphaViews_&&c.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),c}}function Xu(g){const c=st;return rt(g,{alpha:c.optional.boolean,expanded:c.optional.boolean,picker:c.optional.custom(Tm)})}function br(g){return g?.1:1}function Jn(g,c){const p=g.match(/^(.+)%$/);return Math.min(p?parseFloat(p[1])*.01*c:parseFloat(g),c)}const Rb={deg:g=>g,grad:g=>g*360/400,rad:g=>g*360/(2*Math.PI),turn:g=>g*360};function Pm(g){const c=g.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!c)return parseFloat(g);const p=parseFloat(c[1]),b=c[2];return Rb[b](p)}const Yu={"func.rgb":g=>{const c=g.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!c)return null;const p=[Jn(c[1],255),Jn(c[2],255),Jn(c[3],255)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])?null:new ee(p,"rgb")},"func.rgba":g=>{const c=g.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!c)return null;const p=[Jn(c[1],255),Jn(c[2],255),Jn(c[3],255),Jn(c[4],1)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])||isNaN(p[3])?null:new ee(p,"rgb")},"func.hsl":g=>{const c=g.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!c)return null;const p=[Pm(c[1]),Jn(c[2],100),Jn(c[3],100)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])?null:new ee(p,"hsl")},"func.hsla":g=>{const c=g.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!c)return null;const p=[Pm(c[1]),Jn(c[2],100),Jn(c[3],100),Jn(c[4],1)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])||isNaN(p[3])?null:new ee(p,"hsl")},"hex.rgb":g=>{const c=g.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(c)return new ee([parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)],"rgb");const p=g.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return p?new ee([parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)],"rgb"):null},"hex.rgba":g=>{const c=g.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(c)return new ee([parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16),Ce(parseInt(c[4]+c[4],16),0,255,0,1)],"rgb");const p=g.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return p?new ee([parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16),Ce(parseInt(p[4],16),0,255,0,1)],"rgb"):null}};function Cc(g){return Object.keys(Yu).reduce((p,b)=>p||(Yu[b](g)?b:null),null)}const Ac=g=>{const c=Cc(g);return c?Yu[c](g):null};function Db(g){return g==="func.hsla"||g==="func.rgba"||g==="hex.rgba"}function Lb(g){if(typeof g=="string"){const c=Ac(g);if(c)return c}return ee.black()}function Rm(g){const c=Ae(Math.floor(g),0,255).toString(16);return c.length===1?`0${c}`:c}function Zu(g,c="#"){const p=oo(g.getComponents("rgb")).map(Rm).join("");return`${c}${p}`}function Pc(g,c="#"){const p=g.getComponents("rgb"),b=[p[0],p[1],p[2],p[3]*255].map(Rm).join("");return`${c}${b}`}function Dm(g){const c=Sn(0);return`rgb(${oo(g.getComponents("rgb")).map(b=>c(b)).join(", ")})`}function Rc(g){const c=Sn(2),p=Sn(0);return`rgba(${g.getComponents("rgb").map((P,q)=>(q===3?c:p)(P)).join(", ")})`}function kb(g){const c=[Sn(0),wc,wc];return`hsl(${oo(g.getComponents("hsl")).map((b,P)=>c[P](b)).join(", ")})`}function Ib(g){const c=[Sn(0),wc,wc,Sn(2)];return`hsla(${g.getComponents("hsl").map((b,P)=>c[P](b)).join(", ")})`}const Nb={"func.hsl":kb,"func.hsla":Ib,"func.rgb":Dm,"func.rgba":Rc,"hex.rgb":Zu,"hex.rgba":Pc};function Lm(g){return Nb[g]}const ja=y("apl");class Fb{constructor(c,p){this.onValueChange_=this.onValueChange_.bind(this),this.value=p.value,this.value.emitter.on("change",this.onValueChange_),this.element=c.createElement("div"),this.element.classList.add(ja()),p.viewProps.bindTabIndex(this.element);const b=c.createElement("div");b.classList.add(ja("b")),this.element.appendChild(b);const P=c.createElement("div");P.classList.add(ja("c")),b.appendChild(P),this.colorElem_=P;const q=c.createElement("div");q.classList.add(ja("m")),this.element.appendChild(q),this.markerElem_=q;const Y=c.createElement("div");Y.classList.add(ja("p")),this.markerElem_.appendChild(Y),this.previewElem_=Y,this.update_()}update_(){const c=this.value.rawValue,p=c.getComponents("rgb"),b=new ee([p[0],p[1],p[2],0],"rgb"),P=new ee([p[0],p[1],p[2],255],"rgb"),q=["to right",Rc(b),Rc(P)];this.colorElem_.style.background=`linear-gradient(${q.join(",")})`,this.previewElem_.style.backgroundColor=Rc(c);const Y=Ce(p[3],0,1,0,100);this.markerElem_.style.left=`${Y}%`}onValueChange_(){this.update_()}}class Ob{constructor(c,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new Fb(c,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xr(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(c,p){if(!c.point)return;const b=c.point.x/c.bounds.width,P=this.value.rawValue,[q,Y,yt]=P.getComponents("hsv");this.value.setRawValue(new ee([q,Y,yt,b],"hsv"),p)}onPointerDown_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerMove_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerUp_(c){this.handlePointerEvent_(c.data,{forceEmit:!0,last:!0})}onKeyDown_(c){const p=Tn(br(!0),Zi(c));if(p===0)return;const b=this.value.rawValue,[P,q,Y,yt]=b.getComponents("hsv");this.value.setRawValue(new ee([P,q,Y,yt+p],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(c){Tn(br(!0),Zi(c))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ao=y("coltxt");function zb(g){const c=g.createElement("select"),p=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return c.appendChild(p.reduce((b,P)=>{const q=g.createElement("option");return q.textContent=P.text,q.value=P.value,b.appendChild(q),b},g.createDocumentFragment())),c}class Vb{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(ao());const b=c.createElement("div");b.classList.add(ao("m")),this.modeElem_=zb(c),this.modeElem_.classList.add(ao("ms")),b.appendChild(this.modeSelectElement);const P=c.createElement("div");P.classList.add(ao("mm")),P.appendChild(Ct(c,"dropdown")),b.appendChild(P),this.element.appendChild(b);const q=c.createElement("div");q.classList.add(ao("w")),this.element.appendChild(q),this.textsElem_=q,this.textViews_=p.textViews,this.applyTextViews_(),M(p.colorMode,Y=>{this.modeElem_.value=Y})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(c){this.textViews_=c,this.applyTextViews_()}applyTextViews_(){Nt(this.textsElem_);const c=this.element.ownerDocument;this.textViews_.forEach(p=>{const b=c.createElement("div");b.classList.add(ao("c")),b.appendChild(p.element),this.textsElem_.appendChild(b)})}}const Bb=Sn(0),Ub={rgb:()=>new Vn({min:0,max:255}),hsl:g=>g===0?new Vn({min:0,max:360}):new Vn({min:0,max:100}),hsv:g=>g===0?new Vn({min:0,max:360}):new Vn({min:0,max:100})};function Ju(g,c,p){return new Ga(g,{arrayPosition:p===0?"fst":p===3-1?"lst":"mid",baseStep:br(!1),parser:c.parser,props:k.fromObject({draggingScale:1,formatter:Bb}),value:B(0,{constraint:Ub[c.colorMode](p)}),viewProps:c.viewProps})}class Hb{constructor(c,p){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=p.parser,this.value=p.value,this.viewProps=p.viewProps,this.colorMode=B(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(c),this.view=new Vb(c,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(c){const p={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},b=[Ju(c,p,0),Ju(c,p,1),Ju(c,p,2)];return b.forEach((P,q)=>{Ha({primary:this.value,secondary:P.value,forward:Y=>Y.rawValue.getComponents(this.colorMode.rawValue)[q],backward:(Y,yt)=>{const zt=this.colorMode.rawValue,$t=Y.rawValue.getComponents(zt);return $t[q]=yt.rawValue,new ee(Am(oo($t),$t[3]),zt)}})}),b}onModeSelectChange_(c){const p=c.currentTarget;this.colorMode.rawValue=p.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Ku=y("hpl");class Wb{constructor(c,p){this.onValueChange_=this.onValueChange_.bind(this),this.value=p.value,this.value.emitter.on("change",this.onValueChange_),this.element=c.createElement("div"),this.element.classList.add(Ku()),p.viewProps.bindTabIndex(this.element);const b=c.createElement("div");b.classList.add(Ku("c")),this.element.appendChild(b);const P=c.createElement("div");P.classList.add(Ku("m")),this.element.appendChild(P),this.markerElem_=P,this.update_()}update_(){const c=this.value.rawValue,[p]=c.getComponents("hsv");this.markerElem_.style.backgroundColor=Dm(new ee([p,100,100],"hsv"));const b=Ce(p,0,360,0,100);this.markerElem_.style.left=`${b}%`}onValueChange_(){this.update_()}}class Gb{constructor(c,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new Wb(c,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xr(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(c,p){if(!c.point)return;const b=Ce(c.point.x,0,c.bounds.width,0,360),P=this.value.rawValue,[,q,Y,yt]=P.getComponents("hsv");this.value.setRawValue(new ee([b,q,Y,yt],"hsv"),p)}onPointerDown_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerMove_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerUp_(c){this.handlePointerEvent_(c.data,{forceEmit:!0,last:!0})}onKeyDown_(c){const p=Tn(br(!1),Zi(c));if(p===0)return;const b=this.value.rawValue,[P,q,Y,yt]=b.getComponents("hsv");this.value.setRawValue(new ee([P+p,q,Y,yt],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(c){Tn(br(!1),Zi(c))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Qu=y("svp"),km=64;class qb{constructor(c,p){this.onValueChange_=this.onValueChange_.bind(this),this.value=p.value,this.value.emitter.on("change",this.onValueChange_),this.element=c.createElement("div"),this.element.classList.add(Qu()),p.viewProps.bindTabIndex(this.element);const b=c.createElement("canvas");b.height=km,b.width=km,b.classList.add(Qu("c")),this.element.appendChild(b),this.canvasElement=b;const P=c.createElement("div");P.classList.add(Qu("m")),this.element.appendChild(P),this.markerElem_=P,this.update_()}update_(){const c=Z(this.canvasElement);if(!c)return;const b=this.value.rawValue.getComponents("hsv"),P=this.canvasElement.width,q=this.canvasElement.height,Y=c.getImageData(0,0,P,q),yt=Y.data;for(let oe=0;oe<q;oe++)for(let ae=0;ae<P;ae++){const wr=Ce(ae,0,P,0,100),Xa=Ce(oe,0,q,100,0),Ya=Cm(b[0],wr,Xa),uo=(oe*P+ae)*4;yt[uo]=Ya[0],yt[uo+1]=Ya[1],yt[uo+2]=Ya[2],yt[uo+3]=255}c.putImageData(Y,0,0);const zt=Ce(b[1],0,100,0,100);this.markerElem_.style.left=`${zt}%`;const $t=Ce(b[2],0,100,100,0);this.markerElem_.style.top=`${$t}%`}onValueChange_(){this.update_()}}class jb{constructor(c,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new qb(c,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xr(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(c,p){if(!c.point)return;const b=Ce(c.point.x,0,c.bounds.width,0,100),P=Ce(c.point.y,0,c.bounds.height,100,0),[q,,,Y]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ee([q,b,P,Y],"hsv"),p)}onPointerDown_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerMove_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerUp_(c){this.handlePointerEvent_(c.data,{forceEmit:!0,last:!0})}onKeyDown_(c){Mm(c.key)&&c.preventDefault();const[p,b,P,q]=this.value.rawValue.getComponents("hsv"),Y=br(!1),yt=Tn(Y,Zi(c)),zt=Tn(Y,Wa(c));yt===0&&zt===0||this.value.setRawValue(new ee([p,b+yt,P+zt,q],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(c){const p=br(!1),b=Tn(p,Zi(c)),P=Tn(p,Wa(c));b===0&&P===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class $b{constructor(c,p){this.value=p.value,this.viewProps=p.viewProps,this.hPaletteC_=new Gb(c,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new jb(c,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=p.supportsAlpha?{palette:new Ob(c,{value:this.value,viewProps:this.viewProps}),text:new Ga(c,{parser:Yi,baseStep:.1,props:k.fromObject({draggingScale:.01,formatter:Sn(2)}),value:B(0,{constraint:new Vn({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ha({primary:this.value,secondary:this.alphaIcs_.text.value,forward:b=>b.rawValue.getComponents()[3],backward:(b,P)=>{const q=b.rawValue.getComponents();return q[3]=P.rawValue,new ee(q,b.rawValue.mode)}}),this.textC_=new Hb(c,{parser:Yi,value:this.value,viewProps:this.viewProps}),this.view=new Pb(c,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:p.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const td=y("colsw");class Xb{constructor(c,p){this.onValueChange_=this.onValueChange_.bind(this),p.value.emitter.on("change",this.onValueChange_),this.value=p.value,this.element=c.createElement("div"),this.element.classList.add(td()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("div");b.classList.add(td("sw")),this.element.appendChild(b),this.swatchElem_=b;const P=c.createElement("button");P.classList.add(td("b")),p.viewProps.bindDisabled(P),this.element.appendChild(P),this.buttonElement=P,this.update_()}update_(){const c=this.value.rawValue;this.swatchElem_.style.backgroundColor=Pc(c)}onValueChange_(){this.update_()}}class Yb{constructor(c,p){this.value=p.value,this.viewProps=p.viewProps,this.view=new Xb(c,{value:this.value,viewProps:this.viewProps})}}class ed{constructor(c,p){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.foldable_=V.create(p.expanded),this.swatchC_=new Yb(c,{value:this.value,viewProps:this.viewProps});const b=this.swatchC_.view.buttonElement;b.addEventListener("blur",this.onButtonBlur_),b.addEventListener("click",this.onButtonClick_),this.textC_=new bc(c,{parser:p.parser,props:k.fromObject({formatter:p.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new yb(c,{foldable:this.foldable_,pickerLayout:p.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=p.pickerLayout==="popup"?new pm(c,{viewProps:this.viewProps}):null;const P=new $b(c,{supportsAlpha:p.supportsAlpha,value:this.value,viewProps:this.viewProps});P.view.allFocusableElements.forEach(q=>{q.addEventListener("blur",this.onPopupChildBlur_),q.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=P,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(P.view.element),Ha({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:q=>q.rawValue,backward:(q,Y)=>Y.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Lt(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(c){if(!this.popC_)return;const p=this.view.element,b=h(c.relatedTarget);(!b||!p.contains(b))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(c){if(!this.popC_)return;const p=this.popC_.view.element,b=N(c);b&&p.contains(b)||b&&b===this.swatchC_.view.buttonElement&&!nt(p.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(c){this.popC_?c.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&c.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Zb(g){return ee.isColorObject(g)?ee.fromObject(g):ee.black()}function Jb(g){return oo(g.getComponents("rgb")).reduce((c,p)=>c<<8|Math.floor(p)&255,0)}function Kb(g){return g.getComponents("rgb").reduce((c,p,b)=>{const P=Math.floor(b===3?p*255:p)&255;return c<<8|P},0)>>>0}function Qb(g){return new ee([g>>16&255,g>>8&255,g&255],"rgb")}function tw(g){return new ee([g>>24&255,g>>16&255,g>>8&255,Ce(g&255,0,255,0,1)],"rgb")}function ew(g){return typeof g!="number"?ee.black():Qb(g)}function nw(g){return typeof g!="number"?ee.black():tw(g)}function iw(g){const c=Lm(g);return(p,b)=>{qa(p,c(b))}}function sw(g){const c=g?Kb:Jb;return(p,b)=>{qa(p,c(b))}}function rw(g,c){const p=c.toRgbaObject();g.writeProperty("r",p.r),g.writeProperty("g",p.g),g.writeProperty("b",p.b),g.writeProperty("a",p.a)}function ow(g,c){const p=c.toRgbaObject();g.writeProperty("r",p.r),g.writeProperty("g",p.g),g.writeProperty("b",p.b)}function aw(g){return g?rw:ow}function nd(g){return"alpha"in g&&g.alpha===!0}function lw(g){return g?c=>Pc(c,"0x"):c=>Zu(c,"0x")}const cw={id:"input-color-number",type:"input",accept:(g,c)=>{if(typeof g!="number"||!("view"in c)||c.view!=="color")return null;const p=Xu(c);return p?{initialValue:g,params:p}:null},binding:{reader:g=>nd(g.params)?nw:ew,equals:ee.equals,writer:g=>sw(nd(g.params))},controller:g=>{const c=nd(g.params),p="expanded"in g.params?g.params.expanded:void 0,b="picker"in g.params?g.params.picker:void 0;return new ed(g.document,{expanded:p!=null?p:!1,formatter:lw(c),parser:Ac,pickerLayout:b!=null?b:"popup",supportsAlpha:c,value:g.value,viewProps:g.viewProps})}};function hw(g){return ee.isRgbaColorObject(g)}const uw={id:"input-color-object",type:"input",accept:(g,c)=>{if(!ee.isColorObject(g))return null;const p=Xu(c);return p?{initialValue:g,params:p}:null},binding:{reader:g=>Zb,equals:ee.equals,writer:g=>aw(hw(g.initialValue))},controller:g=>{const c=ee.isRgbaColorObject(g.initialValue),p="expanded"in g.params?g.params.expanded:void 0,b="picker"in g.params?g.params.picker:void 0,P=c?Pc:Zu;return new ed(g.document,{expanded:p!=null?p:!1,formatter:P,parser:Ac,pickerLayout:b!=null?b:"popup",supportsAlpha:c,value:g.value,viewProps:g.viewProps})}},dw={id:"input-color-string",type:"input",accept:(g,c)=>{if(typeof g!="string"||"view"in c&&c.view==="text"||!Cc(g))return null;const b=Xu(c);return b?{initialValue:g,params:b}:null},binding:{reader:g=>Lb,equals:ee.equals,writer:g=>{const c=Cc(g.initialValue);if(!c)throw m.shouldNeverHappen();return iw(c)}},controller:g=>{const c=Cc(g.initialValue);if(!c)throw m.shouldNeverHappen();const p=Lm(c),b="expanded"in g.params?g.params.expanded:void 0,P="picker"in g.params?g.params.picker:void 0;return new ed(g.document,{expanded:b!=null?b:!1,formatter:p,parser:Ac,pickerLayout:P!=null?P:"popup",supportsAlpha:Db(c),value:g.value,viewProps:g.viewProps})}};class Ms{constructor(c){this.components=c.components,this.asm_=c.assembly}constrain(c){const p=this.asm_.toComponents(c).map((b,P)=>{var q,Y;return(Y=(q=this.components[P])===null||q===void 0?void 0:q.constrain(b))!==null&&Y!==void 0?Y:b});return this.asm_.fromComponents(p)}}const Im=y("pndtxt");class pw{constructor(c,p){this.textViews=p.textViews,this.element=c.createElement("div"),this.element.classList.add(Im()),this.textViews.forEach(b=>{const P=c.createElement("div");P.classList.add(Im("a")),P.appendChild(b.element),this.element.appendChild(P)})}}function fw(g,c,p){return new Ga(g,{arrayPosition:p===0?"fst":p===c.axes.length-1?"lst":"mid",baseStep:c.axes[p].baseStep,parser:c.parser,props:c.axes[p].textProps,value:B(0,{constraint:c.axes[p].constraint}),viewProps:c.viewProps})}class id{constructor(c,p){this.value=p.value,this.viewProps=p.viewProps,this.acs_=p.axes.map((b,P)=>fw(c,p,P)),this.acs_.forEach((b,P)=>{Ha({primary:this.value,secondary:b.value,forward:q=>p.assembly.toComponents(q.rawValue)[P],backward:(q,Y)=>{const yt=p.assembly.toComponents(q.rawValue);return yt[P]=Y.rawValue,p.assembly.fromComponents(yt)}})}),this.view=new pw(c,{textViews:this.acs_.map(b=>b.view)})}}function mw(g){return"step"in g&&!u(g.step)?new vr(g.step):null}function gw(g){return"max"in g&&!u(g.max)||"min"in g&&!u(g.min)?new Vn({max:g.max,min:g.min}):null}function _w(g){const c=[],p=mw(g);p&&c.push(p);const b=gw(g);b&&c.push(b);const P=ju(g.options);return P&&c.push(P),new _r(c)}function vw(g){const c=g?Pi(g,Vn):null;return c?[c.minValue,c.maxValue]:[void 0,void 0]}function xw(g){const[c,p]=vw(g);return[c!=null?c:0,p!=null?p:100]}const yw={id:"input-number",type:"input",accept:(g,c)=>{if(typeof g!="number")return null;const p=st,b=rt(c,{format:p.optional.function,max:p.optional.number,min:p.optional.number,options:p.optional.custom(Mc),step:p.optional.number});return b?{initialValue:g,params:b}:null},binding:{reader:g=>ym,constraint:g=>_w(g.params),writer:g=>qa},controller:g=>{var c,p;const b=g.value,P=g.constraint;if(P&&Pi(P,za))return new Va(g.document,{props:k.fromObject({options:(c=$u(P))!==null&&c!==void 0?c:[]}),value:b,viewProps:g.viewProps});const q=(p="format"in g.params?g.params.format:void 0)!==null&&p!==void 0?p:Sn(Sc(P,b.rawValue));if(P&&Pi(P,Vn)){const[Y,yt]=xw(P);return new qu(g.document,{baseStep:so(P),parser:Yi,sliderProps:k.fromObject({maxValue:yt,minValue:Y}),textProps:k.fromObject({draggingScale:ro(P,b.rawValue),formatter:q}),value:b,viewProps:g.viewProps})}return new Ga(g.document,{baseStep:so(P),parser:Yi,props:k.fromObject({draggingScale:ro(P,b.rawValue),formatter:q}),value:b,viewProps:g.viewProps})}};class Ss{constructor(c=0,p=0){this.x=c,this.y=p}getComponents(){return[this.x,this.y]}static isObject(c){if(u(c))return!1;const p=c.x,b=c.y;return!(typeof p!="number"||typeof b!="number")}static equals(c,p){return c.x===p.x&&c.y===p.y}toObject(){return{x:this.x,y:this.y}}}const Nm={toComponents:g=>g.getComponents(),fromComponents:g=>new Ss(...g)},lo=y("p2d");class bw{constructor(c,p){this.element=c.createElement("div"),this.element.classList.add(lo()),p.viewProps.bindClassModifiers(this.element),M(p.expanded,R(this.element,lo(void 0,"expanded")));const b=c.createElement("div");b.classList.add(lo("h")),this.element.appendChild(b);const P=c.createElement("button");P.classList.add(lo("b")),P.appendChild(Ct(c,"p2dpad")),p.viewProps.bindDisabled(P),b.appendChild(P),this.buttonElement=P;const q=c.createElement("div");if(q.classList.add(lo("t")),b.appendChild(q),this.textElement=q,p.pickerLayout==="inline"){const Y=c.createElement("div");Y.classList.add(lo("p")),this.element.appendChild(Y),this.pickerElement=Y}else this.pickerElement=null}}const Ts=y("p2dp");class ww{constructor(c,p){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=p.invertsY,this.maxValue_=p.maxValue,this.element=c.createElement("div"),this.element.classList.add(Ts()),p.layout==="popup"&&this.element.classList.add(Ts(void 0,"p"));const b=c.createElement("div");b.classList.add(Ts("p")),p.viewProps.bindTabIndex(b),this.element.appendChild(b),this.padElement=b;const P=c.createElementNS(wt,"svg");P.classList.add(Ts("g")),this.padElement.appendChild(P),this.svgElem_=P;const q=c.createElementNS(wt,"line");q.classList.add(Ts("ax")),q.setAttributeNS(null,"x1","0"),q.setAttributeNS(null,"y1","50%"),q.setAttributeNS(null,"x2","100%"),q.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(q);const Y=c.createElementNS(wt,"line");Y.classList.add(Ts("ax")),Y.setAttributeNS(null,"x1","50%"),Y.setAttributeNS(null,"y1","0"),Y.setAttributeNS(null,"x2","50%"),Y.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(Y);const yt=c.createElementNS(wt,"line");yt.classList.add(Ts("l")),yt.setAttributeNS(null,"x1","50%"),yt.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(yt),this.lineElem_=yt;const zt=c.createElement("div");zt.classList.add(Ts("m")),this.padElement.appendChild(zt),this.markerElem_=zt,p.value.emitter.on("change",this.onValueChange_),this.value=p.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[c,p]=this.value.rawValue.getComponents(),b=this.maxValue_,P=Ce(c,-b,+b,0,100),q=Ce(p,-b,+b,0,100),Y=this.invertsY_?100-q:q;this.lineElem_.setAttributeNS(null,"x2",`${P}%`),this.lineElem_.setAttributeNS(null,"y2",`${Y}%`),this.markerElem_.style.left=`${P}%`,this.markerElem_.style.top=`${Y}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Fm(g,c,p){return[Tn(c[0],Zi(g)),Tn(c[1],Wa(g))*(p?1:-1)]}class Mw{constructor(c,p){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.baseSteps_=p.baseSteps,this.maxValue_=p.maxValue,this.invertsY_=p.invertsY,this.view=new ww(c,{invertsY:this.invertsY_,layout:p.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xr(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(c,p){if(!c.point)return;const b=this.maxValue_,P=Ce(c.point.x,0,c.bounds.width,-b,+b),q=Ce(this.invertsY_?c.bounds.height-c.point.y:c.point.y,0,c.bounds.height,-b,+b);this.value.setRawValue(new Ss(P,q),p)}onPointerDown_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerMove_(c){this.handlePointerEvent_(c.data,{forceEmit:!1,last:!1})}onPointerUp_(c){this.handlePointerEvent_(c.data,{forceEmit:!0,last:!0})}onPadKeyDown_(c){Mm(c.key)&&c.preventDefault();const[p,b]=Fm(c,this.baseSteps_,this.invertsY_);p===0&&b===0||this.value.setRawValue(new Ss(this.value.rawValue.x+p,this.value.rawValue.y+b),{forceEmit:!1,last:!1})}onPadKeyUp_(c){const[p,b]=Fm(c,this.baseSteps_,this.invertsY_);p===0&&b===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Sw{constructor(c,p){var b,P;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.foldable_=V.create(p.expanded),this.popC_=p.pickerLayout==="popup"?new pm(c,{viewProps:this.viewProps}):null;const q=new Mw(c,{baseSteps:[p.axes[0].baseStep,p.axes[1].baseStep],invertsY:p.invertsY,layout:p.pickerLayout,maxValue:p.maxValue,value:this.value,viewProps:this.viewProps});q.view.allFocusableElements.forEach(Y=>{Y.addEventListener("blur",this.onPopupChildBlur_),Y.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=q,this.textC_=new id(c,{assembly:Nm,axes:p.axes,parser:p.parser,value:this.value,viewProps:this.viewProps}),this.view=new bw(c,{expanded:this.foldable_.value("expanded"),pickerLayout:p.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(b=this.view.buttonElement)===null||b===void 0||b.addEventListener("blur",this.onPadButtonBlur_),(P=this.view.buttonElement)===null||P===void 0||P.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ha({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:Y=>Y.rawValue,backward:(Y,yt)=>yt.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Lt(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(c){if(!this.popC_)return;const p=this.view.element,b=h(c.relatedTarget);(!b||!p.contains(b))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(c){if(!this.popC_)return;const p=this.popC_.view.element,b=N(c);b&&p.contains(b)||b&&b===this.view.buttonElement&&!nt(p.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(c){this.popC_?c.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&c.key==="Escape"&&this.view.buttonElement.focus()}}function Tw(g){return Ss.isObject(g)?new Ss(g.x,g.y):new Ss}function Ew(g,c){g.writeProperty("x",c.x),g.writeProperty("y",c.y)}function Om(g){if(!g)return;const c=[];return u(g.step)||c.push(new vr(g.step)),(!u(g.max)||!u(g.min))&&c.push(new Vn({max:g.max,min:g.min})),new _r(c)}function Cw(g){return new Ms({assembly:Nm,components:[Om("x"in g?g.x:void 0),Om("y"in g?g.y:void 0)]})}function zm(g,c){const p=g&&Pi(g,Vn);if(p)return Math.max(Math.abs(p.minValue||0),Math.abs(p.maxValue||0));const b=so(g);return Math.max(Math.abs(b)*10,Math.abs(c)*10)}function Aw(g,c){const p=c instanceof Ms?c.components[0]:void 0,b=c instanceof Ms?c.components[1]:void 0,P=zm(p,g.x),q=zm(b,g.y);return Math.max(P,q)}function Vm(g,c){return{baseStep:so(c),constraint:c,textProps:k.fromObject({draggingScale:ro(c,g),formatter:Sn(Sc(c,g))})}}function Pw(g){if(!("y"in g))return!1;const c=g.y;return c&&"inverted"in c?!!c.inverted:!1}const Rw={id:"input-point2d",type:"input",accept:(g,c)=>{if(!Ss.isObject(g))return null;const p=st,b=rt(c,{expanded:p.optional.boolean,picker:p.optional.custom(Tm),x:p.optional.custom(bs),y:p.optional.object({inverted:p.optional.boolean,max:p.optional.number,min:p.optional.number,step:p.optional.number})});return b?{initialValue:g,params:b}:null},binding:{reader:g=>Tw,constraint:g=>Cw(g.params),equals:Ss.equals,writer:g=>Ew},controller:g=>{const c=g.document,p=g.value,b=g.constraint;if(!(b instanceof Ms))throw m.shouldNeverHappen();const P="expanded"in g.params?g.params.expanded:void 0,q="picker"in g.params?g.params.picker:void 0;return new Sw(c,{axes:[Vm(p.rawValue.x,b.components[0]),Vm(p.rawValue.y,b.components[1])],expanded:P!=null?P:!1,invertsY:Pw(g.params),maxValue:Aw(p.rawValue,b),parser:Yi,pickerLayout:q!=null?q:"popup",value:p,viewProps:g.viewProps})}};class co{constructor(c=0,p=0,b=0){this.x=c,this.y=p,this.z=b}getComponents(){return[this.x,this.y,this.z]}static isObject(c){if(u(c))return!1;const p=c.x,b=c.y,P=c.z;return!(typeof p!="number"||typeof b!="number"||typeof P!="number")}static equals(c,p){return c.x===p.x&&c.y===p.y&&c.z===p.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Bm={toComponents:g=>g.getComponents(),fromComponents:g=>new co(...g)};function Dw(g){return co.isObject(g)?new co(g.x,g.y,g.z):new co}function Lw(g,c){g.writeProperty("x",c.x),g.writeProperty("y",c.y),g.writeProperty("z",c.z)}function sd(g){if(!g)return;const c=[];return u(g.step)||c.push(new vr(g.step)),(!u(g.max)||!u(g.min))&&c.push(new Vn({max:g.max,min:g.min})),new _r(c)}function kw(g){return new Ms({assembly:Bm,components:[sd("x"in g?g.x:void 0),sd("y"in g?g.y:void 0),sd("z"in g?g.z:void 0)]})}function rd(g,c){return{baseStep:so(c),constraint:c,textProps:k.fromObject({draggingScale:ro(c,g),formatter:Sn(Sc(c,g))})}}const Iw={id:"input-point3d",type:"input",accept:(g,c)=>{if(!co.isObject(g))return null;const p=st,b=rt(c,{x:p.optional.custom(bs),y:p.optional.custom(bs),z:p.optional.custom(bs)});return b?{initialValue:g,params:b}:null},binding:{reader:g=>Dw,constraint:g=>kw(g.params),equals:co.equals,writer:g=>Lw},controller:g=>{const c=g.value,p=g.constraint;if(!(p instanceof Ms))throw m.shouldNeverHappen();return new id(g.document,{assembly:Bm,axes:[rd(c.rawValue.x,p.components[0]),rd(c.rawValue.y,p.components[1]),rd(c.rawValue.z,p.components[2])],parser:Yi,value:c,viewProps:g.viewProps})}};class ho{constructor(c=0,p=0,b=0,P=0){this.x=c,this.y=p,this.z=b,this.w=P}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(c){if(u(c))return!1;const p=c.x,b=c.y,P=c.z,q=c.w;return!(typeof p!="number"||typeof b!="number"||typeof P!="number"||typeof q!="number")}static equals(c,p){return c.x===p.x&&c.y===p.y&&c.z===p.z&&c.w===p.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Um={toComponents:g=>g.getComponents(),fromComponents:g=>new ho(...g)};function Nw(g){return ho.isObject(g)?new ho(g.x,g.y,g.z,g.w):new ho}function Fw(g,c){g.writeProperty("x",c.x),g.writeProperty("y",c.y),g.writeProperty("z",c.z),g.writeProperty("w",c.w)}function Dc(g){if(!g)return;const c=[];return u(g.step)||c.push(new vr(g.step)),(!u(g.max)||!u(g.min))&&c.push(new Vn({max:g.max,min:g.min})),new _r(c)}function Ow(g){return new Ms({assembly:Um,components:[Dc("x"in g?g.x:void 0),Dc("y"in g?g.y:void 0),Dc("z"in g?g.z:void 0),Dc("w"in g?g.w:void 0)]})}function zw(g,c){return{baseStep:so(c),constraint:c,textProps:k.fromObject({draggingScale:ro(c,g),formatter:Sn(Sc(c,g))})}}const Vw={id:"input-point4d",type:"input",accept:(g,c)=>{if(!ho.isObject(g))return null;const p=st,b=rt(c,{x:p.optional.custom(bs),y:p.optional.custom(bs),z:p.optional.custom(bs),w:p.optional.custom(bs)});return b?{initialValue:g,params:b}:null},binding:{reader:g=>Nw,constraint:g=>Ow(g.params),equals:ho.equals,writer:g=>Fw},controller:g=>{const c=g.value,p=g.constraint;if(!(p instanceof Ms))throw m.shouldNeverHappen();return new id(g.document,{assembly:Um,axes:c.rawValue.getComponents().map((b,P)=>zw(b,p.components[P])),parser:Yi,value:c,viewProps:g.viewProps})}};function Bw(g){const c=[],p=ju(g.options);return p&&c.push(p),new _r(c)}const Uw={id:"input-string",type:"input",accept:(g,c)=>{if(typeof g!="string")return null;const b=rt(c,{options:st.optional.custom(Mc)});return b?{initialValue:g,params:b}:null},binding:{reader:g=>bm,constraint:g=>Bw(g.params),writer:g=>qa},controller:g=>{var c;const p=g.document,b=g.value,P=g.constraint;return P&&Pi(P,za)?new Va(p,{props:k.fromObject({options:(c=$u(P))!==null&&c!==void 0?c:[]}),value:b,viewProps:g.viewProps}):new bc(p,{parser:q=>q,props:k.fromObject({formatter:Bu}),value:b,viewProps:g.viewProps})}},$a={monitor:{defaultInterval:200,defaultLineCount:3}},Hm=y("mll");class Hw{constructor(c,p){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=p.formatter,this.element=c.createElement("div"),this.element.classList.add(Hm()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("textarea");b.classList.add(Hm("i")),b.style.height=`calc(var(--bld-us) * ${p.lineCount})`,b.readOnly=!0,p.viewProps.bindDisabled(b),this.element.appendChild(b),this.textareaElem_=b,p.value.emitter.on("change",this.onValueUpdate_),this.value=p.value,this.update_()}update_(){const c=this.textareaElem_,p=c.scrollTop===c.scrollHeight-c.clientHeight,b=[];this.value.rawValue.forEach(P=>{P!==void 0&&b.push(this.formatter_(P))}),c.textContent=b.join(`
`),p&&(c.scrollTop=c.scrollHeight)}onValueUpdate_(){this.update_()}}class od{constructor(c,p){this.value=p.value,this.viewProps=p.viewProps,this.view=new Hw(c,{formatter:p.formatter,lineCount:p.lineCount,value:this.value,viewProps:this.viewProps})}}const Wm=y("sgl");class Ww{constructor(c,p){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=p.formatter,this.element=c.createElement("div"),this.element.classList.add(Wm()),p.viewProps.bindClassModifiers(this.element);const b=c.createElement("input");b.classList.add(Wm("i")),b.readOnly=!0,b.type="text",p.viewProps.bindDisabled(b),this.element.appendChild(b),this.inputElement=b,p.value.emitter.on("change",this.onValueUpdate_),this.value=p.value,this.update_()}update_(){const c=this.value.rawValue,p=c[c.length-1];this.inputElement.value=p!==void 0?this.formatter_(p):""}onValueUpdate_(){this.update_()}}class ad{constructor(c,p){this.value=p.value,this.viewProps=p.viewProps,this.view=new Ww(c,{formatter:p.formatter,value:this.value,viewProps:this.viewProps})}}const Gw={id:"monitor-bool",type:"monitor",accept:(g,c)=>{if(typeof g!="boolean")return null;const b=rt(c,{lineCount:st.optional.number});return b?{initialValue:g,params:b}:null},binding:{reader:g=>mm},controller:g=>{var c;return g.value.rawValue.length===1?new ad(g.document,{formatter:gm,value:g.value,viewProps:g.viewProps}):new od(g.document,{formatter:gm,lineCount:(c=g.params.lineCount)!==null&&c!==void 0?c:$a.monitor.defaultLineCount,value:g.value,viewProps:g.viewProps})}};class qw{constructor(){this.emitter=new w,this.index_=-1}get index(){return this.index_}set index(c){this.index_!==c&&(this.index_=c,this.emitter.emit("change",{index:c,sender:this}))}}const Es=y("grl");class jw{constructor(c,p){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=c.createElement("div"),this.element.classList.add(Es()),p.viewProps.bindClassModifiers(this.element),this.formatter_=p.formatter,this.minValue_=p.minValue,this.maxValue_=p.maxValue,this.cursor_=p.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const b=c.createElementNS(wt,"svg");b.classList.add(Es("g")),b.style.height=`calc(var(--bld-us) * ${p.lineCount})`,this.element.appendChild(b),this.svgElem_=b;const P=c.createElementNS(wt,"polyline");this.svgElem_.appendChild(P),this.lineElem_=P;const q=c.createElement("div");q.classList.add(Es("t"),y("tt")()),this.element.appendChild(q),this.tooltipElem_=q,p.value.emitter.on("change",this.onValueUpdate_),this.value=p.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const c=this.svgElem_.getBoundingClientRect(),p=this.value.rawValue.length-1,b=this.minValue_,P=this.maxValue_,q=[];this.value.rawValue.forEach((oe,ae)=>{if(oe===void 0)return;const wr=Ce(ae,0,p,0,c.width),Xa=Ce(oe,b,P,c.height,0);q.push([wr,Xa].join(","))}),this.lineElem_.setAttributeNS(null,"points",q.join(" "));const Y=this.tooltipElem_,yt=this.value.rawValue[this.cursor_.index];if(yt===void 0){Y.classList.remove(Es("t","a"));return}const zt=Ce(this.cursor_.index,0,p,0,c.width),$t=Ce(yt,b,P,c.height,0);Y.style.left=`${zt}px`,Y.style.top=`${$t}px`,Y.textContent=`${this.formatter_(yt)}`,Y.classList.contains(Es("t","a"))||(Y.classList.add(Es("t","a"),Es("t","in")),at(Y),Y.classList.remove(Es("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class $w{constructor(c,p){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.cursor_=new qw,this.view=new jw(c,{cursor:this.cursor_,formatter:p.formatter,lineCount:p.lineCount,maxValue:p.maxValue,minValue:p.minValue,value:this.value,viewProps:this.viewProps}),!nt(c))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const b=new xr(this.view.element);b.emitter.on("down",this.onGraphPointerDown_),b.emitter.on("move",this.onGraphPointerMove_),b.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(c){const p=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Ce(c.offsetX,0,p.width,0,this.value.rawValue.length))}onGraphPointerDown_(c){this.onGraphPointerMove_(c)}onGraphPointerMove_(c){if(!c.data.point){this.cursor_.index=-1;return}this.cursor_.index=Math.floor(Ce(c.data.point.x,0,c.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.index=-1}}function ld(g){return"format"in g&&!u(g.format)?g.format:Sn(2)}function Xw(g){var c;return g.value.rawValue.length===1?new ad(g.document,{formatter:ld(g.params),value:g.value,viewProps:g.viewProps}):new od(g.document,{formatter:ld(g.params),lineCount:(c=g.params.lineCount)!==null&&c!==void 0?c:$a.monitor.defaultLineCount,value:g.value,viewProps:g.viewProps})}function Yw(g){var c,p,b;return new $w(g.document,{formatter:ld(g.params),lineCount:(c=g.params.lineCount)!==null&&c!==void 0?c:$a.monitor.defaultLineCount,maxValue:(p="max"in g.params?g.params.max:null)!==null&&p!==void 0?p:100,minValue:(b="min"in g.params?g.params.min:null)!==null&&b!==void 0?b:0,value:g.value,viewProps:g.viewProps})}function Gm(g){return"view"in g&&g.view==="graph"}const Zw={id:"monitor-number",type:"monitor",accept:(g,c)=>{if(typeof g!="number")return null;const p=st,b=rt(c,{format:p.optional.function,lineCount:p.optional.number,max:p.optional.number,min:p.optional.number,view:p.optional.string});return b?{initialValue:g,params:b}:null},binding:{defaultBufferSize:g=>Gm(g)?64:1,reader:g=>ym},controller:g=>Gm(g.params)?Yw(g):Xw(g)},Jw={id:"monitor-string",type:"monitor",accept:(g,c)=>{if(typeof g!="string")return null;const p=st,b=rt(c,{lineCount:p.optional.number,multiline:p.optional.boolean});return b?{initialValue:g,params:b}:null},binding:{reader:g=>bm},controller:g=>{var c;const p=g.value;return p.rawValue.length>1||"multiline"in g.params&&g.params.multiline?new od(g.document,{formatter:Bu,lineCount:(c=g.params.lineCount)!==null&&c!==void 0?c:$a.monitor.defaultLineCount,value:p,viewProps:g.viewProps}):new ad(g.document,{formatter:Bu,value:p,viewProps:g.viewProps})}};class Kw{constructor(c){this.onValueChange_=this.onValueChange_.bind(this),this.reader=c.reader,this.writer=c.writer,this.emitter=new w,this.value=c.value,this.value.emitter.on("change",this.onValueChange_),this.target=c.target,this.read()}read(){const c=this.target.read();c!==void 0&&(this.value.rawValue=this.reader(c))}write_(c){this.writer(this.target,c)}onValueChange_(c){this.write_(c.rawValue),this.emitter.emit("change",{options:c.options,rawValue:c.rawValue,sender:this})}}function Qw(g,c){const p=g.accept(c.target.read(),c.params);if(u(p))return null;const b=st,P={target:c.target,initialValue:p.initialValue,params:p.params},q=g.binding.reader(P),Y=g.binding.constraint?g.binding.constraint(P):void 0,yt=B(q(p.initialValue),{constraint:Y,equals:g.binding.equals}),zt=new Kw({reader:q,target:c.target,value:yt,writer:g.binding.writer(P)}),$t=b.optional.boolean(c.params.disabled).value,oe=b.optional.boolean(c.params.hidden).value,ae=g.controller({constraint:Y,document:c.document,initialValue:p.initialValue,params:p.params,value:zt.value,viewProps:ue.create({disabled:$t,hidden:oe})}),wr=b.optional.string(c.params.label).value;return new Ne(c.document,{binding:zt,blade:W(),props:k.fromObject({label:wr||c.target.key}),valueController:ae})}class tM{constructor(c){this.onTick_=this.onTick_.bind(this),this.reader_=c.reader,this.target=c.target,this.emitter=new w,this.value=c.value,this.ticker=c.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const c=this.target.read();if(c===void 0)return;const p=this.value.rawValue,b=this.reader_(c);this.value.rawValue=cb(p,b),this.emitter.emit("update",{rawValue:b,sender:this})}onTick_(c){this.read()}}function eM(g,c){return c===0?new Cy:new Ay(g,c!=null?c:$a.monitor.defaultInterval)}function nM(g,c){var p,b,P;const q=st,Y=g.accept(c.target.read(),c.params);if(u(Y))return null;const yt={target:c.target,initialValue:Y.initialValue,params:Y.params},zt=g.binding.reader(yt),$t=(b=(p=q.optional.number(c.params.bufferSize).value)!==null&&p!==void 0?p:g.binding.defaultBufferSize&&g.binding.defaultBufferSize(Y.params))!==null&&b!==void 0?b:1,oe=q.optional.number(c.params.interval).value,ae=new tM({reader:zt,target:c.target,ticker:eM(c.document,oe),value:ab($t)}),wr=q.optional.boolean(c.params.disabled).value,Xa=q.optional.boolean(c.params.hidden).value,Ya=g.controller({document:c.document,params:Y.params,value:ae.value,viewProps:ue.create({disabled:wr,hidden:Xa})}),uo=(P=q.optional.string(c.params.label).value)!==null&&P!==void 0?P:c.target.key;return new di(c.document,{binding:ae,blade:W(),props:k.fromObject({label:uo}),valueController:Ya})}class iM{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(c){c.type==="blade"?this.pluginsMap_.blades.unshift(c):c.type==="input"?this.pluginsMap_.inputs.unshift(c):c.type==="monitor"&&this.pluginsMap_.monitors.unshift(c)}createInput(c,p,b){const P=p.read();if(u(P))throw new m({context:{key:p.key},type:"nomatchingcontroller"});const q=this.pluginsMap_.inputs.reduce((Y,yt)=>Y||Qw(yt,{document:c,target:p,params:b}),null);if(q)return q;throw new m({context:{key:p.key},type:"nomatchingcontroller"})}createMonitor(c,p,b){const P=this.pluginsMap_.monitors.reduce((q,Y)=>q||nM(Y,{document:c,params:b,target:p}),null);if(P)return P;throw new m({context:{key:p.key},type:"nomatchingcontroller"})}createBlade(c,p){const b=this.pluginsMap_.blades.reduce((P,q)=>P||Ey(q,{document:c,params:p}),null);if(!b)throw new m({type:"nomatchingview",context:{params:p}});return b}createBladeApi(c){if(c instanceof Ne)return new Mn(c);if(c instanceof di)return new ui(c);if(c instanceof lt)return new eo(c,this);const p=this.pluginsMap_.blades.reduce((b,P)=>b||P.api({controller:c,pool:this}),null);if(!p)throw m.shouldNeverHappen();return p}}function sM(){const g=new iM;return[Rw,Iw,Vw,Uw,yw,dw,uw,cw,xb,Gw,Jw,Zw,Vt,Gt,xs,um].forEach(c=>{g.register(c)}),g}class qm extends i{constructor(c){super(c);this.emitter_=new w,this.controller_.valueController.value.emitter.on("change",p=>{this.emitter_.emit("change",{event:new o(this,p.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}get options(){return this.controller_.valueController.props.get("options")}set options(c){this.controller_.valueController.props.set("options",c)}get value(){return this.controller_.valueController.value.rawValue}set value(c){this.controller_.valueController.value.rawValue=c}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}}class jm extends i{constructor(c){super(c);this.emitter_=new w,this.controller_.valueController.value.emitter.on("change",p=>{this.emitter_.emit("change",{event:new o(this,p.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(c){this.controller_.valueController.sliderController.props.set("maxValue",c)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(c){this.controller_.valueController.sliderController.props.set("minValue",c)}get value(){return this.controller_.valueController.value.rawValue}set value(c){this.controller_.valueController.value.rawValue=c}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}}class $m extends i{constructor(c){super(c);this.emitter_=new w,this.controller_.valueController.value.emitter.on("change",p=>{this.emitter_.emit("change",{event:new o(this,p.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(c){this.controller_.valueController.props.set("formatter",c)}get value(){return this.controller_.valueController.value.rawValue}set value(c){this.controller_.valueController.value.rawValue=c}on(c,p){const b=p.bind(this);return this.emitter_.on(c,P=>{b(P.event)}),this}}const rM=function(){return{id:"list",type:"blade",accept(g){const c=st,p=rt(g,{options:c.required.custom(Mc),value:c.required.raw,view:c.required.constant("list"),label:c.optional.string});return p?{params:p}:null},controller(g){const c=new Va(g.document,{props:k.fromObject({options:Em(g.params.options)}),value:B(g.params.value),viewProps:g.viewProps});return new Jt(g.document,{blade:g.blade,props:k.fromObject({label:g.params.label}),valueController:c})},api(g){return!(g.controller instanceof Jt)||!(g.controller.valueController instanceof Va)?null:new qm(g.controller)}}}();function oM(g){return g.reduce((c,p)=>Object.assign(c,{[p.presetKey]:p.read()}),{})}function aM(g,c){g.forEach(p=>{const b=c[p.presetKey];b!==void 0&&p.write(b)})}class lM extends gr{constructor(c,p){super(c,p)}get element(){return this.controller_.view.element}importPreset(c){const p=this.controller_.rackController.rack.find(Ne).map(b=>b.binding.target);aM(p,c),this.refresh()}exportPreset(){const c=this.controller_.rackController.rack.find(Ne).map(p=>p.binding.target);return oM(c)}refresh(){this.controller_.rackController.rack.find(Ne).forEach(c=>{c.binding.read()}),this.controller_.rackController.rack.find(di).forEach(c=>{c.binding.read()})}}class cM extends Yt{constructor(c,p){super(c,{expanded:p.expanded,blade:p.blade,props:p.props,root:!0,viewProps:p.viewProps})}}const hM={id:"slider",type:"blade",accept(g){const c=st,p=rt(g,{max:c.required.number,min:c.required.number,view:c.required.constant("slider"),format:c.optional.function,label:c.optional.string,value:c.optional.number});return p?{params:p}:null},controller(g){var c,p;const b=(c=g.params.value)!==null&&c!==void 0?c:0,P=new qu(g.document,{baseStep:1,parser:Yi,sliderProps:k.fromObject({maxValue:g.params.max,minValue:g.params.min}),textProps:k.fromObject({draggingScale:ro(void 0,b),formatter:(p=g.params.format)!==null&&p!==void 0?p:rb}),value:B(b),viewProps:g.viewProps});return new Jt(g.document,{blade:g.blade,props:k.fromObject({label:g.params.label}),valueController:P})},api(g){return!(g.controller instanceof Jt)||!(g.controller.valueController instanceof qu)?null:new jm(g.controller)}},uM=function(){return{id:"text",type:"blade",accept(g){const c=st,p=rt(g,{parse:c.required.function,value:c.required.raw,view:c.required.constant("text"),format:c.optional.function,label:c.optional.string});return p?{params:p}:null},controller(g){var c;const p=new bc(g.document,{parser:g.params.parse,props:k.fromObject({formatter:(c=g.params.format)!==null&&c!==void 0?c:b=>String(b)}),value:B(g.params.value),viewProps:g.viewProps});return new Jt(g.document,{blade:g.blade,props:k.fromObject({label:g.params.label}),valueController:p})},api(g){return!(g.controller instanceof Jt)||!(g.controller.valueController instanceof bc)?null:new $m(g.controller)}}}();function dM(g){const c=g.createElement("div");return c.classList.add(y("dfw")()),g.body&&g.body.appendChild(c),c}function Xm(g,c,p){if(g.querySelector(`style[data-tp-style=${c}]`))return;const b=g.createElement("style");b.dataset.tpStyle=c,b.textContent=p,g.head.appendChild(b)}class pM extends lM{constructor(c){var p;const b=c||{},P=(p=b.document)!==null&&p!==void 0?p:mt(),q=sM(),Y=new cM(P,{expanded:b.expanded,blade:W(),props:k.fromObject({title:b.title}),viewProps:ue.create()});super(Y,q);this.pool_=q,this.containerElem_=b.container||dM(P),this.containerElem_.appendChild(this.element),this.doc_=P,this.usesDefaultWrapper_=!b.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw m.alreadyDisposed();return this.doc_}dispose(){const c=this.containerElem_;if(!c)throw m.alreadyDisposed();if(this.usesDefaultWrapper_){const p=c.parentElement;p&&p.removeChild(c)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(c){("plugin"in c?[c.plugin]:"plugins"in c?c.plugins:[]).forEach(b=>{this.pool_.register(b),this.embedPluginStyle_(b)})}embedPluginStyle_(c){c.css&&Xm(this.document,`plugin-${c.id}`,c.css)}setUpDefaultPlugins_(){Xm(this.document,"default",".tp-lstv_s,.tp-btnv_b,.tp-p2dv_b,.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i,.tp-grlv_g,.tp-sglv_i,.tp-mllv_i,.tp-fldv_b,.tp-rotv_b,.tp-ckbv_i,.tp-coltxtv_ms,.tp-tbiv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-lstv_s,.tp-btnv_b,.tp-p2dv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-lstv_s:hover,.tp-btnv_b:hover,.tp-p2dv_b:hover{background-color:var(--btn-bg-h)}.tp-lstv_s:focus,.tp-btnv_b:focus,.tp-p2dv_b:focus{background-color:var(--btn-bg-f)}.tp-lstv_s:active,.tp-btnv_b:active,.tp-p2dv_b:active{background-color:var(--btn-bg-a)}.tp-lstv_s:disabled,.tp-btnv_b:disabled,.tp-p2dv_b:disabled{opacity:0.5}.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-colswv_sw:hover,.tp-p2dpv_p:hover,.tp-txtv_i:hover{background-color:var(--in-bg-h)}.tp-colswv_sw:focus,.tp-p2dpv_p:focus,.tp-txtv_i:focus{background-color:var(--in-bg-f)}.tp-colswv_sw:active,.tp-p2dpv_p:active,.tp-txtv_i:active{background-color:var(--in-bg-a)}.tp-colswv_sw:disabled,.tp-p2dpv_p:disabled,.tp-txtv_i:disabled{opacity:0.5}.tp-grlv_g,.tp-sglv_i,.tp-mllv_i{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);width:100%}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono,Source Code Pro,Menlo,Courier,monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #2f3137);--bs-sh: var(--tp-base-shadow-color, rgba(0,0,0,0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #2f3137);--cnt-bg: var(--tp-container-background-color, rgba(187,188,196,0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187,188,196,0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187,188,196,0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187,188,196,0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187,188,196,0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187,188,196,0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187,188,196,0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187,188,196,0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187,188,196,0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0,0,0,0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187,188,196,0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(0,0,0,0.2))}.tp-fldv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-rotv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1 * var(--cnt-v-p))}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-rotv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-fldv_c>.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv{margin-left:4px}.tp-fldv_c>.tp-fldv>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c .tp-fldv>.tp-fldv_c,.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-tabv>.tp-tabv_i,.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-fldv_c .tp-tabv>.tp-tabv_c,.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_b,.tp-rotv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-fldv_b:hover,.tp-rotv_b:hover{background-color:var(--cnt-bg-h)}.tp-fldv_b:focus,.tp-rotv_b:focus{background-color:var(--cnt-bg-f)}.tp-fldv_b:active,.tp-rotv_b:active{background-color:var(--cnt-bg-a)}.tp-fldv_b:disabled,.tp-rotv_b:disabled{opacity:0.5}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:'';display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px) / 2 - 2px);margin:auto;opacity:0.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{transform:none}.tp-fldv_c,.tp-rotv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c,.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c{display:none}.tp-fldv.tp-fldv-expanded>.tp-fldv_c,.tp-rotv.tp-rotv-expanded .tp-rotv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-coltxtv_m,.tp-lstv{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-coltxtv_mm,.tp-lstv_m{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-coltxtv_mm svg,.tp-lstv_m svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-coltxtv_mm svg path,.tp-lstv_m svg path{fill:currentColor}.tp-coltxtv_w,.tp-pndtxtv{display:flex}.tp-coltxtv_c,.tp-pndtxtv_a{width:100%}.tp-coltxtv_c+.tp-coltxtv_c,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-pndtxtv_a{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:0.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:'';height:2px;left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us) * 4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0,0,0,0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,0.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,0.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br)}.tp-colswv.tp-v-disabled{opacity:0.5}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left 0.05s, top 0.05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:0.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:0.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:0.5}.tp-mllv_i{display:block;height:calc(var(--bld-us) * 3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:0.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:0.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:'';display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:0.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:0.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:0.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:0.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:0.1;position:absolute;top:0;transition:border-radius 0.1s, height 0.1s, transform 0.1s, width 0.1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:'';font-size:0.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}"),this.pool_.getAll().forEach(c=>{this.embedPluginStyle_(c)}),this.registerPlugin({plugins:[hM,rM,um,uM]})}}const fM=new n("3.0.7");e.BladeApi=i,e.ButtonApi=x,e.FolderApi=gr,e.InputBindingApi=Mn,e.ListApi=qm,e.MonitorBindingApi=ui,e.Pane=pM,e.SeparatorApi=Zt,e.SliderApi=jm,e.TabApi=ys,e.TabPageApi=We,e.TextApi=$m,e.TpChangeEvent=o,e.VERSION=fM,Object.defineProperty(e,"__esModule",{value:!0})})})(Hv,Hv.exports);function as(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Wv(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}/*!
 * GSAP 3.9.1
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var qn={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ua={duration:.5,overwrite:!1,delay:0},qp,ni=1e8,_e=1/ni,jp=Math.PI*2,GP=jp/4,qP=0,Gv=Math.sqrt,jP=Math.cos,$P=Math.sin,Qe=function(t){return typeof t=="string"},tn=function(t){return typeof t=="function"},ls=function(t){return typeof t=="number"},$p=function(t){return typeof t=="undefined"},cs=function(t){return typeof t=="object"},Pn=function(t){return t!==!1},qv=function(){return typeof window!="undefined"},zh=function(t){return tn(t)||Qe(t)},jv=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},mn=Array.isArray,Xp=/(?:-?\.?\d|\.)+/gi,$v=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,da=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Yp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Xv=/[+-]=-?[.\d]+/,Yv=/[^,'"\[\]\s]+/gi,XP=/[\d.+\-=]+(?:e[-+]\d*)*/i,ke,Vi,Zp,Jp,jn={},Vh={},Zv,Jv=function(t){return(Vh=pa(t,jn))&&Ui},Kp=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Bh=function(t,e){return!e&&console.warn(t)},Kv=function(t,e){return t&&(jn[t]=e)&&Vh&&(Vh[t]=e)||jn},Dl=function(){return 0},Qp={},Ys=[],tf={},Qv,$n={},ef={},t0=30,Uh=[],nf="",sf=function(t){var e=t[0],n,i;if(cs(e)||tn(e)||(t=[t]),!(n=(e._gsap||{}).harness)){for(i=Uh.length;i--&&!Uh[i].targetTest(e););n=Uh[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new C0(t[i],n)))||t.splice(i,1);return t},Nr=function(t){return t._gsap||sf(ri(t))[0]._gsap},e0=function(t,e,n){return(n=t[e])&&tn(n)?t[e]():$p(n)&&t.getAttribute&&t.getAttribute(e)||n},Rn=function(t,e){return(t=t.split(",")).forEach(e)||t},Ue=function(t){return Math.round(t*1e5)/1e5||0},gn=function(t){return Math.round(t*1e7)/1e7||0},YP=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},Hh=function(){var t=Ys.length,e=Ys.slice(0),n,i;for(tf={},Ys.length=0,n=0;n<t;n++)i=e[n],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},n0=function(t,e,n,i){Ys.length&&Hh(),t.render(e,n,i),Ys.length&&Hh()},i0=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(Yv).length<2?e:Qe(t)?t.trim():t},s0=function(t){return t},ii=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},ZP=function(t){return function(e,n){for(var i in n)i in e||i==="duration"&&t||i==="ease"||(e[i]=n[i])}},pa=function(t,e){for(var n in e)t[n]=e[n];return t},r0=function r(t,e){for(var n in e)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(t[n]=cs(e[n])?r(t[n]||(t[n]={}),e[n]):e[n]);return t},Wh=function(t,e){var n={},i;for(i in t)i in e||(n[i]=t[i]);return n},Ll=function(t){var e=t.parent||ke,n=t.keyframes?ZP(mn(t.keyframes)):ii;if(Pn(t.inherit))for(;e;)n(t,e.vars.defaults),e=e.parent||e._dp;return t},JP=function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0},KP=function(t,e,n,i,s){n===void 0&&(n="_first"),i===void 0&&(i="_last");var o=t[i],a;if(s)for(a=e[s];o&&o[s]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=o,e.parent=e._dp=t,e},Gh=function(t,e,n,i){n===void 0&&(n="_first"),i===void 0&&(i="_last");var s=e._prev,o=e._next;s?s._next=o:t[n]===e&&(t[n]=o),o?o._prev=s:t[i]===e&&(t[i]=s),e._next=e._prev=e.parent=null},hs=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Fr=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},QP=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},tR=function r(t){return!t||t._ts&&r(t.parent)},o0=function(t){return t._repeat?fa(t._tTime,t=t.duration()+t._rDelay)*t:0},fa=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},qh=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},jh=function(t){return t._end=gn(t._start+(t._tDur/Math.abs(t._ts||t._rts||_e)||0))},a0=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=gn(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),jh(t),n._dirty||Fr(n,t)),t},l0=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=qh(t.rawTime(),e),(!e._dur||Il(0,e.totalDuration(),n)-e._tTime>_e)&&e.render(n,!0)),Fr(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-_e}},Bi=function(t,e,n,i){return e.parent&&hs(e),e._start=gn((ls(n)?n:n||t!==ke?si(t,n,e):t._time)+e._delay),e._end=gn(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),KP(t,e,"_first","_last",t._sort?"_start":0),rf(e)||(t._recent=e),i||l0(t,e),t},c0=function(t,e){return(jn.ScrollTrigger||Kp("scrollTrigger",e))&&jn.ScrollTrigger.create(e,t)},h0=function(t,e,n,i){if(MR(t,e),!t._initted)return 1;if(!n&&t._pt&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Qv!==ai.frame)return Ys.push(t),t._lazy=[e,i],1},eR=function r(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||r(e))},rf=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},nR=function(t,e,n,i){var s=t.ratio,o=e<0||!e&&(!t._start&&eR(t)&&!(!t._initted&&rf(t))||(t._ts<0||t._dp._ts<0)&&!rf(t))?0:1,a=t._rDelay,l=0,h,u,d;if(a&&t._repeat&&(l=Il(0,t._tDur,e),u=fa(l,a),t._yoyo&&u&1&&(o=1-o),u!==fa(t._tTime,a)&&(s=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==s||i||t._zTime===_e||!e&&t._zTime){if(!t._initted&&h0(t,e,i,n))return;for(d=t._zTime,t._zTime=e||(n?_e:0),n||(n=e&&!d),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=l,h=t._pt;h;)h.r(o,h.d),h=h._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!n&&oi(t,"onUpdate"),l&&t._repeat&&!n&&t.parent&&oi(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&hs(t,1),n||(oi(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},iR=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if(i.data==="isPause"&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if(i.data==="isPause"&&i._start<e)return i;i=i._prev}},ma=function(t,e,n,i){var s=t._repeat,o=gn(e)||0,a=t._tTime/t._tDur;return a&&!i&&(t._time*=o/t._dur),t._dur=o,t._tDur=s?s<0?1e10:gn(o*(s+1)+t._rDelay*s):o,a>0&&!i?a0(t,t._tTime=t._tDur*a):t.parent&&jh(t),n||Fr(t.parent,t),t},u0=function(t){return t instanceof Ln?Fr(t):ma(t,t._dur)},sR={_start:0,endTime:Dl,totalDuration:Dl},si=function r(t,e,n){var i=t.labels,s=t._recent||sR,o=t.duration()>=ni?s.endTime(!1):t._dur,a,l,h;return Qe(e)&&(isNaN(e)||e in i)?(l=e.charAt(0),h=e.substr(-1)==="%",a=e.indexOf("="),l==="<"||l===">"?(a>=0&&(e=e.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(e.substr(1))||0)*(h?(a<0?s:n).totalDuration()/100:1)):a<0?(e in i||(i[e]=o),i[e]):(l=parseFloat(e.charAt(a-1)+e.substr(a+1)),h&&n&&(l=l/100*(mn(n)?n[0]:n).totalDuration()),a>1?r(t,e.substr(0,a-1),n)+l:o+l)):e==null?o:+e},kl=function(t,e,n){var i=ls(e[1]),s=(i?2:1)+(t<2?0:1),o=e[s],a,l;if(i&&(o.duration=e[1]),o.parent=n,t){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=Pn(l.vars.inherit)&&l.parent;o.immediateRender=Pn(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[s-1]}return new en(e[0],o,e[s+1])},Zs=function(t,e){return t||t===0?e(t):e},Il=function(t,e,n){return n<t?t:n>e?e:n},Dn=function(t,e){return!Qe(t)||!(e=XP.exec(t))?"":t.substr(e.index+e[0].length)},rR=function(t,e,n){return Zs(n,function(i){return Il(t,e,i)})},of=[].slice,d0=function(t,e){return t&&cs(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&cs(t[0]))&&!t.nodeType&&t!==Vi},oR=function(t,e,n){return n===void 0&&(n=[]),t.forEach(function(i){var s;return Qe(i)&&!e||d0(i,1)?(s=n).push.apply(s,ri(i)):n.push(i)})||n},ri=function(t,e,n){return Qe(t)&&!n&&(Zp||!_a())?of.call((e||Jp).querySelectorAll(t),0):mn(t)?oR(t,n):d0(t)?of.call(t,0):t?[t]:[]},aR=function(t){return t=ri(t)[0]||Bh("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return ri(e,n.querySelectorAll?n:n===t?Bh("Invalid scope")||Jp.createElement("div"):t)}},p0=function(t){return t.sort(function(){return .5-Math.random()})},f0=function(t){if(tn(t))return t;var e=cs(t)?t:{each:t},n=Or(e.ease),i=e.from||0,s=parseFloat(e.base)||0,o={},a=i>0&&i<1,l=isNaN(i)||a,h=e.axis,u=i,d=i;return Qe(i)?u=d={center:.5,edges:.5,end:1}[i]||0:!a&&l&&(u=i[0],d=i[1]),function(f,m,_){var x=(_||e).length,w=o[x],v,y,C,S,M,E,T,R,F;if(!w){if(F=e.grid==="auto"?0:(e.grid||[1,ni])[1],!F){for(T=-ni;T<(T=_[F++].getBoundingClientRect().left)&&F<x;);F--}for(w=o[x]=[],v=l?Math.min(F,x)*u-.5:i%F,y=F===ni?0:l?x*d/F-.5:i/F|0,T=0,R=ni,E=0;E<x;E++)C=E%F-v,S=y-(E/F|0),w[E]=M=h?Math.abs(h==="y"?S:C):Gv(C*C+S*S),M>T&&(T=M),M<R&&(R=M);i==="random"&&p0(w),w.max=T-R,w.min=R,w.v=x=(parseFloat(e.amount)||parseFloat(e.each)*(F>x?x-1:h?h==="y"?x/F:F:Math.max(F,x/F))||0)*(i==="edges"?-1:1),w.b=x<0?s-x:s,w.u=Dn(e.amount||e.each)||0,n=n&&x<0?S0(n):n}return x=(w[f]-w.min)/w.max||0,gn(w.b+(n?n(x):x)*w.v)+w.u}},af=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=Math.round(parseFloat(n)/t)*t*e;return(i-i%1)/e+(ls(n)?0:Dn(n))}},m0=function(t,e){var n=mn(t),i,s;return!n&&cs(t)&&(i=n=t.radius||ni,t.values?(t=ri(t.values),(s=!ls(t[0]))&&(i*=i)):t=af(t.increment)),Zs(e,n?tn(t)?function(o){return s=t(o),Math.abs(s-o)<=i?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),h=ni,u=0,d=t.length,f,m;d--;)s?(f=t[d].x-a,m=t[d].y-l,f=f*f+m*m):f=Math.abs(t[d]-a),f<h&&(h=f,u=d);return u=!i||h<=i?t[u]:o,s||u===o||ls(o)?u:u+Dn(o)}:af(t))},g0=function(t,e,n,i){return Zs(mn(t)?!e:n===!0?!!(n=0):!i,function(){return mn(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+n*.99))/n)*n*i)/i})},lR=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){return e.reduce(function(s,o){return o(s)},i)}},cR=function(t,e){return function(n){return t(parseFloat(n))+(e||Dn(n))}},hR=function(t,e,n){return v0(t,e,0,1,n)},_0=function(t,e,n){return Zs(n,function(i){return t[~~e(i)]})},uR=function r(t,e,n){var i=e-t;return mn(t)?_0(t,r(0,t.length),e):Zs(n,function(s){return(i+(s-t)%i)%i+t})},dR=function r(t,e,n){var i=e-t,s=i*2;return mn(t)?_0(t,r(0,t.length-1),e):Zs(n,function(o){return o=(s+(o-t)%s)%s||0,t+(o>i?s-o:o)})},Nl=function(t){for(var e=0,n="",i,s,o,a;~(i=t.indexOf("random(",e));)o=t.indexOf(")",i),a=t.charAt(i+7)==="[",s=t.substr(i+7,o-i-7).match(a?Yv:Xp),n+=t.substr(e,i-e)+g0(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),e=o+1;return n+t.substr(e,t.length-e)},v0=function(t,e,n,i,s){var o=e-t,a=i-n;return Zs(s,function(l){return n+((l-t)/o*a||0)})},pR=function r(t,e,n,i){var s=isNaN(t+e)?0:function(m){return(1-m)*t+m*e};if(!s){var o=Qe(t),a={},l,h,u,d,f;if(n===!0&&(i=1)&&(n=null),o)t={p:t},e={p:e};else if(mn(t)&&!mn(e)){for(u=[],d=t.length,f=d-2,h=1;h<d;h++)u.push(r(t[h-1],t[h]));d--,s=function(_){_*=d;var x=Math.min(f,~~_);return u[x](_-x)},n=e}else i||(t=pa(mn(t)?[]:{},t));if(!u){for(l in e)uf.call(a,t,l,"get",e[l]);s=function(_){return ff(_,a)||(o?t.p:t)}}}return Zs(n,s)},x0=function(t,e,n){var i=t.labels,s=ni,o,a,l;for(o in i)a=i[o]-e,a<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},oi=function(t,e,n){var i=t.vars,s=i[e],o,a;if(!!s)return o=i[e+"Params"],a=i.callbackScope||t,n&&Ys.length&&Hh(),o?s.apply(a,o):s.call(a)},Fl=function(t){return hs(t),t.scrollTrigger&&t.scrollTrigger.kill(!1),t.progress()<1&&oi(t,"onInterrupt"),t},ga,fR=function(t){t=!t.name&&t.default||t;var e=t.name,n=tn(t),i=e&&!n&&t.init?function(){this._props=[]}:t,s={init:Dl,render:ff,add:uf,kill:RR,modifier:PR,rawVars:0},o={targetTest:0,get:0,getSetter:pf,aliases:{},register:0};if(_a(),t!==i){if($n[e])return;ii(i,ii(Wh(t,s),o)),pa(i.prototype,pa(s,Wh(t,o))),$n[i.prop=e]=i,t.targetTest&&(Uh.push(i),Qp[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Kv(e,i),t.register&&t.register(Ui,i,kn)},ve=255,Ol={aqua:[0,ve,ve],lime:[0,ve,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ve],navy:[0,0,128],white:[ve,ve,ve],olive:[128,128,0],yellow:[ve,ve,0],orange:[ve,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ve,0,0],pink:[ve,192,203],cyan:[0,ve,ve],transparent:[ve,ve,ve,0]},lf=function(t,e,n){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(n-e)*t*6:t<.5?n:t*3<2?e+(n-e)*(2/3-t)*6:e)*ve+.5|0},y0=function(t,e,n){var i=t?ls(t)?[t>>16,t>>8&ve,t&ve]:0:Ol.black,s,o,a,l,h,u,d,f,m,_;if(!i){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Ol[t])i=Ol[t];else if(t.charAt(0)==="#"){if(t.length<6&&(s=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+s+s+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return i=parseInt(t.substr(1,6),16),[i>>16,i>>8&ve,i&ve,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),i=[t>>16,t>>8&ve,t&ve]}else if(t.substr(0,3)==="hsl"){if(i=_=t.match(Xp),!e)l=+i[0]%360/360,h=+i[1]/100,u=+i[2]/100,o=u<=.5?u*(h+1):u+h-u*h,s=u*2-o,i.length>3&&(i[3]*=1),i[0]=lf(l+1/3,s,o),i[1]=lf(l,s,o),i[2]=lf(l-1/3,s,o);else if(~t.indexOf("="))return i=t.match($v),n&&i.length<4&&(i[3]=1),i}else i=t.match(Xp)||Ol.transparent;i=i.map(Number)}return e&&!_&&(s=i[0]/ve,o=i[1]/ve,a=i[2]/ve,d=Math.max(s,o,a),f=Math.min(s,o,a),u=(d+f)/2,d===f?l=h=0:(m=d-f,h=u>.5?m/(2-d-f):m/(d+f),l=d===s?(o-a)/m+(o<a?6:0):d===o?(a-s)/m+2:(s-o)/m+4,l*=60),i[0]=~~(l+.5),i[1]=~~(h*100+.5),i[2]=~~(u*100+.5)),n&&i.length<4&&(i[3]=1),i},b0=function(t){var e=[],n=[],i=-1;return t.split(Js).forEach(function(s){var o=s.match(da)||[];e.push.apply(e,o),n.push(i+=o.length+1)}),e.c=n,e},w0=function(t,e,n){var i="",s=(t+i).match(Js),o=e?"hsla(":"rgba(",a=0,l,h,u,d;if(!s)return t;if(s=s.map(function(f){return(f=y0(f,e,1))&&o+(e?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),n&&(u=b0(t),l=n.c,l.join(i)!==u.c.join(i)))for(h=t.replace(Js,"1").split(da),d=h.length-1;a<d;a++)i+=h[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:n).shift());if(!h)for(h=t.split(Js),d=h.length-1;a<d;a++)i+=h[a]+s[a];return i+h[d]},Js=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Ol)r+="|"+t+"\\b";return new RegExp(r+")","gi")}(),mR=/hsl[a]?\(/,M0=function(t){var e=t.join(" "),n;if(Js.lastIndex=0,Js.test(e))return n=mR.test(e),t[1]=w0(t[1],n),t[0]=w0(t[0],n,b0(t[1])),!0},$h,ai=function(){var r=Date.now,t=500,e=33,n=r(),i=n,s=1e3/240,o=s,a=[],l,h,u,d,f,m,_=function x(w){var v=r()-i,y=w===!0,C,S,M,E;if(v>t&&(n+=v-e),i+=v,M=i-n,C=M-o,(C>0||y)&&(E=++d.frame,f=M-d.time*1e3,d.time=M=M/1e3,o+=C+(C>=s?4:s-C),S=1),y||(l=h(x)),S)for(m=0;m<a.length;m++)a[m](M,f,E,w)};return d={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(w){return f/(1e3/(w||60))},wake:function(){Zv&&(!Zp&&qv()&&(Vi=Zp=window,Jp=Vi.document||{},jn.gsap=Ui,(Vi.gsapVersions||(Vi.gsapVersions=[])).push(Ui.version),Jv(Vh||Vi.GreenSockGlobals||!Vi.gsap&&Vi||{}),u=Vi.requestAnimationFrame),l&&d.sleep(),h=u||function(w){return setTimeout(w,o-d.time*1e3+1|0)},$h=1,_(2))},sleep:function(){(u?Vi.cancelAnimationFrame:clearTimeout)(l),$h=0,h=Dl},lagSmoothing:function(w,v){t=w||1/_e,e=Math.min(v,t,0)},fps:function(w){s=1e3/(w||240),o=d.time*1e3+s},add:function(w){a.indexOf(w)<0&&a.push(w),_a()},remove:function(w,v){~(v=a.indexOf(w))&&a.splice(v,1)&&m>=v&&m--},_listeners:a},d}(),_a=function(){return!$h&&ai.wake()},ie={},gR=/^[\d.\-M][\d.\-,\s]/,_R=/["']/g,vR=function(t){for(var e={},n=t.substr(1,t.length-3).split(":"),i=n[0],s=1,o=n.length,a,l,h;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,h=l.substr(0,a),e[i]=isNaN(h)?h.replace(_R,"").trim():+h,i=l.substr(a+1).trim();return e},xR=function(t){var e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.indexOf("(",e);return t.substring(e,~i&&i<n?t.indexOf(")",n+1):n)},yR=function(t){var e=(t+"").split("("),n=ie[e[0]];return n&&e.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[vR(e[1])]:xR(t).split(",").map(i0)):ie._CE&&gR.test(t)?ie._CE("",t):n},S0=function(t){return function(e){return 1-t(1-e)}},T0=function r(t,e){for(var n=t._first,i;n;)n instanceof Ln?r(n,e):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==e&&(n.timeline?r(n.timeline,e):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=e)),n=n._next},Or=function(t,e){return t&&(tn(t)?t:ie[t]||yR(t))||e},zr=function(t,e,n,i){n===void 0&&(n=function(l){return 1-e(1-l)}),i===void 0&&(i=function(l){return l<.5?e(l*2)/2:1-e((1-l)*2)/2});var s={easeIn:e,easeOut:n,easeInOut:i},o;return Rn(t,function(a){ie[a]=jn[a]=s,ie[o=a.toLowerCase()]=n;for(var l in s)ie[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=ie[a+"."+l]=s[l]}),s},E0=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},cf=function r(t,e,n){var i=e>=1?e:1,s=(n||(t?.3:.45))/(e<1?e:1),o=s/jp*(Math.asin(1/i)||0),a=function(u){return u===1?1:i*Math.pow(2,-10*u)*$P((u-o)*s)+1},l=t==="out"?a:t==="in"?function(h){return 1-a(1-h)}:E0(a);return s=jp/s,l.config=function(h,u){return r(t,h,u)},l},hf=function r(t,e){e===void 0&&(e=1.70158);var n=function(o){return o?--o*o*((e+1)*o+e)+1:0},i=t==="out"?n:t==="in"?function(s){return 1-n(1-s)}:E0(n);return i.config=function(s){return r(t,s)},i};Rn("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,t){var e=t<5?t+1:t;zr(r+",Power"+(e-1),t?function(n){return Math.pow(n,e)}:function(n){return n},function(n){return 1-Math.pow(1-n,e)},function(n){return n<.5?Math.pow(n*2,e)/2:1-Math.pow((1-n)*2,e)/2})});ie.Linear.easeNone=ie.none=ie.Linear.easeIn;zr("Elastic",cf("in"),cf("out"),cf());(function(r,t){var e=1/t,n=2*e,i=2.5*e,s=function(a){return a<e?r*a*a:a<n?r*Math.pow(a-1.5/t,2)+.75:a<i?r*(a-=2.25/t)*a+.9375:r*Math.pow(a-2.625/t,2)+.984375};zr("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);zr("Expo",function(r){return r?Math.pow(2,10*(r-1)):0});zr("Circ",function(r){return-(Gv(1-r*r)-1)});zr("Sine",function(r){return r===1?1:-jP(r*GP)+1});zr("Back",hf("in"),hf("out"),hf());ie.SteppedEase=ie.steps=jn.SteppedEase={config:function(t,e){t===void 0&&(t=1);var n=1/t,i=t+(e?0:1),s=e?1:0,o=1-_e;return function(a){return((i*Il(0,o,a)|0)+s)*n}}};ua.ease=ie["quad.out"];Rn("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return nf+=r+","+r+"Params,"});var C0=function(t,e){this.id=qP++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:e0,this.set=e?e.getSetter:pf},zl=function(){function r(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,ma(this,+e.duration,1,1),this.data=e.data,$h||ai.wake()}var t=r.prototype;return t.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},t.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},t.totalDuration=function(n){return arguments.length?(this._dirty=0,ma(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(n,i){if(_a(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(a0(this,n),!s._dp||s.parent||l0(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Bi(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===_e||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),n0(this,n,i)),this},t.time=function(n,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+o0(this))%(this._dur+this._rDelay)||(n?this._dur:0),i):this._time},t.totalProgress=function(n,i){return arguments.length?this.totalTime(this.totalDuration()*n,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(n,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+o0(this),i):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(n,i){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,i):this._repeat?fa(this._tTime,s)+1:1},t.timeScale=function(n){if(!arguments.length)return this._rts===-_e?0:this._rts;if(this._rts===n)return this;var i=this.parent&&this._ts?qh(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-_e?0:this._rts,QP(this.totalTime(Il(-this._delay,this._tDur,i),!0)),jh(this),this},t.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_a(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_e&&(this._tTime-=_e)))),this):this._ps},t.startTime=function(n){if(arguments.length){this._start=n;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Bi(i,this,n-this._delay),this}return this._start},t.endTime=function(n){return this._start+(Pn(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(n){var i=this.parent||this._dp;return i?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?qh(i.rawTime(n),this):this._tTime:this._tTime},t.globalTime=function(n){for(var i=this,s=arguments.length?n:i.rawTime();i;)s=i._start+s/(i._ts||1),i=i._dp;return s},t.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,u0(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(n){if(arguments.length){var i=this._time;return this._rDelay=n,u0(this),i?this.time(i):this}return this._rDelay},t.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},t.seek=function(n,i){return this.totalTime(si(this,n),Pn(i))},t.restart=function(n,i){return this.play().totalTime(n?-this._delay:0,Pn(i))},t.play=function(n,i){return n!=null&&this.seek(n,i),this.reversed(!1).paused(!1)},t.reverse=function(n,i){return n!=null&&this.seek(n||this.totalDuration(),i),this.reversed(!0).paused(!1)},t.pause=function(n,i){return n!=null&&this.seek(n,i),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-_e:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-_e,this},t.isActive=function(){var n=this.parent||this._dp,i=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=i&&s<this.endTime(!0)-_e)},t.eventCallback=function(n,i,s){var o=this.vars;return arguments.length>1?(i?(o[n]=i,s&&(o[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=i)):delete o[n],this):o[n]},t.then=function(n){var i=this;return new Promise(function(s){var o=tn(n)?n:s0,a=function(){var h=i.then;i.then=null,tn(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=h),s(o),i.then=h};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?a():i._prom=a})},t.kill=function(){Fl(this)},r}();ii(zl.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_e,_prom:0,_ps:!1,_rts:1});var Ln=function(r){Wv(t,r);function t(n,i){var s;return n===void 0&&(n={}),s=r.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=Pn(n.sortChildren),ke&&Bi(n.parent||ke,as(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&c0(as(s),n.scrollTrigger),s}var e=t.prototype;return e.to=function(i,s,o){return kl(0,arguments,this),this},e.from=function(i,s,o){return kl(1,arguments,this),this},e.fromTo=function(i,s,o,a){return kl(2,arguments,this),this},e.set=function(i,s,o){return s.duration=0,s.parent=this,Ll(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new en(i,s,si(this,o),1),this},e.call=function(i,s,o){return Bi(this,en.delayedCall(0,i,s),o)},e.staggerTo=function(i,s,o,a,l,h,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=h,o.onCompleteParams=u,o.parent=this,new en(i,o,si(this,l)),this},e.staggerFrom=function(i,s,o,a,l,h,u){return o.runBackwards=1,Ll(o).immediateRender=Pn(o.immediateRender),this.staggerTo(i,s,o,a,l,h,u)},e.staggerFromTo=function(i,s,o,a,l,h,u,d){return a.startAt=o,Ll(a).immediateRender=Pn(a.immediateRender),this.staggerTo(i,s,a,l,h,u,d)},e.render=function(i,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,h=this._dur,u=i<=0?0:gn(i),d=this._zTime<0!=i<0&&(this._initted||!h),f,m,_,x,w,v,y,C,S,M,E,T;if(this!==ke&&u>l&&i>=0&&(u=l),u!==this._tTime||o||d){if(a!==this._time&&h&&(u+=this._time-a,i+=this._time-a),f=u,S=this._start,C=this._ts,v=!C,d&&(h||(a=this._zTime),(i||!s)&&(this._zTime=i)),this._repeat){if(E=this._yoyo,w=h+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(w*100+i,s,o);if(f=gn(u%w),u===l?(x=this._repeat,f=h):(x=~~(u/w),x&&x===u/w&&(f=h,x--),f>h&&(f=h)),M=fa(this._tTime,w),!a&&this._tTime&&M!==x&&(M=x),E&&x&1&&(f=h-f,T=1),x!==M&&!this._lock){var R=E&&M&1,F=R===(E&&x&1);if(x<M&&(R=!R),a=R?0:h,this._lock=1,this.render(a||(T?0:gn(x*w)),s,!h)._lock=0,this._tTime=u,!s&&this.parent&&oi(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||v!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,l=this._tDur,F&&(this._lock=2,a=R?h:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!v)return this;T0(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(y=iR(this,gn(a),gn(f)),y&&(u-=f-(f=y._start))),this._tTime=u,this._time=f,this._act=!C,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,a=0),!a&&f&&!s&&(oi(this,"onStart"),this._tTime!==u))return this;if(f>=a&&i>=0)for(m=this._first;m;){if(_=m._next,(m._act||f>=m._start)&&m._ts&&y!==m){if(m.parent!==this)return this.render(i,s,o);if(m.render(m._ts>0?(f-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(f-m._start)*m._ts,s,o),f!==this._time||!this._ts&&!v){y=0,_&&(u+=this._zTime=-_e);break}}m=_}else{m=this._last;for(var z=i<0?i:f;m;){if(_=m._prev,(m._act||z<=m._end)&&m._ts&&y!==m){if(m.parent!==this)return this.render(i,s,o);if(m.render(m._ts>0?(z-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(z-m._start)*m._ts,s,o),f!==this._time||!this._ts&&!v){y=0,_&&(u+=this._zTime=z?-_e:_e);break}}m=_}}if(y&&!s&&(this.pause(),y.render(f>=a?0:-_e)._zTime=f>=a?1:-1,this._ts))return this._start=S,jh(this),this.render(i,s,o);this._onUpdate&&!s&&oi(this,"onUpdate",!0),(u===l&&l>=this.totalDuration()||!u&&a)&&(S===this._start||Math.abs(C)!==Math.abs(this._ts))&&(this._lock||((i||!h)&&(u===l&&this._ts>0||!u&&this._ts<0)&&hs(this,1),!s&&!(i<0&&!a)&&(u||a||!l)&&(oi(this,u===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(i,s){var o=this;if(ls(s)||(s=si(this,s,i)),!(i instanceof zl)){if(mn(i))return i.forEach(function(a){return o.add(a,s)}),this;if(Qe(i))return this.addLabel(i,s);if(tn(i))i=en.delayedCall(0,i);else return this}return this!==i?Bi(this,i,s):this},e.getChildren=function(i,s,o,a){i===void 0&&(i=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-ni);for(var l=[],h=this._first;h;)h._start>=a&&(h instanceof en?s&&l.push(h):(o&&l.push(h),i&&l.push.apply(l,h.getChildren(!0,s,o)))),h=h._next;return l},e.getById=function(i){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===i)return s[o]},e.remove=function(i){return Qe(i)?this.removeLabel(i):tn(i)?this.killTweensOf(i):(Gh(this,i),i===this._recent&&(this._recent=this._last),Fr(this))},e.totalTime=function(i,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=gn(ai.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),r.prototype.totalTime.call(this,i,s),this._forcing=0,this):this._tTime},e.addLabel=function(i,s){return this.labels[i]=si(this,s),this},e.removeLabel=function(i){return delete this.labels[i],this},e.addPause=function(i,s,o){var a=en.delayedCall(0,s||Dl,o);return a.data="isPause",this._hasPause=1,Bi(this,a,si(this,i))},e.removePause=function(i){var s=this._first;for(i=si(this,i);s;)s._start===i&&s.data==="isPause"&&hs(s),s=s._next},e.killTweensOf=function(i,s,o){for(var a=this.getTweensOf(i,o),l=a.length;l--;)Ks!==a[l]&&a[l].kill(i,s);return this},e.getTweensOf=function(i,s){for(var o=[],a=ri(i),l=this._first,h=ls(s),u;l;)l instanceof en?YP(l._targets,a)&&(h?(!Ks||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(u=l.getTweensOf(a,s)).length&&o.push.apply(o,u),l=l._next;return o},e.tweenTo=function(i,s){s=s||{};var o=this,a=si(o,i),l=s,h=l.startAt,u=l.onStart,d=l.onStartParams,f=l.immediateRender,m,_=en.to(o,ii({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(h&&"time"in h?h.time:o._time))/o.timeScale())||_e,onStart:function(){if(o.pause(),!m){var w=s.duration||Math.abs((a-(h&&"time"in h?h.time:o._time))/o.timeScale());_._dur!==w&&ma(_,w,0,1).render(_._time,!0,!0),m=1}u&&u.apply(_,d||[])}},s));return f?_.render(0):_},e.tweenFromTo=function(i,s,o){return this.tweenTo(s,ii({startAt:{time:si(this,i)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(i){return i===void 0&&(i=this._time),x0(this,si(this,i))},e.previousLabel=function(i){return i===void 0&&(i=this._time),x0(this,si(this,i),1)},e.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+_e)},e.shiftChildren=function(i,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,h;a;)a._start>=o&&(a._start+=i,a._end+=i),a=a._next;if(s)for(h in l)l[h]>=o&&(l[h]+=i);return Fr(this)},e.invalidate=function(){var i=this._first;for(this._lock=0;i;)i.invalidate(),i=i._next;return r.prototype.invalidate.call(this)},e.clear=function(i){i===void 0&&(i=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),Fr(this)},e.totalDuration=function(i){var s=0,o=this,a=o._last,l=ni,h,u,d;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-i:i));if(o._dirty){for(d=o.parent;a;)h=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,Bi(o,a,u-a._delay,1)._lock=0):l=u,u<0&&a._ts&&(s-=u,(!d&&!o._dp||d&&d.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=h;ma(o,o===ke&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(i){if(ke._ts&&(n0(ke,qh(i,ke)),Qv=ai.frame),ai.frame>=t0){t0+=qn.autoSleep||120;var s=ke._first;if((!s||!s._ts)&&qn.autoSleep&&ai._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||ai.sleep()}}},t}(zl);ii(Ln.prototype,{_lock:0,_hasPause:0,_forcing:0});var bR=function(t,e,n,i,s,o,a){var l=new kn(this._pt,t,e,0,1,k0,null,s),h=0,u=0,d,f,m,_,x,w,v,y;for(l.b=n,l.e=i,n+="",i+="",(v=~i.indexOf("random("))&&(i=Nl(i)),o&&(y=[n,i],o(y,t,e),n=y[0],i=y[1]),f=n.match(Yp)||[];d=Yp.exec(i);)_=d[0],x=i.substring(h,d.index),m?m=(m+1)%5:x.substr(-5)==="rgba("&&(m=1),_!==f[u++]&&(w=parseFloat(f[u-1])||0,l._pt={_next:l._pt,p:x||u===1?x:",",s:w,c:_.charAt(1)==="="?parseFloat(_.substr(2))*(_.charAt(0)==="-"?-1:1):parseFloat(_)-w,m:m&&m<4?Math.round:0},h=Yp.lastIndex);return l.c=h<i.length?i.substring(h,i.length):"",l.fp=a,(Xv.test(i)||v)&&(l.e=0),this._pt=l,l},uf=function(t,e,n,i,s,o,a,l,h){tn(i)&&(i=i(s||0,t,o));var u=t[e],d=n!=="get"?n:tn(u)?h?t[e.indexOf("set")||!tn(t["get"+e.substr(3)])?e:"get"+e.substr(3)](h):t[e]():u,f=tn(u)?h?ER:D0:df,m;if(Qe(i)&&(~i.indexOf("random(")&&(i=Nl(i)),i.charAt(1)==="="&&(m=parseFloat(d)+parseFloat(i.substr(2))*(i.charAt(0)==="-"?-1:1)+(Dn(d)||0),(m||m===0)&&(i=m))),d!==i)return!isNaN(d*i)&&i!==""?(m=new kn(this._pt,t,e,+d||0,i-(d||0),typeof u=="boolean"?AR:L0,0,f),h&&(m.fp=h),a&&m.modifier(a,this,t),this._pt=m):(!u&&!(e in t)&&Kp(e,i),bR.call(this,t,e,d,i,f,l||qn.stringFilter,h))},wR=function(t,e,n,i,s){if(tn(t)&&(t=Vl(t,s,e,n,i)),!cs(t)||t.style&&t.nodeType||mn(t)||jv(t))return Qe(t)?Vl(t,s,e,n,i):t;var o={},a;for(a in t)o[a]=Vl(t[a],s,e,n,i);return o},A0=function(t,e,n,i,s,o){var a,l,h,u;if($n[t]&&(a=new $n[t]).init(s,a.rawVars?e[t]:wR(e[t],i,s,o,n),n,i,o)!==!1&&(n._pt=l=new kn(n._pt,s,t,0,1,a.render,a,0,a.priority),n!==ga))for(h=n._ptLookup[n._targets.indexOf(s)],u=a._props.length;u--;)h[a._props[u]]=l;return a},Ks,MR=function r(t,e){var n=t.vars,i=n.ease,s=n.startAt,o=n.immediateRender,a=n.lazy,l=n.onUpdate,h=n.onUpdateParams,u=n.callbackScope,d=n.runBackwards,f=n.yoyoEase,m=n.keyframes,_=n.autoRevert,x=t._dur,w=t._startAt,v=t._targets,y=t.parent,C=y&&y.data==="nested"?y.parent._targets:v,S=t._overwrite==="auto"&&!qp,M=t.timeline,E,T,R,F,z,L,A,D,I,B,k,G,tt;if(M&&(!m||!i)&&(i="none"),t._ease=Or(i,ua.ease),t._yEase=f?S0(Or(f===!0?i:f,ua.ease)):0,f&&t._yoyo&&!t._repeat&&(f=t._yEase,t._yEase=t._ease,t._ease=f),t._from=!M&&!!n.runBackwards,!M||m&&!n.stagger){if(D=v[0]?Nr(v[0]).harness:0,G=D&&n[D.prop],E=Wh(n,Qp),w&&hs(w.render(-1,!0)),s)if(hs(t._startAt=en.set(v,ii({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:Pn(a),startAt:null,delay:0,onUpdate:l,onUpdateParams:h,callbackScope:u,stagger:0},s))),e<0&&!o&&!_&&t._startAt.render(-1,!0),o){if(e>0&&!_&&(t._startAt=0),x&&e<=0){e&&(t._zTime=e);return}}else _===!1&&(t._startAt=0);else if(d&&x){if(w)!_&&(t._startAt=0);else if(e&&(o=!1),R=ii({overwrite:!1,data:"isFromStart",lazy:o&&Pn(a),immediateRender:o,stagger:0,parent:y},E),G&&(R[D.prop]=G),hs(t._startAt=en.set(v,R)),e<0&&t._startAt.render(-1,!0),t._zTime=e,!o)r(t._startAt,_e);else if(!e)return}for(t._pt=0,a=x&&Pn(a)||a&&!x,T=0;T<v.length;T++){if(z=v[T],A=z._gsap||sf(v)[T]._gsap,t._ptLookup[T]=B={},tf[A.id]&&Ys.length&&Hh(),k=C===v?T:C.indexOf(z),D&&(I=new D).init(z,G||E,t,k,C)!==!1&&(t._pt=F=new kn(t._pt,z,I.name,0,1,I.render,I,0,I.priority),I._props.forEach(function(K){B[K]=F}),I.priority&&(L=1)),!D||G)for(R in E)$n[R]&&(I=A0(R,E,t,k,z,C))?I.priority&&(L=1):B[R]=F=uf.call(t,z,R,"get",E[R],k,C,0,n.stringFilter);t._op&&t._op[T]&&t.kill(z,t._op[T]),S&&t._pt&&(Ks=t,ke.killTweensOf(z,B,t.globalTime(e)),tt=!t.parent,Ks=0),t._pt&&a&&(tf[A.id]=1)}L&&I0(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!tt,m&&e<=0&&M.render(ni,!0,!0)},SR=function(t,e){var n=t[0]?Nr(t[0]).harness:0,i=n&&n.aliases,s,o,a,l;if(!i)return e;s=pa({},e);for(o in i)if(o in s)for(l=i[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},TR=function(t,e,n,i){var s=e.ease||i||"power1.inOut",o,a;if(mn(e))a=n[t]||(n[t]=[]),e.forEach(function(l,h){return a.push({t:h/(e.length-1)*100,v:l,e:s})});else for(o in e)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:s})},Vl=function(t,e,n,i,s){return tn(t)?t.call(e,n,i,s):Qe(t)&&~t.indexOf("random(")?Nl(t):t},P0=nf+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",R0={};Rn(P0+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return R0[r]=1});var en=function(r){Wv(t,r);function t(n,i,s,o){var a;typeof i=="number"&&(s.duration=i,i=s,s=null),a=r.call(this,o?i:Ll(i))||this;var l=a.vars,h=l.duration,u=l.delay,d=l.immediateRender,f=l.stagger,m=l.overwrite,_=l.keyframes,x=l.defaults,w=l.scrollTrigger,v=l.yoyoEase,y=i.parent||ke,C=(mn(n)||jv(n)?ls(n[0]):"length"in i)?[n]:ri(n),S,M,E,T,R,F,z,L;if(a._targets=C.length?sf(C):Bh("GSAP target "+n+" not found. https://greensock.com",!qn.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=m,_||f||zh(h)||zh(u)){if(i=a.vars,S=a.timeline=new Ln({data:"nested",defaults:x||{}}),S.kill(),S.parent=S._dp=as(a),S._start=0,f||zh(h)||zh(u)){if(T=C.length,z=f&&f0(f),cs(f))for(R in f)~P0.indexOf(R)&&(L||(L={}),L[R]=f[R]);for(M=0;M<T;M++)E=Wh(i,R0),E.stagger=0,v&&(E.yoyoEase=v),L&&pa(E,L),F=C[M],E.duration=+Vl(h,as(a),M,F,C),E.delay=(+Vl(u,as(a),M,F,C)||0)-a._delay,!f&&T===1&&E.delay&&(a._delay=u=E.delay,a._start+=u,E.delay=0),S.to(F,E,z?z(M,F,C):0),S._ease=ie.none;S.duration()?h=u=0:a.timeline=0}else if(_){Ll(ii(S.vars.defaults,{ease:"none"})),S._ease=Or(_.ease||i.ease||"none");var A=0,D,I,B;if(mn(_))_.forEach(function(k){return S.to(C,k,">")});else{E={};for(R in _)R==="ease"||R==="easeEach"||TR(R,_[R],E,_.easeEach);for(R in E)for(D=E[R].sort(function(k,G){return k.t-G.t}),A=0,M=0;M<D.length;M++)I=D[M],B={ease:I.e,duration:(I.t-(M?D[M-1].t:0))/100*h},B[R]=I.v,S.to(C,B,A),A+=B.duration;S.duration()<h&&S.to({},{duration:h-S.duration()})}}h||a.duration(h=S.duration())}else a.timeline=0;return m===!0&&!qp&&(Ks=as(a),ke.killTweensOf(C),Ks=0),Bi(y,as(a),s),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(d||!h&&!_&&a._start===gn(y._time)&&Pn(d)&&tR(as(a))&&y.data!=="nested")&&(a._tTime=-_e,a.render(Math.max(0,-u))),w&&c0(as(a),w),a}var e=t.prototype;return e.render=function(i,s,o){var a=this._time,l=this._tDur,h=this._dur,u=i>l-_e&&i>=0?l:i<_e?0:i,d,f,m,_,x,w,v,y,C;if(!h)nR(this,i,s,o);else if(u!==this._tTime||!i||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=i<0){if(d=u,y=this.timeline,this._repeat){if(_=h+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(_*100+i,s,o);if(d=gn(u%_),u===l?(m=this._repeat,d=h):(m=~~(u/_),m&&m===u/_&&(d=h,m--),d>h&&(d=h)),w=this._yoyo&&m&1,w&&(C=this._yEase,d=h-d),x=fa(this._tTime,_),d===a&&!o&&this._initted)return this;m!==x&&(y&&this._yEase&&T0(y,w),this.vars.repeatRefresh&&!w&&!this._lock&&(this._lock=o=1,this.render(gn(_*m),!0).invalidate()._lock=0))}if(!this._initted){if(h0(this,i<0?i:d,o,s))return this._tTime=0,this;if(h!==this._dur)return this.render(i,s,o)}if(this._tTime=u,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(C||this._ease)(d/h),this._from&&(this.ratio=v=1-v),d&&!a&&!s&&(oi(this,"onStart"),this._tTime!==u))return this;for(f=this._pt;f;)f.r(v,f.d),f=f._next;y&&y.render(i<0?i:!d&&w?-_e:y._dur*y._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=i),this._onUpdate&&!s&&(i<0&&this._startAt&&this._startAt.render(i,!0,o),oi(this,"onUpdate")),this._repeat&&m!==x&&this.vars.onRepeat&&!s&&this.parent&&oi(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(i<0&&this._startAt&&!this._onUpdate&&this._startAt.render(i,!0,!0),(i||!h)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&hs(this,1),!s&&!(i<0&&!a)&&(u||a)&&(oi(this,u===l?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),r.prototype.invalidate.call(this)},e.kill=function(i,s){if(s===void 0&&(s="all"),!i&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Fl(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(i,s,Ks&&Ks.vars.overwrite!==!0)._first||Fl(this),this.parent&&o!==this.timeline.totalDuration()&&ma(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=i?ri(i):a,h=this._ptLookup,u=this._pt,d,f,m,_,x,w,v;if((!s||s==="all")&&JP(a,l))return s==="all"&&(this._pt=0),Fl(this);for(d=this._op=this._op||[],s!=="all"&&(Qe(s)&&(x={},Rn(s,function(y){return x[y]=1}),s=x),s=SR(a,s)),v=a.length;v--;)if(~l.indexOf(a[v])){f=h[v],s==="all"?(d[v]=s,_=f,m={}):(m=d[v]=d[v]||{},_=s);for(x in _)w=f&&f[x],w&&((!("kill"in w.d)||w.d.kill(x)===!0)&&Gh(this,w,"_pt"),delete f[x]),m!=="all"&&(m[x]=1)}return this._initted&&!this._pt&&u&&Fl(this),this},t.to=function(i,s){return new t(i,s,arguments[2])},t.from=function(i,s){return kl(1,arguments)},t.delayedCall=function(i,s,o,a){return new t(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(i,s,o){return kl(2,arguments)},t.set=function(i,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new t(i,s)},t.killTweensOf=function(i,s,o){return ke.killTweensOf(i,s,o)},t}(zl);ii(en.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Rn("staggerTo,staggerFrom,staggerFromTo",function(r){en[r]=function(){var t=new Ln,e=of.call(arguments,0);return e.splice(r==="staggerFromTo"?5:4,0,0),t[r].apply(t,e)}});var df=function(t,e,n){return t[e]=n},D0=function(t,e,n){return t[e](n)},ER=function(t,e,n,i){return t[e](i.fp,n)},CR=function(t,e,n){return t.setAttribute(e,n)},pf=function(t,e){return tn(t[e])?D0:$p(t[e])&&t.setAttribute?CR:df},L0=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},AR=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},k0=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(t===1&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round((n.s+n.c*t)*1e4)/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},ff=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},PR=function(t,e,n,i){for(var s=this._pt,o;s;)o=s._next,s.p===i&&s.modifier(t,e,n),s=o},RR=function(t){for(var e=this._pt,n,i;e;)i=e._next,e.p===t&&!e.op||e.op===t?Gh(this,e,"_pt"):e.dep||(n=1),e=i;return!n},DR=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},I0=function(t){for(var e=t._pt,n,i,s,o;e;){for(n=e._next,i=s;i&&i.pr>e.pr;)i=i._next;(e._prev=i?i._prev:o)?e._prev._next=e:s=e,(e._next=i)?i._prev=e:o=e,e=n}t._pt=s},kn=function(){function r(e,n,i,s,o,a,l,h,u){this.t=n,this.s=s,this.c=o,this.p=i,this.r=a||L0,this.d=l||this,this.set=h||df,this.pr=u||0,this._next=e,e&&(e._prev=this)}var t=r.prototype;return t.modifier=function(n,i,s){this.mSet=this.mSet||this.set,this.set=DR,this.m=n,this.mt=s,this.tween=i},r}();Rn(nf+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return Qp[r]=1});jn.TweenMax=jn.TweenLite=en;jn.TimelineLite=jn.TimelineMax=Ln;ke=new Ln({sortChildren:!1,defaults:ua,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});qn.stringFilter=M0;var Xh={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(i){return fR(i)})},timeline:function(t){return new Ln(t)},getTweensOf:function(t,e){return ke.getTweensOf(t,e)},getProperty:function(t,e,n,i){Qe(t)&&(t=ri(t)[0]);var s=Nr(t||{}).get,o=n?s0:i0;return n==="native"&&(n=""),t&&(e?o(($n[e]&&$n[e].get||s)(t,e,n,i)):function(a,l,h){return o(($n[a]&&$n[a].get||s)(t,a,l,h))})},quickSetter:function(t,e,n){if(t=ri(t),t.length>1){var i=t.map(function(u){return Ui.quickSetter(u,e,n)}),s=i.length;return function(u){for(var d=s;d--;)i[d](u)}}t=t[0]||{};var o=$n[e],a=Nr(t),l=a.harness&&(a.harness.aliases||{})[e]||e,h=o?function(u){var d=new o;ga._pt=0,d.init(t,n?u+n:u,ga,0,[t]),d.render(1,d),ga._pt&&ff(1,ga)}:a.set(t,l);return o?h:function(u){return h(t,l,n?u+n:u,a,1)}},isTweening:function(t){return ke.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Or(t.ease,ua.ease)),r0(ua,t||{})},config:function(t){return r0(qn,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,s=t.defaults,o=t.extendTimeline;(i||"").split(",").forEach(function(a){return a&&!$n[a]&&!jn[a]&&Bh(e+" effect requires "+a+" plugin.")}),ef[e]=function(a,l,h){return n(ri(a),ii(l||{},s),h)},o&&(Ln.prototype[e]=function(a,l,h){return this.add(ef[e](a,cs(l)?l:(h=l)&&{},this),h)})},registerEase:function(t,e){ie[t]=Or(e)},parseEase:function(t,e){return arguments.length?Or(t,e):ie},getById:function(t){return ke.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var n=new Ln(t),i,s;for(n.smoothChildTiming=Pn(t.smoothChildTiming),ke.remove(n),n._dp=0,n._time=n._tTime=ke._time,i=ke._first;i;)s=i._next,(e||!(!i._dur&&i instanceof en&&i.vars.onComplete===i._targets[0]))&&Bi(n,i,i._start-i._delay),i=s;return Bi(ke,n,0),n},utils:{wrap:uR,wrapYoyo:dR,distribute:f0,random:g0,snap:m0,normalize:hR,getUnit:Dn,clamp:rR,splitColor:y0,toArray:ri,selector:aR,mapRange:v0,pipe:lR,unitize:cR,interpolate:pR,shuffle:p0},install:Jv,effects:ef,ticker:ai,updateRoot:Ln.updateRoot,plugins:$n,globalTimeline:ke,core:{PropTween:kn,globals:Kv,Tween:en,Timeline:Ln,Animation:zl,getCache:Nr,_removeLinkedListItem:Gh,suppressOverwrites:function(t){return qp=t}}};Rn("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return Xh[r]=en[r]});ai.add(Ln.updateRoot);ga=Xh.to({},{duration:0});var LR=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},kR=function(t,e){var n=t._targets,i,s,o;for(i in e)for(s=n.length;s--;)o=t._ptLookup[s][i],o&&(o=o.d)&&(o._pt&&(o=LR(o,i)),o&&o.modifier&&o.modifier(e[i],t,n[s],i))},mf=function(t,e){return{name:t,rawVars:1,init:function(i,s,o){o._onInit=function(a){var l,h;if(Qe(s)&&(l={},Rn(s,function(u){return l[u]=1}),s=l),e){l={};for(h in s)l[h]=e(s[h]);s=l}kR(a,s)}}}},Ui=Xh.registerPlugin({name:"attr",init:function(t,e,n,i,s){var o,a;for(o in e)a=this.add(t,"setAttribute",(t.getAttribute(o)||0)+"",e[o],i,s,0,0,o),a&&(a.op=o),this._props.push(o)}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n])}},mf("roundProps",af),mf("modifiers"),mf("snap",m0))||Xh;en.version=Ln.version=Ui.version="3.9.1";Zv=1;qv()&&_a();ie.Power0;ie.Power1;ie.Power2;ie.Power3;ie.Power4;ie.Linear;ie.Quad;ie.Cubic;ie.Quart;ie.Quint;ie.Strong;ie.Elastic;ie.Back;ie.SteppedEase;ie.Bounce;ie.Sine;ie.Expo;ie.Circ;/*!
 * CSSPlugin 3.9.1
 * https://greensock.com
 *
 * Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var N0,Qs,va,gf,Vr,F0,IR=function(){return typeof window!="undefined"},tr={},Br=180/Math.PI,xa=Math.PI/180,ya=Math.atan2,O0=1e8,z0=/([A-Z])/g,NR=/(?:left|right|width|margin|padding|x)/i,FR=/[\s,\(]\S/,er={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},V0=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},OR=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},zR=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},VR=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},B0=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},U0=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},BR=function(t,e,n){return t.style[e]=n},UR=function(t,e,n){return t.style.setProperty(e,n)},HR=function(t,e,n){return t._gsap[e]=n},WR=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},GR=function(t,e,n,i,s){var o=t._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},qR=function(t,e,n,i,s){var o=t._gsap;o[e]=n,o.renderTransform(s,o)},ln="transform",nr=ln+"Origin",H0,_f=function(t,e){var n=Qs.createElementNS?Qs.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Qs.createElement(t);return n.style?n:Qs.createElement(t)},us=function r(t,e,n){var i=getComputedStyle(t);return i[e]||i.getPropertyValue(e.replace(z0,"-$1").toLowerCase())||i.getPropertyValue(e)||!n&&r(t,ba(e)||e,1)||""},W0="O,Moz,ms,Ms,Webkit".split(","),ba=function(t,e,n){var i=e||Vr,s=i.style,o=5;if(t in s&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(W0[o]+t in s););return o<0?null:(o===3?"ms":o>=0?W0[o]:"")+t},vf=function(){IR()&&window.document&&(N0=window,Qs=N0.document,va=Qs.documentElement,Vr=_f("div")||{style:{}},_f("div"),ln=ba(ln),nr=ln+"Origin",Vr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",H0=!!ba("perspective"),gf=1)},xf=function r(t){var e=_f("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,i=this.nextSibling,s=this.style.cssText,o;if(va.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(i?n.insertBefore(this,i):n.appendChild(this)),va.removeChild(e),this.style.cssText=s,o},G0=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},q0=function(t){var e;try{e=t.getBBox()}catch{e=xf.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===xf||(e=xf.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+G0(t,["x","cx","x1"])||0,y:+G0(t,["y","cy","y1"])||0,width:0,height:0}:e},j0=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&q0(t))},Bl=function(t,e){if(e){var n=t.style;e in tr&&e!==nr&&(e=ln),n.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),n.removeProperty(e.replace(z0,"-$1").toLowerCase())):n.removeAttribute(e)}},ir=function(t,e,n,i,s,o){var a=new kn(t._pt,e,n,0,1,o?U0:B0);return t._pt=a,a.b=i,a.e=s,t._props.push(n),a},$0={deg:1,rad:1,turn:1},sr=function r(t,e,n,i){var s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=Vr.style,l=NR.test(e),h=t.tagName.toLowerCase()==="svg",u=(h?"client":"offset")+(l?"Width":"Height"),d=100,f=i==="px",m=i==="%",_,x,w,v;return i===o||!s||$0[i]||$0[o]?s:(o!=="px"&&!f&&(s=r(t,e,n,"px")),v=t.getCTM&&j0(t),(m||o==="%")&&(tr[e]||~e.indexOf("adius"))?(_=v?t.getBBox()[l?"width":"height"]:t[u],Ue(m?s/_*d:s/100*_)):(a[l?"width":"height"]=d+(f?o:i),x=~e.indexOf("adius")||i==="em"&&t.appendChild&&!h?t:t.parentNode,v&&(x=(t.ownerSVGElement||{}).parentNode),(!x||x===Qs||!x.appendChild)&&(x=Qs.body),w=x._gsap,w&&m&&w.width&&l&&w.time===ai.time?Ue(s/w.width*d):((m||o==="%")&&(a.position=us(t,"position")),x===t&&(a.position="static"),x.appendChild(Vr),_=Vr[u],x.removeChild(Vr),a.position="absolute",l&&m&&(w=Nr(x),w.time=ai.time,w.width=x[u]),Ue(f?_*s/d:_&&s?d/_*s:0))))},Ur=function(t,e,n,i){var s;return gf||vf(),e in er&&e!=="transform"&&(e=er[e],~e.indexOf(",")&&(e=e.split(",")[0])),tr[e]&&e!=="transform"?(s=Hl(t,i),s=e!=="transformOrigin"?s[e]:s.svg?s.origin:Zh(us(t,nr))+" "+s.zOrigin+"px"):(s=t.style[e],(!s||s==="auto"||i||~(s+"").indexOf("calc("))&&(s=Yh[e]&&Yh[e](t,e,n)||us(t,e)||e0(t,e)||(e==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?sr(t,e,s,n)+n:s},jR=function(t,e,n,i){if(!n||n==="none"){var s=ba(e,t,1),o=s&&us(t,s,1);o&&o!==n?(e=s,n=o):e==="borderColor"&&(n=us(t,"borderTopColor"))}var a=new kn(this._pt,t.style,e,0,1,k0),l=0,h=0,u,d,f,m,_,x,w,v,y,C,S,M,E;if(a.b=n,a.e=i,n+="",i+="",i==="auto"&&(t.style[e]=i,i=us(t,e)||i,t.style[e]=n),u=[n,i],M0(u),n=u[0],i=u[1],f=n.match(da)||[],E=i.match(da)||[],E.length){for(;d=da.exec(i);)w=d[0],y=i.substring(l,d.index),_?_=(_+1)%5:(y.substr(-5)==="rgba("||y.substr(-5)==="hsla(")&&(_=1),w!==(x=f[h++]||"")&&(m=parseFloat(x)||0,S=x.substr((m+"").length),M=w.charAt(1)==="="?+(w.charAt(0)+"1"):0,M&&(w=w.substr(2)),v=parseFloat(w),C=w.substr((v+"").length),l=da.lastIndex-C.length,C||(C=C||qn.units[e]||S,l===i.length&&(i+=C,a.e+=C)),S!==C&&(m=sr(t,e,x,C)||0),a._pt={_next:a._pt,p:y||h===1?y:",",s:m,c:M?M*v:v-m,m:_&&_<4||e==="zIndex"?Math.round:0});a.c=l<i.length?i.substring(l,i.length):""}else a.r=e==="display"&&i==="none"?U0:B0;return Xv.test(i)&&(a.e=0),this._pt=a,a},X0={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},$R=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return(n==="top"||n==="bottom"||i==="left"||i==="right")&&(t=n,n=i,i=t),e[0]=X0[n]||n,e[1]=X0[i]||i,e.join(" ")},XR=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n=e.t,i=n.style,s=e.u,o=n._gsap,a,l,h;if(s==="all"||s===!0)i.cssText="",l=1;else for(s=s.split(","),h=s.length;--h>-1;)a=s[h],tr[a]&&(l=1,a=a==="transformOrigin"?nr:ln),Bl(n,a);l&&(Bl(n,ln),o&&(o.svg&&n.removeAttribute("transform"),Hl(n,1),o.uncache=1))}},Yh={clearProps:function(t,e,n,i,s){if(s.data!=="isFromStart"){var o=t._pt=new kn(t._pt,e,n,0,0,XR);return o.u=i,o.pr=-10,o.tween=s,t._props.push(n),1}}},Ul=[1,0,0,1,0,0],Y0={},Z0=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},J0=function(t){var e=us(t,ln);return Z0(e)?Ul:e.substr(7).match($v).map(Ue)},yf=function(t,e){var n=t._gsap||Nr(t),i=t.style,s=J0(t),o,a,l,h;return n.svg&&t.getAttribute("transform")?(l=t.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?Ul:s):(s===Ul&&!t.offsetParent&&t!==va&&!n.svg&&(l=i.display,i.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(h=1,a=t.nextSibling,va.appendChild(t)),s=J0(t),l?i.display=l:Bl(t,"display"),h&&(a?o.insertBefore(t,a):o?o.appendChild(t):va.removeChild(t))),e&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},bf=function(t,e,n,i,s,o){var a=t._gsap,l=s||yf(t,!0),h=a.xOrigin||0,u=a.yOrigin||0,d=a.xOffset||0,f=a.yOffset||0,m=l[0],_=l[1],x=l[2],w=l[3],v=l[4],y=l[5],C=e.split(" "),S=parseFloat(C[0])||0,M=parseFloat(C[1])||0,E,T,R,F;n?l!==Ul&&(T=m*w-_*x)&&(R=S*(w/T)+M*(-x/T)+(x*y-w*v)/T,F=S*(-_/T)+M*(m/T)-(m*y-_*v)/T,S=R,M=F):(E=q0(t),S=E.x+(~C[0].indexOf("%")?S/100*E.width:S),M=E.y+(~(C[1]||C[0]).indexOf("%")?M/100*E.height:M)),i||i!==!1&&a.smooth?(v=S-h,y=M-u,a.xOffset=d+(v*m+y*x)-v,a.yOffset=f+(v*_+y*w)-y):a.xOffset=a.yOffset=0,a.xOrigin=S,a.yOrigin=M,a.smooth=!!i,a.origin=e,a.originIsAbsolute=!!n,t.style[nr]="0px 0px",o&&(ir(o,a,"xOrigin",h,S),ir(o,a,"yOrigin",u,M),ir(o,a,"xOffset",d,a.xOffset),ir(o,a,"yOffset",f,a.yOffset)),t.setAttribute("data-svg-origin",S+" "+M)},Hl=function(t,e){var n=t._gsap||new C0(t);if("x"in n&&!e&&!n.uncache)return n;var i=t.style,s=n.scaleX<0,o="px",a="deg",l=us(t,nr)||"0",h,u,d,f,m,_,x,w,v,y,C,S,M,E,T,R,F,z,L,A,D,I,B,k,G,tt,K,j,$,st,rt,xt;return h=u=d=_=x=w=v=y=C=0,f=m=1,n.svg=!!(t.getCTM&&j0(t)),E=yf(t,n.svg),n.svg&&(k=(!n.uncache||l==="0px 0px")&&!e&&t.getAttribute("data-svg-origin"),bf(t,k||l,!!k||n.originIsAbsolute,n.smooth!==!1,E)),S=n.xOrigin||0,M=n.yOrigin||0,E!==Ul&&(z=E[0],L=E[1],A=E[2],D=E[3],h=I=E[4],u=B=E[5],E.length===6?(f=Math.sqrt(z*z+L*L),m=Math.sqrt(D*D+A*A),_=z||L?ya(L,z)*Br:0,v=A||D?ya(A,D)*Br+_:0,v&&(m*=Math.abs(Math.cos(v*xa))),n.svg&&(h-=S-(S*z+M*A),u-=M-(S*L+M*D))):(xt=E[6],st=E[7],K=E[8],j=E[9],$=E[10],rt=E[11],h=E[12],u=E[13],d=E[14],T=ya(xt,$),x=T*Br,T&&(R=Math.cos(-T),F=Math.sin(-T),k=I*R+K*F,G=B*R+j*F,tt=xt*R+$*F,K=I*-F+K*R,j=B*-F+j*R,$=xt*-F+$*R,rt=st*-F+rt*R,I=k,B=G,xt=tt),T=ya(-A,$),w=T*Br,T&&(R=Math.cos(-T),F=Math.sin(-T),k=z*R-K*F,G=L*R-j*F,tt=A*R-$*F,rt=D*F+rt*R,z=k,L=G,A=tt),T=ya(L,z),_=T*Br,T&&(R=Math.cos(T),F=Math.sin(T),k=z*R+L*F,G=I*R+B*F,L=L*R-z*F,B=B*R-I*F,z=k,I=G),x&&Math.abs(x)+Math.abs(_)>359.9&&(x=_=0,w=180-w),f=Ue(Math.sqrt(z*z+L*L+A*A)),m=Ue(Math.sqrt(B*B+xt*xt)),T=ya(I,B),v=Math.abs(T)>2e-4?T*Br:0,C=rt?1/(rt<0?-rt:rt):0),n.svg&&(k=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!Z0(us(t,ln)),k&&t.setAttribute("transform",k))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(f*=-1,v+=_<=0?180:-180,_+=_<=0?180:-180):(m*=-1,v+=v<=0?180:-180)),n.x=h-((n.xPercent=h&&(n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-h)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+o,n.y=u-((n.yPercent=u&&(n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-u)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+o,n.z=d+o,n.scaleX=Ue(f),n.scaleY=Ue(m),n.rotation=Ue(_)+a,n.rotationX=Ue(x)+a,n.rotationY=Ue(w)+a,n.skewX=v+a,n.skewY=y+a,n.transformPerspective=C+o,(n.zOrigin=parseFloat(l.split(" ")[2])||0)&&(i[nr]=Zh(l)),n.xOffset=n.yOffset=0,n.force3D=qn.force3D,n.renderTransform=n.svg?ZR:H0?K0:YR,n.uncache=0,n},Zh=function(t){return(t=t.split(" "))[0]+" "+t[1]},wf=function(t,e,n){var i=Dn(e);return Ue(parseFloat(e)+parseFloat(sr(t,"x",n+"px",i)))+i},YR=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,K0(t,e)},Hr="0deg",Wl="0px",Wr=") ",K0=function(t,e){var n=e||this,i=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,h=n.rotation,u=n.rotationY,d=n.rotationX,f=n.skewX,m=n.skewY,_=n.scaleX,x=n.scaleY,w=n.transformPerspective,v=n.force3D,y=n.target,C=n.zOrigin,S="",M=v==="auto"&&t&&t!==1||v===!0;if(C&&(d!==Hr||u!==Hr)){var E=parseFloat(u)*xa,T=Math.sin(E),R=Math.cos(E),F;E=parseFloat(d)*xa,F=Math.cos(E),o=wf(y,o,T*F*-C),a=wf(y,a,-Math.sin(E)*-C),l=wf(y,l,R*F*-C+C)}w!==Wl&&(S+="perspective("+w+Wr),(i||s)&&(S+="translate("+i+"%, "+s+"%) "),(M||o!==Wl||a!==Wl||l!==Wl)&&(S+=l!==Wl||M?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Wr),h!==Hr&&(S+="rotate("+h+Wr),u!==Hr&&(S+="rotateY("+u+Wr),d!==Hr&&(S+="rotateX("+d+Wr),(f!==Hr||m!==Hr)&&(S+="skew("+f+", "+m+Wr),(_!==1||x!==1)&&(S+="scale("+_+", "+x+Wr),y.style[ln]=S||"translate(0, 0)"},ZR=function(t,e){var n=e||this,i=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,h=n.skewX,u=n.skewY,d=n.scaleX,f=n.scaleY,m=n.target,_=n.xOrigin,x=n.yOrigin,w=n.xOffset,v=n.yOffset,y=n.forceCSS,C=parseFloat(o),S=parseFloat(a),M,E,T,R,F;l=parseFloat(l),h=parseFloat(h),u=parseFloat(u),u&&(u=parseFloat(u),h+=u,l+=u),l||h?(l*=xa,h*=xa,M=Math.cos(l)*d,E=Math.sin(l)*d,T=Math.sin(l-h)*-f,R=Math.cos(l-h)*f,h&&(u*=xa,F=Math.tan(h-u),F=Math.sqrt(1+F*F),T*=F,R*=F,u&&(F=Math.tan(u),F=Math.sqrt(1+F*F),M*=F,E*=F)),M=Ue(M),E=Ue(E),T=Ue(T),R=Ue(R)):(M=d,R=f,E=T=0),(C&&!~(o+"").indexOf("px")||S&&!~(a+"").indexOf("px"))&&(C=sr(m,"x",o,"px"),S=sr(m,"y",a,"px")),(_||x||w||v)&&(C=Ue(C+_-(_*M+x*T)+w),S=Ue(S+x-(_*E+x*R)+v)),(i||s)&&(F=m.getBBox(),C=Ue(C+i/100*F.width),S=Ue(S+s/100*F.height)),F="matrix("+M+","+E+","+T+","+R+","+C+","+S+")",m.setAttribute("transform",F),y&&(m.style[ln]=F)},JR=function(t,e,n,i,s,o){var a=360,l=Qe(s),h=parseFloat(s)*(l&&~s.indexOf("rad")?Br:1),u=o?h*o:h-i,d=i+u+"deg",f,m;return l&&(f=s.split("_")[1],f==="short"&&(u%=a,u!==u%(a/2)&&(u+=u<0?a:-a)),f==="cw"&&u<0?u=(u+a*O0)%a-~~(u/a)*a:f==="ccw"&&u>0&&(u=(u-a*O0)%a-~~(u/a)*a)),t._pt=m=new kn(t._pt,e,n,i,u,OR),m.e=d,m.u="deg",t._props.push(n),m},Q0=function(t,e){for(var n in e)t[n]=e[n];return t},KR=function(t,e,n){var i=Q0({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,h,u,d,f,m,_;i.svg?(h=n.getAttribute("transform"),n.setAttribute("transform",""),o[ln]=e,a=Hl(n,1),Bl(n,ln),n.setAttribute("transform",h)):(h=getComputedStyle(n)[ln],o[ln]=e,a=Hl(n,1),o[ln]=h);for(l in tr)h=i[l],u=a[l],h!==u&&s.indexOf(l)<0&&(m=Dn(h),_=Dn(u),d=m!==_?sr(n,l,h,_):parseFloat(h),f=parseFloat(u),t._pt=new kn(t._pt,a,l,d,f-d,V0),t._pt.u=_||0,t._props.push(l));Q0(a,i)};Rn("padding,margin,Width,Radius",function(r,t){var e="Top",n="Right",i="Bottom",s="Left",o=(t<3?[e,n,i,s]:[e+s,e+n,i+n,i+s]).map(function(a){return t<2?r+a:"border"+a+r});Yh[t>1?"border"+r:r]=function(a,l,h,u,d){var f,m;if(arguments.length<4)return f=o.map(function(_){return Ur(a,_,h)}),m=f.join(" "),m.split(f[0]).length===5?f[0]:m;f=(u+"").split(" "),m={},o.forEach(function(_,x){return m[_]=f[x]=f[x]||f[(x-1)/2|0]}),a.init(l,m,d)}});var tx={name:"css",register:vf,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,s){var o=this._props,a=t.style,l=n.vars.startAt,h,u,d,f,m,_,x,w,v,y,C,S,M,E,T;gf||vf();for(x in e)if(x!=="autoRound"&&(u=e[x],!($n[x]&&A0(x,e,n,i,t,s)))){if(m=typeof u,_=Yh[x],m==="function"&&(u=u.call(n,i,t,s),m=typeof u),m==="string"&&~u.indexOf("random(")&&(u=Nl(u)),_)_(this,t,x,u,n)&&(T=1);else if(x.substr(0,2)==="--")h=(getComputedStyle(t).getPropertyValue(x)+"").trim(),u+="",Js.lastIndex=0,Js.test(h)||(w=Dn(h),v=Dn(u)),v?w!==v&&(h=sr(t,x,h,v)+v):w&&(u+=w),this.add(a,"setProperty",h,u,i,s,0,0,x),o.push(x);else if(m!=="undefined"){if(l&&x in l?(h=typeof l[x]=="function"?l[x].call(n,i,t,s):l[x],Qe(h)&&~h.indexOf("random(")&&(h=Nl(h)),Dn(h+"")||(h+=qn.units[x]||Dn(Ur(t,x))||""),(h+"").charAt(1)==="="&&(h=Ur(t,x))):h=Ur(t,x),f=parseFloat(h),y=m==="string"&&u.charAt(1)==="="?+(u.charAt(0)+"1"):0,y&&(u=u.substr(2)),d=parseFloat(u),x in er&&(x==="autoAlpha"&&(f===1&&Ur(t,"visibility")==="hidden"&&d&&(f=0),ir(this,a,"visibility",f?"inherit":"hidden",d?"inherit":"hidden",!d)),x!=="scale"&&x!=="transform"&&(x=er[x],~x.indexOf(",")&&(x=x.split(",")[0]))),C=x in tr,C){if(S||(M=t._gsap,M.renderTransform&&!e.parseTransform||Hl(t,e.parseTransform),E=e.smoothOrigin!==!1&&M.smooth,S=this._pt=new kn(this._pt,a,ln,0,1,M.renderTransform,M,0,-1),S.dep=1),x==="scale")this._pt=new kn(this._pt,M,"scaleY",M.scaleY,(y?y*d:d-M.scaleY)||0),o.push("scaleY",x),x+="X";else if(x==="transformOrigin"){u=$R(u),M.svg?bf(t,u,0,E,0,this):(v=parseFloat(u.split(" ")[2])||0,v!==M.zOrigin&&ir(this,M,"zOrigin",M.zOrigin,v),ir(this,a,x,Zh(h),Zh(u)));continue}else if(x==="svgOrigin"){bf(t,u,1,E,0,this);continue}else if(x in Y0){JR(this,M,x,f,u,y);continue}else if(x==="smoothOrigin"){ir(this,M,"smooth",M.smooth,u);continue}else if(x==="force3D"){M[x]=u;continue}else if(x==="transform"){KR(this,u,t);continue}}else x in a||(x=ba(x)||x);if(C||(d||d===0)&&(f||f===0)&&!FR.test(u)&&x in a)w=(h+"").substr((f+"").length),d||(d=0),v=Dn(u)||(x in qn.units?qn.units[x]:w),w!==v&&(f=sr(t,x,h,v)),this._pt=new kn(this._pt,C?M:a,x,f,y?y*d:d-f,!C&&(v==="px"||x==="zIndex")&&e.autoRound!==!1?VR:V0),this._pt.u=v||0,w!==v&&v!=="%"&&(this._pt.b=h,this._pt.r=zR);else if(x in a)jR.call(this,t,x,h,u);else if(x in t)this.add(t,x,h||t[x],u,i,s);else{Kp(x,u);continue}o.push(x)}}T&&I0(this)},get:Ur,aliases:er,getSetter:function(t,e,n){var i=er[e];return i&&i.indexOf(",")<0&&(e=i),e in tr&&e!==nr&&(t._gsap.x||Ur(t,"x"))?n&&F0===n?e==="scale"?WR:HR:(F0=n||{})&&(e==="scale"?GR:qR):t.style&&!$p(t.style[e])?BR:~e.indexOf("-")?UR:pf(t,e)},core:{_removeProperty:Bl,_getMatrix:yf}};Ui.utils.checkPrefix=ba;(function(r,t,e,n){var i=Rn(r+","+t+","+e,function(s){tr[s]=1});Rn(t,function(s){qn.units[s]="deg",Y0[s]=1}),er[i[13]]=r+","+t,Rn(n,function(s){var o=s.split(":");er[o[1]]=i[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Rn("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){qn.units[r]="px"});Ui.registerPlugin(tx);var QR=Ui.registerPlugin(tx)||Ui;QR.core.Tween;const ex="14.7.77",nx=(r,t,e)=>({endTime:t,insertTime:e,type:"exponentialRampToValue",value:r}),ix=(r,t,e)=>({endTime:t,insertTime:e,type:"linearRampToValue",value:r}),Mf=(r,t)=>({startTime:t,type:"setValue",value:r}),sx=(r,t,e)=>({duration:e,startTime:t,type:"setValueCurve",values:r}),rx=(r,t,{startTime:e,target:n,timeConstant:i})=>n+(t-n)*Math.exp((e-r)/i),wa=r=>r.type==="exponentialRampToValue",Jh=r=>r.type==="linearRampToValue",rr=r=>wa(r)||Jh(r),Sf=r=>r.type==="setValue",ds=r=>r.type==="setValueCurve",Kh=(r,t,e,n)=>{const i=r[t];return i===void 0?n:rr(i)||Sf(i)?i.value:ds(i)?i.values[i.values.length-1]:rx(e,Kh(r,t-1,i.startTime,n),i)},ox=(r,t,e,n,i)=>e===void 0?[n.insertTime,i]:rr(e)?[e.endTime,e.value]:Sf(e)?[e.startTime,e.value]:ds(e)?[e.startTime+e.duration,e.values[e.values.length-1]]:[e.startTime,Kh(r,t-1,e.startTime,i)],Tf=r=>r.type==="cancelAndHold",Ef=r=>r.type==="cancelScheduledValues",or=r=>Tf(r)||Ef(r)?r.cancelTime:wa(r)||Jh(r)?r.endTime:r.startTime,ax=(r,t,e,{endTime:n,value:i})=>e===i?i:0<e&&0<i||e<0&&i<0?e*(i/e)**((r-t)/(n-t)):0,lx=(r,t,e,{endTime:n,value:i})=>e+(r-t)/(n-t)*(i-e),tD=(r,t)=>{const e=Math.floor(t),n=Math.ceil(t);return e===n?r[e]:(1-(t-e))*r[e]+(1-(n-t))*r[n]},eD=(r,{duration:t,startTime:e,values:n})=>{const i=(r-e)/t*(n.length-1);return tD(n,i)},Qh=r=>r.type==="setTarget";class nD{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const e=or(t);if(Tf(t)||Ef(t)){const n=this._automationEvents.findIndex(s=>Ef(t)&&ds(s)?s.startTime+s.duration>=e:or(s)>=e),i=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),Tf(t)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&rr(i)){if(Qh(s))throw new Error("The internal list is malformed.");const o=ds(s)?s.startTime+s.duration:or(s),a=ds(s)?s.values[s.values.length-1]:s.value,l=wa(i)?ax(e,o,a,i):lx(e,o,a,i),h=wa(i)?nx(l,e,this._currenTime):ix(l,e,this._currenTime);this._automationEvents.push(h)}s!==void 0&&Qh(s)&&this._automationEvents.push(Mf(this.getValue(e),e)),s!==void 0&&ds(s)&&s.startTime+s.duration>e&&(this._automationEvents[this._automationEvents.length-1]=sx(new Float32Array([6,7]),s.startTime,e-s.startTime))}}else{const n=this._automationEvents.findIndex(o=>or(o)>e),i=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(i!==void 0&&ds(i)&&or(i)+i.duration>e)return!1;const s=wa(t)?nx(t.value,t.endTime,this._currenTime):Jh(t)?ix(t.value,e,this._currenTime):t;if(n===-1)this._automationEvents.push(s);else{if(ds(t)&&e+t.duration>or(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,s)}}return!0}flush(t){const e=this._automationEvents.findIndex(n=>or(n)>t);if(e>1){const n=this._automationEvents.slice(e-1),i=n[0];Qh(i)&&n.unshift(Mf(Kh(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const e=this._automationEvents.findIndex(o=>or(o)>t),n=this._automationEvents[e],i=(e===-1?this._automationEvents.length:e)-1,s=this._automationEvents[i];if(s!==void 0&&Qh(s)&&(n===void 0||!rr(n)||n.insertTime>t))return rx(t,Kh(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&Sf(s)&&(n===void 0||!rr(n)))return s.value;if(s!==void 0&&ds(s)&&(n===void 0||!rr(n)||s.startTime+s.duration>t))return t<s.startTime+s.duration?eD(t,s):s.values[s.values.length-1];if(s!==void 0&&rr(s)&&(n===void 0||!rr(n)))return s.value;if(n!==void 0&&wa(n)){const[o,a]=ox(this._automationEvents,i,s,n,this._defaultValue);return ax(t,o,a,n)}if(n!==void 0&&Jh(n)){const[o,a]=ox(this._automationEvents,i,s,n,this._defaultValue);return lx(t,o,a,n)}return this._defaultValue}}const iD=r=>({cancelTime:r,type:"cancelAndHold"}),sD=r=>({cancelTime:r,type:"cancelScheduledValues"}),rD=(r,t)=>({endTime:t,type:"exponentialRampToValue",value:r}),oD=(r,t)=>({endTime:t,type:"linearRampToValue",value:r}),aD=(r,t,e)=>({startTime:t,target:r,timeConstant:e,type:"setTarget"}),lD=()=>new DOMException("","AbortError"),cD=r=>(t,e,[n,i,s],o)=>{r(t[i],[e,n,s],a=>a[0]===e&&a[1]===n,o)},hD=r=>(t,e,n)=>{const i=[];for(let s=0;s<n.numberOfInputs;s+=1)i.push(new Set);r.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})},uD=r=>(t,e)=>{r.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})},Ma=new WeakSet,cx=new WeakMap,Cf=new WeakMap,hx=new WeakMap,Af=new WeakMap,tu=new WeakMap,ux=new WeakMap,Pf=new WeakMap,Rf=new WeakMap,Df=new WeakMap,dx={construct(){return dx}},dD=r=>{try{const t=new Proxy(r,dx);new t}catch{return!1}return!0},px=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,fx=(r,t)=>{const e=[];let n=r.replace(/^[\s]+/,""),i=n.match(px);for(;i!==null;){const s=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,t).toString());e.push(o),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(px)}return[e.join(";"),n]},mx=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},gx=r=>{if(!dD(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},pD=(r,t,e,n,i,s,o,a,l,h,u,d,f)=>{let m=0;return(_,x,w={credentials:"omit"})=>{const v=u.get(_);if(v!==void 0&&v.has(x))return Promise.resolve();const y=h.get(_);if(y!==void 0){const M=y.get(x);if(M!==void 0)return M}const C=s(_),S=C.audioWorklet===void 0?i(x).then(([M,E])=>{const[T,R]=fx(M,E),F=`${T};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${R}
})})(window,'_AWGS')`;return e(F)}).then(()=>{const M=f._AWGS.pop();if(M===void 0)throw new SyntaxError;n(C.currentTime,C.sampleRate,()=>M(class{},void 0,(E,T)=>{if(E.trim()==="")throw t();const R=Rf.get(C);if(R!==void 0){if(R.has(E))throw t();gx(T),mx(T.parameterDescriptors),R.set(E,T)}else gx(T),mx(T.parameterDescriptors),Rf.set(C,new Map([[E,T]]))},C.sampleRate,void 0,void 0))}):Promise.all([i(x),Promise.resolve(r(d,d))]).then(([[M,E],T])=>{const R=m+1;m=R;const[F,z]=fx(M,E),I=`${F};((AudioWorkletProcessor,registerProcessor)=>{${z}
})(${T?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${T?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${T?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${R}',class extends AudioWorkletProcessor{process(){return !1}})`,B=new Blob([I],{type:"application/javascript; charset=utf-8"}),k=URL.createObjectURL(B);return C.audioWorklet.addModule(k,w).then(()=>{if(a(C))return C;const G=o(C);return G.audioWorklet.addModule(k,w).then(()=>G)}).then(G=>{if(l===null)throw new SyntaxError;try{new l(G,`__sac${R}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(k))});return y===void 0?h.set(_,new Map([[x,S]])):y.set(x,S),S.then(()=>{const M=u.get(_);M===void 0?u.set(_,new Set([x])):M.add(x)}).finally(()=>{const M=h.get(_);M!==void 0&&M.delete(x)}),S}},yi=(r,t)=>{const e=r.get(t);if(e===void 0)throw new Error("A value with the given key could not be found.");return e},eu=(r,t)=>{const e=Array.from(r).filter(t);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");const[n]=e;return r.delete(n),n},_x=(r,t,e,n)=>{const i=yi(r,t),s=eu(i,o=>o[0]===e&&o[1]===n);return i.size===0&&r.delete(t),s},Gl=r=>yi(ux,r),Sa=r=>{if(Ma.has(r))throw new Error("The AudioNode is already stored.");Ma.add(r),Gl(r).forEach(t=>t(!0))},vx=r=>"port"in r,ql=r=>{if(!Ma.has(r))throw new Error("The AudioNode is not stored.");Ma.delete(r),Gl(r).forEach(t=>t(!1))},Lf=(r,t)=>{!vx(r)&&t.every(e=>e.size===0)&&ql(r)},fD=(r,t,e,n,i,s,o,a,l,h,u,d,f)=>{const m=new WeakMap;return(_,x,w,v,y)=>{const{activeInputs:C,passiveInputs:S}=s(x),{outputs:M}=s(_),E=a(_),T=R=>{const F=l(x),z=l(_);if(R){const L=_x(S,_,w,v);r(C,_,L,!1),!y&&!d(_)&&e(z,F,w,v),f(x)&&Sa(x)}else{const L=n(C,_,w,v);t(S,v,L,!1),!y&&!d(_)&&i(z,F,w,v);const A=o(x);if(A===0)u(x)&&Lf(x,C);else{const D=m.get(x);D!==void 0&&clearTimeout(D),m.set(x,setTimeout(()=>{u(x)&&Lf(x,C)},A*1e3))}}};return h(M,[x,w,v],R=>R[0]===x&&R[1]===w&&R[2]===v,!0)?(E.add(T),u(_)?r(C,_,[w,v,T],!0):t(S,v,[_,w,T],!0),!0):!1}},mD=r=>(t,e,[n,i,s],o)=>{const a=t.get(n);a===void 0?t.set(n,new Set([[i,e,s]])):r(a,[i,e,s],l=>l[0]===i&&l[1]===e,o)},gD=r=>(t,e)=>{const n=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(n).connect(t.destination);const i=()=>{e.removeEventListener("ended",i),e.disconnect(n),n.disconnect()};e.addEventListener("ended",i)},_D=r=>(t,e)=>{r(t).add(e)},vD={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},xD=(r,t,e,n,i,s)=>class extends r{constructor(a,l){const h=i(a),u=gt(gt({},vD),l),d=n(h,u),f=s(h)?t():null;super(a,!1,d,f);this._nativeAnalyserNode=d}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},_n=(r,t)=>r.context===t,yD=(r,t,e)=>()=>{const n=new WeakMap,i=async(s,o)=>{let a=t(s);if(!_n(a,o)){const h={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=r(o,h)}return n.set(o,a),await e(s,o,a),a};return{render(s,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},nu=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Hi=()=>new DOMException("","IndexSizeError"),kf=r=>{r.getChannelData=(t=>e=>{try{return t.call(r,e)}catch(n){throw n.code===12?Hi():n}})(r.getChannelData)},bD={numberOfChannels:1},wD=(r,t,e,n,i,s,o,a)=>{let l=null;return class xx{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:f,sampleRate:m}=gt(gt({},bD),u);l===null&&(l=new i(1,1,44100));const _=n!==null&&t(s,s)?new n({length:d,numberOfChannels:f,sampleRate:m}):l.createBuffer(f,d,m);if(_.numberOfChannels===0)throw e();return typeof _.copyFromChannel!="function"?(o(_),kf(_)):t(nu,()=>nu(_))||a(_),r.add(_),_}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===xx.prototype||r.has(u)}}},In=-34028234663852886e22,yn=-In,ps=r=>Ma.has(r),MD={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},SD=(r,t,e,n,i,s,o,a)=>class extends r{constructor(h,u){const d=s(h),f=gt(gt({},MD),u),m=i(d,f),_=o(d),x=_?t():null;super(h,!1,m,x);this._audioBufferSourceNodeRenderer=x,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=m,this._onended=null,this._playbackRate=e(this,_,m.playbackRate,yn,In)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(h){if(this._nativeAudioBufferSourceNode.buffer=h,h!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(h){this._nativeAudioBufferSourceNode.loop=h}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(h){this._nativeAudioBufferSourceNode.loopEnd=h}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(h){this._nativeAudioBufferSourceNode.loopStart=h}get onended(){return this._onended}set onended(h){const u=typeof h=="function"?a(this,h):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?h:d}get playbackRate(){return this._playbackRate}start(h=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(h,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[h,u]:[h,u,d]),this.context.state!=="closed"){Sa(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),ps(this)&&ql(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(h=0){this._nativeAudioBufferSourceNode.stop(h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=h)}},TD=(r,t,e,n,i)=>()=>{const s=new WeakMap;let o=null,a=null;const l=async(h,u)=>{let d=e(h);const f=_n(d,u);if(!f){const m={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=t(u,m),o!==null&&d.start(...o),a!==null&&d.stop(a)}return s.set(u,d),f?await r(u,h.playbackRate,d.playbackRate):await n(u,h.playbackRate,d.playbackRate),await i(h,u,d),d};return{set start(h){o=h},set stop(h){a=h},render(h,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):l(h,u)}}},ED=r=>"playbackRate"in r,CD=r=>"frequency"in r&&"gain"in r,AD=r=>"offset"in r,PD=r=>!("frequency"in r)&&"gain"in r,RD=r=>"detune"in r&&"frequency"in r,DD=r=>"pan"in r,bn=r=>yi(cx,r),jl=r=>yi(hx,r),If=(r,t)=>{const{activeInputs:e}=bn(r);e.forEach(i=>i.forEach(([s])=>{t.includes(r)||If(s,[...t,r])}));const n=ED(r)?[r.playbackRate]:vx(r)?Array.from(r.parameters.values()):CD(r)?[r.Q,r.detune,r.frequency,r.gain]:AD(r)?[r.offset]:PD(r)?[r.gain]:RD(r)?[r.detune,r.frequency]:DD(r)?[r.pan]:[];for(const i of n){const s=jl(i);s!==void 0&&s.activeInputs.forEach(([o])=>If(o,t))}ps(r)&&ql(r)},yx=r=>{If(r.destination,[])},LD=r=>r===void 0||typeof r=="number"||typeof r=="string"&&(r==="balanced"||r==="interactive"||r==="playback"),kD=(r,t,e,n,i,s,o,a,l)=>class extends r{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let d;try{d=new l(u)}catch(_){throw _.code===12&&_.message==="sampleRate is not in range"?e():_}if(d===null)throw n();if(!LD(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&d.sampleRate!==u.sampleRate)throw e();super(d,2);const{latencyHint:f}=u,{sampleRate:m}=d;if(this._baseLatency=typeof d.baseLatency=="number"?d.baseLatency:f==="balanced"?512/m:f==="interactive"||f===void 0?256/m:f==="playback"?1024/m:Math.max(2,Math.min(128,Math.round(f*m/128)))*128/m,this._nativeAudioContext=d,l.name==="webkitAudioContext"?(this._nativeGainNode=d.createGain(),this._nativeOscillatorNode=d.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(d.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,d.state==="running"){this._state="suspended";const _=()=>{this._state==="suspended"&&(this._state=null),d.removeEventListener("statechange",_)};d.addEventListener("statechange",_)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),yx(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,d)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,d)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?t():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?t():u})}},ID=(r,t,e,n,i,s,o,a)=>class extends r{constructor(h,u){const d=s(h),f=o(d),m=i(d,u,f),_=f?t(a):null;super(h,!1,m,_);this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=m}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(h){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(h>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=h}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(h){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=h}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},ND=r=>{const t=new WeakMap,e=async(n,i)=>{const s=i.destination;return t.set(i,s),await r(n,i,s),s};return{render(n,i){const s=t.get(i);return s!==void 0?Promise.resolve(s):e(n,i)}}},FD=(r,t,e,n,i,s,o,a)=>(l,h)=>{const u=h.listener,d=()=>{const M=new Float32Array(1),E=t(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),T=o(h);let R=!1,F=[0,0,-1,0,1,0],z=[0,0,0];const L=()=>{if(R)return;R=!0;const B=n(h,256,9,0);B.onaudioprocess=({inputBuffer:k})=>{const G=[s(k,M,0),s(k,M,1),s(k,M,2),s(k,M,3),s(k,M,4),s(k,M,5)];G.some((K,j)=>K!==F[j])&&(u.setOrientation(...G),F=G);const tt=[s(k,M,6),s(k,M,7),s(k,M,8)];tt.some((K,j)=>K!==z[j])&&(u.setPosition(...tt),z=tt)},E.connect(B)},A=B=>k=>{k!==F[B]&&(F[B]=k,u.setOrientation(...F))},D=B=>k=>{k!==z[B]&&(z[B]=k,u.setPosition(...z))},I=(B,k,G)=>{const tt=e(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:k});tt.connect(E,0,B),tt.start(),Object.defineProperty(tt.offset,"defaultValue",{get(){return k}});const K=r({context:l},T,tt.offset,yn,In);return a(K,"value",j=>()=>j.call(K),j=>$=>{try{j.call(K,$)}catch(st){if(st.code!==9)throw st}L(),T&&G($)}),K.cancelAndHoldAtTime=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.cancelAndHoldAtTime),K.cancelScheduledValues=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.cancelScheduledValues),K.exponentialRampToValueAtTime=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.exponentialRampToValueAtTime),K.linearRampToValueAtTime=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.linearRampToValueAtTime),K.setTargetAtTime=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.setTargetAtTime),K.setValueAtTime=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.setValueAtTime),K.setValueCurveAtTime=(j=>T?()=>{throw i()}:(...$)=>{const st=j.apply(K,$);return L(),st})(K.setValueCurveAtTime),K};return{forwardX:I(0,0,A(0)),forwardY:I(1,0,A(1)),forwardZ:I(2,-1,A(2)),positionX:I(6,0,D(0)),positionY:I(7,0,D(1)),positionZ:I(8,0,D(2)),upX:I(3,0,A(3)),upY:I(4,1,A(4)),upZ:I(5,0,A(5))}},{forwardX:f,forwardY:m,forwardZ:_,positionX:x,positionY:w,positionZ:v,upX:y,upY:C,upZ:S}=u.forwardX===void 0?d():u;return{get forwardX(){return f},get forwardY(){return m},get forwardZ(){return _},get positionX(){return x},get positionY(){return w},get positionZ(){return v},get upX(){return y},get upY(){return C},get upZ(){return S}}},iu=r=>"context"in r,$l=r=>iu(r[0]),Gr=(r,t,e,n)=>{for(const i of r)if(e(i)){if(n)return!1;throw Error("The set contains at least one similar element.")}return r.add(t),!0},bx=(r,t,[e,n],i)=>{Gr(r,[t,e,n],s=>s[0]===t&&s[1]===e,i)},wx=(r,[t,e,n],i)=>{const s=r.get(t);s===void 0?r.set(t,new Set([[e,n]])):Gr(s,[e,n],o=>o[0]===e,i)},Ta=r=>"inputs"in r,su=(r,t,e,n)=>{if(Ta(t)){const i=t.inputs[n];return r.connect(i,e,0),[i,e,0]}return r.connect(t,e,n),[t,e,n]},Mx=(r,t,e)=>{for(const n of r)if(n[0]===t&&n[1]===e)return r.delete(n),n;return null},OD=(r,t,e)=>eu(r,n=>n[0]===t&&n[1]===e),Sx=(r,t)=>{if(!Gl(r).delete(t))throw new Error("Missing the expected event listener.")},Tx=(r,t,e)=>{const n=yi(r,t),i=eu(n,s=>s[0]===e);return n.size===0&&r.delete(t),i},ru=(r,t,e,n)=>{Ta(t)?r.disconnect(t.inputs[n],e,0):r.disconnect(t,e,n)},Se=r=>yi(Cf,r),Xl=r=>yi(Af,r),qr=r=>Pf.has(r),ou=r=>!Ma.has(r),Ex=(r,t)=>new Promise(e=>{if(t!==null)e(!0);else{const n=r.createScriptProcessor(256,1,1),i=r.createGain(),s=r.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=r.createBufferSource();a.buffer=s,a.loop=!0,a.connect(n).connect(r.destination),a.connect(i),a.disconnect(i),n.onaudioprocess=l=>{const h=l.inputBuffer.getChannelData(0);Array.prototype.some.call(h,u=>u===1)?e(!0):e(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(r.destination)},a.start()}}),Nf=(r,t)=>{const e=new Map;for(const n of r)for(const i of n){const s=e.get(i);e.set(i,s===void 0?1:s+1)}e.forEach((n,i)=>t(i,n))},au=r=>"context"in r,zD=r=>{const t=new Map;r.connect=(e=>(n,i=0,s=0)=>{const o=au(n)?e(n,i,s):e(n,i),a=t.get(n);return a===void 0?t.set(n,[{input:s,output:i}]):a.every(l=>l.input!==s||l.output!==i)&&a.push({input:s,output:i}),o})(r.connect.bind(r)),r.disconnect=(e=>(n,i,s)=>{if(e.apply(r),n===void 0)t.clear();else if(typeof n=="number")for(const[o,a]of t){const l=a.filter(h=>h.output!==n);l.length===0?t.delete(o):t.set(o,l)}else if(t.has(n))if(i===void 0)t.delete(n);else{const o=t.get(n);if(o!==void 0){const a=o.filter(l=>l.output!==i&&(l.input!==s||s===void 0));a.length===0?t.delete(n):t.set(n,a)}}for(const[o,a]of t)a.forEach(l=>{au(o)?r.connect(o,l.output,l.input):r.connect(o,l.output)})})(r.disconnect)},VD=(r,t,e,n)=>{const{activeInputs:i,passiveInputs:s}=jl(t),{outputs:o}=bn(r),a=Gl(r),l=h=>{const u=Se(r),d=Xl(t);if(h){const f=Tx(s,r,e);bx(i,r,f,!1),!n&&!qr(r)&&u.connect(d,e)}else{const f=OD(i,r,e);wx(s,f,!1),!n&&!qr(r)&&u.disconnect(d,e)}};return Gr(o,[t,e],h=>h[0]===t&&h[1]===e,!0)?(a.add(l),ps(r)?bx(i,r,[e,l],!0):wx(s,[r,e,l],!0),!0):!1},BD=(r,t,e,n)=>{const{activeInputs:i,passiveInputs:s}=bn(t),o=Mx(i[n],r,e);return o===null?[_x(s,r,e,n)[2],!1]:[o[2],!0]},UD=(r,t,e)=>{const{activeInputs:n,passiveInputs:i}=jl(t),s=Mx(n,r,e);return s===null?[Tx(i,r,e)[1],!1]:[s[2],!0]},Ff=(r,t,e,n,i)=>{const[s,o]=BD(r,e,n,i);if(s!==null&&(Sx(r,s),o&&!t&&!qr(r)&&ru(Se(r),Se(e),n,i)),ps(e)){const{activeInputs:a}=bn(e);Lf(e,a)}},Of=(r,t,e,n)=>{const[i,s]=UD(r,e,n);i!==null&&(Sx(r,i),s&&!t&&!qr(r)&&Se(r).disconnect(Xl(e),n))},HD=(r,t)=>{const e=bn(r),n=[];for(const i of e.outputs)$l(i)?Ff(r,t,...i):Of(r,t,...i),n.push(i[0]);return e.outputs.clear(),n},WD=(r,t,e)=>{const n=bn(r),i=[];for(const s of n.outputs)s[1]===e&&($l(s)?Ff(r,t,...s):Of(r,t,...s),i.push(s[0]),n.outputs.delete(s));return i},GD=(r,t,e,n,i)=>{const s=bn(r);return Array.from(s.outputs).filter(o=>o[0]===e&&(n===void 0||o[1]===n)&&(i===void 0||o[2]===i)).map(o=>($l(o)?Ff(r,t,...o):Of(r,t,...o),s.outputs.delete(o),o[0]))},qD=(r,t,e,n,i,s,o,a,l,h,u,d,f,m,_,x)=>class extends h{constructor(v,y,C,S){super(C);this._context=v,this._nativeAudioNode=C;const M=u(v);d(M)&&e(Ex,()=>Ex(M,x))!==!0&&zD(C),Cf.set(this,C),ux.set(this,new Set),v.state!=="closed"&&y&&Sa(this),r(this,S,C)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,y=0,C=0){if(y<0||y>=this._nativeAudioNode.numberOfOutputs)throw i();const S=u(this._context),M=_(S);if(f(v)||m(v))throw s();if(iu(v)){const R=Se(v);try{const z=su(this._nativeAudioNode,R,y,C),L=ou(this);(M||L)&&this._nativeAudioNode.disconnect(...z),this.context.state!=="closed"&&!L&&ou(v)&&Sa(v)}catch(z){throw z.code===12?s():z}if(t(this,v,y,C,M)){const z=l([this],v);Nf(z,n(M))}return v}const E=Xl(v);if(E.name==="playbackRate"&&E.maxValue===1024)throw o();try{this._nativeAudioNode.connect(E,y),(M||ou(this))&&this._nativeAudioNode.disconnect(E,y)}catch(R){throw R.code===12?s():R}if(VD(this,v,y,M)){const R=l([this],v);Nf(R,n(M))}}disconnect(v,y,C){let S;const M=u(this._context),E=_(M);if(v===void 0)S=HD(this,E);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw i();S=WD(this,E,v)}else{if(y!==void 0&&(y<0||y>=this.numberOfOutputs)||iu(v)&&C!==void 0&&(C<0||C>=v.numberOfInputs))throw i();if(S=GD(this,E,v,y,C),S.length===0)throw s()}for(const T of S){const R=l([this],T);Nf(R,a)}}},jD=(r,t,e,n,i,s,o,a,l,h,u,d,f)=>(m,_,x,w=null,v=null)=>{const y=new nD(x.defaultValue),C=_?n(y):null,S={get defaultValue(){return x.defaultValue},get maxValue(){return w===null?x.maxValue:w},get minValue(){return v===null?x.minValue:v},get value(){return x.value},set value(M){x.value=M,S.setValueAtTime(M,m.context.currentTime)},cancelAndHoldAtTime(M){if(typeof x.cancelAndHoldAtTime=="function")C===null&&y.flush(m.context.currentTime),y.add(i(M)),x.cancelAndHoldAtTime(M);else{const E=Array.from(y).pop();C===null&&y.flush(m.context.currentTime),y.add(i(M));const T=Array.from(y).pop();x.cancelScheduledValues(M),E!==T&&T!==void 0&&(T.type==="exponentialRampToValue"?x.exponentialRampToValueAtTime(T.value,T.endTime):T.type==="linearRampToValue"?x.linearRampToValueAtTime(T.value,T.endTime):T.type==="setValue"?x.setValueAtTime(T.value,T.startTime):T.type==="setValueCurve"&&x.setValueCurveAtTime(T.values,T.startTime,T.duration))}return S},cancelScheduledValues(M){return C===null&&y.flush(m.context.currentTime),y.add(s(M)),x.cancelScheduledValues(M),S},exponentialRampToValueAtTime(M,E){if(M===0)throw new RangeError;if(!Number.isFinite(E)||E<0)throw new RangeError;return C===null&&y.flush(m.context.currentTime),y.add(o(M,E)),x.exponentialRampToValueAtTime(M,E),S},linearRampToValueAtTime(M,E){return C===null&&y.flush(m.context.currentTime),y.add(a(M,E)),x.linearRampToValueAtTime(M,E),S},setTargetAtTime(M,E,T){return C===null&&y.flush(m.context.currentTime),y.add(l(M,E,T)),x.setTargetAtTime(M,E,T),S},setValueAtTime(M,E){return C===null&&y.flush(m.context.currentTime),y.add(h(M,E)),x.setValueAtTime(M,E),S},setValueCurveAtTime(M,E,T){const R=M instanceof Float32Array?M:new Float32Array(M);if(d!==null&&d.name==="webkitAudioContext"){const F=E+T,z=m.context.sampleRate,L=Math.ceil(E*z),A=Math.floor(F*z),D=A-L,I=new Float32Array(D);for(let k=0;k<D;k+=1){const G=(R.length-1)/T*((L+k)/z-E),tt=Math.floor(G),K=Math.ceil(G);I[k]=tt===K?R[tt]:(1-(G-tt))*R[tt]+(1-(K-G))*R[K]}C===null&&y.flush(m.context.currentTime),y.add(u(I,E,T)),x.setValueCurveAtTime(I,E,T);const B=A/z;B<F&&f(S,I[I.length-1],B),f(S,R[R.length-1],F)}else C===null&&y.flush(m.context.currentTime),y.add(u(R,E,T)),x.setValueCurveAtTime(R,E,T);return S}};return e.set(S,x),t.set(S,m),r(S,C),S},$D=r=>({replay(t){for(const e of r)if(e.type==="exponentialRampToValue"){const{endTime:n,value:i}=e;t.exponentialRampToValueAtTime(i,n)}else if(e.type==="linearRampToValue"){const{endTime:n,value:i}=e;t.linearRampToValueAtTime(i,n)}else if(e.type==="setTarget"){const{startTime:n,target:i,timeConstant:s}=e;t.setTargetAtTime(i,n,s)}else if(e.type==="setValue"){const{startTime:n,value:i}=e;t.setValueAtTime(i,n)}else if(e.type==="setValueCurve"){const{duration:n,startTime:i,values:s}=e;t.setValueCurveAtTime(s,i,n)}else throw new Error("Can't apply an unknown automation.")}});class Cx{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((n,i)=>t.call(e,n,i,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const XD={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},YD=(r,t,e,n,i,s,o,a,l,h,u,d,f,m)=>class extends t{constructor(x,w,v){var y;const C=a(x),S=l(C),M=u(gt(gt({},XD),v));f(M);const E=Rf.get(C),T=E==null?void 0:E.get(w),R=S||C.state!=="closed"?C:(y=o(C))!==null&&y!==void 0?y:C,F=i(R,S?null:x.baseLatency,h,w,T,M),z=S?n(w,M,T):null;super(x,!0,F,z);const L=[];F.parameters.forEach((D,I)=>{const B=e(this,S,D);L.push([I,B])}),this._nativeAudioWorkletNode=F,this._onprocessorerror=null,this._parameters=new Cx(L),S&&r(C,this);const{activeInputs:A}=s(this);d(F,A)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(x){const w=typeof x=="function"?m(this,x):null;this._nativeAudioWorkletNode.onprocessorerror=w;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===w?x:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function lu(r,t,e,n,i){if(typeof r.copyFromChannel=="function")t[e].byteLength===0&&(t[e]=new Float32Array(128)),r.copyFromChannel(t[e],n,i);else{const s=r.getChannelData(n);if(t[e].byteLength===0)t[e]=s.slice(i,i+128);else{const o=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[e].set(o)}}}const Ax=(r,t,e,n,i)=>{typeof r.copyToChannel=="function"?t[e].byteLength!==0&&r.copyToChannel(t[e],n,i):t[e].byteLength!==0&&r.getChannelData(n).set(t[e],i)},cu=(r,t)=>{const e=[];for(let n=0;n<r;n+=1){const i=[],s=typeof t=="number"?t:t[n];for(let o=0;o<s;o+=1)i.push(new Float32Array(128));e.push(i)}return e},ZD=(r,t)=>{const e=yi(Df,r),n=Se(t);return yi(e,n)},JD=async(r,t,e,n,i,s,o)=>{const a=t===null?Math.ceil(r.context.length/128)*128:t.length,l=n.channelCount*n.numberOfInputs,h=i.reduce((w,v)=>w+v,0),u=h===0?null:e.createBuffer(h,a,e.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const d=bn(r),f=await ZD(e,r),m=cu(n.numberOfInputs,n.channelCount),_=cu(n.numberOfOutputs,i),x=Array.from(r.parameters.keys()).reduce((w,v)=>Bt(gt({},w),{[v]:new Float32Array(128)}),{});for(let w=0;w<a;w+=128){if(n.numberOfInputs>0&&t!==null)for(let v=0;v<n.numberOfInputs;v+=1)for(let y=0;y<n.channelCount;y+=1)lu(t,m[v],y,y,w);s.parameterDescriptors!==void 0&&t!==null&&s.parameterDescriptors.forEach(({name:v},y)=>{lu(t,x,v,l+y,w)});for(let v=0;v<n.numberOfInputs;v+=1)for(let y=0;y<i[v];y+=1)_[v][y].byteLength===0&&(_[v][y]=new Float32Array(128));try{const v=m.map((C,S)=>d.activeInputs[S].size===0?[]:C),y=o(w/e.sampleRate,e.sampleRate,()=>f.process(v,_,x));if(u!==null)for(let C=0,S=0;C<n.numberOfOutputs;C+=1){for(let M=0;M<i[C];M+=1)Ax(u,_[C],M,S+M,w);S+=i[C]}if(!y)break}catch(v){r.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},KD=(r,t,e,n,i,s,o,a,l,h,u,d,f,m,_,x)=>(w,v,y)=>{const C=new WeakMap;let S=null;const M=async(E,T)=>{let R=u(E),F=null;const z=_n(R,T),L=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(d===null){const A=L.reduce((k,G)=>k+G,0),D=i(T,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),I=[];for(let k=0;k<E.numberOfOutputs;k+=1)I.push(n(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:L[k]}));const B=o(T,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});B.connect=t.bind(null,I),B.disconnect=l.bind(null,I),F=[D,I,B]}else z||(R=new d(T,w));if(C.set(T,F===null?R:F[2]),F!==null){if(S===null){if(y===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const G=E.channelCount*E.numberOfInputs,tt=y.parameterDescriptors===void 0?0:y.parameterDescriptors.length,K=G+tt;S=JD(E,K===0?null:await(async()=>{const $=new f(K,Math.ceil(E.context.length/128)*128,T.sampleRate),st=[],rt=[];for(let Q=0;Q<v.numberOfInputs;Q+=1)st.push(o($,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),rt.push(i($,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const xt=await Promise.all(Array.from(E.parameters.values()).map(async Q=>{const _t=s($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Q.value});return await m($,Q,_t.offset),_t})),It=n($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,G+tt)});for(let Q=0;Q<v.numberOfInputs;Q+=1){st[Q].connect(rt[Q]);for(let _t=0;_t<v.channelCount;_t+=1)rt[Q].connect(It,_t,Q*v.channelCount+_t)}for(const[Q,_t]of xt.entries())_t.connect(It,0,G+Q),_t.start(0);return It.connect($.destination),await Promise.all(st.map(Q=>_(E,$,Q))),x($)})(),T,v,L,y,h)}const A=await S,D=e(T,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[I,B,k]=F;A!==null&&(D.buffer=A,D.start(0)),D.connect(I);for(let G=0,tt=0;G<E.numberOfOutputs;G+=1){const K=B[G];for(let j=0;j<L[G];j+=1)I.connect(K,tt+j,j);tt+=L[G]}return k}if(z)for(const[A,D]of E.parameters.entries())await r(T,D,R.parameters.get(A));else for(const[A,D]of E.parameters.entries())await m(T,D,R.parameters.get(A));return await _(E,T,R),R};return{render(E,T){a(T,E);const R=C.get(T);return R!==void 0?Promise.resolve(R):M(E,T)}}},QD=(r,t,e,n,i,s,o,a,l,h,u,d,f,m,_,x,w,v,y,C)=>class extends _{constructor(M,E){super(M,E);this._nativeContext=M,this._audioWorklet=r===void 0?void 0:{addModule:(T,R)=>r(this,T,R)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(M,E,T){return new e({length:E,numberOfChannels:M,sampleRate:T})}createBufferSource(){return new n(this)}createChannelMerger(M=6){return new s(this,{numberOfInputs:M})}createChannelSplitter(M=6){return new o(this,{numberOfOutputs:M})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(M=1){return new u(this,{maxDelayTime:M})}createDynamicsCompressor(){return new d(this)}createGain(){return new f(this)}createIIRFilter(M,E){return new m(this,{feedback:E,feedforward:M})}createOscillator(){return new x(this)}createPanner(){return new w(this)}createPeriodicWave(M,E,T={disableNormalization:!1}){return new v(this,Bt(gt({},T),{imag:E,real:M}))}createStereoPanner(){return new y(this)}createWaveShaper(){return new C(this)}decodeAudioData(M,E,T){return h(this._nativeContext,M).then(R=>(typeof E=="function"&&E(R),R),R=>{throw typeof T=="function"&&T(R),R})}},tL={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},eL=(r,t,e,n,i,s,o,a)=>class extends r{constructor(h,u){const d=s(h),f=gt(gt({},tL),u),m=i(d,f),_=o(d),x=_?e():null;super(h,!1,m,x);this._Q=t(this,_,m.Q,yn,In),this._detune=t(this,_,m.detune,1200*Math.log2(yn),-1200*Math.log2(yn)),this._frequency=t(this,_,m.frequency,h.sampleRate/2,0),this._gain=t(this,_,m.gain,40*Math.log10(yn),In),this._nativeBiquadFilterNode=m,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(h){this._nativeBiquadFilterNode.type=h}getFrequencyResponse(h,u,d){try{this._nativeBiquadFilterNode.getFrequencyResponse(h,u,d)}catch(f){throw f.code===11?n():f}if(h.length!==u.length||u.length!==d.length)throw n()}},nL=(r,t,e,n,i)=>()=>{const s=new WeakMap,o=async(a,l)=>{let h=e(a);const u=_n(h,l);if(!u){const d={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=t(l,d)}return s.set(l,h),u?(await r(l,a.Q,h.Q),await r(l,a.detune,h.detune),await r(l,a.frequency,h.frequency),await r(l,a.gain,h.gain)):(await n(l,a.Q,h.Q),await n(l,a.detune,h.detune),await n(l,a.frequency,h.frequency),await n(l,a.gain,h.gain)),await i(a,l,h),h};return{render(a,l){const h=s.get(l);return h!==void 0?Promise.resolve(h):o(a,l)}}},iL=(r,t)=>(e,n)=>{const i=t.get(e);if(i!==void 0)return i;const s=r.get(e);if(s!==void 0)return s;try{const o=n();return o instanceof Promise?(r.set(e,o),o.catch(()=>!1).then(a=>(r.delete(e),t.set(e,a),a))):(t.set(e,o),o)}catch{return t.set(e,!1),!1}},sL={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},rL=(r,t,e,n,i)=>class extends r{constructor(o,a){const l=n(o),h=gt(gt({},sL),a),u=e(l,h),d=i(l)?t():null;super(o,!1,u,d)}},oL=(r,t,e)=>()=>{const n=new WeakMap,i=async(s,o)=>{let a=t(s);if(!_n(a,o)){const h={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=r(o,h)}return n.set(o,a),await e(s,o,a),a};return{render(s,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},aL={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},lL=(r,t,e,n,i,s)=>class extends r{constructor(a,l){const h=n(a),u=s(gt(gt({},aL),l)),d=e(h,u),f=i(h)?t():null;super(a,!1,d,f)}},cL=(r,t,e)=>()=>{const n=new WeakMap,i=async(s,o)=>{let a=t(s);if(!_n(a,o)){const h={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=r(o,h)}return n.set(o,a),await e(s,o,a),a};return{render(s,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},hL=r=>(t,e,n)=>r(e,t,n),uL=r=>(t,e,n=0,i=0)=>{const s=t[n];if(s===void 0)throw r();return au(e)?s.connect(e,0,i):s.connect(e,0)},dL=r=>(t,e)=>{const n=r(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(e),n.start(),()=>{n.stop(),n.disconnect(e)}},pL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},fL=(r,t,e,n,i,s,o)=>class extends r{constructor(l,h){const u=i(l),d=gt(gt({},pL),h),f=n(u,d),m=s(u),_=m?e():null;super(l,!1,f,_);this._constantSourceNodeRenderer=_,this._nativeConstantSourceNode=f,this._offset=t(this,m,f.offset,yn,In),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const h=typeof l=="function"?o(this,l):null;this._nativeConstantSourceNode.onended=h;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===h?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Sa(this);const h=()=>{this._nativeConstantSourceNode.removeEventListener("ended",h),ps(this)&&ql(this)};this._nativeConstantSourceNode.addEventListener("ended",h)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},mL=(r,t,e,n,i)=>()=>{const s=new WeakMap;let o=null,a=null;const l=async(h,u)=>{let d=e(h);const f=_n(d,u);if(!f){const m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=t(u,m),o!==null&&d.start(o),a!==null&&d.stop(a)}return s.set(u,d),f?await r(u,h.offset,d.offset):await n(u,h.offset,d.offset),await i(h,u,d),d};return{set start(h){o=h},set stop(h){a=h},render(h,u){const d=s.get(u);return d!==void 0?Promise.resolve(d):l(h,u)}}},gL=r=>t=>(r[0]=t,r[0]),_L={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},vL=(r,t,e,n,i,s)=>class extends r{constructor(a,l){const h=n(a),u=gt(gt({},_L),l),d=e(h,u),m=i(h)?t():null;super(a,!1,d,m);this._isBufferNullified=!1,this._nativeConvolverNode=d,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},xL=(r,t,e)=>()=>{const n=new WeakMap,i=async(s,o)=>{let a=t(s);if(!_n(a,o)){const h={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=r(o,h)}return n.set(o,a),Ta(a)?await e(s,o,a.inputs[0]):await e(s,o,a),a};return{render(s,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},yL=(r,t)=>(e,n,i)=>{if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(e,n,i)}catch(s){throw s.name==="SyntaxError"?r():s}},bL=()=>new DOMException("","DataCloneError"),Px=r=>{const{port1:t,port2:e}=new MessageChannel;return new Promise(n=>{const i=()=>{e.onmessage=null,t.close(),e.close(),n()};e.onmessage=()=>i();try{t.postMessage(r,[r])}finally{i()}})},wL=(r,t,e,n,i,s,o,a,l,h,u)=>(d,f)=>{const m=o(d)?d:s(d);if(i.has(f)){const _=e();return Promise.reject(_)}try{i.add(f)}catch{}return t(l,()=>l(m))?m.decodeAudioData(f).then(_=>(Px(f).catch(()=>{}),t(a,()=>a(_))||u(_),r.add(_),_)):new Promise((_,x)=>{const w=async()=>{try{await Px(f)}catch{}},v=y=>{x(y),w()};try{m.decodeAudioData(f,y=>{typeof y.copyFromChannel!="function"&&(h(y),kf(y)),r.add(y),w().then(()=>_(y))},y=>{v(y===null?n():y)})}catch(y){v(y)}})},ML=(r,t,e,n,i,s,o,a)=>(l,h)=>{const u=t.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=s(l.context),f=a(d);if(u===h){if(t.delete(l),!f&&o(l)){const m=n(l),{outputs:_}=e(l);for(const x of _)if($l(x)){const w=n(x[0]);r(m,w,x[1],x[2])}else{const w=i(x[0]);m.connect(w,x[1])}}}else t.set(l,u-h)},SL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},TL=(r,t,e,n,i,s,o)=>class extends r{constructor(l,h){const u=i(l),d=gt(gt({},SL),h),f=n(u,d),m=s(u),_=m?e(d.maxDelayTime):null;super(l,!1,f,_);this._delayTime=t(this,m,f.delayTime),o(this,d.maxDelayTime)}get delayTime(){return this._delayTime}},EL=(r,t,e,n,i)=>s=>{const o=new WeakMap,a=async(l,h)=>{let u=e(l);const d=_n(u,h);if(!d){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=t(h,f)}return o.set(h,u),d?await r(h,l.delayTime,u.delayTime):await n(h,l.delayTime,u.delayTime),await i(l,h,u),u};return{render(l,h){const u=o.get(h);return u!==void 0?Promise.resolve(u):a(l,h)}}},CL=r=>(t,e,n,i)=>r(t[i],s=>s[0]===e&&s[1]===n),AL=r=>(t,e)=>{r(t).delete(e)},PL=r=>"delayTime"in r,RL=(r,t,e)=>function n(i,s){const o=iu(s)?s:e(r,s);if(PL(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=t(o);return Array.from(a).map(l=>n([...i,o],l[0])).reduce((l,h)=>l.concat(h),[])},hu=(r,t,e)=>{const n=t[e];if(n===void 0)throw r();return n},DL=r=>(t,e=void 0,n=void 0,i=0)=>e===void 0?t.forEach(s=>s.disconnect()):typeof e=="number"?hu(r,t,e).disconnect():au(e)?n===void 0?t.forEach(s=>s.disconnect(e)):i===void 0?hu(r,t,n).disconnect(e,0):hu(r,t,n).disconnect(e,0,i):n===void 0?t.forEach(s=>s.disconnect(e)):hu(r,t,n).disconnect(e,0),LL={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},kL=(r,t,e,n,i,s,o,a)=>class extends r{constructor(h,u){const d=s(h),f=gt(gt({},LL),u),m=n(d,f),_=o(d),x=_?e():null;super(h,!1,m,x);this._attack=t(this,_,m.attack),this._knee=t(this,_,m.knee),this._nativeDynamicsCompressorNode=m,this._ratio=t(this,_,m.ratio),this._release=t(this,_,m.release),this._threshold=t(this,_,m.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(h){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=h,h>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(h){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=h,h==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},IL=(r,t,e,n,i)=>()=>{const s=new WeakMap,o=async(a,l)=>{let h=e(a);const u=_n(h,l);if(!u){const d={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=t(l,d)}return s.set(l,h),u?(await r(l,a.attack,h.attack),await r(l,a.knee,h.knee),await r(l,a.ratio,h.ratio),await r(l,a.release,h.release),await r(l,a.threshold,h.threshold)):(await n(l,a.attack,h.attack),await n(l,a.knee,h.knee),await n(l,a.ratio,h.ratio),await n(l,a.release,h.release),await n(l,a.threshold,h.threshold)),await i(a,l,h),h};return{render(a,l){const h=s.get(l);return h!==void 0?Promise.resolve(h):o(a,l)}}},NL=()=>new DOMException("","EncodingError"),FL=r=>t=>new Promise((e,n)=>{if(r===null){n(new SyntaxError);return}const i=r.document.head;if(i===null)n(new SyntaxError);else{const s=r.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(o),l=r.onerror,h=()=>{r.onerror=l,URL.revokeObjectURL(a)};r.onerror=(u,d,f,m,_)=>{if(d===a||d===r.location.href&&f===1&&m===1)return h(),n(_),!1;if(l!==null)return l(u,d,f,m,_)},s.onerror=()=>{h(),n(new SyntaxError)},s.onload=()=>{h(),e()},s.src=a,s.type="module",i.appendChild(s)}}),OL=r=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,n,i){if(n!==null){let s=this._listeners.get(n);s===void 0&&(s=r(this,n),typeof n=="function"&&this._listeners.set(n,s)),this._nativeEventTarget.addEventListener(e,s,i)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,n,i){const s=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(e,s===void 0?null:s,i)}},zL=r=>(t,e,n)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(t*e)}},currentTime:{configurable:!0,get(){return t}}});try{return n()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}},VL=r=>async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw r()},BL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},UL=(r,t,e,n,i,s)=>class extends r{constructor(a,l){const h=i(a),u=gt(gt({},BL),l),d=n(h,u),f=s(h),m=f?e():null;super(a,!1,d,m);this._gain=t(this,f,d.gain,yn,In)}get gain(){return this._gain}},HL=(r,t,e,n,i)=>()=>{const s=new WeakMap,o=async(a,l)=>{let h=e(a);const u=_n(h,l);if(!u){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=t(l,d)}return s.set(l,h),u?await r(l,a.gain,h.gain):await n(l,a.gain,h.gain),await i(a,l,h),h};return{render(a,l){const h=s.get(l);return h!==void 0?Promise.resolve(h):o(a,l)}}},WL=(r,t)=>e=>t(r,e),GL=r=>t=>{const e=r(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer},qL=r=>t=>{var e;return(e=r.get(t))!==null&&e!==void 0?e:0},jL=r=>t=>{const e=r(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer},$L=r=>t=>r.get(t),nn=()=>new DOMException("","InvalidStateError"),XL=r=>t=>{const e=r.get(t);if(e===void 0)throw nn();return e},YL=(r,t)=>e=>{let n=r.get(e);if(n!==void 0)return n;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new t(1,1,44100),r.set(e,n),n},ZL=r=>t=>{const e=r.get(t);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e},uu=()=>new DOMException("","InvalidAccessError"),JL=r=>{r.getFrequencyResponse=(t=>(e,n,i)=>{if(e.length!==n.length||n.length!==i.length)throw uu();return t.call(r,e,n,i)})(r.getFrequencyResponse)},KL={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},QL=(r,t,e,n,i,s)=>class extends r{constructor(a,l){const h=n(a),u=i(h),d=gt(gt({},KL),l),f=t(h,u?null:a.baseLatency,d),m=u?e(d.feedback,d.feedforward):null;super(a,!1,f,m);JL(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,l,h){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,h)}},Rx=(r,t,e,n,i,s,o,a,l,h,u)=>{const d=h.length;let f=a;for(let m=0;m<d;m+=1){let _=e[0]*h[m];for(let x=1;x<i;x+=1){const w=f-x&l-1;_+=e[x]*s[w],_-=r[x]*o[w]}for(let x=i;x<n;x+=1)_+=e[x]*s[f-x&l-1];for(let x=i;x<t;x+=1)_-=r[x]*o[f-x&l-1];s[f]=h[m],o[f]=_,f=f+1&l-1,u[m]=_}return f},tk=(r,t,e,n)=>{const i=e instanceof Float64Array?e:new Float64Array(e),s=n instanceof Float64Array?n:new Float64Array(n),o=i.length,a=s.length,l=Math.min(o,a);if(i[0]!==1){for(let _=0;_<o;_+=1)s[_]/=i[0];for(let _=1;_<a;_+=1)i[_]/=i[0]}const h=32,u=new Float32Array(h),d=new Float32Array(h),f=t.createBuffer(r.numberOfChannels,r.length,r.sampleRate),m=r.numberOfChannels;for(let _=0;_<m;_+=1){const x=r.getChannelData(_),w=f.getChannelData(_);u.fill(0),d.fill(0),Rx(i,o,s,a,l,u,d,0,h,x,w)}return f},ek=(r,t,e,n,i)=>(s,o)=>{const a=new WeakMap;let l=null;const h=async(u,d)=>{let f=null,m=t(u);const _=_n(m,d);if(d.createIIRFilter===void 0?f=r(d,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):_||(m=d.createIIRFilter(o,s)),a.set(d,f===null?m:f),f!==null){if(l===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");const w=new e(u.context.destination.channelCount,u.context.length,d.sampleRate);l=(async()=>{await n(u,w,w.destination);const v=await i(w);return tk(v,d,s,o)})()}const x=await l;return f.buffer=x,f.start(0),f}return await n(u,d,m),m};return{render(u,d){const f=a.get(d);return f!==void 0?Promise.resolve(f):h(u,d)}}},nk=(r,t,e,n,i,s)=>o=>(a,l)=>{const h=r.get(a);if(h===void 0){if(!o&&s(a)){const u=n(a),{outputs:d}=e(a);for(const f of d)if($l(f)){const m=n(f[0]);t(u,m,f[1],f[2])}else{const m=i(f[0]);u.disconnect(m,f[1])}}r.set(a,l)}else r.set(a,h+l)},ik=(r,t)=>e=>{const n=r.get(e);return t(n)||t(e)},sk=(r,t)=>e=>r.has(e)||t(e),rk=(r,t)=>e=>r.has(e)||t(e),ok=(r,t)=>e=>{const n=r.get(e);return t(n)||t(e)},ak=r=>t=>r!==null&&t instanceof r,lk=r=>t=>r!==null&&typeof r.AudioNode=="function"&&t instanceof r.AudioNode,ck=r=>t=>r!==null&&typeof r.AudioParam=="function"&&t instanceof r.AudioParam,hk=(r,t)=>e=>r(e)||t(e),uk=r=>t=>r!==null&&t instanceof r,dk=r=>r!==null&&r.isSecureContext,pk=(r,t,e,n)=>class extends r{constructor(s,o){const a=e(s),l=t(a,o);if(n(a))throw TypeError();super(s,!0,l,null);this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},fk={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},mk=(r,t,e,n)=>class extends r{constructor(s,o){const a=e(s);if(n(a))throw new TypeError;const l=gt(gt({},fk),o),h=t(a,l);super(s,!1,h,null);this._nativeMediaStreamAudioDestinationNode=h}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},gk=(r,t,e,n)=>class extends r{constructor(s,o){const a=e(s),l=t(a,o);if(n(a))throw new TypeError;super(s,!0,l,null);this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},_k=(r,t,e)=>class extends r{constructor(i,s){const o=e(i),a=t(o,s);super(i,!0,a,null)}},vk=(r,t,e,n,i,s)=>class extends e{constructor(a,l){super(a);this._nativeContext=a,tu.set(this,a),n(a)&&i.set(a,new Set),this._destination=new r(this,l),this._listener=t(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=l;const h=this._nativeContext.onstatechange;this._onstatechange=h!==null&&h===l?a:h}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Yl=r=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const e=r.decodeAudioData(t.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch{}return!1},xk=(r,t)=>(e,n,i)=>{const s=new Set;return e.connect=(o=>(a,l=0,h=0)=>{const u=s.size===0;if(t(a))return o.call(e,a,l,h),r(s,[a,l,h],d=>d[0]===a&&d[1]===l&&d[2]===h,!0),u&&n(),a;o.call(e,a,l),r(s,[a,l],d=>d[0]===a&&d[1]===l,!0),u&&n()})(e.connect),e.disconnect=(o=>(a,l,h)=>{const u=s.size>0;if(a===void 0)o.apply(e),s.clear();else if(typeof a=="number"){o.call(e,a);for(const f of s)f[1]===a&&s.delete(f)}else{t(a)?o.call(e,a,l,h):o.call(e,a,l);for(const f of s)f[0]===a&&(l===void 0||f[1]===l)&&(h===void 0||f[2]===h)&&s.delete(f)}const d=s.size===0;u&&d&&i()})(e.disconnect),e},Re=(r,t,e)=>{const n=t[e];n!==void 0&&n!==r[e]&&(r[e]=n)},$e=(r,t)=>{Re(r,t,"channelCount"),Re(r,t,"channelCountMode"),Re(r,t,"channelInterpretation")},Dx=r=>typeof r.getFloatTimeDomainData=="function",yk=r=>{r.getFloatTimeDomainData=t=>{const e=new Uint8Array(t.length);r.getByteTimeDomainData(e);const n=Math.max(e.length,r.fftSize);for(let i=0;i<n;i+=1)t[i]=(e[i]-128)*.0078125;return t}},bk=(r,t)=>(e,n)=>{const i=e.createAnalyser();if($e(i,n),!(n.maxDecibels>n.minDecibels))throw t();return Re(i,n,"fftSize"),Re(i,n,"maxDecibels"),Re(i,n,"minDecibels"),Re(i,n,"smoothingTimeConstant"),r(Dx,()=>Dx(i))||yk(i),i},wk=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null,Ie=(r,t,e)=>{const n=t[e];n!==void 0&&n!==r[e].value&&(r[e].value=n)},Mk=r=>{r.start=(t=>{let e=!1;return(n=0,i=0,s)=>{if(e)throw nn();t.call(r,n,i,s),e=!0}})(r.start)},zf=r=>{r.start=(t=>(e=0,n=0,i)=>{if(typeof i=="number"&&i<0||n<0||e<0)throw new RangeError("The parameters can't be negative.");t.call(r,e,n,i)})(r.start)},Vf=r=>{r.stop=(t=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");t.call(r,e)})(r.stop)},Sk=(r,t,e,n,i,s,o,a,l,h,u)=>(d,f)=>{const m=d.createBufferSource();return $e(m,f),Ie(m,f,"playbackRate"),Re(m,f,"buffer"),Re(m,f,"loop"),Re(m,f,"loopEnd"),Re(m,f,"loopStart"),t(e,()=>e(d))||Mk(m),t(n,()=>n(d))||l(m),t(i,()=>i(d))||h(m,d),t(s,()=>s(d))||zf(m),t(o,()=>o(d))||u(m,d),t(a,()=>a(d))||Vf(m),r(d,m),m},Tk=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null,Ek=(r,t)=>(e,n,i)=>{const s=e.destination;if(s.channelCount!==n)try{s.channelCount=n}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:n});const o=r(e,{channelCount:n,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return t(o,"channelCount",a=>()=>a.call(o),a=>l=>{a.call(o,l);try{s.channelCount=l}catch(h){if(l>s.maxChannelCount)throw h}}),t(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{a.call(o,l),s.channelCountMode=l}),t(o,"channelInterpretation",a=>()=>a.call(o),a=>l=>{a.call(o,l),s.channelInterpretation=l}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},Ck=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null,Ak=r=>{const{port1:t}=new MessageChannel;try{t.postMessage(r)}finally{t.close()}},Pk=(r,t,e,n,i)=>(s,o,a,l,h,u)=>{if(a!==null)try{const d=new a(s,l,u),f=new Map;let m=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw r()}},channelCountMode:{get:()=>"explicit",set:()=>{throw r()}},onprocessorerror:{get:()=>m,set:_=>{typeof m=="function"&&d.removeEventListener("processorerror",m),m=typeof _=="function"?_:null,typeof m=="function"&&d.addEventListener("processorerror",m)}}}),d.addEventListener=(_=>(...x)=>{if(x[0]==="processorerror"){const w=typeof x[1]=="function"?x[1]:typeof x[1]=="object"&&x[1]!==null&&typeof x[1].handleEvent=="function"?x[1].handleEvent:null;if(w!==null){const v=f.get(x[1]);v!==void 0?x[1]=v:(x[1]=y=>{y.type==="error"?(Object.defineProperties(y,{type:{value:"processorerror"}}),w(y)):w(new ErrorEvent(x[0],gt({},y)))},f.set(w,x[1]))}}return _.call(d,"error",x[1],x[2]),_.call(d,...x)})(d.addEventListener),d.removeEventListener=(_=>(...x)=>{if(x[0]==="processorerror"){const w=f.get(x[1]);w!==void 0&&(f.delete(x[1]),x[1]=w)}return _.call(d,"error",x[1],x[2]),_.call(d,x[0],x[1],x[2])})(d.removeEventListener),u.numberOfOutputs!==0){const _=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(_).connect(s.destination),i(d,()=>_.disconnect(),()=>_.connect(s.destination))}return d}catch(d){throw d.code===11?n():d}if(h===void 0)throw n();return Ak(u),t(s,o,h,u)},Lx=(r,t)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*t))))),Rk=r=>new Promise((t,e)=>{const{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:s})=>{n.close(),i.close(),t(s)},n.onmessageerror=({data:s})=>{n.close(),i.close(),e(s)},i.postMessage(r)}),Dk=async(r,t)=>{const e=await Rk(t);return new r(e)},Lk=(r,t,e,n)=>{let i=Df.get(r);i===void 0&&(i=new WeakMap,Df.set(r,i));const s=Dk(e,n);return i.set(t,s),s},kk=(r,t,e,n,i,s,o,a,l,h,u,d,f)=>(m,_,x,w)=>{if(w.numberOfInputs===0&&w.numberOfOutputs===0)throw l();const v=Array.isArray(w.outputChannelCount)?w.outputChannelCount:Array.from(w.outputChannelCount);if(v.some(Z=>Z<1))throw l();if(v.length!==w.numberOfOutputs)throw t();if(w.channelCountMode!=="explicit")throw l();const y=w.channelCount*w.numberOfInputs,C=v.reduce((Z,it)=>Z+it,0),S=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length;if(y+S>6||C>6)throw l();const M=new MessageChannel,E=[],T=[];for(let Z=0;Z<w.numberOfInputs;Z+=1)E.push(o(m,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1})),T.push(i(m,{channelCount:w.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:w.channelCount}));const R=[];if(x.parameterDescriptors!==void 0)for(const{defaultValue:Z,maxValue:it,minValue:Ct,name:Et}of x.parameterDescriptors){const St=s(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:w.parameterData[Et]!==void 0?w.parameterData[Et]:Z===void 0?0:Z});Object.defineProperties(St.offset,{defaultValue:{get:()=>Z===void 0?0:Z},maxValue:{get:()=>it===void 0?yn:it},minValue:{get:()=>Ct===void 0?In:Ct}}),R.push(St)}const F=n(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+S)}),z=Lx(_,m.sampleRate),L=a(m,z,y+S,Math.max(1,C)),A=i(m,{channelCount:Math.max(1,C),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,C)}),D=[];for(let Z=0;Z<w.numberOfOutputs;Z+=1)D.push(n(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[Z]}));for(let Z=0;Z<w.numberOfInputs;Z+=1){E[Z].connect(T[Z]);for(let it=0;it<w.channelCount;it+=1)T[Z].connect(F,it,Z*w.channelCount+it)}const I=new Cx(x.parameterDescriptors===void 0?[]:x.parameterDescriptors.map(({name:Z},it)=>{const Ct=R[it];return Ct.connect(F,0,y+it),Ct.start(0),[Z,Ct.offset]}));F.connect(L);let B=w.channelInterpretation,k=null;const G=w.numberOfOutputs===0?[L]:D,tt={get bufferSize(){return z},get channelCount(){return w.channelCount},set channelCount(Z){throw e()},get channelCountMode(){return w.channelCountMode},set channelCountMode(Z){throw e()},get channelInterpretation(){return B},set channelInterpretation(Z){for(const it of E)it.channelInterpretation=Z;B=Z},get context(){return L.context},get inputs(){return E},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get onprocessorerror(){return k},set onprocessorerror(Z){typeof k=="function"&&tt.removeEventListener("processorerror",k),k=typeof Z=="function"?Z:null,typeof k=="function"&&tt.addEventListener("processorerror",k)},get parameters(){return I},get port(){return M.port2},addEventListener(...Z){return L.addEventListener(Z[0],Z[1],Z[2])},connect:r.bind(null,G),disconnect:h.bind(null,G),dispatchEvent(...Z){return L.dispatchEvent(Z[0])},removeEventListener(...Z){return L.removeEventListener(Z[0],Z[1],Z[2])}},K=new Map;M.port1.addEventListener=(Z=>(...it)=>{if(it[0]==="message"){const Ct=typeof it[1]=="function"?it[1]:typeof it[1]=="object"&&it[1]!==null&&typeof it[1].handleEvent=="function"?it[1].handleEvent:null;if(Ct!==null){const Et=K.get(it[1]);Et!==void 0?it[1]=Et:(it[1]=St=>{u(m.currentTime,m.sampleRate,()=>Ct(St))},K.set(Ct,it[1]))}}return Z.call(M.port1,it[0],it[1],it[2])})(M.port1.addEventListener),M.port1.removeEventListener=(Z=>(...it)=>{if(it[0]==="message"){const Ct=K.get(it[1]);Ct!==void 0&&(K.delete(it[1]),it[1]=Ct)}return Z.call(M.port1,it[0],it[1],it[2])})(M.port1.removeEventListener);let j=null;Object.defineProperty(M.port1,"onmessage",{get:()=>j,set:Z=>{typeof j=="function"&&M.port1.removeEventListener("message",j),j=typeof Z=="function"?Z:null,typeof j=="function"&&(M.port1.addEventListener("message",j),M.port1.start())}}),x.prototype.port=M.port1;let $=null;Lk(m,tt,x,w).then(Z=>$=Z);const rt=cu(w.numberOfInputs,w.channelCount),xt=cu(w.numberOfOutputs,v),It=x.parameterDescriptors===void 0?[]:x.parameterDescriptors.reduce((Z,{name:it})=>Bt(gt({},Z),{[it]:new Float32Array(128)}),{});let Q=!0;const _t=()=>{w.numberOfOutputs>0&&L.disconnect(A);for(let Z=0,it=0;Z<w.numberOfOutputs;Z+=1){const Ct=D[Z];for(let Et=0;Et<v[Z];Et+=1)A.disconnect(Ct,it+Et,Et);it+=v[Z]}},Rt=new Map;L.onaudioprocess=({inputBuffer:Z,outputBuffer:it})=>{if($!==null){const Ct=d(tt);for(let Et=0;Et<z;Et+=128){for(let St=0;St<w.numberOfInputs;St+=1)for(let Nt=0;Nt<w.channelCount;Nt+=1)lu(Z,rt[St],Nt,Nt,Et);x.parameterDescriptors!==void 0&&x.parameterDescriptors.forEach(({name:St},Nt)=>{lu(Z,It,St,y+Nt,Et)});for(let St=0;St<w.numberOfInputs;St+=1)for(let Nt=0;Nt<v[St];Nt+=1)xt[St][Nt].byteLength===0&&(xt[St][Nt]=new Float32Array(128));try{const St=rt.map((U,N)=>{if(Ct[N].size>0)return Rt.set(N,z/128),U;const pt=Rt.get(N);return pt===void 0?[]:(U.every(bt=>bt.every(ut=>ut===0))&&(pt===1?Rt.delete(N):Rt.set(N,pt-1)),U)});Q=u(m.currentTime+Et/m.sampleRate,m.sampleRate,()=>$.process(St,xt,It));for(let U=0,N=0;U<w.numberOfOutputs;U+=1){for(let ot=0;ot<v[U];ot+=1)Ax(it,xt[U],ot,N+ot,Et);N+=v[U]}}catch(St){Q=!1,tt.dispatchEvent(new ErrorEvent("processorerror",{colno:St.colno,filename:St.filename,lineno:St.lineno,message:St.message}))}if(!Q){for(let St=0;St<w.numberOfInputs;St+=1){E[St].disconnect(T[St]);for(let Nt=0;Nt<w.channelCount;Nt+=1)T[Et].disconnect(F,Nt,St*w.channelCount+Nt)}if(x.parameterDescriptors!==void 0){const St=x.parameterDescriptors.length;for(let Nt=0;Nt<St;Nt+=1){const U=R[Nt];U.disconnect(F,0,y+Nt),U.stop()}}F.disconnect(L),L.onaudioprocess=null,wt?_t():nt();break}}}};let wt=!1;const at=o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),qt=()=>L.connect(at).connect(m.destination),nt=()=>{L.disconnect(at),at.disconnect()},ft=()=>{if(Q){nt(),w.numberOfOutputs>0&&L.connect(A);for(let Z=0,it=0;Z<w.numberOfOutputs;Z+=1){const Ct=D[Z];for(let Et=0;Et<v[Z];Et+=1)A.connect(Ct,it+Et,Et);it+=v[Z]}}wt=!0},mt=()=>{Q&&(qt(),_t()),wt=!1};return qt(),f(tt,ft,mt)},kx=(r,t)=>{const e=r.createBiquadFilter();return $e(e,t),Ie(e,t,"Q"),Ie(e,t,"detune"),Ie(e,t,"frequency"),Ie(e,t,"gain"),Re(e,t,"type"),e},Ik=(r,t)=>(e,n)=>{const i=e.createChannelMerger(n.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&t(e,i),$e(i,n),i},Nk=r=>{const t=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw nn()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw nn()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw nn()}})},Zl=(r,t)=>{const e=r.createChannelSplitter(t.numberOfOutputs);return $e(e,t),Nk(e),e},Fk=(r,t,e,n,i)=>(s,o)=>{if(s.createConstantSource===void 0)return e(s,o);const a=s.createConstantSource();return $e(a,o),Ie(a,o,"offset"),t(n,()=>n(s))||zf(a),t(i,()=>i(s))||Vf(a),r(s,a),a},Ea=(r,t)=>(r.connect=t.connect.bind(t),r.disconnect=t.disconnect.bind(t),r),Ok=(r,t,e,n)=>(i,a)=>{var l=a,{offset:s}=l,o=Za(l,["offset"]);const h=i.createBuffer(1,2,44100),u=t(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),d=e(i,Bt(gt({},o),{gain:s})),f=h.getChannelData(0);f[0]=1,f[1]=1,u.buffer=h,u.loop=!0;const m={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(w){d.channelCount=w},get channelCountMode(){return d.channelCountMode},set channelCountMode(w){d.channelCountMode=w},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(w){d.channelInterpretation=w},get context(){return d.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get offset(){return d.gain},get onended(){return u.onended},set onended(w){u.onended=w},addEventListener(...w){return u.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return u.dispatchEvent(w[0])},removeEventListener(...w){return u.removeEventListener(w[0],w[1],w[2])},start(w=0){u.start.call(u,w)},stop(w=0){u.stop.call(u,w)}},_=()=>u.connect(d),x=()=>u.disconnect(d);return r(i,u),n(Ea(m,d),_,x)},zk=(r,t)=>(e,n)=>{const i=e.createConvolver();if($e(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),Re(i,n,"buffer"),n.channelCount>2||(t(i,"channelCount",s=>()=>s.call(i),s=>o=>{if(o>2)throw r();return s.call(i,o)}),n.channelCountMode==="max"))throw r();return t(i,"channelCountMode",s=>()=>s.call(i),s=>o=>{if(o==="max")throw r();return s.call(i,o)}),i},Ix=(r,t)=>{const e=r.createDelay(t.maxDelayTime);return $e(e,t),Ie(e,t,"delayTime"),e},Vk=r=>(t,e)=>{const n=t.createDynamicsCompressor();if($e(n,e),e.channelCount>2||e.channelCountMode==="max")throw r();return Ie(n,e,"attack"),Ie(n,e,"knee"),Ie(n,e,"ratio"),Ie(n,e,"release"),Ie(n,e,"threshold"),n},Nn=(r,t)=>{const e=r.createGain();return $e(e,t),Ie(e,t,"gain"),e},Bk=r=>(t,e,n)=>{if(t.createIIRFilter===void 0)return r(t,e,n);const i=t.createIIRFilter(n.feedforward,n.feedback);return $e(i,n),i};function Uk(r,t){const e=t[0]*t[0]+t[1]*t[1];return[(r[0]*t[0]+r[1]*t[1])/e,(r[1]*t[0]-r[0]*t[1])/e]}function Hk(r,t){return[r[0]*t[0]-r[1]*t[1],r[0]*t[1]+r[1]*t[0]]}function Nx(r,t){let e=[0,0];for(let n=r.length-1;n>=0;n-=1)e=Hk(e,t),e[0]+=r[n];return e}const Wk=(r,t,e,n)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:h,feedforward:u})=>{const d=Lx(s,i.sampleRate),f=h instanceof Float64Array?h:new Float64Array(h),m=u instanceof Float64Array?u:new Float64Array(u),_=f.length,x=m.length,w=Math.min(_,x);if(_===0||_>20)throw n();if(f[0]===0)throw t();if(x===0||x>20)throw n();if(m[0]===0)throw t();if(f[0]!==1){for(let R=0;R<x;R+=1)m[R]/=f[0];for(let R=1;R<_;R+=1)f[R]/=f[0]}const v=e(i,d,o,o);v.channelCount=o,v.channelCountMode=a,v.channelInterpretation=l;const y=32,C=[],S=[],M=[];for(let R=0;R<o;R+=1){C.push(0);const F=new Float32Array(y),z=new Float32Array(y);F.fill(0),z.fill(0),S.push(F),M.push(z)}v.onaudioprocess=R=>{const F=R.inputBuffer,z=R.outputBuffer,L=F.numberOfChannels;for(let A=0;A<L;A+=1){const D=F.getChannelData(A),I=z.getChannelData(A);C[A]=Rx(f,_,m,x,w,S[A],M[A],C[A],y,D,I)}};const E=i.sampleRate/2;return Ea({get bufferSize(){return d},get channelCount(){return v.channelCount},set channelCount(R){v.channelCount=R},get channelCountMode(){return v.channelCountMode},set channelCountMode(R){v.channelCountMode=R},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(R){v.channelInterpretation=R},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...R){return v.addEventListener(R[0],R[1],R[2])},dispatchEvent(...R){return v.dispatchEvent(R[0])},getFrequencyResponse(R,F,z){if(R.length!==F.length||F.length!==z.length)throw r();const L=R.length;for(let A=0;A<L;A+=1){const D=-Math.PI*(R[A]/E),I=[Math.cos(D),Math.sin(D)],B=Nx(m,I),k=Nx(f,I),G=Uk(B,k);F[A]=Math.sqrt(G[0]*G[0]+G[1]*G[1]),z[A]=Math.atan2(G[1],G[0])}},removeEventListener(...R){return v.removeEventListener(R[0],R[1],R[2])}},v)},Gk=(r,t)=>r.createMediaElementSource(t.mediaElement),qk=(r,t)=>{const e=r.createMediaStreamDestination();return $e(e,t),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e},jk=(r,{mediaStream:t})=>{const e=t.getAudioTracks();e.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const n=e.slice(0,1),i=r.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,"mediaStream",{value:t}),i},$k=(r,t)=>(e,{mediaStreamTrack:n})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(n);const i=new MediaStream([n]),s=e.createMediaStreamSource(i);if(n.kind!=="audio")throw r();if(t(e))throw new TypeError;return s},Xk=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null,Yk=(r,t,e,n,i,s)=>(o,a)=>{const l=o.createOscillator();return $e(l,a),Ie(l,a,"detune"),Ie(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):Re(l,a,"type"),t(e,()=>e(o))||zf(l),t(n,()=>n(o))||s(l,o),t(i,()=>i(o))||Vf(l),r(o,l),l},Zk=r=>(t,e)=>{const n=t.createPanner();return n.orientationX===void 0?r(t,e):($e(n,e),Ie(n,e,"orientationX"),Ie(n,e,"orientationY"),Ie(n,e,"orientationZ"),Ie(n,e,"positionX"),Ie(n,e,"positionY"),Ie(n,e,"positionZ"),Re(n,e,"coneInnerAngle"),Re(n,e,"coneOuterAngle"),Re(n,e,"coneOuterGain"),Re(n,e,"distanceModel"),Re(n,e,"maxDistance"),Re(n,e,"panningModel"),Re(n,e,"refDistance"),Re(n,e,"rolloffFactor"),n)},Jk=(r,t,e,n,i,s,o,a,l,h)=>(u,z)=>{var L=z,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:m,distanceModel:_,maxDistance:x,orientationX:w,orientationY:v,orientationZ:y,panningModel:C,positionX:S,positionY:M,positionZ:E,refDistance:T,rolloffFactor:R}=L,F=Za(L,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);const A=u.createPanner();if(F.channelCount>2||F.channelCountMode==="max")throw o();$e(A,F);const D={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},I=e(u,Bt(gt({},D),{channelInterpretation:"speakers",numberOfInputs:6})),B=n(u,Bt(gt({},F),{gain:1})),k=n(u,Bt(gt({},D),{gain:1})),G=n(u,Bt(gt({},D),{gain:0})),tt=n(u,Bt(gt({},D),{gain:0})),K=n(u,Bt(gt({},D),{gain:0})),j=n(u,Bt(gt({},D),{gain:0})),$=n(u,Bt(gt({},D),{gain:0})),st=i(u,256,6,1),rt=s(u,Bt(gt({},D),{curve:new Float32Array([1,1]),oversample:"none"}));let xt=[w,v,y],It=[S,M,E];const Q=new Float32Array(1);st.onaudioprocess=({inputBuffer:at})=>{const qt=[l(at,Q,0),l(at,Q,1),l(at,Q,2)];qt.some((ft,mt)=>ft!==xt[mt])&&(A.setOrientation(...qt),xt=qt);const nt=[l(at,Q,3),l(at,Q,4),l(at,Q,5)];nt.some((ft,mt)=>ft!==It[mt])&&(A.setPosition(...nt),It=nt)},Object.defineProperty(G.gain,"defaultValue",{get:()=>0}),Object.defineProperty(tt.gain,"defaultValue",{get:()=>0}),Object.defineProperty(K.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0});const _t={get bufferSize(){},get channelCount(){return A.channelCount},set channelCount(at){if(at>2)throw o();B.channelCount=at,A.channelCount=at},get channelCountMode(){return A.channelCountMode},set channelCountMode(at){if(at==="max")throw o();B.channelCountMode=at,A.channelCountMode=at},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(at){B.channelInterpretation=at,A.channelInterpretation=at},get coneInnerAngle(){return A.coneInnerAngle},set coneInnerAngle(at){A.coneInnerAngle=at},get coneOuterAngle(){return A.coneOuterAngle},set coneOuterAngle(at){A.coneOuterAngle=at},get coneOuterGain(){return A.coneOuterGain},set coneOuterGain(at){if(at<0||at>1)throw t();A.coneOuterGain=at},get context(){return A.context},get distanceModel(){return A.distanceModel},set distanceModel(at){A.distanceModel=at},get inputs(){return[B]},get maxDistance(){return A.maxDistance},set maxDistance(at){if(at<0)throw new RangeError;A.maxDistance=at},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get orientationX(){return k.gain},get orientationY(){return G.gain},get orientationZ(){return tt.gain},get panningModel(){return A.panningModel},set panningModel(at){A.panningModel=at},get positionX(){return K.gain},get positionY(){return j.gain},get positionZ(){return $.gain},get refDistance(){return A.refDistance},set refDistance(at){if(at<0)throw new RangeError;A.refDistance=at},get rolloffFactor(){return A.rolloffFactor},set rolloffFactor(at){if(at<0)throw new RangeError;A.rolloffFactor=at},addEventListener(...at){return B.addEventListener(at[0],at[1],at[2])},dispatchEvent(...at){return B.dispatchEvent(at[0])},removeEventListener(...at){return B.removeEventListener(at[0],at[1],at[2])}};d!==_t.coneInnerAngle&&(_t.coneInnerAngle=d),f!==_t.coneOuterAngle&&(_t.coneOuterAngle=f),m!==_t.coneOuterGain&&(_t.coneOuterGain=m),_!==_t.distanceModel&&(_t.distanceModel=_),x!==_t.maxDistance&&(_t.maxDistance=x),w!==_t.orientationX.value&&(_t.orientationX.value=w),v!==_t.orientationY.value&&(_t.orientationY.value=v),y!==_t.orientationZ.value&&(_t.orientationZ.value=y),C!==_t.panningModel&&(_t.panningModel=C),S!==_t.positionX.value&&(_t.positionX.value=S),M!==_t.positionY.value&&(_t.positionY.value=M),E!==_t.positionZ.value&&(_t.positionZ.value=E),T!==_t.refDistance&&(_t.refDistance=T),R!==_t.rolloffFactor&&(_t.rolloffFactor=R),(xt[0]!==1||xt[1]!==0||xt[2]!==0)&&A.setOrientation(...xt),(It[0]!==0||It[1]!==0||It[2]!==0)&&A.setPosition(...It);const Rt=()=>{B.connect(A),r(B,rt,0,0),rt.connect(k).connect(I,0,0),rt.connect(G).connect(I,0,1),rt.connect(tt).connect(I,0,2),rt.connect(K).connect(I,0,3),rt.connect(j).connect(I,0,4),rt.connect($).connect(I,0,5),I.connect(st).connect(u.destination)},wt=()=>{B.disconnect(A),a(B,rt,0,0),rt.disconnect(k),k.disconnect(I),rt.disconnect(G),G.disconnect(I),rt.disconnect(tt),tt.disconnect(I),rt.disconnect(K),K.disconnect(I),rt.disconnect(j),j.disconnect(I),rt.disconnect($),$.disconnect(I),I.disconnect(st),st.disconnect(u.destination)};return h(Ea(_t,A),Rt,wt)},Kk=r=>(t,{disableNormalization:e,imag:n,real:i})=>{const s=n instanceof Float32Array?n:new Float32Array(n),o=i instanceof Float32Array?i:new Float32Array(i),a=t.createPeriodicWave(o,s,{disableNormalization:e});if(Array.from(n).length<2)throw r();return a},Jl=(r,t,e,n)=>r.createScriptProcessor(t,e,n),Qk=(r,t)=>(e,n)=>{const i=n.channelCountMode;if(i==="clamped-max")throw t();if(e.createStereoPanner===void 0)return r(e,n);const s=e.createStereoPanner();return $e(s,n),Ie(s,n,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw t()}}),s},t3=(r,t,e,n,i,s)=>{const o=16385,a=new Float32Array([1,1]),l=Math.PI/2,h={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u=Bt(gt({},h),{oversample:"none"}),d=(_,x,w,v)=>{const y=new Float32Array(o),C=new Float32Array(o);for(let F=0;F<o;F+=1){const z=F/(o-1)*l;y[F]=Math.cos(z),C[F]=Math.sin(z)}const S=e(_,Bt(gt({},h),{gain:0})),M=n(_,Bt(gt({},u),{curve:y})),E=n(_,Bt(gt({},u),{curve:a})),T=e(_,Bt(gt({},h),{gain:0})),R=n(_,Bt(gt({},u),{curve:C}));return{connectGraph(){x.connect(S),x.connect(E.inputs===void 0?E:E.inputs[0]),x.connect(T),E.connect(w),w.connect(M.inputs===void 0?M:M.inputs[0]),w.connect(R.inputs===void 0?R:R.inputs[0]),M.connect(S.gain),R.connect(T.gain),S.connect(v,0,0),T.connect(v,0,1)},disconnectGraph(){x.disconnect(S),x.disconnect(E.inputs===void 0?E:E.inputs[0]),x.disconnect(T),E.disconnect(w),w.disconnect(M.inputs===void 0?M:M.inputs[0]),w.disconnect(R.inputs===void 0?R:R.inputs[0]),M.disconnect(S.gain),R.disconnect(T.gain),S.disconnect(v,0,0),T.disconnect(v,0,1)}}},f=(_,x,w,v)=>{const y=new Float32Array(o),C=new Float32Array(o),S=new Float32Array(o),M=new Float32Array(o),E=Math.floor(o/2);for(let G=0;G<o;G+=1)if(G>E){const tt=(G-E)/(o-1-E)*l;y[G]=Math.cos(tt),C[G]=Math.sin(tt),S[G]=0,M[G]=1}else{const tt=G/(o-1-E)*l;y[G]=1,C[G]=0,S[G]=Math.cos(tt),M[G]=Math.sin(tt)}const T=t(_,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),R=e(_,Bt(gt({},h),{gain:0})),F=n(_,Bt(gt({},u),{curve:y})),z=e(_,Bt(gt({},h),{gain:0})),L=n(_,Bt(gt({},u),{curve:C})),A=n(_,Bt(gt({},u),{curve:a})),D=e(_,Bt(gt({},h),{gain:0})),I=n(_,Bt(gt({},u),{curve:S})),B=e(_,Bt(gt({},h),{gain:0})),k=n(_,Bt(gt({},u),{curve:M}));return{connectGraph(){x.connect(T),x.connect(A.inputs===void 0?A:A.inputs[0]),T.connect(R,0),T.connect(z,0),T.connect(D,1),T.connect(B,1),A.connect(w),w.connect(F.inputs===void 0?F:F.inputs[0]),w.connect(L.inputs===void 0?L:L.inputs[0]),w.connect(I.inputs===void 0?I:I.inputs[0]),w.connect(k.inputs===void 0?k:k.inputs[0]),F.connect(R.gain),L.connect(z.gain),I.connect(D.gain),k.connect(B.gain),R.connect(v,0,0),D.connect(v,0,0),z.connect(v,0,1),B.connect(v,0,1)},disconnectGraph(){x.disconnect(T),x.disconnect(A.inputs===void 0?A:A.inputs[0]),T.disconnect(R,0),T.disconnect(z,0),T.disconnect(D,1),T.disconnect(B,1),A.disconnect(w),w.disconnect(F.inputs===void 0?F:F.inputs[0]),w.disconnect(L.inputs===void 0?L:L.inputs[0]),w.disconnect(I.inputs===void 0?I:I.inputs[0]),w.disconnect(k.inputs===void 0?k:k.inputs[0]),F.disconnect(R.gain),L.disconnect(z.gain),I.disconnect(D.gain),k.disconnect(B.gain),R.disconnect(v,0,0),D.disconnect(v,0,0),z.disconnect(v,0,1),B.disconnect(v,0,1)}}},m=(_,x,w,v,y)=>{if(x===1)return d(_,w,v,y);if(x===2)return f(_,w,v,y);throw i()};return(_,C)=>{var S=C,{channelCount:x,channelCountMode:w,pan:v}=S,y=Za(S,["channelCount","channelCountMode","pan"]);if(w==="max")throw i();const M=r(_,Bt(gt({},y),{channelCount:1,channelCountMode:w,numberOfInputs:2})),E=e(_,Bt(gt({},y),{channelCount:x,channelCountMode:w,gain:1})),T=e(_,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:R,disconnectGraph:F}=m(_,x,E,T,M);Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"maxValue",{get:()=>1}),Object.defineProperty(T.gain,"minValue",{get:()=>-1});const z={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(I){E.channelCount!==I&&(L&&F(),{connectGraph:R,disconnectGraph:F}=m(_,I,E,T,M),L&&R()),E.channelCount=I},get channelCountMode(){return E.channelCountMode},set channelCountMode(I){if(I==="clamped-max"||I==="max")throw i();E.channelCountMode=I},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(I){E.channelInterpretation=I},get context(){return E.context},get inputs(){return[E]},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get pan(){return T.gain},addEventListener(...I){return E.addEventListener(I[0],I[1],I[2])},dispatchEvent(...I){return E.dispatchEvent(I[0])},removeEventListener(...I){return E.removeEventListener(I[0],I[1],I[2])}};let L=!1;const A=()=>{R(),L=!0},D=()=>{F(),L=!1};return s(Ea(z,M),A,D)}},e3=(r,t,e,n,i,s,o)=>(a,l)=>{const h=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return e(a,l);$e(h,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw t();Re(h,{curve:u},"curve"),Re(h,l,"oversample");let d=null,f=!1;return o(h,"curve",x=>()=>x.call(h),x=>w=>(x.call(h,w),f&&(n(w)&&d===null?d=r(a,h):!n(w)&&d!==null&&(d(),d=null)),w)),i(h,()=>{f=!0,n(h.curve)&&(d=r(a,h))},()=>{f=!1,d!==null&&(d(),d=null)})},n3=(r,t,e,n,i)=>(s,h)=>{var u=h,{curve:o,oversample:a}=u,l=Za(u,["curve","oversample"]);const d=s.createWaveShaper(),f=s.createWaveShaper();$e(d,l),$e(f,l);const m=e(s,Bt(gt({},l),{gain:1})),_=e(s,Bt(gt({},l),{gain:-1})),x=e(s,Bt(gt({},l),{gain:1})),w=e(s,Bt(gt({},l),{gain:-1}));let v=null,y=!1,C=null;const S={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(T){m.channelCount=T,_.channelCount=T,d.channelCount=T,x.channelCount=T,f.channelCount=T,w.channelCount=T},get channelCountMode(){return d.channelCountMode},set channelCountMode(T){m.channelCountMode=T,_.channelCountMode=T,d.channelCountMode=T,x.channelCountMode=T,f.channelCountMode=T,w.channelCountMode=T},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(T){m.channelInterpretation=T,_.channelInterpretation=T,d.channelInterpretation=T,x.channelInterpretation=T,f.channelInterpretation=T,w.channelInterpretation=T},get context(){return d.context},get curve(){return C},set curve(T){if(T!==null&&T.length<2)throw t();if(T===null)d.curve=T,f.curve=T;else{const R=T.length,F=new Float32Array(R+2-R%2),z=new Float32Array(R+2-R%2);F[0]=T[0],z[0]=-T[R-1];const L=Math.ceil((R+1)/2),A=(R+1)/2-1;for(let D=1;D<L;D+=1){const I=D/L*A,B=Math.floor(I),k=Math.ceil(I);F[D]=B===k?T[B]:(1-(I-B))*T[B]+(1-(k-I))*T[k],z[D]=B===k?-T[R-1-B]:-((1-(I-B))*T[R-1-B])-(1-(k-I))*T[R-1-k]}F[L]=R%2==1?T[L-1]:(T[L-2]+T[L-1])/2,d.curve=F,f.curve=z}C=T,y&&(n(C)&&v===null?v=r(s,m):v!==null&&(v(),v=null))},get inputs(){return[m]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get oversample(){return d.oversample},set oversample(T){d.oversample=T,f.oversample=T},addEventListener(...T){return m.addEventListener(T[0],T[1],T[2])},dispatchEvent(...T){return m.dispatchEvent(T[0])},removeEventListener(...T){return m.removeEventListener(T[0],T[1],T[2])}};o!==null&&(S.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==S.oversample&&(S.oversample=a);const M=()=>{m.connect(d).connect(x),m.connect(_).connect(f).connect(w).connect(x),y=!0,n(C)&&(v=r(s,m))},E=()=>{m.disconnect(d),d.disconnect(x),m.disconnect(_),_.disconnect(f),f.disconnect(w),w.disconnect(x),y=!1,v!==null&&(v(),v=null)};return i(Ea(S,x),M,E)},wn=()=>new DOMException("","NotSupportedError"),i3={numberOfChannels:1},s3=(r,t,e,n,i)=>class extends r{constructor(o,a,l){let h;if(typeof o=="number"&&a!==void 0&&l!==void 0)h={length:a,numberOfChannels:o,sampleRate:l};else if(typeof o=="object")h=o;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:d,sampleRate:f}=gt(gt({},i3),h),m=n(d,u,f);t(Yl,()=>Yl(m))||m.addEventListener("statechange",(()=>{let _=0;const x=w=>{this._state==="running"&&(_>0?(m.removeEventListener("statechange",x),w.stopImmediatePropagation(),this._waitForThePromiseToSettle(w)):_+=1)};return x})());super(m,d);this._length=u,this._nativeOfflineAudioContext=m,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,yx(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},r3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},o3=(r,t,e,n,i,s,o)=>class extends r{constructor(l,h){const u=i(l),d=gt(gt({},r3),h),f=e(u,d),m=s(u),_=m?n():null,x=l.sampleRate/2;super(l,!1,f,_);this._detune=t(this,m,f.detune,153600,-153600),this._frequency=t(this,m,f.frequency,x,-x),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=_,this._oscillatorNodeRenderer!==null&&d.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=d.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const h=typeof l=="function"?o(this,l):null;this._nativeOscillatorNode.onended=h;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===h?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Sa(this);const h=()=>{this._nativeOscillatorNode.removeEventListener("ended",h),ps(this)&&ql(this)};this._nativeOscillatorNode.addEventListener("ended",h)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},a3=(r,t,e,n,i)=>()=>{const s=new WeakMap;let o=null,a=null,l=null;const h=async(u,d)=>{let f=e(u);const m=_n(f,d);if(!m){const _={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=t(d,_),a!==null&&f.start(a),l!==null&&f.stop(l)}return s.set(d,f),m?(await r(d,u.detune,f.detune),await r(d,u.frequency,f.frequency)):(await n(d,u.detune,f.detune),await n(d,u.frequency,f.frequency)),await i(u,d,f),f};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){l=u},render(u,d){const f=s.get(d);return f!==void 0?Promise.resolve(f):h(u,d)}}},l3={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},c3=(r,t,e,n,i,s,o)=>class extends r{constructor(l,h){const u=i(l),d=gt(gt({},l3),h),f=e(u,d),m=s(u),_=m?n():null;super(l,!1,f,_);this._nativePannerNode=f,this._orientationX=t(this,m,f.orientationX,yn,In),this._orientationY=t(this,m,f.orientationY,yn,In),this._orientationZ=t(this,m,f.orientationZ,yn,In),this._positionX=t(this,m,f.positionX,yn,In),this._positionY=t(this,m,f.positionY,yn,In),this._positionZ=t(this,m,f.positionZ,yn,In),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},h3=(r,t,e,n,i,s,o,a,l,h)=>()=>{const u=new WeakMap;let d=null;const f=async(m,_)=>{let x=null,w=s(m);const v={channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation},y=Bt(gt({},v),{coneInnerAngle:w.coneInnerAngle,coneOuterAngle:w.coneOuterAngle,coneOuterGain:w.coneOuterGain,distanceModel:w.distanceModel,maxDistance:w.maxDistance,panningModel:w.panningModel,refDistance:w.refDistance,rolloffFactor:w.rolloffFactor}),C=_n(w,_);if("bufferSize"in w)x=n(_,Bt(gt({},v),{gain:1}));else if(!C){const S=Bt(gt({},y),{orientationX:w.orientationX.value,orientationY:w.orientationY.value,orientationZ:w.orientationZ.value,positionX:w.positionX.value,positionY:w.positionY.value,positionZ:w.positionZ.value});w=i(_,S)}if(u.set(_,x===null?w:x),x!==null){if(d===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const L=new o(6,m.context.length,_.sampleRate),A=t(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});A.connect(L.destination),d=(async()=>{const D=await Promise.all([m.orientationX,m.orientationY,m.orientationZ,m.positionX,m.positionY,m.positionZ].map(async(I,B)=>{const k=e(L,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:B===0?1:0});return await a(L,I,k.offset),k}));for(let I=0;I<6;I+=1)D[I].connect(A,0,I),D[I].start(0);return h(L)})()}const S=await d,M=n(_,Bt(gt({},v),{gain:1}));await l(m,_,M);const E=[];for(let L=0;L<S.numberOfChannels;L+=1)E.push(S.getChannelData(L));let T=[E[0][0],E[1][0],E[2][0]],R=[E[3][0],E[4][0],E[5][0]],F=n(_,Bt(gt({},v),{gain:1})),z=i(_,Bt(gt({},y),{orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:R[0],positionY:R[1],positionZ:R[2]}));M.connect(F).connect(z.inputs[0]),z.connect(x);for(let L=128;L<S.length;L+=128){const A=[E[0][L],E[1][L],E[2][L]],D=[E[3][L],E[4][L],E[5][L]];if(A.some((I,B)=>I!==T[B])||D.some((I,B)=>I!==R[B])){T=A,R=D;const I=L/_.sampleRate;F.gain.setValueAtTime(0,I),F=n(_,Bt(gt({},v),{gain:0})),z=i(_,Bt(gt({},y),{orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:R[0],positionY:R[1],positionZ:R[2]})),F.gain.setValueAtTime(1,I),M.connect(F).connect(z.inputs[0]),z.connect(x)}}return x}return C?(await r(_,m.orientationX,w.orientationX),await r(_,m.orientationY,w.orientationY),await r(_,m.orientationZ,w.orientationZ),await r(_,m.positionX,w.positionX),await r(_,m.positionY,w.positionY),await r(_,m.positionZ,w.positionZ)):(await a(_,m.orientationX,w.orientationX),await a(_,m.orientationY,w.orientationY),await a(_,m.orientationZ,w.orientationZ),await a(_,m.positionX,w.positionX),await a(_,m.positionY,w.positionY),await a(_,m.positionZ,w.positionZ)),Ta(w)?await l(m,_,w.inputs[0]):await l(m,_,w),w};return{render(m,_){const x=u.get(_);return x!==void 0?Promise.resolve(x):f(m,_)}}},u3={disableNormalization:!1},d3=(r,t,e,n)=>class Fx{constructor(s,o){const a=t(s),l=n(gt(gt({},u3),o)),h=r(a,l);return e.add(h),h}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Fx.prototype||e.has(s)}},p3=(r,t)=>(e,n,i)=>(r(n).replay(i),t(n,e,i)),f3=(r,t,e)=>async(n,i,s)=>{const o=r(n);await Promise.all(o.activeInputs.map((a,l)=>Array.from(a).map(async([h,u])=>{const f=await t(h).render(h,i),m=n.context.destination;!e(h)&&(n!==m||!e(n))&&f.connect(s,u,l)})).reduce((a,l)=>[...a,...l],[]))},m3=(r,t,e)=>async(n,i,s)=>{const o=t(n);await Promise.all(Array.from(o.activeInputs).map(async([a,l])=>{const u=await r(a).render(a,i);e(a)||u.connect(s,l)}))},g3=(r,t,e,n)=>i=>r(Yl,()=>Yl(i))?Promise.resolve(r(n,n)).then(s=>{if(!s){const o=e(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const o=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),_3=r=>(t,e)=>{r.set(t,e)},v3=r=>(t,e)=>r.set(t,e),x3=(r,t,e,n,i,s,o,a)=>(l,h)=>e(l).render(l,h).then(()=>Promise.all(Array.from(n(h)).map(u=>e(u).render(u,h)))).then(()=>i(h)).then(u=>(typeof u.copyFromChannel!="function"?(o(u),kf(u)):t(s,()=>s(u))||a(u),r.add(u),u)),y3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},b3=(r,t,e,n,i,s)=>class extends r{constructor(a,l){const h=i(a),u=gt(gt({},y3),l),d=e(h,u),f=s(h),m=f?n():null;super(a,!1,d,m);this._pan=t(this,f,d.pan)}get pan(){return this._pan}},w3=(r,t,e,n,i)=>()=>{const s=new WeakMap,o=async(a,l)=>{let h=e(a);const u=_n(h,l);if(!u){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=t(l,d)}return s.set(l,h),u?await r(l,a.pan,h.pan):await n(l,a.pan,h.pan),Ta(h)?await i(a,l,h.inputs[0]):await i(a,l,h),h};return{render(a,l){const h=s.get(l);return h!==void 0?Promise.resolve(h):o(a,l)}}},M3=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0},S3=(r,t)=>async()=>{if(r===null)return!0;if(t===null)return!1;const e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new t(1,128,44100),i=URL.createObjectURL(e);let s=!1,o=!1;try{await n.audioWorklet.addModule(i);const a=new r(n,"a",{numberOfOutputs:0}),l=n.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,l.connect(a),l.start(0),await n.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return s&&!o},T3=(r,t)=>()=>{if(t===null)return Promise.resolve(!1);const e=new t(1,1,44100),n=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{e.oncomplete=()=>{n.disconnect(),i(e.currentTime!==0)},e.startRendering()})},E3=()=>new DOMException("","UnknownError"),C3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},A3=(r,t,e,n,i,s,o)=>class extends r{constructor(l,h){const u=i(l),d=gt(gt({},C3),h),f=e(u,d),_=s(u)?n():null;super(l,!0,f,_);this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},P3=(r,t,e)=>()=>{const n=new WeakMap,i=async(s,o)=>{let a=t(s);if(!_n(a,o)){const h={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=r(o,h)}return n.set(o,a),Ta(a)?await e(s,o,a.inputs[0]):await e(s,o,a),a};return{render(s,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},R3=()=>typeof window=="undefined"?null:window,D3=(r,t)=>e=>{e.copyFromChannel=(n,i,s=0)=>{const o=r(s),a=r(i);if(a>=e.numberOfChannels)throw t();const l=e.length,h=e.getChannelData(a),u=n.length;for(let d=o<0?-o:0;d+o<l&&d<u;d+=1)n[d]=h[d+o]},e.copyToChannel=(n,i,s=0)=>{const o=r(s),a=r(i);if(a>=e.numberOfChannels)throw t();const l=e.length,h=e.getChannelData(a),u=n.length;for(let d=o<0?-o:0;d+o<l&&d<u;d+=1)h[d+o]=n[d]}},L3=r=>t=>{t.copyFromChannel=(e=>(n,i,s=0)=>{const o=r(s),a=r(i);if(o<t.length)return e.call(t,n,a,o)})(t.copyFromChannel),t.copyToChannel=(e=>(n,i,s=0)=>{const o=r(s),a=r(i);if(o<t.length)return e.call(t,n,a,o)})(t.copyToChannel)},k3=r=>(t,e)=>{const n=e.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=n),r(t,"buffer",i=>()=>{const s=i.call(t);return s===n?null:s},i=>s=>i.call(t,s===null?n:s))},I3=(r,t)=>(e,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});const i=e.createBufferSource();t(n,()=>{const a=n.numberOfInputs;for(let l=0;l<a;l+=1)i.connect(n,0,l)},()=>i.disconnect(n))},Ox=(r,t,e)=>r.copyFromChannel===void 0?r.getChannelData(e)[0]:(r.copyFromChannel(t,e),t[0]),zx=r=>{if(r===null)return!1;const t=r.length;return t%2!=0?r[Math.floor(t/2)]!==0:r[t/2-1]+r[t/2]!==0},Kl=(r,t,e,n)=>{let i=r;for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(r,t,{get:e(s),set:n(o)})},N3=r=>Bt(gt({},r),{outputChannelCount:r.outputChannelCount!==void 0?r.outputChannelCount:r.numberOfInputs===1&&r.numberOfOutputs===1?[r.channelCount]:Array.from({length:r.numberOfOutputs},()=>1)}),F3=r=>Bt(gt({},r),{channelCount:r.numberOfOutputs}),O3=r=>{const{imag:t,real:e}=r;return t===void 0?e===void 0?Bt(gt({},r),{imag:[0,0],real:[0,0]}):Bt(gt({},r),{imag:Array.from(e,()=>0),real:e}):e===void 0?Bt(gt({},r),{imag:t,real:Array.from(t,()=>0)}):Bt(gt({},r),{imag:t,real:e})},Vx=(r,t,e)=>{try{r.setValueAtTime(t,e)}catch(n){if(n.code!==9)throw n;Vx(r,t,e+1e-7)}},z3=r=>{const t=r.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},V3=r=>{const t=r.createBufferSource(),e=r.createBuffer(1,1,44100);t.buffer=e;try{t.start(0,1)}catch{return!1}return!0},B3=r=>{const t=r.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},Bf=r=>{const t=r.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},Bx=r=>{const t=r.createBuffer(1,1,44100),e=r.createBufferSource();e.buffer=t,e.start(),e.stop();try{return e.stop(),!0}catch{return!1}},Uf=r=>{const t=r.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},U3=r=>{const{port1:t,port2:e}=new MessageChannel;try{t.postMessage(r)}finally{t.close(),e.close()}},H3=r=>{r.start=(t=>(e=0,n=0,i)=>{const s=r.buffer,o=s===null?n:Math.min(s.duration,n);s!==null&&o>s.duration-.5/r.context.sampleRate?t.call(r,e,0,0):t.call(r,e,o,i)})(r.start)},Ux=(r,t)=>{const e=t.createGain();r.connect(e);const n=(i=>()=>{i.call(r,e),r.removeEventListener("ended",n)})(r.disconnect);r.addEventListener("ended",n),Ea(r,e),r.stop=(i=>{let s=!1;return(o=0)=>{if(s)try{i.call(r,o)}catch{e.gain.setValueAtTime(0,o)}else i.call(r,o),s=!0}})(r.stop)},Ca=(r,t)=>e=>{const n={value:r};return Object.defineProperties(e,{currentTarget:n,target:n}),typeof t=="function"?t.call(r,e):t.handleEvent.call(r,e)},W3=cD(Gr),G3=mD(Gr),q3=CL(eu),Hx=new WeakMap,j3=qL(Hx),bi=iL(new Map,new WeakMap),Wi=R3(),Wx=bk(bi,Hi),Hf=GL(bn),cn=f3(bn,Hf,qr),$3=yD(Wx,Se,cn),Me=XL(tu),fs=Xk(Wi),fe=uk(fs),Gx=new WeakMap,qx=OL(Ca),Ql=Tk(Wi),Wf=ak(Ql),Gf=lk(Wi),jx=ck(Wi),tc=Ck(Wi),Oe=qD(hD(cx),fD(W3,G3,su,q3,ru,bn,j3,Gl,Se,Gr,ps,qr,ou),bi,nk(Pf,ru,bn,Se,Xl,ps),Hi,uu,wn,ML(su,Pf,bn,Se,Xl,Me,ps,fe),RL(Gx,bn,yi),qx,Me,Wf,Gf,jx,fe,tc),X3=xD(Oe,$3,Hi,Wx,Me,fe),qf=new WeakSet,$x=wk(Wi),Xx=gL(new Uint32Array(1)),jf=D3(Xx,Hi),$f=L3(Xx),Y3=wD(qf,bi,wn,$x,fs,M3($x),jf,$f),du=gD(Nn),Yx=m3(Hf,jl,qr),Gi=hL(Yx),Aa=Sk(du,bi,z3,V3,B3,Bf,Bx,Uf,H3,k3(Kl),Ux),qi=p3(jL(jl),Yx),Z3=TD(Gi,Aa,Se,qi,cn),wi=jD(uD(hx),Gx,Af,$D,iD,sD,rD,oD,aD,Mf,sx,Ql,Vx),J3=SD(Oe,Z3,wi,nn,Aa,Me,fe,Ca),K3=ID(Oe,ND,Hi,nn,Ek(Nn,Kl),Me,fe,cn),Q3=nL(Gi,kx,Se,qi,cn),jr=v3(Hx),tI=eL(Oe,wi,Q3,uu,kx,Me,fe,jr),ar=xk(Gr,Gf),eI=I3(nn,ar),lr=Ik(Ql,eI),nI=oL(lr,Se,cn),iI=rL(Oe,nI,lr,Me,fe),sI=cL(Zl,Se,cn),rI=lL(Oe,sI,Zl,Me,fe,F3),oI=Ok(du,Aa,Nn,ar),Pa=Fk(du,bi,oI,Bf,Uf),aI=mL(Gi,Pa,Se,qi,cn),lI=fL(Oe,wi,aI,Pa,Me,fe,Ca),Zx=zk(wn,Kl),cI=xL(Zx,Se,cn),hI=vL(Oe,cI,Zx,Me,fe,jr),uI=EL(Gi,Ix,Se,qi,cn),dI=TL(Oe,wi,uI,Ix,Me,fe,jr),Jx=Vk(wn),pI=IL(Gi,Jx,Se,qi,cn),fI=kL(Oe,wi,pI,Jx,wn,Me,fe,jr),mI=HL(Gi,Nn,Se,qi,cn),gI=UL(Oe,wi,mI,Nn,Me,fe),_I=Wk(uu,nn,Jl,wn),pu=g3(bi,Nn,Jl,T3(Nn,fs)),vI=ek(Aa,Se,fs,cn,pu),xI=Bk(_I),yI=QL(Oe,xI,vI,Me,fe,jr),bI=FD(wi,lr,Pa,Jl,wn,Ox,fe,Kl),Kx=new WeakMap,wI=vk(K3,bI,qx,fe,Kx,Ca),Qx=Yk(du,bi,Bf,Bx,Uf,Ux),MI=a3(Gi,Qx,Se,qi,cn),SI=o3(Oe,wi,Qx,MI,Me,fe,Ca),ty=dL(Aa),TI=n3(ty,nn,Nn,zx,ar),fu=e3(ty,nn,TI,zx,ar,Ql,Kl),EI=Jk(su,nn,lr,Nn,Jl,fu,wn,ru,Ox,ar),ey=Zk(EI),CI=h3(Gi,lr,Pa,Nn,ey,Se,fs,qi,cn,pu),AI=c3(Oe,wi,ey,CI,Me,fe,jr),PI=Kk(Hi),RI=d3(PI,Me,new WeakSet,O3),DI=t3(lr,Zl,Nn,fu,wn,ar),ny=Qk(DI,wn),LI=w3(Gi,ny,Se,qi,cn),kI=b3(Oe,wi,ny,LI,Me,fe),II=P3(fu,Se,cn),NI=A3(Oe,nn,fu,II,Me,fe,jr),iy=dk(Wi),Xf=zL(Wi),sy=new WeakMap,FI=YL(sy,fs),OI=iy?pD(bi,wn,FL(Wi),Xf,VL(lD),Me,FI,fe,tc,new WeakMap,new WeakMap,S3(tc,fs),Wi):void 0,zI=hk(Wf,fe),VI=wL(qf,bi,bL,NL,new WeakSet,Me,zI,nu,Yl,jf,$f),ry=QD(OI,X3,Y3,J3,tI,iI,rI,lI,hI,VI,dI,fI,gI,yI,wI,SI,AI,RI,kI,NI),BI=pk(Oe,Gk,Me,fe),UI=mk(Oe,qk,Me,fe),HI=gk(Oe,jk,Me,fe),WI=$k(nn,fe),GI=_k(Oe,WI,Me),qI=kD(ry,nn,wn,E3,BI,UI,HI,GI,Ql),Yf=ZL(Kx),jI=_D(Yf),oy=uL(Hi),$I=AL(Yf),ay=DL(Hi),ly=new WeakMap,XI=WL(ly,yi),YI=kk(oy,Hi,nn,lr,Zl,Pa,Nn,Jl,wn,ay,Xf,XI,ar),ZI=Pk(nn,YI,Nn,wn,ar),JI=KD(Gi,oy,Aa,lr,Zl,Pa,Nn,$I,ay,Xf,Se,tc,fs,qi,cn,pu),KI=$L(sy),QI=_3(ly),cy=iy?YD(jI,Oe,wi,JI,ZI,bn,KI,Me,fe,tc,N3,QI,U3,Ca):void 0,tN=yL(wn,fs),eN=x3(qf,bi,Hf,Yf,pu,nu,jf,$f),nN=s3(ry,bi,nn,tN,eN),iN=ik(tu,Wf),sN=sk(Cf,Gf),rN=rk(Af,jx),oN=ok(tu,fe);function Xt(r,t){if(!r)throw new Error(t)}function ji(r,t,e=1/0){if(!(t<=r&&r<=e))throw new RangeError(`Value must be within [${t}, ${e}], got: ${r}`)}function hy(r){!r.isOffline&&r.state!=="running"&&dy('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let uy=console;function aN(...r){uy.log(...r)}function dy(...r){uy.warn(...r)}function li(r){return typeof r=="undefined"}function ne(r){return!li(r)}function lN(r){return typeof r=="function"}function cr(r){return typeof r=="number"}function $r(r){return Object.prototype.toString.call(r)==="[object Object]"&&r.constructor===Object}function cN(r){return typeof r=="boolean"}function Mi(r){return Array.isArray(r)}function $i(r){return typeof r=="string"}function mu(r){return $i(r)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(r)}function hN(r){return new qI(r)}function uN(r,t,e){return new nN(r,t,e)}const Xr=typeof self=="object"?self:null,dN=Xr&&(Xr.hasOwnProperty("AudioContext")||Xr.hasOwnProperty("webkitAudioContext"));function pN(r,t,e){return Xt(ne(cy),"This node only works in a secure context (https or localhost)"),new cy(r,t,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Si(r,t,e,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,t,e,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(t,e,s):o(t,e))||s);return i>3&&s&&Object.defineProperty(t,e,s),s}function He(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{h(n.next(u))}catch(d){o(d)}}function l(u){try{h(n.throw(u))}catch(d){o(d)}}function h(u){u.done?s(u.value):i(u.value).then(a,l)}h((n=n.apply(r,t||[])).next())})}class fN{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(t*1e3,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Yr(r){return rN(r)}function hr(r){return sN(r)}function gu(r){return oN(r)}function Ra(r){return iN(r)}function py(r){return r instanceof AudioBuffer}function mN(r,t){return r==="value"||Yr(t)||hr(t)||py(t)}function Da(r,...t){if(!t.length)return r;const e=t.shift();if($r(r)&&$r(e))for(const n in e)mN(n,e[n])?r[n]=e[n]:$r(e[n])?(r[n]||Object.assign(r,{[n]:{}}),Da(r[n],e[n])):Object.assign(r,{[n]:e[n]});return Da(r,...t)}function gN(r,t){return r.length===t.length&&r.every((e,n)=>t[n]===e)}function vt(r,t,e=[],n){const i={},s=Array.from(t);if($r(s[0])&&n&&!Reflect.has(s[0],n)&&(Object.keys(s[0]).some(a=>Reflect.has(r,a))||(Da(i,{[n]:s[0]}),e.splice(e.indexOf(n),1),s.shift())),s.length===1&&$r(s[0]))Da(i,s[0]);else for(let o=0;o<e.length;o++)ne(s[o])&&(i[e[o]]=s[o]);return Da(r,i)}function _N(r){return r.constructor.getDefaults()}function La(r,t){return li(r)?t:r}function ka(r,t){return t.forEach(e=>{Reflect.has(r,e)&&delete r[e]}),r}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class ms{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Xr&&this.toString()===Xr.TONE_DEBUG_CLASS)&&aN(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}ms.version=ex;const Zf=1e-6;function _u(r,t){return r>t+Zf}function Jf(r,t){return _u(r,t)||Ti(r,t)}function fy(r,t){return r+Zf<t}function Ti(r,t){return Math.abs(r-t)<Zf}function vN(r,t,e){return Math.max(Math.min(r,e),t)}class Xi extends ms{constructor(){super();this.name="Timeline",this._timeline=[];const t=vt(Xi.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Xt(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Xt(Jf(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(t){const e=this._timeline.indexOf(t);return e!==-1&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Ti(this._timeline[e].time,t)){for(let n=e;n>=0&&Ti(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else this._timeline.length===1&&Jf(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(this._timeline.length===0)return-1;let n=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<s;){let o=Math.floor(n+(s-n)/2);const a=this._timeline[o],l=this._timeline[o+1];if(Ti(a[e],t)){for(let h=o;h<this._timeline.length;h++){const u=this._timeline[h];if(Ti(u[e],t))o=h;else break}return o}else{if(fy(a[e],t)&&_u(l[e],t))return o;_u(a[e],t)?s=o:n=o+1}}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return n!==-1&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),s=this._search(e);return i!==-1&&s!==-1?(this._timeline[i].time!==t&&(i+=1),this._timeline[s].time===e&&(s-=1),this._iterate(n,i,s)):i===-1&&this._iterate(n,0,s),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(n!==-1&&Ti(this._timeline[n].time,t)){let i=n;for(let s=n;s>=0&&Ti(this._timeline[s].time,t);s--)i=s;this._iterate(s=>{e(s)},i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const my=[];function vu(r){my.push(r)}function xN(r){my.forEach(t=>t(r))}const gy=[];function xu(r){gy.push(r)}function yN(r){gy.forEach(t=>t(r))}class ec extends ms{constructor(){super(...arguments);this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(i=>{li(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(e)}),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach(i=>{if(li(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(li(e))this._events[t]=[];else{const s=this._events[t];for(let o=s.length-1;o>=0;o--)s[o]===e&&s.splice(o,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let i=0,s=n.length;i<s;i++)n[i].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const n=Object.getOwnPropertyDescriptor(ec.prototype,e);Object.defineProperty(t.prototype,e,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class _y extends ec{constructor(){super(...arguments);this.isOffline=!1}toJSON(){return{}}}class nc extends _y{constructor(){super();this.name="Context",this._constants=new Map,this._timeouts=new Xi,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=vt(nc.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=hN({latencyHint:t.latencyHint}),this._ticker=new fN(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(xN(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return Xt(Ra(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return Xt(Ra(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return Xt(Ra(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Xt(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Xt(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Xt(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Xt(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return pN(this.rawContext,t,e)}addAudioWorkletModule(t,e){return He(this,void 0,void 0,function*(){Xt(ne(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)})}workletsAreReady(){return He(this,void 0,void 0,function*(){const t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,$i(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25;break}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Ra(this._context)?this._context.resume():Promise.resolve()}close(){return He(this,void 0,void 0,function*(){Ra(this._context)&&(yield this._context.close()),this._initialized&&yN(this)})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let s=0;s<n.length;s++)n[s]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:s+e})};return i(),n}}class bN extends _y{constructor(){super(...arguments);this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return He(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}}function De(r,t){Mi(t)?t.forEach(e=>De(r,e)):Object.defineProperty(r,t,{enumerable:!0,writable:!1})}function Kf(r,t){Mi(t)?t.forEach(e=>Kf(r,e)):Object.defineProperty(r,t,{writable:!0})}const xe=()=>{};class ye extends ms{constructor(){super();this.name="ToneAudioBuffer",this.onload=xe;const t=vt(ye.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&py(t.url)||t.url instanceof ye?this.set(t.url):$i(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:xe,onload:xe,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ei().sampleRate}set(t){return t instanceof ye?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return He(this,void 0,void 0,function*(){const e=ye.load(t).then(n=>{this.set(n),this.onload(this)});ye.downloads.push(e);try{yield e}finally{const n=ye.downloads.indexOf(e);ye.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Mi(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,s=Ei(),o=s.createBuffer(n,i,s.sampleRate),a=!e&&n===1?[t]:t;for(let l=0;l<n;l++)o.copyToChannel(a[l],l);return this._buffer=o,this}toMono(t){if(cr(t))this.fromArray(this.toArray(t));else{let e=new Float32Array(this.length);const n=this.numberOfChannels;for(let i=0;i<n;i++){const s=this.toArray(i);for(let o=0;o<s.length;o++)e[o]+=s[o]}e=e.map(i=>i/n),this.fromArray(e)}return this}toArray(t){if(cr(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{const e=[];for(let n=0;n<this.numberOfChannels;n++)e[n]=this.getChannelData(n);return e}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Xt(n<i,"The start time must be less than the end time");const s=i-n,o=Ei().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(n,i),a);return new ye(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new ye().fromArray(t)}static fromUrl(t){return He(this,void 0,void 0,function*(){return yield new ye().load(t)})}static load(t){return He(this,void 0,void 0,function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const a=e[1].split("|");let l=a[0];for(const h of a)if(ye.supportsType(h)){l=h;break}t=t.replace(e[0],l)}const n=ye.baseUrl===""||ye.baseUrl.endsWith("/")?ye.baseUrl:ye.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const s=yield i.arrayBuffer();return yield Ei().decodeAudioData(s)})}static supportsType(t){const e=t.split("."),n=e[e.length-1];return document.createElement("audio").canPlayType("audio/"+n)!==""}static loaded(){return He(this,void 0,void 0,function*(){for(yield Promise.resolve();ye.downloads.length;)yield ye.downloads[0]})}}ye.baseUrl="";ye.downloads=[];class Qf extends nc{constructor(){super({clockSource:"offline",context:gu(arguments[0])?arguments[0]:uN(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:gu(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]});this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=gu(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return He(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(t=!0){return He(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new ye(e)})}close(){return Promise.resolve()}}const vy=new bN;let ic=vy;function Ei(){return ic===vy&&dN&&wN(new nc),ic}function wN(r){Ra(r)?ic=new nc(r):gu(r)?ic=new Qf(r):ic=r}if(Xr&&!Xr.TONE_SILENCE_LOGGING){const t=` * Tone.js v${ex} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function MN(r){return Math.pow(10,r/20)}function SN(r){return 20*(Math.log(r)/Math.LN10)}function xy(r){return Math.pow(2,r/12)}let yu=440;function TN(){return yu}function EN(r){yu=r}function tm(r){return Math.round(yy(r))}function yy(r){return 69+12*Math.log2(r/yu)}function CN(r){return yu*Math.pow(2,(r-69)/12)}class em extends ms{constructor(t,e,n){super();this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i=e==="."?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(Math.floor(e)*3))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&t!=="0"&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(i+=this._beatsToUnits(parseFloat(e))),n&&n!=="0"&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof em&&this.fromType(this._val),li(this._val))return this._noArg();if($i(this._val)&&li(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if($r(this._val)){let t=0;for(const e in this._val)if(ne(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(ne(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}else return $i(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class Ci extends em{constructor(){super(...arguments);this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Ci(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf(),a=Math.round(i/n)*n-i;return i+a*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let s=1;s<9;s++){const o=Math.pow(2,s);e.push(o+"n."),e.push(o+"n"),e.push(o+"t")}e.push("0");let n=e[0],i=new Ci(this.context,e[0]).toSeconds();return e.forEach(s=>{const o=new Ci(this.context,s).toSeconds();Math.abs(o-t)<Math.abs(i-t)&&(n=s,i=o)}),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const s=i.toString();return s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3))),[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return tm(this.toFrequency())}_now(){return this.context.now()}}class ci extends Ci{constructor(){super(...arguments);this.name="Frequency",this.defaultUnits="hz"}static get A4(){return TN()}static set A4(t){EN(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return this.defaultUnits==="midi"?t:ci.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const i=AN[t.toLowerCase()]+(parseInt(e,10)+1)*12;return this.defaultUnits==="midi"?i:ci.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&t!=="0"&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(i*=this._beatsToUnits(parseFloat(e))),n&&n!=="0"&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new ci(this.context,this.valueOf()*xy(t))}harmonize(t){return t.map(e=>this.transpose(e))}toMidi(){return tm(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/ci.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);return i<0&&(n+=-12*i),PN[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(t*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return CN(t)}static ftom(t){return tm(t)}}const AN={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},PN=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class sc extends Ci{constructor(){super(...arguments);this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Fn extends ms{constructor(){super();const t=vt(Fn.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ei()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Ci(this.context,t).toSeconds()}toFrequency(t){return new ci(this.context,t).toFrequency()}toTicks(t){return new sc(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(n=>{li(t[n])&&delete e[n]}),e}get(){const t=_N(this);return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const n=this[e];ne(n)&&ne(n.value)&&ne(n.setValueAtTime)?t[e]=n.value:n instanceof Fn?t[e]=n._getPartialProperties(t[e]):Mi(n)||cr(n)||$i(n)||cN(n)?t[e]=n:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&ne(this[e])&&(this[e]&&ne(this[e].value)&&ne(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Fn?this[e].set(t[e]):this[e]=t[e])}),this}}class nm extends Xi{constructor(t="stopped"){super();this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return e!==null?e.state:this._initial}setStateAtTime(t,e,n){return ji(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){const n=this._search(e);for(let i=n;i>=0;i--){const s=this._timeline[i];if(s.state===t)return s}}getNextState(t,e){const n=this._search(e);if(n!==-1)for(let i=n;i<this._timeline.length;i++){const s=this._timeline[i];if(s.state===t)return s}}}class me extends Fn{constructor(){super(vt(me.getDefaults(),arguments,["param","units","convert"]));this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=vt(me.getDefaults(),arguments,["param","units","convert"]);for(Xt(ne(t.param)&&(Yr(t.param)||t.param instanceof me),"param must be an AudioParam");!Yr(t.param);)t.param=t.param._param;this._swappable=ne(t.swappable)?t.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Xi(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,ne(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Fn.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return ne(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return ne(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return ne(this.maxValue)&&ne(this.minValue)&&ji(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?MN(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&this.units==="decibels"?SN(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Xt(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let s=this._initialValue;if(i===null)s=this._initialValue;else if(i.type==="setTargetAtTime"&&(n===null||n.type==="setValueAtTime")){const o=this._events.getBefore(i.time);let a;o===null?a=this._initialValue:a=o.value,i.type==="setTargetAtTime"&&(s=this._exponentialApproach(i.time,a,i.value,i.constant,e))}else if(n===null)s=i.value;else if(n.type==="linearRampToValueAtTime"||n.type==="exponentialRampToValueAtTime"){let o=i.value;if(i.type==="setTargetAtTime"){const a=this._events.getBefore(i.time);a===null?o=this._initialValue:o=a.value}n.type==="linearRampToValueAtTime"?s=this._linearInterpolate(i.time,o,n.time,n.value,e):s=this._exponentialInterpolate(i.time,o,n.time,n.value,e)}else s=i.value;return this._toType(s)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(e)===0&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Xt(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Ti(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return Xt(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+n*.9),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);Xt(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(e);return this._assertRange(i),Xt(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,s,n),this._param.setTargetAtTime(i,s,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const s=this._fromType(t[0])*i;this.setValueAtTime(this._toType(s),e);const o=n/(t.length-1);for(let a=1;a<t.length;a++){const l=this._fromType(t[a])*i;this.linearRampToValueAtTime(this._toType(l),e+a*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Xt(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Xt(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),s=this._events.getAfter(e);return i&&Ti(i.time,e)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(n),e):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&n.type==="setTargetAtTime"){const i=this._events.getAfter(n.time),s=i?i.time:e+2,o=(s-e)/10;for(let a=e;a<s;a+=o)t.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,i=>{i.type==="cancelScheduledValues"?t.cancelScheduledValues(i.time):i.type==="setTargetAtTime"?t.setTargetAtTime(i.value,i.time,i.constant):t[i.type](i.value,i.time)}),this}setParam(t){Xt(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,s){return n+(e-n)*Math.exp(-(s-t)/i)}_linearInterpolate(t,e,n,i,s){return e+(i-e)*((s-t)/(n-t))}_exponentialInterpolate(t,e,n,i,s){return e*Math.pow(i/e,(s-t)/(n-t))}}class Ut extends Fn{constructor(){super(...arguments);this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return ne(this.input)?Yr(this.input)||this.input instanceof me?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ne(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return ne(t)&&(t instanceof Ut||hr(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(n=>{n.channelCount=t.channelCount,n.channelCountMode=t.channelCountMode,n.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();Xt(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Ia(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return dy("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return RN(this,t,e,n),this}chain(...t){return rc(this,...t),this}fan(...t){return t.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),ne(this.input)&&(this.input instanceof Ut?this.input.dispose():hr(this.input)&&this.input.disconnect()),ne(this.output)&&(this.output instanceof Ut?this.output.dispose():hr(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function rc(...r){const t=r.shift();r.reduce((e,n)=>(e instanceof Ut?e.connect(n):hr(e)&&Ia(e,n),n),t)}function Ia(r,t,e=0,n=0){for(Xt(ne(r),"Cannot connect from undefined node"),Xt(ne(t),"Cannot connect to undefined node"),(t instanceof Ut||hr(t))&&Xt(t.numberOfInputs>0,"Cannot connect to node with no inputs"),Xt(r.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof Ut||t instanceof me;)ne(t.input)&&(t=t.input);for(;r instanceof Ut;)ne(r.output)&&(r=r.output);Yr(t)?r.connect(t,e):r.connect(t,e,n)}function RN(r,t,e=0,n=0){if(ne(t))for(;t instanceof Ut;)t=t.input;for(;!hr(r);)ne(r.output)&&(r=r.output);Yr(t)?r.disconnect(t,e):hr(t)?r.disconnect(t,e,n):r.disconnect()}class Xe extends Ut{constructor(){super(vt(Xe.getDefaults(),arguments,["gain","units"]));this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=vt(Xe.getDefaults(),arguments,["gain","units"]);this.gain=new me({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),De(this,"gain")}static getDefaults(){return Object.assign(Ut.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Na extends Ut{constructor(t){super(t);this.onended=xe,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Xe({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){const n=this.toSeconds(e);return this._startTime!==-1&&n>=this._startTime&&(this._stopTime===-1||n<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Ut.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:xe})}_startGain(t,e=1){Xt(this._startTime===-1,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Xt(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n=this._curve==="exponential"?e*2:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==xe&&(this.onended(this),this.onended=xe,!this.context.isOffline)){const t=()=>this.dispose();typeof window.requestIdleCallback!="undefined"?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Xt(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class bu extends Na{constructor(){super(vt(bu.getDefaults(),arguments,["offset"]));this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=vt(bu.getDefaults(),arguments,["offset"]);Ia(this._source,this._gainNode),this.offset=new me({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Na.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Te extends Ut{constructor(){super(vt(Te.getDefaults(),arguments,["value","units"]));this.name="Signal",this.override=!0;const t=vt(Te.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new bu({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Ut.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return im(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function im(r,t,e,n){(t instanceof me||Yr(t)||t instanceof Te&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof Te&&(t.overridden=!0)),Ia(r,t,e,n)}class wu extends me{constructor(){super(vt(wu.getDefaults(),arguments,["value"]));this.name="TickParam",this._events=new Xi(1/0),this._multiplier=1;const t=vt(wu.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(me.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),s=this._events.get(e),o=Math.round(Math.max(1/n,1));for(let a=0;a<=o;a++){const l=n*a+e,h=this._exponentialApproach(s.time,s.value,i,n,l);this.linearRampToValueAtTime(this._toType(h),l)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),o=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),o=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),s=Math.round(Math.max((e-i.time)*10,1)),o=(e-i.time)/s;for(let a=0;a<=s;a++){const l=o*a+i.time,h=this._exponentialInterpolate(i.time,i.value,e,n,l);this.linearRampToValueAtTime(this._toType(h),l)}return this}_getTicksUntilEvent(t,e){if(t===null)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(li(t.ticks)){const o=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(o,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const s=this._events.get(e);return s&&s.time===e&&s.type==="setValueAtTime"&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&n.type==="linearRampToValueAtTime"&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),o=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),a=Math.sqrt(Math.pow(i,2)-2*o*(e.ticks-t)),l=(-i+a)/o,h=(-i-a)/o;return(l>0?l:h)+e.time}else return e?e.value===0?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),s=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-s}_fromType(t){return this.units==="bpm"&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units==="bpm"&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Mu extends Te{constructor(){super(vt(Mu.getDefaults(),arguments,["value"]));this.name="TickSignal";const t=vt(Mu.getDefaults(),arguments,["value"]);this.input=this._param=new wu({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Te.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Su extends Fn{constructor(){super(vt(Su.getDefaults(),arguments,["frequency"]));this.name="TickSource",this._state=new nm,this._tickOffset=new Xi;const t=vt(Su.getDefaults(),arguments,["frequency"]);this.frequency=new Mu({context:this.context,units:t.units,value:t.frequency}),De(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Fn.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),ne(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if(this._state.getValueAtTime(e)==="stopped"){const n=this._state.get(e);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let s=n,o=0;return this._state.forEachBetween(n.time,e+this.sampleTime,a=>{let l=s.time;const h=this._tickOffset.get(a.time);h&&h.time>=s.time&&(o=h.ticks,l=h.time),s.state==="started"&&a.state!=="started"&&(o+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(l)),s=a}),this._state.remove(i),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,s=0;return this._state.forEachBetween(e.time,t+this.sampleTime,o=>{let a=i.time;const l=this._tickOffset.get(o.time);l&&l.time>=i.time&&(s=l.seconds,a=l.time),i.state==="started"&&o.state!=="started"&&(s+=o.time-a),i=o}),this._state.remove(n),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),s=Math.max(n.time,i.time),o=this.frequency.getTicksAtTime(s)+t-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,o=>{i&&i.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(i.time,t),o.time-this.sampleTime,n),i=o});let s=null;if(i&&i.state==="started"){const o=Math.max(i.time,t),a=this.frequency.getTicksAtTime(o),l=this.frequency.getTicksAtTime(i.time),h=a-l;let u=Math.ceil(h)-h;u=Ti(u,1)?0:u;let d=this.frequency.getTimeOfTick(a+u);for(;d<e;){try{n(d,Math.round(this.getTicksAtTime(d)))}catch(f){s=f;break}d+=this.frequency.getDurationOfTicks(1,d)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class oc extends Fn{constructor(){super(vt(oc.getDefaults(),arguments,["callback","frequency"]));this.name="Clock",this.callback=xe,this._lastUpdate=0,this._state=new nm("stopped"),this._boundLoop=this._loop.bind(this);const t=vt(oc.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Su({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,De(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Fn.getDefaults(),{callback:xe,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){hy(this.context);const n=this.toSeconds(t);return this.log("start",n),this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,n=>{switch(n.state){case"started":const i=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,i);break;case"stopped":n.time!==0&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time);break}}),this._tickSource.forEachTickBetween(t,e,(n,i)=>{this.callback(n,i)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ec.mixin(oc);class sm extends ms{constructor(){super();this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=vt(sm.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:xe,onload:xe,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Xt(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,n=xe,i=xe){return $i(e)?this._buffers.set(t.toString(),new ye(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new ye(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class gs extends sc{constructor(){super(...arguments);this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class DN extends Fn{constructor(){super(...arguments);this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Xi,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}vu(r=>{r.draw=new DN({context:r})});xu(r=>{r.draw.dispose()});class LN extends ms{constructor(){super(...arguments);this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Xt(ne(t.time),"Events must have a time property"),Xt(ne(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new kN(t.time,t.time+t.duration,t);for(this._root===null?this._root=e:this._root.insert(e),this._length++;e!==null;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(this._root!==null){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,e=>this.remove(e)),this}_setRoot(t){this._root=t,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(t,e){t.parent!==null?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(t.left===null&&t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{const e=t.getBalance();let n,i=null;if(e>0)if(t.left.right===null)n=t.left,n.right=t.right,i=n;else{for(n=t.left.right;n.right!==null;)n=n.right;n.parent&&(n.parent.right=n.left,i=n.parent,n.left=t.left,n.right=t.right)}else if(t.right.left===null)n=t.right,n.left=t.left,i=n;else{for(n=t.right.left;n.left!==null;)n=n.left;n.parent&&(n.parent.left=n.right,i=n.parent,n.left=t.left,n.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=n:t.parent.right=n:this._setRoot(n),i&&this._rebalance(i)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),e!==null?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),e!==null?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){const e=[];if(this._root.search(t,e),e.length>0){let n=e[0];for(let i=1;i<e.length;i++)e[i].low>n.low&&(n=e[i]);return n.event}}return null}forEach(t){if(this._root!==null){const e=[];this._root.traverse(n=>e.push(n)),e.forEach(n=>{n.event&&t(n.event)})}return this}forEachAtTime(t,e){if(this._root!==null){const n=[];this._root.search(t,n),n.forEach(i=>{i.event&&e(i.event)})}return this}forEachFrom(t,e){if(this._root!==null){const n=[];this._root.searchAfter(t,n),n.forEach(i=>{i.event&&e(i.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class kN{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(this.left!==null&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),!(this.low>t)&&this.right!==null&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),this.left!==null&&this.left.searchAfter(t,e)),this.right!==null&&this.right.searchAfter(t,e)}traverse(t){t(this),this.left!==null&&this.left.traverse(t),this.right!==null&&this.right.traverse(t)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null&&this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null&&(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Zr extends Ut{constructor(){super(vt(Zr.getDefaults(),arguments,["volume"]));this.name="Volume";const t=vt(Zr.getDefaults(),arguments,["volume"]);this.input=this.output=new Xe({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,De(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Ut.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Tu extends Ut{constructor(){super(vt(Tu.getDefaults(),arguments));this.name="Destination",this.input=new Zr({context:this.context}),this.output=new Xe({context:this.context}),this.volume=this.input.volume;const t=vt(Tu.getDefaults(),arguments);rc(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Ut.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),rc(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}vu(r=>{r.destination=new Tu({context:r})});xu(r=>{r.destination.dispose()});class IN extends ms{constructor(t){super();this.name="TimelineValue",this._timeline=new Xi({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class ur{constructor(t,e){this.id=ur._eventId++;const n=Object.assign(ur.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:xe,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}ur._eventId=0;class rm extends ur{constructor(t,e){super(t,e);this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(rm.getDefaults(),e);this.duration=new gs(t.context,n.duration).valueOf(),this._interval=new gs(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},ur.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new gs(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new gs(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new gs(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class ac extends Fn{constructor(){super(vt(ac.getDefaults(),arguments));this.name="Transport",this._loop=new IN(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Xi,this._repeatedEvents=new LN,this._syncedSignals=[],this._swingAmount=0;const t=vt(ac.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new oc({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),De(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Fn.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(this._swingTicks*2)!=0){const n=e%(this._swingTicks*2)/(this._swingTicks*2),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new gs(this.context,this._swingTicks*2/3).toSeconds()*i}this._timeline.forEachAtTime(e,n=>n.invoke(t))}schedule(t,e){const n=new ur(this,{callback:t,time:new sc(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const s=new rm(this,{callback:t,duration:new Ci(this.context,i).toTicks(),interval:new Ci(this.context,e).toTicks(),time:new sc(this.context,n).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(t,e){const n=new ur(this,{callback:t,once:!0,time:new sc(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(e,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new gs(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return ne(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!=="started"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Mi(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Ci(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Ci(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new gs(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new gs(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if(this.state==="started"){const n=this._clock.getTicksAtTime(e),i=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e),s=e+i;this.emit("stop",s),this._clock.setTicksAtTime(t,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!=="started")return 0;{const e=this.now(),n=this.getTicksAtTime(e),i=t-n%t;return this._clock.nextTickTime(i,e)}}syncSignal(t,e){if(!e){const i=this.now();if(t.getValueAtTime(i)!==0){const s=this.bpm.getValueAtTime(i),o=1/(60/s/this.PPQ);e=t.getValueAtTime(i)/o}else e=0}const n=new Xe(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Kf(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ec.mixin(ac);vu(r=>{r.transport=new ac({context:r})});xu(r=>{r.transport.dispose()});class On extends Ut{constructor(t){super(t);this.input=void 0,this._state=new nm("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=xe,this._syncedStop=xe,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Zr({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,De(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Ut.getDefaults(),{mute:!1,onstop:xe,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=li(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),!this._synced&&this._state.getValueAtTime(i)==="started")Xt(_u(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);else if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const s=this._state.get(i);s&&(s.offset=this.toSeconds(La(e,0)),s.duration=n?this.toSeconds(n):void 0);const o=this.context.transport.schedule(a=>{this._start(a,e,n)},i);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else hy(this.context),this._start(i,e,n);return this}stop(t){let e=li(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this._state.getValueAtTime(e)==="started"||ne(this._state.getNextState("started",e))){if(this.log("stop",e),!this._synced)this._stop(e);else{const n=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(n)}this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),this._state.getValueAtTime(t)==="started"&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&n.state==="started"&&n.time!==e){const i=e-this.toSeconds(n.time);let s;n.duration&&(s=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,s)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)==="started"&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=xe,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class lc extends Na{constructor(){super(vt(lc.getDefaults(),arguments,["url","onload"]));this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=vt(lc.getDefaults(),arguments,["url","onload"]);Ia(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new me({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new ye(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Na.getDefaults(),{url:new ye,loop:!1,loopEnd:0,loopStart:0,onload:xe,onerror:xe,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){Xt(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(t);this._startGain(s,i),this.loop?e=La(e,this.loopStart):e=La(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),h=a-l;Jf(o,a)&&(o=(o-l)%h+l),Ti(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,fy(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,o)),ne(n)){let a=this.toSeconds(n);a=Math.max(a,0),this.stop(s+a)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Jr(r,t){return He(this,void 0,void 0,function*(){const e=t/r.context.sampleRate,n=new Qf(1,e,r.context.sampleRate);return new r.constructor(Object.assign(r.get(),{frequency:2/e,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class Eu extends Na{constructor(){super(vt(Eu.getDefaults(),arguments,["frequency","type"]));this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=vt(Eu.getDefaults(),arguments,["frequency","type"]);Ia(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new me({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new me({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),De(this,["frequency","detune"])}static getDefaults(){return Object.assign(Na.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class ze extends On{constructor(){super(vt(ze.getDefaults(),arguments,["frequency","type"]));this.name="Oscillator",this._oscillator=null;const t=vt(ze.getDefaults(),arguments,["frequency","type"]);this.frequency=new Te({context:this.context,units:"frequency",value:t.frequency}),De(this,"frequency"),this.detune=new Te({context:this.context,units:"cents",value:t.detune}),De(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&t.type!=="custom"&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(On.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new Eu({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return ze._periodicWaveCache.find(e=>e.phase===this._phase&&gN(e.partials,this._partials));{const t=ze._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=["sine","square","sawtooth","triangle"].indexOf(t)!==-1;if(this._phase===0&&e)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=t);else{const n=this._getCachedPeriodicWave();if(ne(n)){const{partials:i,wave:s}=n;this._wave=s,this._partials=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[i,s]=this._getRealImaginary(t,this._phase),o=this.context.createPeriodicWave(i,s);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),ze._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),ze._periodicWaveCache.length>100&&ze._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&this._type!=="custom"&&t!=="custom"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){ji(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),this._type!=="custom")t===0?this.type=e:this.type=e+t.toString();else{const i=new Float32Array(t);this._partials.forEach((s,o)=>i[o]=s),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(t,e){let i=4096/2;const s=new Float32Array(i),o=new Float32Array(i);let a=1;if(t==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,i=a,this._partials.length===0)return[s,o]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);l?(a=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),t=l[1],a=Math.max(a,2),i=a):this._partialCount=0,this._partials=[]}for(let l=1;l<i;++l){const h=2/(l*Math.PI);let u;switch(t){case"sine":u=l<=a?1:0,this._partials[l-1]=u;break;case"square":u=l&1?2*h:0,this._partials[l-1]=u;break;case"sawtooth":u=h*(l&1?1:-1),this._partials[l-1]=u;break;case"triangle":l&1?u=2*(h*h)*(l-1>>1&1?-1:1):u=0,this._partials[l-1]=u;break;case"custom":u=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}u!==0?(s[l]=-u*Math.sin(e*l),o[l]=u*Math.cos(e*l)):(s[l]=0,o[l]=0)}return[s,o]}_inverseFFT(t,e,n){let i=0;const s=t.length;for(let o=0;o<s;o++)i+=t[o]*Math.cos(o*n)+e[o]*Math.sin(o*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=Math.PI*2,s=32;for(let o=0;o<s;o++)n=Math.max(this._inverseFFT(t,e,o/s*i),n);return vN(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}ze._periodicWaveCache=[];class dr extends Ut{constructor(){super(Object.assign(vt(dr.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return im(this,t,e,n),this}}class Fa extends dr{constructor(){super(Object.assign(vt(Fa.getDefaults(),arguments,["mapping","length"])));this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=vt(Fa.getDefaults(),arguments,["mapping","length"]);Mi(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):lN(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Te.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,s=e;i<s;i++){const o=i/(s-1)*2-1;n[i]=t(o,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){const e=["none","2x","4x"].some(n=>n.includes(t));Xt(e,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class NN extends dr{constructor(){super(...arguments);this.name="AudioToGain",this._norm=new Fa({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class pr extends Te{constructor(){super(Object.assign(vt(pr.getDefaults(),arguments,["value"])));this.name="Multiply",this.override=!1;const t=vt(pr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Xe({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Te.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class cc extends On{constructor(){super(vt(cc.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="AMOscillator",this._modulationScale=new NN({context:this.context}),this._modulationNode=new Xe({context:this.context});const t=vt(cc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ze({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ze({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new pr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),De(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ze.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class hc extends On{constructor(){super(vt(hc.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="FMOscillator",this._modulationNode=new Xe({context:this.context,gain:0});const t=vt(hc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ze({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Te({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ze({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new pr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new pr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),De(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ze.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Oa extends On{constructor(){super(vt(Oa.getDefaults(),arguments,["frequency","width"]));this.name="PulseOscillator",this._widthGate=new Xe({context:this.context,gain:0}),this._thresh=new Fa({context:this.context,mapping:e=>e<=0?-1:1});const t=vt(Oa.getDefaults(),arguments,["frequency","width"]);this.width=new Te({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ze({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),De(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(On.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class uc extends On{constructor(){super(vt(uc.getDefaults(),arguments,["frequency","type","spread"]));this.name="FatOscillator",this._oscillators=[];const t=vt(uc.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Te({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Te({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,De(this,["frequency","detune"])}static getDefaults(){return Object.assign(ze.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach((i,s)=>i.detune.value=e+n*s)}}get count(){return this._oscillators.length}set count(t){if(ji(t,1),this._oscillators.length!==t){this._forEach(e=>e.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const n=new ze({context:this.context,volume:-6-t*1.1,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:e===0?()=>this.onstop(this):xe});this.type==="custom"&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,this.state==="started"&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((e,n)=>e.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class dc extends On{constructor(){super(vt(dc.getDefaults(),arguments,["frequency","modulationFrequency"]));this.name="PWMOscillator",this.sourceType="pwm",this._scale=new pr({context:this.context,value:2});const t=vt(dc.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Oa({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ze({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),De(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(On.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const by={am:cc,fat:uc,fm:hc,oscillator:ze,pulse:Oa,pwm:dc};class Kr extends On{constructor(){super(vt(Kr.getDefaults(),arguments,["frequency","type"]));this.name="OmniOscillator";const t=vt(Kr.getDefaults(),arguments,["frequency","type"]);this.frequency=new Te({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Te({context:this.context,units:"cents",value:t.detune}),De(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ze.getDefaults(),hc.getDefaults(),cc.getDefaults(),uc.getDefaults(),Oa.getDefaults(),dc.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):t==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=by[t],n=this.now();if(this._oscillator){const i=this._oscillator;i.stop(n),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(e=this._oscillator.type),t==="fm"?this.type="fm"+e:t==="am"?this.type="am"+e:t==="fat"?this.type="fat"+e:t==="oscillator"?this.type=e:t==="pulse"?this.type="pulse":t==="pwm"&&(this.type="pwm")}_getOscType(t,e){return t instanceof by[e]}get baseType(){return this._oscillator.baseType}set baseType(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&t!=="pulse"&&t!=="pwm"&&(this._oscillator.baseType=t)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(t){this._getOscType(this._oscillator,"fat")&&cr(t)&&(this._oscillator.count=t)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(t){this._getOscType(this._oscillator,"fat")&&cr(t)&&(this._oscillator.spread=t)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&$i(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(t=1024){return He(this,void 0,void 0,function*(){return Jr(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class om extends Te{constructor(){super(Object.assign(vt(om.getDefaults(),arguments,["value"])));this.override=!1,this.name="Add",this._sum=new Xe({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,rc(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Te.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Cu extends dr{constructor(){super(Object.assign(vt(Cu.getDefaults(),arguments,["min","max"])));this.name="Scale";const t=vt(Cu.getDefaults(),arguments,["min","max"]);this._mult=this.input=new pr({context:this.context,value:t.max-t.min}),this._add=this.output=new om({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(dr.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}function wy(r,t=1/0){const e=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(s){ji(s,r,t),e.set(this,s)}})}}function _s(r,t=1/0){const e=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(s){ji(this.toSeconds(s),r,t),e.set(this,s)}})}}class pc extends On{constructor(){super(vt(pc.getDefaults(),arguments,["url","onload"]));this.name="Player",this._activeSources=new Set;const t=vt(pc.getDefaults(),arguments,["url","onload"]);this._buffer=new ye({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(On.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:xe,onerror:xe,playbackRate:1,reverse:!1})}load(t){return He(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=xe){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){this._loop?e=La(e,this._loopStart):e=La(e,0);const i=this.toSeconds(e),s=n;n=La(n,Math.max(this._buffer.duration-i,0));let o=this.toSeconds(n);o=o/this._playbackRate,t=this.toSeconds(t);const a=new lc({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&li(s)?a.start(t,i):a.start(t,i,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(n=>n.stop(e))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="started"){const i=this.toSeconds(t);this._stop(n),this._start(n,i)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&ji(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&ji(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}Si([_s(0)],pc.prototype,"fadeIn",void 0);Si([_s(0)],pc.prototype,"fadeOut",void 0);class Au extends dr{constructor(){super(Object.assign(vt(Au.getDefaults(),arguments,["value"])));this.name="Pow";const t=vt(Au.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new Fa({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(dr.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class hi extends Ut{constructor(){super(vt(hi.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="Envelope",this._sig=new Te({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=vt(hi.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Ut.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if($i(t))return t;{let n;for(n in Pu)if(Pu[n][e]===t)return n;return t}}_setCurve(t,e,n){if($i(n)&&Reflect.has(Pu,n)){const i=Pu[n];$r(i)?t!=="_decayCurve"&&(this[t]=i[e]):this[t]=i}else if(Mi(n)&&t!=="_decayCurve")this[t]=n;else throw new Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Xt(["linear","exponential"].some(e=>e===t),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let i=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),o=this.getValueAtTime(t);if(o>0){const a=1/i;i=(1-o)/a}if(i<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if(this._attackCurve==="linear")this._sig.linearRampTo(e,i,t);else if(this._attackCurve==="exponential")this._sig.targetRampTo(e,i,t);else{this._sig.cancelAndHoldAtTime(t);let a=this._attackCurve;for(let l=1;l<a.length;l++)if(a[l-1]<=o&&o<=a[l]){a=this._attackCurve.slice(l),a[0]=o;break}this._sig.setValueCurveAtTime(a,t,i,e)}if(s&&this.sustain<1){const a=e*this.sustain,l=t+i;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,s+l):this._sig.exponentialApproachValueAtTime(a,l,s)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve==="linear"?this._sig.linearRampTo(0,n,t):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,n,t):(Xt(Mi(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return im(this,t,e,n),this}asArray(t=1024){return He(this,void 0,void 0,function*(){const e=t/this.context.sampleRate,n=new Qf(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),o=s*.1,a=s+o,l=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/a,decay:e*this.toSeconds(this.decay)/a,release:e*this.toSeconds(this.release)/a,context:n}));return l._sig.toDestination(),l.triggerAttackRelease(e*(i+o)/a,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}Si([_s(0)],hi.prototype,"attack",void 0);Si([_s(0)],hi.prototype,"decay",void 0);Si([wy(0,1)],hi.prototype,"sustain",void 0);Si([_s(0)],hi.prototype,"release",void 0);const Pu=(()=>{const r=128;let t,e;const n=[];for(t=0;t<r;t++)n[t]=Math.sin(t/(r-1)*(Math.PI/2));const i=[],s=6.4;for(t=0;t<r-1;t++){e=t/(r-1);const f=Math.sin(e*(Math.PI*2)*s-Math.PI/2)+1;i[t]=f/10+e*.83}i[r-1]=1;const o=[],a=5;for(t=0;t<r;t++)o[t]=Math.ceil(t/(r-1)*a)/a;const l=[];for(t=0;t<r;t++)e=t/(r-1),l[t]=.5*(1-Math.cos(Math.PI*e));const h=[];for(t=0;t<r;t++){e=t/(r-1);const f=Math.pow(e,3)*4+.2,m=Math.cos(f*Math.PI*2*e);h[t]=Math.abs(m*(1-e))}function u(f){const m=new Array(f.length);for(let _=0;_<f.length;_++)m[_]=1-f[_];return m}function d(f){return f.slice(0).reverse()}return{bounce:{In:u(h),Out:h},cosine:{In:n,Out:d(n)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:l,Out:u(l)},step:{In:o,Out:u(o)}}})();class Qr extends Ut{constructor(){super(vt(Qr.getDefaults(),arguments));this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=vt(Qr.getDefaults(),arguments);this._volume=this.output=new Zr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,De(this,"volume")}static getDefaults(){return Object.assign(Ut.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...i)=>{const s=i[e],o=this.context.transport.schedule(a=>{i[e]=a,n.apply(this,i)},s);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n),o=this.toSeconds(e);return this.triggerAttack(t,s,i),this.triggerRelease(s+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class vs extends Qr{constructor(){super(vt(vs.getDefaults(),arguments));const t=vt(vs.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Qr.getDefaults(),{detune:0,onsilence:xe,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof ci?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,s,n)}else this.frequency.setValueAtTime(i,n);return this}}Si([_s(0)],vs.prototype,"portamento",void 0);class Ru extends hi{constructor(){super(vt(Ru.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="AmplitudeEnvelope",this._gainNode=new Xe({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class fc extends vs{constructor(){super(vt(fc.getDefaults(),arguments));this.name="Synth";const t=vt(fc.getDefaults(),arguments);this.oscillator=new Kr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Ru(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),De(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(vs.getDefaults(),{envelope:Object.assign(ka(hi.getDefaults(),Object.keys(Ut.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(ka(Kr.getDefaults(),[...Object.keys(On.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class mc extends Ut{constructor(){super(vt(mc.getDefaults(),arguments,["frequency","type"]));this.name="BiquadFilter";const t=vt(mc.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new me({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new me({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new me({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new me({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(Ut.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){Xt(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t)!==-1,`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let o=0;o<t;o++){const l=Math.pow(o/t,2)*(2e4-20)+20;e[o]=l}const n=new Float32Array(t),i=new Float32Array(t),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class gc extends Ut{constructor(){super(vt(gc.getDefaults(),arguments,["frequency","type","rolloff"]));this.name="Filter",this.input=new Xe({context:this.context}),this.output=new Xe({context:this.context}),this._filters=[];const t=vt(gc.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Te({context:this.context,units:"positive",value:t.Q}),this.frequency=new Te({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Te({context:this.context,units:"cents",value:t.detune}),this.gain=new Te({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,De(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Ut.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){Xt(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t)!==-1,`Invalid filter type: ${t}`),this._type=t,this._filters.forEach(n=>n.type=t)}get rolloff(){return this._rolloff}set rolloff(t){const e=cr(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let i=n.indexOf(e);Xt(i!==-1,`rolloff can only be ${n.join(", ")}`),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(s=>s.disconnect()),this._filters=new Array(i);for(let s=0;s<i;s++){const o=new mc({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[s]=o}this._internalChannels=this._filters,rc(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new mc({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((s,o)=>n[o]*=s)}),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose()}),Kf(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class _c extends hi{constructor(){super(vt(_c.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="FrequencyEnvelope";const t=vt(_c.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Au({context:this.context,value:t.exponent}),this._scale=this.output=new Cu({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(hi.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);ji(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class am extends vs{constructor(){super(vt(am.getDefaults(),arguments));this.name="MonoSynth";const t=vt(am.getDefaults(),arguments);this.oscillator=new Kr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new gc(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new _c(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Ru(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),De(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(vs.getDefaults(),{envelope:Object.assign(ka(hi.getDefaults(),Object.keys(Ut.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(ka(gc.getDefaults(),Object.keys(Ut.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(ka(_c.getDefaults(),Object.keys(Ut.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(ka(Kr.getDefaults(),Object.keys(On.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class vc extends fc{constructor(){super(vt(vc.getDefaults(),arguments));this.name="MembraneSynth",this.portamento=0;const t=vt(vc.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,De(this,["oscillator","envelope"])}static getDefaults(){return Da(vs.getDefaults(),fc.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof ci?t.toFrequency():t),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Si([wy(0)],vc.prototype,"octaves",void 0);Si([_s(0)],vc.prototype,"pitchDecay",void 0);const My=new Set;function lm(r){My.add(r)}function Sy(r,t){const e=`registerProcessor("${r}", ${t})`;My.add(e)}const FN=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;lm(FN);const ON=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;lm(ON);const zN=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;lm(zN);const VN="feedback-comb-filter",BN=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;Sy(VN,BN);class xc extends Qr{constructor(){super(vt(xc.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"));this.name="Sampler",this._activeSources=new Map;const t=vt(xc.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(n=>{const i=parseInt(n,10);if(Xt(mu(n)||cr(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),mu(n)){const s=new ci(this.context,n).toMidi();e[s]=t.urls[n]}else cr(i)&&isFinite(i)&&(e[i]=t.urls[i])}),this._buffers=new sm({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Qr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:xe,onerror:xe,release:.1,urls:{}})}_findClosest(t){const e=96;let n=0;for(;n<e;){if(this._buffers.has(t+n))return-n;if(this._buffers.has(t-n))return n;n++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(i=>{const s=yy(new ci(this.context,i).toFrequency()),o=Math.round(s),a=s-o,l=this._findClosest(o),h=o-l,u=this._buffers.get(h),d=xy(l+a),f=new lc({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:d}).connect(this.output);f.start(e,0,u.duration/d,n),Mi(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const m=this._activeSources.get(o),_=m.indexOf(f);_!==-1&&m.splice(_,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(n=>{const i=new ci(this.context,n).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const s=this._activeSources.get(i);e=this.toSeconds(e),s.forEach(o=>{o.stop(e)}),this._activeSources.set(i,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(e)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const s=this.toSeconds(n);return this.triggerAttack(t,s,i),Mi(e)?(Xt(Mi(t),"notes must be an array when duration is array"),t.forEach((o,a)=>{const l=e[Math.min(a,e.length-1)];this.triggerRelease(o,s+this.toSeconds(l))})):this.triggerRelease(t,s+this.toSeconds(e)),this}add(t,e,n){if(Xt(mu(t)||isFinite(t),`note must be a pitch or midi: ${t}`),mu(t)){const i=new ci(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(e=>e.dispose())}),this._activeSources.clear(),this}}Si([_s(0)],xc.prototype,"attack",void 0);Si([_s(0)],xc.prototype,"release",void 0);class Du extends Ut{constructor(){super(Object.assign(vt(Du.getDefaults(),arguments,["pan"])));this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=vt(Du.getDefaults(),arguments,["pan"]);this.pan=new me({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",De(this,"pan")}static getDefaults(){return Object.assign(Ut.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const UN="bit-crusher",HN=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;Sy(UN,HN);class Lu extends Ut{constructor(){super(vt(Lu.getDefaults(),arguments,["channels"]));this.name="Split";const t=vt(Lu.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Ut.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class cm extends Ut{constructor(){super(vt(cm.getDefaults(),arguments,["type","size"]));this.name="Analyser",this._analysers=[],this._buffers=[];const t=vt(cm.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Xe({context:this.context}),this._split=new Lu({context:this.context,channels:t.channels}),this.input.connect(this._split),ji(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(Ut.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((t,e)=>{const n=this._buffers[e];this._type==="fft"?t.getFloatFrequencyData(n):this._type==="waveform"&&t.getFloatTimeDomainData(n)}),this.channels===1?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach((e,n)=>{e.fftSize=t*2,this._buffers[n]=new Float32Array(t)})}get channels(){return this._analysers.length}get type(){return this._type}set type(t){Xt(t==="waveform"||t==="fft",`Analyser: invalid type: ${t}`),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach(e=>e.smoothingTimeConstant=t)}dispose(){return super.dispose(),this._analysers.forEach(t=>t.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class Ve extends Ut{constructor(){super(vt(Ve.getDefaults(),arguments,["solo"]));this.name="Solo";const t=vt(Ve.getDefaults(),arguments,["solo"]);this.input=this.output=new Xe({context:this.context}),Ve._allSolos.has(this.context)||Ve._allSolos.set(this.context,new Set),Ve._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Ut.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Ve._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Ve._soloed.has(this.context)||Ve._soloed.set(this.context,new Set),Ve._soloed.get(this.context).add(this)}_removeSolo(){Ve._soloed.has(this.context)&&Ve._soloed.get(this.context).delete(this)}_isSoloed(){return Ve._soloed.has(this.context)&&Ve._soloed.get(this.context).has(this)}_noSolos(){return!Ve._soloed.has(this.context)||Ve._soloed.has(this.context)&&Ve._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ve._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ve._allSolos=new Map;Ve._soloed=new Map;class ku extends Ut{constructor(){super(vt(ku.getDefaults(),arguments,["pan","volume"]));this.name="PanVol";const t=vt(ku.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Du({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Zr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,De(this,["pan","volume"])}static getDefaults(){return Object.assign(Ut.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class to extends Ut{constructor(){super(vt(to.getDefaults(),arguments,["volume","pan"]));this.name="Channel";const t=vt(to.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Ve({solo:t.solo,context:this.context}),this._panVol=this.output=new ku({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),De(this,["pan","volume"])}static getDefaults(){return Object.assign(Ut.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return to.buses.has(t)||to.buses.set(t,new Xe({context:this.context})),to.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new Xe({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}to.buses=new Map;class WN extends Ut{constructor(){super(...arguments);this.name="Listener",this.positionX=new me({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new me({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new me({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new me({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new me({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new me({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new me({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new me({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new me({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Ut.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}vu(r=>{r.listener=new WN({context:r})});xu(r=>{r.listener.dispose()});Ei().transport;Ei().destination;Ei().destination;Ei().listener;Ei().draw;Ei();function MF(){return ye.loaded()}export{jN as A,Gp as B,$N as C,V2 as D,DP as F,hP as G,iv as I,vn as L,Cn as M,XN as O,An as P,Ye as R,S_ as S,N2 as T,ht as V,pe as W,Cv as a,te as b,Pr as c,kt as d,ul as e,rv as f,G_ as g,up as h,sv as i,B2 as j,Kn as k,Yd as l,Vd as m,qN as n,QR as o,am as p,pc as q,MF as r,cm as s};
